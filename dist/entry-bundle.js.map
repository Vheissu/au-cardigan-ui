{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/@aurelia/metadata/dist/esnext/index.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/functions.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/reporter.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/resource.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/di.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/logger.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/profiler.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/eventaggregator.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/subscriber-collection.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/proxy-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/lifecycle.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/setter-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/binding-context.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/signaler.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/definitions.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/connectable.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/binding-behavior.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/value-converter.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/ast.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/flags.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/collection-length-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/array-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/computed-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/dirty-checker.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/collection-size-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/map-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/primitive-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/property-accessor.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/set-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/observer-locator.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/property-binding.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/call-binding.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/expression-parser.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/interpolation-binding.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/let-binding.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/binding/ref-binding.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/observation/bindable-observer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/binding-behaviors/binding-mode.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/binding-behaviors/debounce.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/binding-behaviors/signals.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/binding-behaviors/throttle.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/templating/bindable.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attribute.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/dom.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attributes/flags.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/lifecycle-task.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attributes/if.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attributes/repeat.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attributes/replaceable.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-attributes/with.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/templating/children.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/custom-element.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/value-converters/sanitize.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/renderer.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/templating/render-context.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/templating/controller.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/templating/view.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/resources/value-converters/view.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/activator.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/aurelia.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/configuration.js","webpack:///./node_modules/@aurelia/runtime/dist/esnext/instructions.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/ast.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/attribute-pattern.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/attribute-parser.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/attribute-patterns.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/binding-command.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/semantic-model.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/binding-commands.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/common.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/expression-parser.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/configuration.js","webpack:///./node_modules/@aurelia/jit/dist/esnext/resource-model.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/binding/listener.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/element-attribute-observer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/binding/attribute.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/attribute-ns-accessor.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/checked-observer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/class-attribute-accessor.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/data-attribute-accessor.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/element-property-accessor.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/event-manager.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/select-value-observer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/style-attribute-accessor.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/svg-analyzer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/value-attribute-observer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/observation/observer-locator.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/binding-behaviors/attr.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/binding-behaviors/self.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/binding-behaviors/update-trigger.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/styles/shadow-dom-styles.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/projectors.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/dom.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/custom-attributes/blur.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/custom-attributes/focus.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/custom-attributes/portal.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/definitions.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/instructions.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/create-element.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/resources/custom-elements/compose.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/html-renderer.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/configuration.js","webpack:///./node_modules/@aurelia/runtime-html/dist/esnext/styles/shadow-dom-registry.js","webpack:///./node_modules/@aurelia/scheduler/dist/esnext/now.js","webpack:///./node_modules/@aurelia/scheduler/dist/esnext/types.js","webpack:///./node_modules/@aurelia/scheduler/dist/esnext/task.js","webpack:///./node_modules/@aurelia/scheduler/dist/esnext/task-queue.js","webpack:///./node_modules/@aurelia/scheduler/dist/esnext/scheduler.js","webpack:///./node_modules/@aurelia/kernel/dist/esnext/platform.js","webpack:///./node_modules/@aurelia/debug/dist/esnext/binding/unparser.js","webpack:///./node_modules/@aurelia/debug/dist/esnext/reporter.js","webpack:///./node_modules/@aurelia/debug/dist/esnext/tracer.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/attribute-syntax-transformer.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/binding-commands.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/semantic-model.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/template-binder.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/template-element-factory.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/template-compiler.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/configuration.js","webpack:///./node_modules/@aurelia/jit-html/dist/esnext/html-attribute-syntax-transformer.js","webpack:///./node_modules/@aurelia/scheduler-dom/dist/esnext/index.js","webpack:///./node_modules/@aurelia/runtime-html-browser/dist/esnext/index.js","webpack:///./node_modules/@aurelia/jit-html-browser/dist/esnext/index.js","webpack:///./node_modules/aurelia/dist/esnext/quick-start.js","webpack:///./node_modules/process/browser.js","webpack:///./src/my-app.css?8004","webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack:///./src/my-app.css","webpack:///./node_modules/css-loader/dist/runtime/api.js","webpack:///./node_modules/@aurelia/fetch-client/dist/esnext/retry-interceptor.js","webpack:///./node_modules/@aurelia/fetch-client/dist/esnext/http-client-configuration.js","webpack:///./node_modules/@aurelia/fetch-client/dist/esnext/http-client.js","webpack:///./node_modules/@aurelia/router/dist/esnext/queue.js","webpack:///./node_modules/@aurelia/router/dist/esnext/browser-navigator.js","webpack:///./node_modules/@aurelia/router/dist/esnext/link-handler.js","webpack:///./node_modules/@aurelia/router/dist/esnext/utils.js","webpack:///./node_modules/@aurelia/router/dist/esnext/parser.js","webpack:///./node_modules/@aurelia/router/dist/esnext/viewport-content.js","webpack:///./node_modules/@aurelia/route-recognizer/dist/esnext/index.js","webpack:///./node_modules/@aurelia/router/dist/esnext/viewport-scope.js","webpack:///./node_modules/@aurelia/router/dist/esnext/found-route.js","webpack:///./node_modules/@aurelia/router/dist/esnext/collection.js","webpack:///./node_modules/@aurelia/router/dist/esnext/route-recognizer.js","webpack:///./node_modules/@aurelia/router/dist/esnext/scope.js","webpack:///./node_modules/@aurelia/router/dist/esnext/viewport.js","webpack:///./node_modules/@aurelia/router/dist/esnext/type-resolvers.js","webpack:///./node_modules/@aurelia/router/dist/esnext/viewport-instruction.js","webpack:///./node_modules/@aurelia/router/dist/esnext/interfaces.js","webpack:///./node_modules/@aurelia/router/dist/esnext/hook-manager.js","webpack:///./node_modules/@aurelia/router/dist/esnext/hook.js","webpack:///./node_modules/@aurelia/router/dist/esnext/nav-route.js","webpack:///./node_modules/@aurelia/router/dist/esnext/nav.js","webpack:///./node_modules/@aurelia/router/dist/esnext/task-queue.js","webpack:///./node_modules/@aurelia/router/dist/esnext/browser-viewer-store.js","webpack:///./node_modules/@aurelia/router/dist/esnext/router.js","webpack:///./node_modules/@aurelia/router/dist/esnext/navigator.js","webpack:///./node_modules/@aurelia/router/dist/esnext/instruction-resolver.js","webpack:///./node_modules/@aurelia/router/dist/esnext/resources/nav.js","webpack:///./node_modules/@aurelia/router/dist/esnext/resources/viewport.js","webpack:///./node_modules/@aurelia/router/dist/esnext/resources/viewport-scope.js","webpack:///./node_modules/@aurelia/router/dist/esnext/resources/goto.js","webpack:///./node_modules/@aurelia/router/dist/esnext/resources/href.js","webpack:///./node_modules/@aurelia/router/dist/esnext/configuration.js","webpack:///./src/welcome.html","webpack:///./src/welcome.ts","webpack:///./src/about.html","webpack:///./src/missing.html","webpack:///./src/missing.ts","webpack:///./src/my-app.html","webpack:///./src/my-app.ts","webpack:///./src/main.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","isObject","isNullOrUndefined","metadataInternalSlot","WeakMap","$typeError","operation","args","paramName","actualValue","expectedType","TypeError","map","String","join","toString","toPropertyKeyOrUndefined","propertyKey","GetOrCreateMetadataMap","O","P","Create","targetMetadata","Map","set","metadataMap","OrdinaryHasOwnMetadata","MetadataKey","has","OrdinaryGetOwnMetadata","OrdinaryDefineOwnMetadata","MetadataValue","OrdinaryOwnMetadataKeys","keys","keysObj","k","metadata","metadataKey","metadataValue","target","ensurePropertyKeyOrUndefined","decorate","decorators","attributes","Array","isArray","descriptor","length","decorated","decorator","DecorateProperty","toPropertyKey","DecorateConstructor","$define","$has","OrdinaryHasMetadata","parent","getPrototypeOf","$hasOwn","$get","OrdinaryGetMetadata","$getOwn","$getKeys","OrdinaryMetadataKeys","ownKeys","parentKeys","ownKeysLen","parentKeysLen","Set","add","$getOwnKeys","$delete","delete","OrdinaryDeleteMetadata","Metadata","define","hasOwn","getOwn","getKeys","getOwnKeys","obj","Reflect","writable","configurable","isNumericLookup","isArrayIndex","result","ch","charCodeAt","isNumberOrBigInt","isStringOrDate","Date","baseCase","CharKind","isDigit","assign","charToKind","char","toUpperCase","toLowerCase","input","cb","len","prevKind","sep","output","curChar","curKind","nextChar","charAt","nextKind","camelCase","cache","callback","pascalCase","slice","kebabCase","toArray","arr","ids","nextId","context","compareNumber","a","b","emptyArray","mergeDistinct","arr1","arr2","lookup","arr3","item","len1","len2","push","bound","boundFn","this","mergeArrays","arrays","arraysLen","array","arrayLen","j","firstDefined","values","Error","getPrototypeChain","functionPrototype","Function","proto","chain","Type","toLookup","objs","isNativeFunction","isNative","sourceText","fn","LogLevel","Reporter","level","code","params","error","Tracer","enabled","liveLoggingEnabled","liveWriter","objName","methodName","writer","enableLiveLogging","optionsOrWriter","annotation","prop","keyFor","isKey","startsWith","resource","Protocol","fromAnnotationOrDefinitionOrTypeOrDefault","def","getDefault","fromAnnotationOrTypeOrDefault","fromDefinitionOrDefault","reflect","hasInternalSlot","applyMetadataPolyfill","ResolverBuilder","container","registerResolver","cacheCallbackResult","destinationKey","strategy","state","cloneArrayWithPossibleProps","source","clone","DefaultContainerConfiguration","jitRegisterInRoot","defaultResolver","singleton","transient","DI","createContainer","config","getDesignParamtypes","annotationParamtypes","appendTo","dependencies","inject","designParamtypes","getAnnotationParamtypes","Proto","getDependencies","auAnnotationParamtype","friendlyName","Interface","index","undefined","getOrCreateAnnotationParamTypes","$isInterface","noDefault","withDefault","configure","register","dep","constructor","Registration","IContainer","createInterface","IServiceLocator","createResolver","resolver","$isResolver","resolve","handler","requestor","getAll","optional","ignore","instance","createNewInstance","instanceProvider","prepare","_requestor","factory","getFactory","construct","ResolverStrategy","resolving","getResolver","Factory","invoker","transformers","dynamicDependencies","invokeWithDynamicDependencies","invoke","ii","transformer","createFactory","staticDependencies","concat","classInvokers","deps","fallbackInvoker","write","containerResolver","isRegistry","InstrinsicTypeNames","factoryAnnotationKey","registerDepth","disposableResolvers","root","resolvers","resourceResolvers","current","jj","defs","isDisposable","validateKey","indexOf","isResourceKey","registerTransformer","autoRegister","jitRegister","searchAncestors","buildAllResponse","_a","disposables","from","pop","dispose","keyAsValue","registrationResolver","newResolver","ParameterizedRegistry","filter","x","fun","cachedCallback","aliasTo","originalKey","aliasKey","defer","results","ColorOptions","__decorate","desc","arguments","getOwnPropertyDescriptor","__metadata","v","__param","paramIndex","ILogConfig","LogConfig","ISink","ILogEventFactory","DefaultLogEventFactory","ILogScopes","DefaultLogger","LoggerSink","freeze","definition","handles","format","red","str","green","yellow","blue","magenta","cyan","white","grey","colorOptions","getLogLevelString","logLevelString","TRC","DBG","INF","WRN","ERR","FTL","QQQ","getIsoString","timestamp","toISOString","DefaultLogEvent","severity","message","optionalParams","scope","getScopeString","logger","now","ConsoleSink","$console","handleEvent","event","debug","info","warn","sinks","_b","_c","_d","_e","_f","traceSinks","debugSinks","infoSinks","warnSinks","errorSinks","fatalSinks","scopedLoggers","$sink","getHandles","includes","emit","$sinks","msgOrGetMsg","createLogEvent","trace","messageOrGetMessage","fatal","scopedLogger","Profiler","timers","profileMap","profiler","createTimer","depth","mark","enter","topLevelCount","totalCount","leave","duration","enable","timer","disable","report","sort","forEach","Handler","messageType","invokeCallback","data","e","invokeHandler","handle","eventLookup","messageHandlers","channelOrInstance","subscribers","channel","channelOrType","idx","splice","sub","subscribe","subscriberCollection","_subscriberFlags","addSubscriber","removeSubscriber","hasSubscriber","hasSubscribers","callSubscribers","unsubscribe","collectionSubscriberCollection","_collectionSubscriberFlags","addCollectionSubscriber","removeCollectionSubscriber","hasCollectionSubscriber","hasCollectionSubscribers","callCollectionSubscribers","subscribeToCollection","unsubscribeFromCollection","subscriber","subscriberFlags","_subscriber0","_subscriber1","_subscriber2","_subscribersRest","addProxySubscriber","hasProxySubscriber","_proxySubscriberFlags","_proxySubscriber0","_proxySubscriber1","_proxySubscriber2","_proxySubscribersRest","_collectionSubscriber0","_collectionSubscriber1","_collectionSubscriber2","_collectionSubscribersRest","removeProxySubscriber","hasProxySubscribers","newValue","previousValue","flags","subscriber0","subscriber1","subscriber2","callSubscriber","id","ownFlags","handleChange","callProxySubscribers","handleProxyChange","indexMap","handleCollectionChange","ProxyObserver_1","ProxySubscriberCollection","proxy","raw","inBatch","getOrCreate","oldValue","Proxy","$raw","proxyObserver","$observer","getRawIfProxy","receiver","callPropertySubscribers","deleteProperty","thisArg","argArray","apply","subscribeToProxy","unsubscribeFromProxy","ViewModelKind","IController","MountStrategy","IViewFactory","ILifecycle","BoundQueue","lifecycle","head","tail","process","begin","end","controller","prevBound","nextBound","next","cur","afterBind","UnboundQueue","prevUnbound","nextUnbound","afterUnbind","AttachedQueue","mount","prevAttached","nextAttached","afterAttach","DetachedQueue","unmount","prevDetached","nextDetached","afterDetach","MountQueue","prevMount","nextMount","UnmountQueue","prevUnmount","nextUnmount","BatchQueue","queue","batch","flushBatch","currentValue","observing","persistentFlags","getValue","setValue","RuntimeError","Number","marker","keyOrObj","$synthetic","bc","ancestor","part","overrideContext","parentOverrideContext","bindingContext","parentScope","scopeParts","$observers","oc","OverrideContext","ps","poc","ISignaler","Signaler","signals","listeners","listener","TargetedInstructionType","parentPartsOwnPartsLookup","mergeParts","parentParts","ownParts","ownPartsLookup","mergedParts","ITargetedInstruction","HooksDefinition","hasCreate","hasBeforeCompile","hasAfterCompile","hasAfterCompileChildren","hasBeforeBind","hasAfterBind","hasBeforeUnbind","hasAfterUnbind","hasBeforeAttach","hasAfterAttach","hasBeforeDetach","hasAfterDetach","hasCaching","registerAliases","aliases","keyFrom","none","slotNames","versionSlotNames","lastSlot","ensureEnoughSlotNames","currentSlot","addObserver","observer","observerSlots","version","observeProperty","propertyName","observerLocator","getObserver","unobserve","all","slots","slotName","connectableDecorator","connectable","assignIdTo","BindingBehaviorStrategy","bindingBehavior","nameOrDef","BindingBehavior","inheritsFromInterceptor","BindingInterceptor","getAnnotation","binding","expr","interceptor","locator","$scope","$state","updateTarget","updateSource","callSource","$bind","$unbind","isType","valueConverter","ValueConverter","hasBind","$kind","hasUnbind","CustomExpression","expression","behaviorKey","evaluate","connect","behavior","evalList","unbind","visitor","visitBindingBehavior","converterKey","converter","toView","fromView","signaler","addSignalListener","removeSignalListener","visitValueConverter","AssignExpression","visitAssign","ConditionalExpression","condition","yes","no","visitConditional","visitAccessThis","$this","$parent","evaluatedValue","visitAccessScope","AccessMemberExpression","visitAccessMember","AccessKeyedExpression","visitAccessKeyed","func","getFunction","visitCallScope","CallMemberExpression","visitCallMember","visitCallFunction","left","right","f","visitBinary","visitUnary","PrimitiveLiteralExpression","visitPrimitiveLiteral","$undefined","$null","$true","$false","$empty","HtmlLiteralExpression","parts","elements","visitHtmlLiteral","ArrayLiteralExpression","visitArrayLiteral","ObjectLiteralExpression","visitObjectLiteral","cooked","expressions","visitTemplate","visitTaggedTemplate","ArrayBindingPattern","visitArrayBindingPattern","ObjectBindingPattern","visitObjectBindingPattern","BindingIdentifier","visitBindingIdentifier","declaration","iterable","size","$array","entry","entries","$map","$number","visitForOfStatement","isMulti","firstExpression","visitInterpolation","list","rawArray","BindingMode","BindingStrategy","State","LifecycleFlags","ExpressionKind","SubscriberFlags","DelegationStrategy","CollectionKind","createIndexMap","deletedItems","isIndexMap","CollectionLengthObserver","observerLookup","sortCompare","y","preSortCompare","insertionSort","to","compareFn","velement","ielement","vtmp","itmp","order","quickSort","v0","v1","v2","i0","i1","i2","c01","c02","c12","vpivot","ipivot","lowEnd","highStart","vtopElement","thirdIndex","partition","$push","$unshift","unshift","$pop","$shift","shift","$splice","$reverse","reverse","$sort","methods","observe","argCount","notify","inserts","element","start","deleteCount","relativeStart","actualStart","Math","max","min","actualDeleteCount","itemCount","deleted","middle","lower","upper","lowerValue","lowerIndex","upperValue","upperIndex","descriptorProps","method","enableArrayObservationCalled","enableArrayObservation","indexObservers","collection","lengthObserver","getOrCreateIndexObserver","indexObserver","ArrayIndexObserver","owner","subscriberCount","arrayObserver","prevValue","currValue","addIndexObserver","removeIndexObserver","getArrayObserver","computedOverrideDefaults","static","volatile","CustomSetterObserver","convertProperty","overrides","propertyDeps","collectionDeps","isCollecting","createGetterTraps","subscribable","getValueAndCollectDependencies","unsubscribeAllDependencies","requireCollect","doNotCollect","addCollectionDep","proxyOrValue","getMapObserver","getSetObserver","addPropertyDep","IDirtyChecker","DirtyCheckSettings","framesPerCheck","disabled","throw","scheduler","tracked","task","elapsedFrames","DirtyCheckProperty","queueRenderTask","check","persistent","cancel","delta","isDirty","flush","dirtyChecker","addProperty","removeProperty","CollectionSizeObserver","$clear","clear","oldSize","deleteResult","enableMapObservationCalled","enableMapObservation","noop","PrimitiveObserver","doNotCache","getStringLength","returnUndefined","PropertyAccessor","setValueDirect","$add","enableSetObservationCalled","observedSet","enableSetObservation","IObserverLocator","ITargetObserverLocator","ITargetAccessorLocator","targetObserverLocator","targetAccessorLocator","adapters","isBindingContext","getObservers","observersLookup","createPropertyObserver","getOrCreateObserversLookup","adapter","overridesAccessor","getAccessor","observedArray","observedMap","createObserversLookup","isNode","getLengthObserver","getIndexObserver","subject","pd","getPropertyDescriptor","adapterObserver","getAdapterObserver","createProperty","computed","givenOverrides","createComputedObserver","getCollectionObserver","rawCollection","oneTime","toViewOrOneTime","sourceExpression","targetProperty","targetObserver","$lifecycle","_previousValue","$args","IExpressionParser","expressionLookup","forOfLookup","interpolationLookup","bindingType","found","parseCore","split","firstPart","endsWith","replace","currentPart","BindingType","MultiInterpolationBinding","interpolation","isFirst","_newValue","Boolean","toBindingContext","cbName","$set","isProxy","propertyChangedCallback","propertyChanged","hasPropertyChangedCallback","shouldInterceptSet","createGetterSetter","is","BindingModeBehavior","originalModes","super","twoWay","opts","delay","firstArg","taskQueue","getPostRenderTaskQueue","queueTask","isNaN","signal","names","lastCall","nextDelay","configOrTarget","$target","$prop","Bindable","isBindableAnnotation","bindableLists","bindables","addName","maybeList","addDescription","builder","configOrProp","attribute","primary","setInterpreter","propStart","prototypeChain","keysLen","Class","iProto","iDefs","customAttribute","CustomAttribute","templateController","isTemplateController","defaultBindingMode","hooks","noMultiBindings","for","node","INode","IRenderLocation","IDOM","ni","niDOM","addEventListener","appendChild","cloneNode","convertToRenderLocation","createDocumentFragment","createNodeSequence","createElement","createCustomEvent","dispatchEvent","createNodeObserver","createTemplate","createTextNode","getEffectiveParentNode","setEffectiveParentNode","insertBefore","isMarker","isNodeInstance","isRenderLocation","makeTarget","registerElementResolver","remove","removeEventListener","setAttribute","DOM","dom","isInitialized","descriptors","protos","getOwnPropertyDescriptors","location","view","hold","$controller","attach","detach","InfrequentMutations","FrequentMutations","ObserveShallow","LifecycleTask","done","canCancel","wait","Promise","TaskSlot","IStartTask","TaskType","StartTask","$StartTask","type","_slot","_promiseOrTask","_container","_key","_callback","_task","promiseOrTask","at","slot","ProviderTask","TerminalTask","IStartTaskManager","run","tasks","startTask","resolveTask","AggregateTerminalTask","PromiseTask","promise","hasStarted","isCancelled","then","nextResult","maybePromiseOrTask","catch","ContinuationTask","antecedent","AggregateContinuationTask","antecedents","hasAsyncWork","ifFactory","elseFactory","elseView","ifView","swap","attachView","release","ensureView","deactivate","updateView","activate","bindView","ifBehavior","viewModel","renderable","hasPendingInstanceMutation","views","normalizedItems","checkCollectionObserver","bindings","forOf","local","normalizeToArray","processViewsKeyed","attachViews","detachViewsByRange","unbindAndRemoveViewsByRange","oldLength","createAndBindAllViews","attachViewsKeyed","offset","applyMutationsToIndices","detachViewsByKey","unbindAndRemoveViewsByKey","createAndBindNewViewsByKey","sortViewsByKey","oldObserver","newObserver","items","iterate","iStart","iEnd","adjustLength","deletedLen","viewScope","newLen","count","fromParent","setContextualProperties","mapLen","nodes","unlink","copy","synchronizeIndices","seq","maxLen","prevIndices","Int32Array","tailIndices","cursor","prev","low","high","mid","longestIncreasingSubsequence","seqLen","link","isLast","isEven","$index","$first","$last","$middle","$even","$odd","$length","bindChild","isChildrenObserverAnnotation","Children","childrenObserverLists","childrenObservers","options","query","defaultChildQuery","defaultChildFilter","defaultChildMap","children","tryStartObserving","projector","filterChildren","subscribeToChildrenChange","onChildrenChanged","CustomElement","customElement","definitionLookup","template","instructions","injectable","needsCompile","surrogates","containerless","isStrictBinding","shadowOptions","hasSlots","generateName","generateType","partialDefinition","nameOrSearchParents","searchParents","$injectable","nameDescriptor","defaultProto","IProjectorLocator","SCRIPT_REGEX","ISanitizer","SanitizeValueConverter","sanitizer","untrustedMarkup","sanitize","ITemplateCompiler","IInstructionRenderer","IRenderer","instructionRenderer","instructionType","decoratedTarget","metadataKeys","ownProperties","instructionRenderers","record","render","targets","host","targetInstructions","renderInstructions","ensureExpression","parser","srcOrExpr","parse","getTarget","potentialTarget","SetPropertyRenderer","instruction","getComponentFactory","res","component","createComponent","childController","forCustomElement","addController","forCustomAttribute","parentContext","viewFactory","getRenderContext","getViewFactory","renderLocation","componentFactory","controllers","childInstructions","childInstruction","applyBindingBehavior","addBinding","refHost","refTargetName","caController","ceController","getRefTarget","behaviorExpressionIndex","behaviorExpressions","behaviorExpression","behaviorOrFactory","definitionContainerLookup","definitionContainerPartsLookup","fragmentCache","isRenderContext","parentContainer","containerLookup","containerPartsLookup","partsLookup","viewModelProvider","fragment","isCompiled","compiledDefinition","createChild","renderer","factoryProvider","parentControllerProvider","instructionProvider","renderLocationProvider","elementProvider","registerFactory","disposeResolvers","compiler","compile","parentController","resourceKey","templateDefinition","controllerLookup","vmKind","mountStrategy","getCached","getDefinition","getBindingContext","hydrateCustomElement","hydrateCustomAttribute","hydrateSynthetic","createObservers","childObserverNames","getOwnPropertyNames","observers","getLookup","childrenDescription","createChildrenObservers","beginChildComponentOperation","beforeCompile","compiledContext","projectorLocator","getElementProjector","createNodes","afterCompile","findTargets","afterCompileChildren","canReturnToCache","unmountSynthetic","bindCustomElement","bindCustomAttribute","bindSynthetic","unbindCustomElement","unbindCustomAttribute","unbindSynthetic","attachCustomElement","attachCustomAttribute","attachSynthetic","detachCustomElement","detachCustomAttribute","detachSynthetic","mountCustomElement","mountSynthetic","unmountCustomElement","cacheCustomElement","cacheCustomAttribute","cacheSynthetic","find","ret","beforeBind","bindBindings","endBind","bindControllers","beforeUnbind","unbindControllers","endUnbind","unbindBindings","beforeAttach","attachControllers","beforeDetach","detachControllers","project","take","tryReturnToCache","caching","noProxy","observableNames","bindable","isCaching","cacheSize","doNotOverrideIfAlreadySet","maxCacheSize","parseInt","forSyntheticView","seenViews","WeakSet","notYetSeen","$view","toCustomElementDefinition","Views","definitions","$views","IViewLocator","ViewValueConverter","viewLocator","viewNameOrSelector","getViewComponentForObject","IActivator","taskManager","mgr","runBeforeRender","runBeforeBind","runBeforeAttach","getCachedOrThrow","initializer","IDOMInitializer","initialize","activator","beforeCreateTask","runBeforeCreate","createTask","combinedAntecedent","_isRunning","_isStarting","_isStopping","_root","isRunning","stop","onBeforeStart","onAfterStart","onBeforeStop","onAfterStop","detail","bubbles","cancelable","global","Aurelia","DefaultComponents","modelInstanceToBoundComponent","modelTypeToUnboundComponent","availableViews","resolvedViewName","getViewName","getOrCreateBoundComponent","BoundComponent","UnboundComponent","getOrCreateUnboundComponent","getView","vm","requestedName","DefaultResources","DefaultRenderers","RuntimeConfiguration","InterpolationInstruction","IteratorBindingInstruction","CallBindingInstruction","RefBindingInstruction","SetPropertyInstruction","HydrateElementInstruction","HydrateAttributeInstruction","HydrateTemplateController","LetElementInstruction","LetBindingInstruction","AttrSyntax","rawName","rawValue","command","CharSpec","chars","repeat","isSymbol","isInverted","hasOfNoneInverse","hasOfSingleInverse","hasOfMultipleInverse","hasOfNone","hasOfSingle","hasOfMultiple","other","_pattern","currentRecord","partsRecord","pattern","charSpec","patterns","nextStates","types","isEndpoint","child","equals","findChild","interpretation","childLen","append","StaticSegment","text","specs","DynamicSegment","symbols","spec","SymbolSegment","SegmentTypes","statics","dynamics","ISyntaxInterpreter","SyntaxInterpreter","rootState","initialStates","defOrDefs","currentState","segments","eachChar","states","getNextStates","aTypes","bTypes","findMatches","IAttributePattern","attributePattern","patternDefs","AttributePattern","definitionAnnotationKey","validatePrototype","getPatternDefinitions","IAttributeParser","interpreter","attrPatterns","attrPattern","interpret","bindingCommand","nameOrDefinition","BindingCommand","makeCamelCase","propName","syntax","SymbolFlags","createMarker","TemplateControllerSymbol","partName","physicalNode","_bindings","_parts","ReplacePartSymbol","CustomAttributeSymbol","PlainAttributeSymbol","BindingSymbol","CustomElementSymbol","isTarget","_customAttributes","_plainAttributes","_childNodes","isContainerless","LetElementSymbol","PlainElementSymbol","TextSymbol","default","unescapeCode","Access","Precedence","Token","Char","startIndex","lastIndex","currentToken","tokenValue","assignable","currentChar","SyntaxError","SemanticError","parseExpression","access","minPrecedence","nextToken","fromCharCode","parseInterpolation","op","TokenValues","consumeOpt","consume","parseArrayLiteralExpression","parseObjectLiteralExpression","parseTemplate","statement","parseForOfStatement","strings","opToken","tokenRaw","tagged","scanTemplateTail","CharScanners","scanNumber","isFloat","parseFloat","scanTemplate","token","expected","KeywordLookup","true","null","false","in","instanceof","typeof","void","of","codes","decompress","compressed","rangeCount","fill","returnToken","unexpectedCharacter","notMapped","IdParts","Uint8Array","quote","unescaped","buffer","last","unescapedStr","scanString","DefaultBindingSyntax","DefaultBindingLanguage","BindableInfo","attr","bindableInfo","hasPrimary","isPrimary","contextLookup","elementLookup","attributeLookup","commandLookup","rootContainer","rootResourceResolvers","model","kind","targetEvent","delegationStrategy","preventDefault","eventManager","$event","AttributeObserver","targetAttribute","hasChanges","flushChanges","classList","priority","style","setProperty","mutationRecords","shouldProcess","attributeName","contains","getPropertyValue","getAttribute","startObservation","stopObservation","subscription","$eMObservers","$mObserver","handleMutation","disconnect","invokeHandleMutation","$scheduler","AttributeNSAccessor","namespace","removeAttributeNS","setAttributeNS","getAttributeNS","defaultMatcher","collectionObserver","valueObserver","synchronizeElement","elementValue","isRadio","matcher","checked","hasMatch","findIndex","pair","existingItem","$isChecked","isChecked","toStringRet","unset","currItem","ClassAttributeAccessor","nameIndex","isActive","classesToAdd","getClassesToAdd","addClassesAndUpdateIndex","classes","className","splitClassString","classString","matches","match","DataAttributeAccessor","removeAttribute","ElementPropertyAccessor","findOriginalEventTarget","composedPath","deepPath","path","stopPropagation","standardStopPropagation","propagationStopped","handleCapturedEvent","orderedCallbacks","capturedCallbacks","parentNode","orderedCallback","handleDelegatedEvent","delegatedCallbacks","ListenerTracker","eventName","capture","DelegateOrCaptureSubscription","decrement","TriggerSubscription","EventSubscriber","events","callbackOrListener","IEventManager","delegatedHandlers","capturedHandlers","handlerEntry","bubbling","increment","capturing","childObserverOptions","childList","subtree","characterData","SelectValueObserver","nodeObserver","multiple","synchronizeOptions","synchronizeValue","option","optionValue","selected","handleNodeChange","styles","cssText","styleTuples","rx","exec","getStyleTuples","getStyleTuplesFromString","getStyleTuplesFromArray","getStyleTuplesFromObject","tuple","ISVGAnalyzer","ValueAttributeObserver","xlinkNS","xmlNS","xmlnsNS","nsAttributes","inputEvents","selectEvents","contentEvents","scrollEvents","overrideProps","svgAnalyzer","tagName","nsProps","isDataAttribute","IsDataAttribute","prefix","isStandardSvgAttribute","handleSelfEvent","selfEventCallSource","originalHandler","noopShadowDOMStyles","applyTo","IShadowDOMStyles","IShadowDOMGlobalStyles","AdoptedStyleSheetsStyles","localStyles","styleSheetCache","sharedStyles","styleSheets","sheet","CSSStyleSheet","replaceSync","ShadowRoot","shadowRoot","adoptedStyleSheets","StyleElementStyles","innerHTML","prepend","defaultShadowOptions","attachShadow","childNodes","getRootNode","NodeType","effectiveParentNodeOverrides","window","document","TNode","TElement","THTMLElement","TCustomEvent","TCSSStyleSheet","TShadowRoot","Node","Element","HTMLElement","CustomEvent","destroy","emptyNodes","FragmentNodeSequence","publisher","deep","locationEnd","createComment","locationStart","replaceChild","$start","$nodes","markupOrNode","content","init","fetch","eventType","evt","MutationObserver","takeRecords","markup","containerlessOffset","nextSibling","nodeType","textContent","childNodeOrNodeSequence","nodeToInsert","referenceNode","nodeName","potentialNode","removeChild","$DOM","isMounted","isLinked","refNode","targetNodeList","querySelectorAll","childNodeList","firstChild","lastChild","addToLinked","obtainRefNode","previousSibling","defaultCaptureEventInit","passive","defaultBubbleEventInit","blurDocMap","BlurManager","blurs","createHandler","blur","addListeners","removeListeners","doc","win","navigator","pointerEnabled","linkedMultiple","searchSubTree","linkingContext","manager","createFor","unregister","triggerBlur","els","containsElementOrShadowRoot","linkedWith","links","contextNode","querySelector","body","el","onBlur","checkTargets","hasChecked","revertCheckage","markChecked","preempt","handleMousedown","composed","handleEventTarget","onpointerdown","ontouchstart","onmousedown","onfocus","onblur","Focus","needsApply","valueChanged","activeElement","focus","toTask","originalLoc","strict","currentTarget","callbackContext","targetChanged","oldTarget","newTarget","resolveTarget","activating","activated","deactivating","deactivated","$document","renderContext","queryContext","HTMLTargetedInstructionType","isHTMLTargetedInstruction","TextBindingInstruction","SetAttributeInstruction","SetClassAttributeInstruction","SetStyleAttributeInstruction","AttributeBindingInstruction","tagOrType","props","allInstructions","hasInstructions","addChildren","createElementForTag","createElementForType","lazyDefinition","getContext","mergeInto","composing","lastSubject","properties","reduce","acc","compose","viewPromise","resolveView","onComposed","provideViewFor","lockScope","isController","createView","SetAttributeRenderer","SetClassAttributeRenderer","addClasses","SetStyleAttributeRenderer","$component","RuntimeHtmlConfiguration","factoryCache","IShadowDOMStyleFactory","createStyleFactory","css","createStyles","supported","some","defaultNow","Now","TaskQueuePriority","defaultQueueTaskOptions","reusable","$resolve","$reject","executor","reject","createExposedPromise","TaskAbortError","createdTime","queueTime","_result","_status","resetPersistentTask","err","returnToPool","isEmpty","time","flushRequestorFactory","processingSize","processingHead","processingTail","pendingSize","pendingHead","pendingTail","delayedSize","delayedHead","delayedTail","flushRequested","yieldPromise","taskPool","taskPoolSize","lastRequest","microTaskRequestFlushTask","flushRequestor","requestFlush","movePendingToProcessing","moveDelayedToProcessing","getTaskQueue","noMoreFiniteWork","reuse","status","addToProcessing","addToPending","addToDelayed","removeFromProcessing","removeFromDelayed","removeFromPending","reset","finish","request","store","IScheduler","microtaskFactory","renderFactory","macroTaskFactory","postRenderFactory","idleFactory","taskQueues","microtask","macroTask","postRender","idle","yieldMicroTask","yieldRenderTask","yieldMacroTask","yieldPostRenderTask","yieldIdleTask","yieldAll","yield","$global","self","isBrowserLike","isWebWorkerLike","isNodeLike","versions","$now","getNanoSeconds","hrtime","moduleLoadTime","nodeLoadTime","upTime","performance","$performance","hr","uptime","emptyObject","$PLATFORM","PLATFORM","getMessageInfoForCode","codeLookup","createInvalidCodeMessageInfo","0","1","2","3","4","5","6","7","8","9","10","11","12","14","15","16","17","18","19","20","21","22","30","31","100","101","102","103","104","105","106","107","108","109","110","111","150","151","401","402","800","801","2000","2001","2002","2003","2004","1001","10000","TraceInfo","stack","defaultOptions","rendering","observation","mounting","di","jit","flagsText","flagNames","stringifyLifecycleFlags","_ctorName","description","ctorName","scopeText","$ctorName","keyText","$key","primitive","RenderingArgsProcessor","$hydrate","addComponent","BindingArgsProcessor","lockedBind","lockedUnbind","InternalObserversLookup","ObservationArgsProcessor","valueText","AttachingArgsProcessor","$attach","$detach","$cache","MountingArgsProcessor","$mount","$unmount","DIArgsProcessor","LifecycleArgsProcessor","JitArgsProcessor","TemplateBinder","IAttrSyntaxTransformer","invalidSurrogateAttribute","attributesToIgnore","hasInlineBindings","isTemplateControllerOf","manifest","resources","attrParser","exprParser","attrSyntaxTransformer","surrogate","attrSyntax","getBindingCommand","attrInfo","getAttributeInfo","transform","bindPlainAttribute","bindChildNodes","parentManifest","manifestRoot","parentManifestRoot","bindLetElement","elementInfo","getElementInfo","bindAttributes","symbol","manifestProxy","previousController","currentController","declareTemplateController","ensureAttributeOrder","manifestNode","currentTemplate","processTemplateControllers","partOwner","replacePart","proxyNode","processReplacePart","plainAttributes","modelOrValueIndex","checkedIndex","childNode","nextChild","bindManifest","bindText","textNode","wholeText","processInterpolationText","attrRawValue","bindMultiAttribute","customAttributes","valueLength","attrName","attrValue","attrTarget","ITemplateElementFactory","markupCache","firstElementChild","nextElementSibling","attrSyntaxModifier","binder","compilation","customAttributeLength","plainAttributeLength","compileCustomAttribute","compilePlainAttribute","compileChildNodes","toDefinition","instructionRows","compileParentNode","instructionRow","compileAttributes","compileBindings","compileParts","compileCustomElement","compilePlainElement","compileTemplateController","controllerInstructionRows","controllerScopeParts","bindingInstructions","compileBinding","attributeInstructions","plainAttributesLength","isOnSurrogate","replaceParts","partScopeParts","partInstructionRows","hasAttribute","shouldDefaultToTwoWay","createDOMScheduler","w","requested","canceled","cancelAnimationFrame","requestAnimationFrame","createRequestAnimationFrameFlushRequestor","clearTimeout","setTimeout","createSetTimeoutFlushRequestorFactory","rafHandle","timeoutHandle","queueFlush","createPostRequestAnimationFrameFlushRequestor","requestIdleCallback","cancelIdleCallback","createRequestIdleCallbackFlushRequestor","ownerDocument","RuntimeHtmlBrowserConfiguration","JitHtmlBrowserConfiguration","createAurelia","au","env","app","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","currentQueue","draining","queueIndex","cleanUpNextTick","drainQueue","timeout","runClearTimeout","Item","nextTick","title","browser","argv","on","addListener","once","off","removeListener","removeAllListeners","prependListener","prependOnceListener","cwd","chdir","dir","umask","api","locals","g","memo","isOldIE","atob","styleTarget","HTMLIFrameElement","contentDocument","stylesInDom","getIndexByIdentifier","identifier","modulesToDom","idCountMap","identifiers","base","media","sourceMap","references","updater","addStyle","insertStyleElement","nonce","insert","textStore","replaceText","replacement","applyToSingletonTag","styleSheet","cssNode","applyToTag","btoa","unescape","encodeURIComponent","JSON","stringify","singletonCounter","update","styleIndex","removeStyleElement","newObj","lastIdentifiers","newList","newLastIdentifiers","_i","_index","___CSS_LOADER_API_IMPORT___","useSourceMap","cssMapping","sourceMapping","base64","sourceURLs","sources","sourceRoot","cssWithMappingToString","mediaQuery","dedupe","alreadyImportedModules","retryStrategy","defaultRetryConfig","maxRetries","interval","retryConfig","counter","requestClone","response","httpClient","doRetry","minRandomInterval","maxRandomInterval","retryStrategies","calculateDelay","newRequest","beforeRetry","retryableRequest","retryCount","random","baseUrl","defaults","interceptors","credentials","rejectErrorResponses","withInterceptor","rejectOnError","ok","absoluteUrlRegexp","activeRequestCount","isRequesting","isConfigured","normalizedConfig","isPrototypeOf","Headers","headers","retryInterceptorIndex","trackRequestStart","buildRequest","processRequest","Response","Request","processResponse","trackRequestEnd","requestContentType","parsedDefaultHeaders","parsedHeaders","$headers","parseHeaderValues","bodyObj","requestInit","url","test","getRequestUrl","isJSON","defaultHeaders","$defaultHeaders","setDefaultHeaders","Blob","callFetch","applyInterceptors","successName","errorName","interceptorArgs","successHandler","errorHandler","identity","reason","thrower","Queue","pending","processing","allowedExecutionCostWithinTick","currentExecutionCostInCurrentTick","dequeue","itemOrItems","costOrCosts","costs","promises","qItem","cost","useUrlFragmentHash","forwardedState","handlePopstate","ev","enqueue","processCalls","qCall","parameters","suppressPopstate","history","pendingCalls","pathname","search","hash","currentEntry","viewerState","go","navigationEntry","firstEntry","pushNavigatorState","calls","_resolve","useHref","getEventInfo","shouldHandleEvent","anchor","targetIsThisWindow","altKey","ctrlKey","metaKey","shiftKey","gotoAttr","goto","href","leftButtonClicked","button","targetWindow","arrayRemove","removed","arrIndex","parseQuery","param","decodeURIComponent","ContentStatus","SegmentKind","fullStateInstruction","contentStatus","entered","fromCache","fromHistory","reentry","isComponentType","componentType","toComponentType","componentInstance","viewport","sameComponent","reentryBehavior","fallback","toComponentInstance","setParameters","componentName","setComponent","ee","previousInstruction","canEnter","typeParameters","toSpecifiedParameters","merged","router","createViewportInstruction","nextInstruction","canLeave","stateful","getElementsByTagName","top","scrollTo","scrollTop","scrollLeft","removeComponent","terminateComponent","unloadComponent","destroyComponent","owningScope","rootComponentType","catches","nextContent","available","sourceItem","sourceItemIndex","connectedScope","enabledChildren","isViewportScope","viewportScope","viewportInstruction","instructionResolver","parseViewportInstruction","isClearViewportInstruction","isClearAllViewportsInstruction","isAddViewportInstruction","removeSourceItem","segment","clearViewportInstruction","addViewportInstruction","getAvailableSourceItem","siblings","every","sibling","routes","FoundRoute","matching","remaining","currentIndex","ConfigurableRoute","caseSensitive","Endpoint","route","paramNames","RecognizedRoute","endpoint","searchParams","isDynamic","queryString","Candidate","skippedStates","stateToAdd","matchCount","$process","nextState","skippedState","isMatch","isOptional","separator","isSeparator","$nextState","collectSkippedStates","statesA","statesB","iA","iB","stateA","stateB","segmentA","segmentB","skippedStatesA","skippedStatesB","skippedStatesALen","skippedStatesBLen","skippedStateA","skippedStateB","hasEndpoint","candidate","compareChains","compareTo","RecognizeResult","candidates","finalize","advance","prevState","setEndpoint","isNotEmpty","StarSegment","routeOrRoutes","$route","queryStart","URLSearchParams","decodeURI","getSolution","getParams","hasScope","replacedChildren","childCollections","passThroughScope","isViewport","scopes","viewportScopes","viewports","includeDisabled","allViewports","allScopes","getOwnedScopes","alreadyFound","disregardViewports","foundViewports","remainingInstructions","ownedScopes","availableViewportScopes","availableViewports","getEnabledViewports","viewportName","viewportInstructions","foundViewportScope","removeCurrent","foundViewport","acceptSegment","addSourceItem","needsViewportDescribed","wantComponent","ownsScope","acceptComponent","remainingViewports","nextScopeInstructions","rem","withoutViewports","doesntNeedViewportDescribed","setViewport","getOwnedViewports","addChild","setElement","vp","includeReplaced","hoistedChildren","reparentViewportInstructions","findMatchingRouteInRoutes","getRoutes","findMatchingRoute","cRoutes","ensureProperRoute","cRoute","recognizer","recognize","$params","remainingPath","foundConfiguration","cloneViewportInstructions","addParameters","NavigationInstructionResolver","toViewportInstructions","forceRemove","elementResolve","previousViewportState","historyCache","navigation","back","forward","cached","isCacheEqual","clearReplacedChildren","equalComponent","refresh","disableReplacedChildren","equalParameters","clearState","usedBy","noLink","noHistory","parseViewportInstructions","freeContent","doForceRemove","statefulHistory","waitForElement","loadComponent","initializeComponent","unloadContent","reenableReplacedChildren","ComponentAppellationResolver","isName","isInstance","getName","getType","getInstance","ViewportHandleResolver","createViewportInstructions","navigationInstructions","findScope","rootScope","viewportComponent","newInstruction","ParametersType","ReentryBehavior","HookTypes","parametersString","parametersRecord","parametersList","parametersType","parseComponentParameters","typedParameters","stringifyComponentParameters","isComponentName","isComponentInstance","getViewport","specifications","specified","parameter","sorted","compareParameters","compareType","sameParameters","mine","others","Hook","hook","includeTargets","excludeTargets","include","exclude","navigationInstruction","arg","cvTarget","beforeNavigation","transformFromUrl","transformToUrl","lastIdentity","hookFunction","wantsMatch","outcome","nav","linkVisible","linkActive","visible","active","meta","parseRoute","computeLink","consideredActive","execute","computeVisible","computeActive","activeChild","components","activeComponents","flattenViewportInstructions","stringifyViewportInstructions","addRoute","updateRoutes","newRoute","QueueTask","TaskQueue","createQueueTask","eventTask","async","evTask","suppressPopstateEvent","popstate","doneTask","forwardState","steps","titleOrEmpty","pushState","replaceState","popState","ClosestScope","IRouter","linkHandler","navs","appendedInstructions","statefulHistoryLength","useDirectRoutes","useConfiguredRoutes","loadedFirst","processingNavigation","lastNavigation","staleChecks","linkCallback","origin","navigatorCallback","processNavigations","navigatorSerializeCallback","preservedEntries","excludeComponents","preservedEntry","serialized","alreadyDone","freeComponents","browserNavigatorCallback","browserNavigationEvent","fromBrowser","navigate","qInstruction","reportCallback","instructionNavigation","configuredRoute","findInstructions","configuredRoutePath","foundInstructions","unknownRoute","clearScopeOwners","clearViewportScopes","clearInstruction","instr","addInstruction","isAddAllViewportsInstruction","updatedScopeOwners","alreadyFoundInstructions","findViewports","guard","console","log","changedScopeOwners","hooked","hookManager","invokeBeforeNavigation","cancelNavigation","scopeOwner","setNextContent","abortContentChange","hasRemaining","configured","routeScopeOwners","appendInstructions","appendedInstruction","existingAlreadyFound","sameViewport","existingFound","existingRemaining","loadContent","replacePaths","new","first","repeating","untracked","finalizeContentChange","addHooks","separators","serializeCallback","ensureRootScope","replacing","getClosestScope","viewModelOrContainer","getContainer","viewModelOrElement","getClosestContainer","findParentScope","addViewport","setClosestScope","removeViewport","unsetClosestScope","addViewportScope","removeViewportScope","toOptions","matchScope","matchChildren","flat","findNav","addNav","addRoutes","addHook","instructionScope","transformUrl","invokeTransformFromUrl","hasSiblingInstructions","foundRoute","nextInstructions","staleCheck","activeRoute","invokeTransformToUrl","fullViewportStates","CustomElementFor","nodeResourceName","qEntry","navigationFlags","uninitializedEntry","loadState","refreshing","historyMovement","pendingNavigations","movement","newIndex","saveState","getState","storedEntry","toStoredEntry","toStoreableEntry","replaceNavigatorState","previous","storableEntry","popNavigatorState","indexPreserve","previousEntry","storeable","scopeStart","scopeEnd","noScope","parametersEnd","parameterSeparator","parameterKeySeparator","action","setInstructionResolver","parsedInstructions","parseViewportInstructionsWorker","excludeViewport","viewportContext","stringifyViewportInstruction","stringifyAViewportInstruction","excludeCurrentViewport","excludeCurrentComponent","forceDescription","stringified","nextStringified","stringifyScopedViewportInstructions","scopeContext","clearViewports","newPath","merge","keepInstances","clones","uriComponent","seps","grouped","parseAViewportInstruction","tokens","pos","specials","special","findNextToken","excludeComponent","instructionString","specification","toSortedParameters","NavCustomElement","ul","li","ulActive","liActive","aActive","ParentViewport","createInjectable","parentViewport","isBound","connectViewport","disconnectViewport","checkExists","ParentViewportScope","connectViewportScope","disconnectViewportScope","hasHref","activeClass","updateValue","created","checkActive","eventListener","hasGoto","configurationOptions","configurationCall","routerConfiguration","with","loadUrl","RouterConfiguration","customize","Welcome","Missing","missingComponent","MyApp"],"mappings":"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","file":"entry-bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 15);\n","/**\n * Determine whether a value is an object.\n *\n * Uses `typeof` to guarantee this works cross-realm, which is where `instanceof Object` might fail.\n *\n * Some environments where these issues are known to arise:\n * - same-origin iframes (accessing the other realm via `window.top`)\n * - `jest`.\n *\n * The exact test is:\n * ```ts\n * typeof value === 'object' && value !== null || typeof value === 'function'\n * ```\n *\n * @param value - The value to test.\n * @returns `true` if the value is an object, otherwise `false`.\n * Also performs a type assertion that defaults to `value is Object | Function` which, if the input type is a union with an object type, will infer the correct type.\n * This can be overridden with the generic type argument.\n *\n * @example\n *\n * ```ts\n * class Foo {\n *   bar = 42;\n * }\n *\n * function doStuff(input?: Foo | null) {\n *   input.bar; // Object is possibly 'null' or 'undefined'\n *\n *   // input has an object type in its union (Foo) so that type will be extracted for the 'true' condition\n *   if (isObject(input)) {\n *     input.bar; // OK (input is now typed as Foo)\n *   }\n * }\n *\n * function doOtherStuff(input: unknown) {\n *   input.bar; // Object is of type 'unknown'\n *\n *   // input is 'unknown' so there is no union type to match and it will default to 'Object | Function'\n *   if (isObject(input)) {\n *     input.bar; // Property 'bar' does not exist on type 'Object | Function'\n *   }\n *\n *   // if we know for sure that, if input is an object, it must be a specific type, we can explicitly tell the function to assert that for us\n *   if (isObject<Foo>(input)) {\n *    input.bar; // OK (input is now typed as Foo)\n *   }\n * }\n * ```\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function isObject(value) {\n    return typeof value === 'object' && value !== null || typeof value === 'function';\n}\n/**\n * Determine whether a value is `null` or `undefined`.\n *\n * @param value - The value to test.\n * @returns `true` if the value is `null` or `undefined`, otherwise `false`.\n * Also performs a type assertion that ensures TypeScript treats the value appropriately in the `if` and `else` branches after this check.\n */\nexport function isNullOrUndefined(value) {\n    return value === null || value === void 0;\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/ban-types */\nconst metadataInternalSlot = new WeakMap();\nfunction $typeError(operation, args, paramName, actualValue, expectedType) {\n    return new TypeError(`${operation}(${args.map(String).join(',')}) - Expected '${paramName}' to be of type ${expectedType}, but got: ${Object.prototype.toString.call(actualValue)} (${String(actualValue)})`);\n}\nfunction toPropertyKeyOrUndefined(propertyKey) {\n    switch (typeof propertyKey) {\n        case 'undefined':\n        case 'string':\n        case 'symbol':\n            return propertyKey;\n        default:\n            return `${propertyKey}`;\n    }\n}\nfunction toPropertyKey(propertyKey) {\n    switch (typeof propertyKey) {\n        case 'string':\n        case 'symbol':\n            return propertyKey;\n        default:\n            return `${propertyKey}`;\n    }\n}\nfunction ensurePropertyKeyOrUndefined(propertyKey) {\n    switch (typeof propertyKey) {\n        case 'undefined':\n        case 'string':\n        case 'symbol':\n            return propertyKey;\n        default:\n            throw new TypeError(`Invalid metadata propertyKey: ${propertyKey}.`);\n    }\n}\nfunction GetOrCreateMetadataMap(O, P, Create) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let targetMetadata be the value of O's [[Metadata]] internal slot.\n    let targetMetadata = metadataInternalSlot.get(O);\n    // 3. If targetMetadata is undefined, then\n    if (targetMetadata === void 0) {\n        // 3. a. If Create is false, return undefined.\n        if (!Create) {\n            return void 0;\n        }\n        // 3. b. Set targetMetadata to be a newly created Map object.\n        targetMetadata = new Map();\n        // 3. c. Set the [[Metadata]] internal slot of O to targetMetadata.\n        metadataInternalSlot.set(O, targetMetadata);\n    }\n    // 4. Let metadataMap be ? Invoke(targetMetadata, \"get\", P).\n    let metadataMap = targetMetadata.get(P);\n    // 5. If metadataMap is undefined, then\n    if (metadataMap === void 0) {\n        // 5. a. If Create is false, return undefined.\n        if (!Create) {\n            return void 0;\n        }\n        // 5. b. Set metadataMap to be a newly created Map object.\n        metadataMap = new Map();\n        // 5. c. Perform ? Invoke(targetMetadata, \"set\", P, metadataMap).\n        targetMetadata.set(P, metadataMap);\n    }\n    // 6. Return metadataMap.\n    return metadataMap;\n}\n// 3.1.2.1 OrdinaryHasOwnMetadata(MetadataKey, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinaryhasownmetadata\nfunction OrdinaryHasOwnMetadata(MetadataKey, O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let metadataMap be ? GetOrCreateMetadataMap(O, P, false).\n    const metadataMap = GetOrCreateMetadataMap(O, P, /* Create */ false);\n    // 3. If metadataMap is undefined, return false.\n    if (metadataMap === void 0) {\n        return false;\n    }\n    // 4. Return ? ToBoolean(? Invoke(metadataMap, \"has\", MetadataKey)).\n    return metadataMap.has(MetadataKey);\n}\n// 3.1.1.1 OrdinaryHasMetadata(MetadataKey, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinaryhasmetadata\nfunction OrdinaryHasMetadata(MetadataKey, O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let hasOwn be ? OrdinaryHasOwnMetadata(MetadataKey, O, P).\n    // 3. If hasOwn is true, return true.\n    if (OrdinaryHasOwnMetadata(MetadataKey, O, P)) {\n        return true;\n    }\n    // 4. Let parent be ? O.[[GetPrototypeOf]]().\n    const parent = Object.getPrototypeOf(O);\n    // 5. If parent is not null, Return ? parent.[[HasMetadata]](MetadataKey, P).\n    if (parent !== null) {\n        return OrdinaryHasMetadata(MetadataKey, parent, P);\n    }\n    // 6. Return false.\n    return false;\n}\n// 3.1.4.1 OrdinaryGetOwnMetadata(MetadataKey, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinarygetownmetadata\nfunction OrdinaryGetOwnMetadata(MetadataKey, O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let metadataMap be ? GetOrCreateMetadataMap(O, P, false).\n    const metadataMap = GetOrCreateMetadataMap(O, P, /* Create */ false);\n    // 3. If metadataMap is undefined, return undefined.\n    if (metadataMap === void 0) {\n        return void 0;\n    }\n    // 4. Return ? Invoke(metadataMap, \"get\", MetadataKey).\n    return metadataMap.get(MetadataKey);\n}\n// 3.1.3.1 OrdinaryGetMetadata(MetadataKey, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinarygetmetadata\nfunction OrdinaryGetMetadata(MetadataKey, O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let hasOwn be ? OrdinaryHasOwnMetadata(MetadataKey, O, P).\n    // 3. If hasOwn is true, return ? OrdinaryGetOwnMetadata(MetadataKey, O, P).\n    if (OrdinaryHasOwnMetadata(MetadataKey, O, P)) {\n        return OrdinaryGetOwnMetadata(MetadataKey, O, P);\n    }\n    // 4. Let parent be ? O.[[GetPrototypeOf]]().\n    const parent = Object.getPrototypeOf(O);\n    // 5. If parent is not null, return ? parent.[[GetMetadata]](MetadataKey, P).\n    if (parent !== null) {\n        return OrdinaryGetMetadata(MetadataKey, parent, P);\n    }\n    // 6. Return undefined.\n    return void 0;\n}\n// 3.1.5.1 OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinarydefineownmetadata\nfunction OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let metadataMap be ? GetOrCreateMetadataMap(O, P, true).\n    const metadataMap = GetOrCreateMetadataMap(O, P, /* Create */ true);\n    // 3. Return ? Invoke(metadataMap, \"set\", MetadataKey, MetadataValue).\n    metadataMap.set(MetadataKey, MetadataValue);\n}\n// 3.1.7.1 OrdinaryOwnMetadataKeys(O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinaryownmetadatakeys\nfunction OrdinaryOwnMetadataKeys(O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let keys be ? ArrayCreate(0).\n    const keys = [];\n    // 3. Let metadataMap be ? GetOrCreateMetadataMap(O, P, false).\n    const metadataMap = GetOrCreateMetadataMap(O, P, /* Create */ false);\n    // 4. If metadataMap is undefined, return keys.\n    if (metadataMap === void 0) {\n        return keys;\n    }\n    // 5. Let keysObj be ? Invoke(metadataMap, \"keys\").\n    const keysObj = metadataMap.keys();\n    // 6. Let iterator be ? GetIterator(keysObj).\n    // 7. Let k be 0.\n    let k = 0;\n    // 8. Repeat\n    for (const key of keysObj) {\n        // 8. a. Let Pk be ! ToString(k).\n        // 8. b. Let next be ? IteratorStep(iterator).\n        // 8. c. If next is false, then\n        // 8. c. i. Let setStatus be ? Set(keys, \"length\", k, true).\n        // 8. c. ii. Assert: setStatus is true.\n        // 8. c. iii. Return keys.\n        // 8. d. Let nextValue be ? IteratorValue(next).\n        // 8. e. Let defineStatus be CreateDataPropertyOrThrow(keys, Pk, nextValue).\n        keys[k] = key;\n        // 8. f. If defineStatus is an abrupt completion, return ? IteratorClose(iterator, defineStatus).\n        // 8. g. Increase k by 1.\n        ++k;\n    }\n    return keys;\n}\n// 3.1.6.1 OrdinaryMetadataKeys(O, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinarymetadatakeys\nfunction OrdinaryMetadataKeys(O, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let ownKeys be ? OrdinaryOwnMetadataKeys(O, P).\n    const ownKeys = OrdinaryOwnMetadataKeys(O, P);\n    // 3. Let parent be ? O.[[GetPrototypeOf]]().\n    const parent = Object.getPrototypeOf(O);\n    // 4. If parent is null, then return ownKeys.\n    if (parent === null) {\n        return ownKeys;\n    }\n    // 5. Let parentKeys be ? O.[[OrdinaryMetadataKeys]](P).\n    const parentKeys = OrdinaryMetadataKeys(parent, P);\n    // 6. Let ownKeysLen = ? Get(ownKeys, \"length\").\n    const ownKeysLen = ownKeys.length;\n    // 7. If ownKeysLen is 0, return parentKeys.\n    if (ownKeysLen === 0) {\n        return parentKeys;\n    }\n    // 8. Let parentKeysLen = ? Get(parentKeys, \"length\").\n    const parentKeysLen = parentKeys.length;\n    // 9. If parentKeysLen is 0, return ownKeys.\n    if (parentKeysLen === 0) {\n        return ownKeys;\n    }\n    // 10. Let set be a newly created Set object.\n    const set = new Set();\n    // 11. Let keys be ? ArrayCreate(0).\n    const keys = [];\n    // 12. Let k be 0.\n    let k = 0;\n    // 13. For each element key of ownKeys\n    let key;\n    for (let i = 0; i < ownKeysLen; ++i) {\n        key = ownKeys[i];\n        // 13. a. Let hasKey be ? Invoke(set, \"has\", key).\n        // 13. b. If hasKey is false, then\n        if (!set.has(key)) {\n            // 13. b. i. Let Pk be ! ToString(k).\n            // 13. b. ii. Perform ? Invoke(set, \"add\", key).\n            set.add(key);\n            // 13. b. iii. Let defineStatus be CreateDataProperty(keys, Pk, key).\n            // 13. b. iv. Assert: defineStatus is true.\n            keys[k] = key;\n            // 13. b. v. Increase k by 1.\n            ++k;\n        }\n    }\n    // 14. For each element key of parentKeys\n    for (let i = 0; i < parentKeysLen; ++i) {\n        key = parentKeys[i];\n        // 14. a. Let hasKey be ? Invoke(set, \"has\", key).\n        // 14. b. If hasKey is false, then\n        if (!set.has(key)) {\n            // 14. b. i. Let Pk be ! ToString(k).\n            // 14. b. ii. Perform ? Invoke(set, \"add\", key).\n            set.add(key);\n            // 14. b. iii. Let defineStatus be CreateDataProperty(keys, Pk, key).\n            // 14. b. iv. Assert: defineStatus is true.\n            keys[k] = key;\n            // 14. b. v. Increase k by 1.\n            ++k;\n        }\n    }\n    // 15. Perform ? Set(keys, \"length\", k).\n    // 16. return keys.\n    return keys;\n}\n// 3.1.8 DeleteMetadata(MetadataKey, P)\n// https://rbuckton.github.io/reflect-metadata/#ordinary-object-internal-methods-and-internal-slots-deletemetadata\nfunction OrdinaryDeleteMetadata(O, MetadataKey, P) {\n    // 1. Assert: P is undefined or IsPropertyKey(P) is true.\n    // 2. Let metadataMap be ? GetOrCreateMetadataMap(O, P, false).\n    const metadataMap = GetOrCreateMetadataMap(O, P, false);\n    // 3. If metadataMap is undefined, return false.\n    if (metadataMap === void 0) {\n        return false;\n    }\n    // 4. Return ? Invoke(metadataMap, \"delete\", MetadataKey).\n    return metadataMap.delete(MetadataKey);\n}\n// 4.1.2 Reflect.metadata(metadataKey, metadataValue)\n// https://rbuckton.github.io/reflect-metadata/#reflect.metadata\n/**\n * A default metadata decorator factory that can be used on a class, class member, or parameter.\n *\n * @param metadataKey - The key for the metadata entry.\n * If `metadataKey` is already defined for the target and target key, the\n * metadataValue for that key will be overwritten.\n * @param metadataValue - The value for the metadata entry.\n * @returns A decorator function.\n */\nexport function metadata(metadataKey, metadataValue) {\n    function decorator(target, propertyKey) {\n        // 1. Assert: F has a [[MetadataKey]] internal slot whose value is an ECMAScript language value, or undefined.\n        // 2. Assert: F has a [[MetadataValue]] internal slot whose value is an ECMAScript language value, or undefined.\n        // 3. If Type(target) is not Object, throw a TypeError exception.\n        if (!isObject(target)) {\n            throw $typeError('@metadata', [metadataKey, metadataValue, target, propertyKey], 'target', target, 'Object or Function');\n        }\n        // 4. If key is not undefined and IsPropertyKey(key) is false, throw a TypeError exception.\n        // 5. Let metadataKey be the value of F's [[MetadataKey]] internal slot.\n        // 6. Let metadataValue be the value of F's [[MetadataValue]] internal slot.\n        // 7. Perform ? target.[[DefineMetadata]](metadataKey, metadataValue, target, key).\n        OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, ensurePropertyKeyOrUndefined(propertyKey));\n        // 8. Return undefined.\n    }\n    return decorator;\n}\nfunction decorate(decorators, target, propertyKey, attributes) {\n    if (propertyKey !== void 0) {\n        if (!Array.isArray(decorators)) {\n            throw $typeError('Metadata.decorate', [decorators, target, propertyKey, attributes], 'decorators', decorators, 'Array');\n        }\n        if (!isObject(target)) {\n            throw $typeError('Metadata.decorate', [decorators, target, propertyKey, attributes], 'target', target, 'Object or Function');\n        }\n        if (!isObject(attributes) && !isNullOrUndefined(attributes)) {\n            throw $typeError('Metadata.decorate', [decorators, target, propertyKey, attributes], 'attributes', attributes, 'Object, Function, null, or undefined');\n        }\n        if (attributes === null) {\n            attributes = void 0;\n        }\n        propertyKey = toPropertyKey(propertyKey);\n        return DecorateProperty(decorators, target, propertyKey, attributes);\n    }\n    else {\n        if (!Array.isArray(decorators)) {\n            throw $typeError('Metadata.decorate', [decorators, target, propertyKey, attributes], 'decorators', decorators, 'Array');\n        }\n        if (typeof target !== 'function') {\n            throw $typeError('Metadata.decorate', [decorators, target, propertyKey, attributes], 'target', target, 'Function');\n        }\n        return DecorateConstructor(decorators, target);\n    }\n}\nfunction DecorateConstructor(decorators, target) {\n    for (let i = decorators.length - 1; i >= 0; --i) {\n        const decorator = decorators[i];\n        const decorated = decorator(target);\n        if (!isNullOrUndefined(decorated)) {\n            if (typeof decorated !== 'function') {\n                throw $typeError('DecorateConstructor', [decorators, target], 'decorated', decorated, 'Function, null, or undefined');\n            }\n            target = decorated;\n        }\n    }\n    return target;\n}\nfunction DecorateProperty(decorators, target, propertyKey, descriptor) {\n    for (let i = decorators.length - 1; i >= 0; --i) {\n        const decorator = decorators[i];\n        const decorated = decorator(target, propertyKey, descriptor);\n        if (!isNullOrUndefined(decorated)) {\n            if (!isObject(decorated)) {\n                throw $typeError('DecorateProperty', [decorators, target, propertyKey, descriptor], 'decorated', decorated, 'Object, Function, null, or undefined');\n            }\n            descriptor = decorated;\n        }\n    }\n    return descriptor;\n}\nfunction $define(metadataKey, metadataValue, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.define', [metadataKey, metadataValue, target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[DefineMetadata]](metadataKey, metadataValue, propertyKey).\n    return OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $has(metadataKey, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.has', [metadataKey, target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[HasMetadata]](metadataKey, propertyKey).\n    return OrdinaryHasMetadata(metadataKey, target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $hasOwn(metadataKey, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.hasOwn', [metadataKey, target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[HasOwn]](metadataKey, propertyKey).\n    return OrdinaryHasOwnMetadata(metadataKey, target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $get(metadataKey, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.get', [metadataKey, target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[GetMetadata]](metadataKey, propertyKey).\n    return OrdinaryGetMetadata(metadataKey, target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $getOwn(metadataKey, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.getOwn', [metadataKey, target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[GetOwnMetadata]](metadataKey, propertyKey).\n    return OrdinaryGetOwnMetadata(metadataKey, target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $getKeys(target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.getKeys', [target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[GetMetadataKeys]](propertyKey).\n    return OrdinaryMetadataKeys(target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $getOwnKeys(target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.getOwnKeys', [target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[GetOwnMetadataKeys]](propertyKey).\n    return OrdinaryOwnMetadataKeys(target, toPropertyKeyOrUndefined(propertyKey));\n}\nfunction $delete(metadataKey, target, propertyKey) {\n    // 1. If Type(target) is not Object, throw a TypeError exception.\n    if (!isObject(target)) {\n        throw $typeError('Metadata.delete', [metadataKey, target, propertyKey], 'target', target, 'Object or Function');\n    }\n    // 2. Return ? target.[[DeleteMetadata]](metadataKey, propertyKey).\n    return OrdinaryDeleteMetadata(target, metadataKey, toPropertyKeyOrUndefined(propertyKey));\n}\nexport const Metadata = {\n    define: $define,\n    has: $has,\n    hasOwn: $hasOwn,\n    get: $get,\n    getOwn: $getOwn,\n    getKeys: $getKeys,\n    getOwnKeys: $getOwnKeys,\n    delete: $delete,\n};\nfunction def(obj, key, value) {\n    Reflect.defineProperty(obj, key, {\n        writable: true,\n        enumerable: false,\n        configurable: true,\n        value,\n    });\n}\nconst internalSlotName = '[[$au]]';\nfunction hasInternalSlot(reflect) {\n    return internalSlotName in reflect;\n}\nexport function applyMetadataPolyfill(reflect) {\n    if (hasInternalSlot(reflect)) {\n        if (reflect[internalSlotName] === metadataInternalSlot) {\n            return;\n        }\n        throw new Error(`Conflicting @aurelia/metadata module import detected. Please make sure you have the same version of all Aurelia packages in your dependency tree.`);\n    }\n    if ('metadata' in reflect ||\n        'decorate' in reflect ||\n        'defineMetadata' in reflect ||\n        'hasMetadata' in reflect ||\n        'hasOwnMetadata' in reflect ||\n        'getMetadata' in reflect ||\n        'getOwnMetadata' in reflect ||\n        'getMetadataKeys' in reflect ||\n        'getOwnMetadataKeys' in reflect ||\n        'deleteMetadata' in reflect) {\n        throw new Error(`Conflicting reflect.metadata polyfill found. If you have 'reflect-metadata' or any other reflect polyfill imported, please remove it, if not (or if you must use a specific polyfill) please file an issue at https://github.com/aurelia/aurelia/issues so that we can look into compatibility options for this scenario.`);\n    }\n    def(Metadata, '$Internal', metadataInternalSlot);\n    def(reflect, 'metadata', metadata);\n    def(reflect, 'decorate', decorate);\n    def(reflect, 'defineMetadata', $define);\n    def(reflect, 'hasMetadata', $has);\n    def(reflect, 'hasOwnMetadata', $hasOwn);\n    def(reflect, 'getMetadata', $get);\n    def(reflect, 'getOwnMetadata', $getOwn);\n    def(reflect, 'getMetadataKeys', $getKeys);\n    def(reflect, 'getOwnMetadataKeys', $getOwnKeys);\n    def(reflect, 'deleteMetadata', $delete);\n}\n//# sourceMappingURL=index.js.map","import { PLATFORM } from './platform';\nconst isNumericLookup = {};\n/**\n * Efficiently determine whether the provided property key is numeric\n * (and thus could be an array indexer) or not.\n *\n * Always returns true for values of type `'number'`.\n *\n * Otherwise, only returns true for strings that consist only of positive integers.\n *\n * Results are cached.\n */\nexport function isArrayIndex(value) {\n    switch (typeof value) {\n        case 'number':\n            return value >= 0 && (value | 0) === value;\n        case 'string': {\n            const result = isNumericLookup[value];\n            if (result !== void 0) {\n                return result;\n            }\n            const length = value.length;\n            if (length === 0) {\n                return isNumericLookup[value] = false;\n            }\n            let ch = 0;\n            for (let i = 0; i < length; ++i) {\n                ch = value.charCodeAt(i);\n                if (i === 0 && ch === 0x30 && length > 1 /* must not start with 0 */ || ch < 0x30 /* 0 */ || ch > 0x39 /* 9 */) {\n                    return isNumericLookup[value] = false;\n                }\n            }\n            return isNumericLookup[value] = true;\n        }\n        default:\n            return false;\n    }\n}\n/**\n * Determines if the value passed is a number or bigint for parsing purposes\n *\n * @param value - Value to evaluate\n */\nexport function isNumberOrBigInt(value) {\n    switch (typeof value) {\n        case 'number':\n        case 'bigint':\n            return true;\n        default:\n            return false;\n    }\n}\n/**\n * Determines if the value passed is a number or bigint for parsing purposes\n *\n * @param value - Value to evaluate\n */\nexport function isStringOrDate(value) {\n    switch (typeof value) {\n        case 'string':\n            return true;\n        case 'object':\n            return value instanceof Date;\n        default:\n            return false;\n    }\n}\n/**\n * Base implementation of camel and kebab cases\n */\nconst baseCase = (function () {\n    let CharKind;\n    (function (CharKind) {\n        CharKind[CharKind[\"none\"] = 0] = \"none\";\n        CharKind[CharKind[\"digit\"] = 1] = \"digit\";\n        CharKind[CharKind[\"upper\"] = 2] = \"upper\";\n        CharKind[CharKind[\"lower\"] = 3] = \"lower\";\n    })(CharKind || (CharKind = {}));\n    // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n    const isDigit = Object.assign(Object.create(null), {\n        '0': true,\n        '1': true,\n        '2': true,\n        '3': true,\n        '4': true,\n        '5': true,\n        '6': true,\n        '7': true,\n        '8': true,\n        '9': true,\n    });\n    function charToKind(char) {\n        if (char === '') {\n            // We get this if we do charAt() with an index out of range\n            return 0 /* none */;\n        }\n        if (char !== char.toUpperCase()) {\n            return 3 /* lower */;\n        }\n        if (char !== char.toLowerCase()) {\n            return 2 /* upper */;\n        }\n        if (isDigit[char] === true) {\n            return 1 /* digit */;\n        }\n        return 0 /* none */;\n    }\n    return function (input, cb) {\n        const len = input.length;\n        if (len === 0) {\n            return input;\n        }\n        let sep = false;\n        let output = '';\n        let prevKind;\n        let curChar = '';\n        let curKind = 0 /* none */;\n        let nextChar = input.charAt(0);\n        let nextKind = charToKind(nextChar);\n        for (let i = 0; i < len; ++i) {\n            prevKind = curKind;\n            curChar = nextChar;\n            curKind = nextKind;\n            nextChar = input.charAt(i + 1);\n            nextKind = charToKind(nextChar);\n            if (curKind === 0 /* none */) {\n                if (output.length > 0) {\n                    // Only set sep to true if it's not at the beginning of output.\n                    sep = true;\n                }\n            }\n            else {\n                if (!sep && output.length > 0 && curKind === 2 /* upper */) {\n                    // Separate UAFoo into UA Foo.\n                    // Separate uaFOO into ua FOO.\n                    sep = prevKind === 3 /* lower */ || nextKind === 3 /* lower */;\n                }\n                output += cb(curChar, sep);\n                sep = false;\n            }\n        }\n        return output;\n    };\n})();\n/**\n * Efficiently convert a string to camelCase.\n *\n * Non-alphanumeric characters are treated as separators.\n *\n * Primarily used by Aurelia to convert DOM attribute names to ViewModel property names.\n *\n * Results are cached.\n */\nexport const camelCase = (function () {\n    const cache = Object.create(null);\n    function callback(char, sep) {\n        return sep ? char.toUpperCase() : char.toLowerCase();\n    }\n    return function (input) {\n        let output = cache[input];\n        if (output === void 0) {\n            output = cache[input] = baseCase(input, callback);\n        }\n        return output;\n    };\n})();\n/**\n * Efficiently convert a string to PascalCase.\n *\n * Non-alphanumeric characters are treated as separators.\n *\n * Primarily used by Aurelia to convert element names to class names for synthetic types.\n *\n * Results are cached.\n */\nexport const pascalCase = (function () {\n    const cache = Object.create(null);\n    return function (input) {\n        let output = cache[input];\n        if (output === void 0) {\n            output = camelCase(input);\n            if (output.length > 0) {\n                output = output[0].toUpperCase() + output.slice(1);\n            }\n            cache[input] = output;\n        }\n        return output;\n    };\n})();\n/**\n * Efficiently convert a string to kebab-case.\n *\n * Non-alphanumeric characters are treated as separators.\n *\n * Primarily used by Aurelia to convert ViewModel property names to DOM attribute names.\n *\n * Results are cached.\n */\nexport const kebabCase = (function () {\n    const cache = Object.create(null);\n    function callback(char, sep) {\n        return sep ? `-${char.toLowerCase()}` : char.toLowerCase();\n    }\n    return function (input) {\n        let output = cache[input];\n        if (output === void 0) {\n            output = cache[input] = baseCase(input, callback);\n        }\n        return output;\n    };\n})();\n/**\n * Efficiently (up to 10x faster than `Array.from`) convert an `ArrayLike` to a real array.\n *\n * Primarily used by Aurelia to convert DOM node lists to arrays.\n */\nexport function toArray(input) {\n    // benchmark: http://jsben.ch/xjsyF\n    const { length } = input;\n    const arr = Array(length);\n    for (let i = 0; i < length; ++i) {\n        arr[i] = input[i];\n    }\n    return arr;\n}\nconst ids = {};\n/**\n * Retrieve the next ID in a sequence for a given string, starting with `1`.\n *\n * Used by Aurelia to assign unique ID's to controllers and resources.\n *\n * Aurelia will always prepend the context name with `au$`, so as long as you avoid\n * using that convention you should be safe from collisions.\n */\nexport function nextId(context) {\n    if (ids[context] === void 0) {\n        ids[context] = 0;\n    }\n    return ++ids[context];\n}\n/**\n * Reset the ID for the given string, so that `nextId` will return `1` again for the next call.\n *\n * Used by Aurelia to reset ID's in between unit tests.\n */\nexport function resetId(context) {\n    ids[context] = 0;\n}\n/**\n * A compare function to pass to `Array.prototype.sort` for sorting numbers.\n * This is needed for numeric sort, since the default sorts them as strings.\n */\nexport function compareNumber(a, b) {\n    return a - b;\n}\nconst emptyArray = PLATFORM.emptyArray;\n/**\n * Efficiently merge and deduplicate the (primitive) values in two arrays.\n *\n * Does not deduplicate existing values in the first array.\n *\n * Guards against null or undefined arrays.\n *\n * Returns `PLATFORM.emptyArray` if both arrays are either `null`, `undefined` or `PLATFORM.emptyArray`\n *\n * @param slice - If `true`, always returns a new array copy (unless neither array is/has a value)\n */\nexport function mergeDistinct(arr1, arr2, slice) {\n    if (arr1 === void 0 || arr1 === null || arr1 === emptyArray) {\n        if (arr2 === void 0 || arr2 === null || arr2 === emptyArray) {\n            return emptyArray;\n        }\n        else {\n            return slice ? arr2.slice(0) : arr2;\n        }\n    }\n    else if (arr2 === void 0 || arr2 === null || arr2 === emptyArray) {\n        return slice ? arr1.slice(0) : arr1;\n    }\n    const lookup = {};\n    const arr3 = slice ? arr1.slice(0) : arr1;\n    let len1 = arr1.length;\n    let len2 = arr2.length;\n    while (len1-- > 0) {\n        lookup[arr1[len1]] = true;\n    }\n    let item;\n    while (len2-- > 0) {\n        item = arr2[len2];\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n        if (lookup[item] === void 0) {\n            arr3.push(item);\n            lookup[item] = true;\n        }\n    }\n    return arr3;\n}\n/**\n * Decorator. (lazily) bind the method to the class instance on first call.\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function bound(target, key, descriptor) {\n    return {\n        configurable: true,\n        enumerable: descriptor.enumerable,\n        get() {\n            // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n            const boundFn = descriptor.value.bind(this);\n            Reflect.defineProperty(this, key, {\n                value: boundFn,\n                writable: true,\n                configurable: true,\n                enumerable: descriptor.enumerable,\n            });\n            return boundFn;\n        },\n    };\n}\nexport function mergeArrays(...arrays) {\n    const result = [];\n    let k = 0;\n    const arraysLen = arrays.length;\n    let arrayLen = 0;\n    let array;\n    for (let i = 0; i < arraysLen; ++i) {\n        array = arrays[i];\n        if (array !== void 0) {\n            arrayLen = array.length;\n            for (let j = 0; j < arrayLen; ++j) {\n                result[k++] = array[j];\n            }\n        }\n    }\n    return result;\n}\nexport function mergeObjects(...objects) {\n    const result = {};\n    const objectsLen = objects.length;\n    let object;\n    let key;\n    for (let i = 0; i < objectsLen; ++i) {\n        object = objects[i];\n        if (object !== void 0) {\n            for (key in object) {\n                result[key] = object[key];\n            }\n        }\n    }\n    return result;\n}\nexport function firstDefined(...values) {\n    const len = values.length;\n    let value;\n    for (let i = 0; i < len; ++i) {\n        value = values[i];\n        if (value !== void 0) {\n            return value;\n        }\n    }\n    throw new Error(`No default value found`);\n}\nexport const getPrototypeChain = (function () {\n    const functionPrototype = Function.prototype;\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    const getPrototypeOf = Object.getPrototypeOf;\n    const cache = new WeakMap();\n    let proto = functionPrototype;\n    let i = 0;\n    let chain = void 0;\n    return function (Type) {\n        chain = cache.get(Type);\n        if (chain === void 0) {\n            cache.set(Type, chain = [proto = Type]);\n            i = 0;\n            while ((proto = getPrototypeOf(proto)) !== functionPrototype) {\n                chain[++i] = proto;\n            }\n        }\n        return chain;\n    };\n})();\nexport function toLookup(...objs) {\n    return Object.assign(Object.create(null), ...objs);\n}\n/**\n * Determine whether the value is a native function.\n *\n * @param fn - The function to check.\n * @returns `true` is the function is a native function, otherwise `false`\n */\nexport const isNativeFunction = (function () {\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    const lookup = new WeakMap();\n    let isNative = false;\n    let sourceText = '';\n    let i = 0;\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    return function (fn) {\n        isNative = lookup.get(fn);\n        if (isNative === void 0) {\n            sourceText = fn.toString();\n            i = sourceText.length;\n            // http://www.ecma-international.org/ecma-262/#prod-NativeFunction\n            isNative = (\n            // 29 is the length of 'function () { [native code] }' which is the smallest length of a native function string\n            i >= 29 &&\n                // 100 seems to be a safe upper bound of the max length of a native function. In Chrome and FF it's 56, in Edge it's 61.\n                i <= 100 &&\n                // This whole heuristic *could* be tricked by a comment. Do we need to care about that?\n                sourceText.charCodeAt(i - 1) === 0x7D && // }\n                // TODO: the spec is a little vague about the precise constraints, so we do need to test this across various browsers to make sure just one whitespace is a safe assumption.\n                sourceText.charCodeAt(i - 2) <= 0x20 && // whitespace\n                sourceText.charCodeAt(i - 3) === 0x5D && // ]\n                sourceText.charCodeAt(i - 4) === 0x65 && // e\n                sourceText.charCodeAt(i - 5) === 0x64 && // d\n                sourceText.charCodeAt(i - 6) === 0x6F && // o\n                sourceText.charCodeAt(i - 7) === 0x63 && // c\n                sourceText.charCodeAt(i - 8) === 0x20 && //\n                sourceText.charCodeAt(i - 9) === 0x65 && // e\n                sourceText.charCodeAt(i - 10) === 0x76 && // v\n                sourceText.charCodeAt(i - 11) === 0x69 && // i\n                sourceText.charCodeAt(i - 12) === 0x74 && // t\n                sourceText.charCodeAt(i - 13) === 0x61 && // a\n                sourceText.charCodeAt(i - 14) === 0x6E && // n\n                sourceText.charCodeAt(i - 15) === 0x58 // [\n            );\n            lookup.set(fn, isNative);\n        }\n        return isNative;\n    };\n})();\n//# sourceMappingURL=functions.js.map","export var LogLevel;\n(function (LogLevel) {\n    /**\n     * The most detailed information about internal app state.\n     *\n     * Disabled by default and should never be enabled in a production environment.\n     */\n    LogLevel[LogLevel[\"trace\"] = 0] = \"trace\";\n    /**\n     * Information that is useful for debugging during development and has no long-term value.\n     */\n    LogLevel[LogLevel[\"debug\"] = 1] = \"debug\";\n    /**\n     * Information about the general flow of the application that has long-term value.\n     */\n    LogLevel[LogLevel[\"info\"] = 2] = \"info\";\n    /**\n     * Unexpected circumstances that require attention but do not otherwise cause the current flow of execution to stop.\n     */\n    LogLevel[LogLevel[\"warn\"] = 3] = \"warn\";\n    /**\n     * Unexpected circumstances that cause the flow of execution in the current activity to stop but do not cause an app-wide failure.\n     */\n    LogLevel[LogLevel[\"error\"] = 4] = \"error\";\n    /**\n     * Unexpected circumstances that cause an app-wide failure or otherwise require immediate attention.\n     */\n    LogLevel[LogLevel[\"fatal\"] = 5] = \"fatal\";\n    /**\n     * No messages should be written.\n     */\n    LogLevel[LogLevel[\"none\"] = 6] = \"none\";\n})(LogLevel || (LogLevel = {}));\nexport const Reporter = {\n    level: 3 /* warn */,\n    write(code, ...params) { return; },\n    error(code, ...params) { return new Error(`Code ${code}`); }\n};\nexport const Tracer = {\n    /**\n     * A convenience property for the user to conditionally call the tracer.\n     * This saves unnecessary `noop` and `slice` calls in non-AOT scenarios even if debugging is disabled.\n     * In AOT these calls will simply be removed entirely.\n     *\n     * This property **only** turns on tracing if `@aurelia/debug` is included and configured as well.\n     */\n    enabled: false,\n    liveLoggingEnabled: false,\n    liveWriter: null,\n    /**\n     * Call this at the start of a method/function.\n     * Each call to `enter` **must** have an accompanying call to `leave` for the tracer to work properly.\n     *\n     * @param objName - Any human-friendly name to identify the traced object with.\n     * @param methodName - Any human-friendly name to identify the traced method with.\n     * @param args - Pass in `Array.prototype.slice.call(arguments)` to also trace the parameters, or `null` if this is not needed (to save memory/cpu)\n     */\n    enter(objName, methodName, args) { return; },\n    /**\n     * Call this at the end of a method/function. Pops one trace item off the stack.\n     */\n    leave() { return; },\n    /**\n     * Writes only the trace info leading up to the current method call.\n     *\n     * @param writer - An object to write the output to.\n     */\n    writeStack(writer) { return; },\n    /**\n     * Writes all trace info captured since the previous flushAll operation.\n     *\n     * @param writer - An object to write the output to. Can be null to simply reset the tracer state.\n     */\n    flushAll(writer) { return; },\n    enableLiveLogging,\n    /**\n     * Stops writing out each trace info item as they are traced.\n     */\n    disableLiveLogging() { return; }\n};\nfunction enableLiveLogging(optionsOrWriter) { return; }\n//# sourceMappingURL=reporter.js.map","import { Metadata } from '@aurelia/metadata';\nimport { PLATFORM } from './platform';\nconst annotation = {\n    name: 'au:annotation',\n    appendTo(target, key) {\n        const keys = Metadata.getOwn(annotation.name, target);\n        if (keys === void 0) {\n            Metadata.define(annotation.name, [key], target);\n        }\n        else {\n            keys.push(key);\n        }\n    },\n    set(target, prop, value) {\n        Metadata.define(annotation.keyFor(prop), value, target);\n    },\n    get(target, prop) {\n        return Metadata.getOwn(annotation.keyFor(prop), target);\n    },\n    getKeys(target) {\n        let keys = Metadata.getOwn(annotation.name, target);\n        if (keys === void 0) {\n            Metadata.define(annotation.name, keys = [], target);\n        }\n        return keys;\n    },\n    isKey(key) {\n        return key.startsWith(annotation.name);\n    },\n    keyFor(name, context) {\n        if (context === void 0) {\n            return `${annotation.name}:${name}`;\n        }\n        return `${annotation.name}:${name}:${context}`;\n    },\n};\nconst resource = {\n    name: 'au:resource',\n    appendTo(target, key) {\n        const keys = Metadata.getOwn(resource.name, target);\n        if (keys === void 0) {\n            Metadata.define(resource.name, [key], target);\n        }\n        else {\n            keys.push(key);\n        }\n    },\n    has(target) {\n        return Metadata.hasOwn(resource.name, target);\n    },\n    getAll(target) {\n        const keys = Metadata.getOwn(resource.name, target);\n        if (keys === void 0) {\n            return PLATFORM.emptyArray;\n        }\n        else {\n            return keys.map(k => Metadata.getOwn(k, target));\n        }\n    },\n    getKeys(target) {\n        let keys = Metadata.getOwn(resource.name, target);\n        if (keys === void 0) {\n            Metadata.define(resource.name, keys = [], target);\n        }\n        return keys;\n    },\n    isKey(key) {\n        return key.startsWith(resource.name);\n    },\n    keyFor(name, context) {\n        if (context === void 0) {\n            return `${resource.name}:${name}`;\n        }\n        return `${resource.name}:${name}:${context}`;\n    },\n};\nexport const Protocol = {\n    annotation,\n    resource,\n};\n// eslint-disable-next-line @typescript-eslint/unbound-method\nconst hasOwn = Object.prototype.hasOwnProperty;\n/**\n * The order in which the values are checked:\n * 1. Annotations (usually set by decorators) have the highest priority; they override the definition as well as static properties on the type.\n * 2. Definition properties (usually set by the customElement decorator object literal) come next. They override static properties on the type.\n * 3. Static properties on the type come last. Note that this does not look up the prototype chain (bindables are an exception here, but we do that differently anyway)\n * 4. The default property that is provided last. The function is only called if the default property is needed\n */\nexport function fromAnnotationOrDefinitionOrTypeOrDefault(name, def, Type, getDefault) {\n    let value = Metadata.getOwn(Protocol.annotation.keyFor(name), Type);\n    if (value === void 0) {\n        value = def[name];\n        if (value === void 0) {\n            value = Type[name];\n            // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n            if (value === void 0 || !hasOwn.call(Type, name)) { // First just check the value (common case is faster), but do make sure it doesn't come from the proto chain\n                return getDefault();\n            }\n            return value;\n        }\n        return value;\n    }\n    return value;\n}\n/**\n * The order in which the values are checked:\n * 1. Annotations (usually set by decorators) have the highest priority; they override static properties on the type.\n * 2. Static properties on the typ. Note that this does not look up the prototype chain (bindables are an exception here, but we do that differently anyway)\n * 3. The default property that is provided last. The function is only called if the default property is needed\n */\nexport function fromAnnotationOrTypeOrDefault(name, Type, getDefault) {\n    let value = Metadata.getOwn(Protocol.annotation.keyFor(name), Type);\n    if (value === void 0) {\n        value = Type[name];\n        // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n        if (value === void 0 || !hasOwn.call(Type, name)) { // First just check the value (common case is faster), but do make sure it doesn't come from the proto chain\n            return getDefault();\n        }\n        return value;\n    }\n    return value;\n}\n/**\n * The order in which the values are checked:\n * 1. Definition properties.\n * 2. The default property that is provided last. The function is only called if the default property is needed\n */\nexport function fromDefinitionOrDefault(name, def, getDefault) {\n    const value = def[name];\n    if (value === void 0) {\n        return getDefault();\n    }\n    return value;\n}\n//# sourceMappingURL=resource.js.map","import { Metadata, isObject, applyMetadataPolyfill } from '@aurelia/metadata';\napplyMetadataPolyfill(Reflect);\nimport { isArrayIndex, isNativeFunction } from './functions';\nimport { PLATFORM } from './platform';\nimport { Reporter } from './reporter';\nimport { Protocol } from './resource';\nexport class ResolverBuilder {\n    constructor(container, key) {\n        this.container = container;\n        this.key = key;\n    }\n    instance(value) {\n        return this.registerResolver(0 /* instance */, value);\n    }\n    singleton(value) {\n        return this.registerResolver(1 /* singleton */, value);\n    }\n    transient(value) {\n        return this.registerResolver(2 /* transient */, value);\n    }\n    callback(value) {\n        return this.registerResolver(3 /* callback */, value);\n    }\n    cachedCallback(value) {\n        return this.registerResolver(3 /* callback */, cacheCallbackResult(value));\n    }\n    aliasTo(destinationKey) {\n        return this.registerResolver(5 /* alias */, destinationKey);\n    }\n    registerResolver(strategy, state) {\n        const { container, key } = this;\n        this.container = this.key = (void 0);\n        return container.registerResolver(key, new Resolver(key, strategy, state));\n    }\n}\nfunction cloneArrayWithPossibleProps(source) {\n    const clone = source.slice();\n    const keys = Object.keys(source);\n    const len = keys.length;\n    let key;\n    for (let i = 0; i < len; ++i) {\n        key = keys[i];\n        if (!isArrayIndex(key)) {\n            clone[key] = source[key];\n        }\n    }\n    return clone;\n}\nexport const DefaultResolver = {\n    none(key) { throw Error(`${key.toString()} not registered, did you forget to add @singleton()?`); },\n    singleton(key) { return new Resolver(key, 1 /* singleton */, key); },\n    transient(key) { return new Resolver(key, 2 /* transient */, key); },\n};\nexport const DefaultContainerConfiguration = {\n    jitRegisterInRoot: true,\n    defaultResolver: DefaultResolver.singleton,\n};\nexport const DI = {\n    createContainer(config = DefaultContainerConfiguration) {\n        return new Container(null, config);\n    },\n    getDesignParamtypes(Type) {\n        return Metadata.getOwn('design:paramtypes', Type);\n    },\n    getAnnotationParamtypes(Type) {\n        const key = Protocol.annotation.keyFor('di:paramtypes');\n        return Metadata.getOwn(key, Type);\n    },\n    getOrCreateAnnotationParamTypes(Type) {\n        const key = Protocol.annotation.keyFor('di:paramtypes');\n        let annotationParamtypes = Metadata.getOwn(key, Type);\n        if (annotationParamtypes === void 0) {\n            Metadata.define(key, annotationParamtypes = [], Type);\n            Protocol.annotation.appendTo(Type, key);\n        }\n        return annotationParamtypes;\n    },\n    getDependencies(Type) {\n        // Note: Every detail of this getDependencies method is pretty deliberate at the moment, and probably not yet 100% tested from every possible angle,\n        // so be careful with making changes here as it can have a huge impact on complex end user apps.\n        // Preferably, only make changes to the dependency resolution process via a RFC.\n        const key = Protocol.annotation.keyFor('di:dependencies');\n        let dependencies = Metadata.getOwn(key, Type);\n        if (dependencies === void 0) {\n            // Type.length is the number of constructor parameters. If this is 0, it could mean the class has an empty constructor\n            // but it could also mean the class has no constructor at all (in which case it inherits the constructor from the prototype).\n            // Non-zero constructor length + no paramtypes means emitDecoratorMetadata is off, or the class has no decorator.\n            // We're not doing anything with the above right now, but it's good to keep in mind for any future issues.\n            const inject = Type.inject;\n            if (inject === void 0) {\n                // design:paramtypes is set by tsc when emitDecoratorMetadata is enabled.\n                const designParamtypes = DI.getDesignParamtypes(Type);\n                // au:annotation:di:paramtypes is set by the parameter decorator from DI.createInterface or by @inject\n                const annotationParamtypes = DI.getAnnotationParamtypes(Type);\n                if (designParamtypes === void 0) {\n                    if (annotationParamtypes === void 0) {\n                        // Only go up the prototype if neither static inject nor any of the paramtypes is defined, as\n                        // there is no sound way to merge a type's deps with its prototype's deps\n                        const Proto = Object.getPrototypeOf(Type);\n                        if (typeof Proto === 'function' && Proto !== Function.prototype) {\n                            dependencies = cloneArrayWithPossibleProps(DI.getDependencies(Proto));\n                        }\n                        else {\n                            dependencies = [];\n                        }\n                    }\n                    else {\n                        // No design:paramtypes so just use the au:annotation:di:paramtypes\n                        dependencies = cloneArrayWithPossibleProps(annotationParamtypes);\n                    }\n                }\n                else if (annotationParamtypes === void 0) {\n                    // No au:annotation:di:paramtypes so just use the design:paramtypes\n                    dependencies = cloneArrayWithPossibleProps(designParamtypes);\n                }\n                else {\n                    // We've got both, so merge them (in case of conflict on same index, au:annotation:di:paramtypes take precedence)\n                    dependencies = cloneArrayWithPossibleProps(designParamtypes);\n                    let len = annotationParamtypes.length;\n                    let auAnnotationParamtype;\n                    for (let i = 0; i < len; ++i) {\n                        auAnnotationParamtype = annotationParamtypes[i];\n                        if (auAnnotationParamtype !== void 0) {\n                            dependencies[i] = auAnnotationParamtype;\n                        }\n                    }\n                    const keys = Object.keys(annotationParamtypes);\n                    len = keys.length;\n                    let key;\n                    for (let i = 0; i < len; ++i) {\n                        key = keys[i];\n                        if (!isArrayIndex(key)) {\n                            dependencies[key] = annotationParamtypes[key];\n                        }\n                    }\n                }\n            }\n            else {\n                // Ignore paramtypes if we have static inject\n                dependencies = cloneArrayWithPossibleProps(inject);\n            }\n            Metadata.define(key, dependencies, Type);\n            Protocol.annotation.appendTo(Type, key);\n        }\n        return dependencies;\n    },\n    /**\n     * creates a decorator that also matches an interface and can be used as a {@linkcode Key}.\n     * ```ts\n     * const ILogger = DI.createInterface<Logger>('Logger').noDefault();\n     * container.register(Registration.singleton(ILogger, getSomeLogger()));\n     * const log = container.get(ILogger);\n     * log.info('hello world');\n     * class Foo {\n     *   constructor( @ILogger log: ILogger ) {\n     *     log.info('hello world');\n     *   }\n     * }\n     * ```\n     * you can also build default registrations into your interface.\n     * ```ts\n     * export const ILogger = DI.createInterface<Logger>('Logger')\n     *        .withDefault( builder => builder.cachedCallback(LoggerDefault));\n     * const log = container.get(ILogger);\n     * log.info('hello world');\n     * class Foo {\n     *   constructor( @ILogger log: ILogger ) {\n     *     log.info('hello world');\n     *   }\n     * }\n     * ```\n     * but these default registrations won't work the same with other decorators that take keys, for example\n     * ```ts\n     * export const MyStr = DI.createInterface<string>('MyStr')\n     *        .withDefault( builder => builder.instance('somestring'));\n     * class Foo {\n     *   constructor( @optional(MyStr) public readonly str: string ) {\n     *   }\n     * }\n     * container.get(Foo).str; // returns undefined\n     * ```\n     * to fix this add this line somewhere before you do a `get`\n     * ```ts\n     * container.register(MyStr);\n     * container.get(Foo).str; // returns 'somestring'\n     * ```\n     *\n     * - @param friendlyName used to improve error messaging\n     */\n    createInterface(friendlyName) {\n        const Interface = function (target, property, index) {\n            if (target == null || new.target !== undefined) {\n                throw new Error(`No registration for interface: '${Interface.friendlyName}'`); // TODO: add error (trying to resolve an InterfaceSymbol that has no registrations)\n            }\n            const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(target);\n            annotationParamtypes[index] = Interface;\n            return target;\n        };\n        Interface.$isInterface = true;\n        Interface.friendlyName = friendlyName == null ? 'Interface' : friendlyName;\n        Interface.noDefault = function () {\n            return Interface;\n        };\n        Interface.withDefault = function (configure) {\n            Interface.withDefault = function () {\n                throw Reporter.error(17, Interface);\n            };\n            Interface.register = function (container, key) {\n                return configure(new ResolverBuilder(container, key !== null && key !== void 0 ? key : Interface));\n            };\n            return Interface;\n        };\n        return Interface;\n    },\n    inject(...dependencies) {\n        return function (target, key, descriptor) {\n            if (typeof descriptor === 'number') { // It's a parameter decorator.\n                const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(target);\n                const dep = dependencies[0];\n                if (dep !== void 0) {\n                    annotationParamtypes[descriptor] = dep;\n                }\n            }\n            else if (key) { // It's a property decorator. Not supported by the container without plugins.\n                const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(target.constructor);\n                const dep = dependencies[0];\n                if (dep !== void 0) {\n                    annotationParamtypes[key] = dep;\n                }\n            }\n            else if (descriptor) { // It's a function decorator (not a Class constructor)\n                const fn = descriptor.value;\n                const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(fn);\n                let dep;\n                for (let i = 0; i < dependencies.length; ++i) {\n                    dep = dependencies[i];\n                    if (dep !== void 0) {\n                        annotationParamtypes[i] = dep;\n                    }\n                }\n            }\n            else { // It's a class decorator.\n                const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(target);\n                let dep;\n                for (let i = 0; i < dependencies.length; ++i) {\n                    dep = dependencies[i];\n                    if (dep !== void 0) {\n                        annotationParamtypes[i] = dep;\n                    }\n                }\n            }\n        };\n    },\n    /**\n     * Registers the `target` class as a transient dependency; each time the dependency is resolved\n     * a new instance will be created.\n     *\n     * @param target - The class / constructor function to register as transient.\n     * @returns The same class, with a static `register` method that takes a container and returns the appropriate resolver.\n     *\n     * @example ```ts\n     * // On an existing class\n     * class Foo { }\n     * DI.transient(Foo);\n     *\n     * // Inline declaration\n     * const Foo = DI.transient(class { });\n     * // Foo is now strongly typed with register\n     * Foo.register(container);\n     * ```\n     */\n    transient(target) {\n        target.register = function register(container) {\n            const registration = Registration.transient(target, target);\n            return registration.register(container, target);\n        };\n        return target;\n    },\n    /**\n     * Registers the `target` class as a singleton dependency; the class will only be created once. Each\n     * consecutive time the dependency is resolved, the same instance will be returned.\n     *\n     * @param target - The class / constructor function to register as a singleton.\n     * @returns The same class, with a static `register` method that takes a container and returns the appropriate resolver.\n     * @example ```ts\n     * // On an existing class\n     * class Foo { }\n     * DI.singleton(Foo);\n     *\n     * // Inline declaration\n     * const Foo = DI.singleton(class { });\n     * // Foo is now strongly typed with register\n     * Foo.register(container);\n     * ```\n     */\n    singleton(target) {\n        target.register = function register(container) {\n            const registration = Registration.singleton(target, target);\n            return registration.register(container, target);\n        };\n        return target;\n    },\n};\nexport const IContainer = DI.createInterface('IContainer').noDefault();\nexport const IServiceLocator = IContainer;\nfunction createResolver(getter) {\n    return function (key) {\n        const resolver = function (target, property, descriptor) {\n            DI.inject(resolver)(target, property, descriptor);\n        };\n        resolver.$isResolver = true;\n        resolver.resolve = function (handler, requestor) {\n            return getter(key, handler, requestor);\n        };\n        return resolver;\n    };\n}\nexport const inject = DI.inject;\nfunction transientDecorator(target) {\n    return DI.transient(target);\n}\nexport function transient(target) {\n    return target == null ? transientDecorator : transientDecorator(target);\n}\nfunction singletonDecorator(target) {\n    return DI.singleton(target);\n}\nexport function singleton(target) {\n    return target == null ? singletonDecorator : singletonDecorator(target);\n}\nexport const all = createResolver((key, handler, requestor) => requestor.getAll(key));\n/**\n * Lazily inject a dependency depending on whether the [[`Key`]] is present at the time of function call.\n *\n * You need to make your argument a function that returns the type, for example\n * ```ts\n * class Foo {\n *   constructor( @lazy('random') public random: () => number )\n * }\n * const foo = container.get(Foo); // instanceof Foo\n * foo.random(); // throws\n * ```\n * would throw an exception because you haven't registered `'random'` before calling the method. This, would give you a\n * new [['Math.random()']] number each time.\n * ```ts\n * class Foo {\n *   constructor( @lazy('random') public random: () => random )\n * }\n * container.register(Registration.callback('random', Math.random ));\n * container.get(Foo).random(); // some random number\n * container.get(Foo).random(); // another random number\n * ```\n * `@lazy` does not manage the lifecycle of the underlying key. If you want a singleton, you have to register as a\n * `singleton`, `transient` would also behave as you would expect, providing you a new instance each time.\n *\n * - @param key [[`Key`]]\n * see { @link DI.createInterface } on interactions with interfaces\n */\nexport const lazy = createResolver((key, handler, requestor) => {\n    return () => requestor.get(key);\n});\n/**\n * Allows you to optionally inject a dependency depending on whether the [[`Key`]] is present, for example\n * ```ts\n * class Foo {\n *   constructor( @inject('mystring') public str: string = 'somestring' )\n * }\n * container.get(Foo); // throws\n * ```\n * would fail\n * ```ts\n * class Foo {\n *   constructor( @optional('mystring') public str: string = 'somestring' )\n * }\n * container.get(Foo).str // somestring\n * ```\n * if you use it without a default it will inject `undefined`, so rember to mark your input type as\n * possibly `undefined`!\n *\n * - @param key: [[`Key`]]\n *\n * see { @link DI.createInterface } on interactions with interfaces\n */\nexport const optional = createResolver((key, handler, requestor) => {\n    if (requestor.has(key, true)) {\n        return requestor.get(key);\n    }\n    else {\n        return undefined;\n    }\n});\n/**\n * ignore tells the container not to try to inject a dependency\n */\nexport function ignore(target, property, descriptor) {\n    DI.inject(ignore)(target, property, descriptor);\n}\nignore.$isResolver = true;\nignore.resolve = () => undefined;\nexport const newInstanceForScope = createResolver((key, handler, requestor) => {\n    const instance = createNewInstance(key, handler);\n    const instanceProvider = new InstanceProvider();\n    instanceProvider.prepare(instance);\n    requestor.registerResolver(key, instanceProvider, true);\n    return instance;\n});\nexport const newInstanceOf = createResolver((key, handler, _requestor) => createNewInstance(key, handler));\nfunction createNewInstance(key, handler) {\n    const factory = handler.getFactory(key);\n    if (factory === null) {\n        throw new Error(`No factory registered for ${key}`);\n    }\n    return factory.construct(handler);\n}\n/** @internal */\nexport var ResolverStrategy;\n(function (ResolverStrategy) {\n    ResolverStrategy[ResolverStrategy[\"instance\"] = 0] = \"instance\";\n    ResolverStrategy[ResolverStrategy[\"singleton\"] = 1] = \"singleton\";\n    ResolverStrategy[ResolverStrategy[\"transient\"] = 2] = \"transient\";\n    ResolverStrategy[ResolverStrategy[\"callback\"] = 3] = \"callback\";\n    ResolverStrategy[ResolverStrategy[\"array\"] = 4] = \"array\";\n    ResolverStrategy[ResolverStrategy[\"alias\"] = 5] = \"alias\";\n})(ResolverStrategy || (ResolverStrategy = {}));\n/** @internal */\nexport class Resolver {\n    constructor(key, strategy, state) {\n        this.key = key;\n        this.strategy = strategy;\n        this.state = state;\n        this.resolving = false;\n    }\n    get $isResolver() { return true; }\n    register(container, key) {\n        return container.registerResolver(key || this.key, this);\n    }\n    resolve(handler, requestor) {\n        switch (this.strategy) {\n            case 0 /* instance */:\n                return this.state;\n            case 1 /* singleton */: {\n                if (this.resolving) {\n                    throw new Error(`Cyclic dependency found: ${this.state.name}`);\n                }\n                this.resolving = true;\n                const factory = handler.getFactory(this.state);\n                if (factory === null) {\n                    throw new Error(`Resolver for ${String(this.key)} returned a null factory`);\n                }\n                this.state = factory.construct(requestor);\n                this.strategy = 0 /* instance */;\n                this.resolving = false;\n                return this.state;\n            }\n            case 2 /* transient */: {\n                // Always create transients from the requesting container\n                const factory = handler.getFactory(this.state);\n                if (factory === null) {\n                    throw new Error(`Resolver for ${String(this.key)} returned a null factory`);\n                }\n                return factory.construct(requestor);\n            }\n            case 3 /* callback */:\n                return this.state(handler, requestor, this);\n            case 4 /* array */:\n                return this.state[0].resolve(handler, requestor);\n            case 5 /* alias */:\n                return handler.get(this.state);\n            default:\n                throw Reporter.error(6, this.strategy);\n        }\n    }\n    getFactory(container) {\n        let resolver;\n        switch (this.strategy) {\n            case 1 /* singleton */:\n            case 2 /* transient */:\n                return container.getFactory(this.state);\n            case 5 /* alias */:\n                resolver = container.getResolver(this.state);\n                if (resolver == null || resolver.getFactory === void 0) {\n                    return null;\n                }\n                return resolver.getFactory(container);\n            default:\n                return null;\n        }\n    }\n}\n/** @internal */\nexport class Factory {\n    constructor(Type, invoker, dependencies) {\n        this.Type = Type;\n        this.invoker = invoker;\n        this.dependencies = dependencies;\n        this.transformers = null;\n    }\n    construct(container, dynamicDependencies) {\n        const transformers = this.transformers;\n        let instance = dynamicDependencies !== void 0\n            ? this.invoker.invokeWithDynamicDependencies(container, this.Type, this.dependencies, dynamicDependencies)\n            : this.invoker.invoke(container, this.Type, this.dependencies);\n        if (transformers == null) {\n            return instance;\n        }\n        for (let i = 0, ii = transformers.length; i < ii; ++i) {\n            instance = transformers[i](instance);\n        }\n        return instance;\n    }\n    registerTransformer(transformer) {\n        if (this.transformers == null) {\n            this.transformers = [];\n        }\n        this.transformers.push(transformer);\n        return true;\n    }\n}\nconst createFactory = (function () {\n    function invokeWithDynamicDependencies(container, Type, staticDependencies, dynamicDependencies) {\n        let i = staticDependencies.length;\n        let args = new Array(i);\n        let lookup;\n        while (i-- > 0) {\n            lookup = staticDependencies[i];\n            if (lookup == null) {\n                throw Reporter.error(7, `Index ${i}.`);\n            }\n            else {\n                args[i] = container.get(lookup);\n            }\n        }\n        if (dynamicDependencies !== void 0) {\n            args = args.concat(dynamicDependencies);\n        }\n        return Reflect.construct(Type, args);\n    }\n    const classInvokers = [\n        {\n            invoke(container, Type) {\n                return new Type();\n            },\n            invokeWithDynamicDependencies\n        },\n        {\n            invoke(container, Type, deps) {\n                return new Type(container.get(deps[0]));\n            },\n            invokeWithDynamicDependencies\n        },\n        {\n            invoke(container, Type, deps) {\n                return new Type(container.get(deps[0]), container.get(deps[1]));\n            },\n            invokeWithDynamicDependencies\n        },\n        {\n            invoke(container, Type, deps) {\n                return new Type(container.get(deps[0]), container.get(deps[1]), container.get(deps[2]));\n            },\n            invokeWithDynamicDependencies\n        },\n        {\n            invoke(container, Type, deps) {\n                return new Type(container.get(deps[0]), container.get(deps[1]), container.get(deps[2]), container.get(deps[3]));\n            },\n            invokeWithDynamicDependencies\n        },\n        {\n            invoke(container, Type, deps) {\n                return new Type(container.get(deps[0]), container.get(deps[1]), container.get(deps[2]), container.get(deps[3]), container.get(deps[4]));\n            },\n            invokeWithDynamicDependencies\n        }\n    ];\n    const fallbackInvoker = {\n        invoke: invokeWithDynamicDependencies,\n        invokeWithDynamicDependencies\n    };\n    return function (Type) {\n        if (isNativeFunction(Type)) {\n            Reporter.write(5, Type.name);\n        }\n        const dependencies = DI.getDependencies(Type);\n        const invoker = classInvokers.length > dependencies.length ? classInvokers[dependencies.length] : fallbackInvoker;\n        return new Factory(Type, invoker, dependencies);\n    };\n})();\nconst containerResolver = {\n    $isResolver: true,\n    resolve(handler, requestor) {\n        return requestor;\n    }\n};\nfunction isRegistry(obj) {\n    return typeof obj.register === 'function';\n}\nfunction isClass(obj) {\n    return obj.prototype !== void 0;\n}\nfunction isResourceKey(key) {\n    return typeof key === 'string' && key.indexOf(':') > 0;\n}\nconst InstrinsicTypeNames = new Set([\n    'Array',\n    'ArrayBuffer',\n    'Boolean',\n    'DataView',\n    'Date',\n    'Error',\n    'EvalError',\n    'Float32Array',\n    'Float64Array',\n    'Function',\n    'Int8Array',\n    'Int16Array',\n    'Int32Array',\n    'Map',\n    'Number',\n    'Object',\n    'Promise',\n    'RangeError',\n    'ReferenceError',\n    'RegExp',\n    'Set',\n    'SharedArrayBuffer',\n    'String',\n    'SyntaxError',\n    'TypeError',\n    'Uint8Array',\n    'Uint8ClampedArray',\n    'Uint16Array',\n    'Uint32Array',\n    'URIError',\n    'WeakMap',\n    'WeakSet',\n]);\nconst factoryKey = 'di:factory';\nconst factoryAnnotationKey = Protocol.annotation.keyFor(factoryKey);\n/** @internal */\nexport class Container {\n    constructor(parent, config = DefaultContainerConfiguration) {\n        this.parent = parent;\n        this.config = config;\n        this.registerDepth = 0;\n        this.disposableResolvers = new Set();\n        if (parent === null) {\n            this.root = this;\n            this.resolvers = new Map();\n            this.resourceResolvers = Object.create(null);\n        }\n        else {\n            this.root = parent.root;\n            this.resolvers = new Map();\n            this.resourceResolvers = Object.assign(Object.create(null), this.root.resourceResolvers);\n        }\n        this.resolvers.set(IContainer, containerResolver);\n    }\n    register(...params) {\n        if (++this.registerDepth === 100) {\n            throw new Error('Unable to autoregister dependency');\n            // TODO: change to reporter.error and add various possible causes in description.\n            // Most likely cause is trying to register a plain object that does not have a\n            // register method and is not a class constructor\n        }\n        let current;\n        let keys;\n        let value;\n        let j;\n        let jj;\n        for (let i = 0, ii = params.length; i < ii; ++i) {\n            current = params[i];\n            if (!isObject(current)) {\n                continue;\n            }\n            if (isRegistry(current)) {\n                current.register(this);\n            }\n            else if (Protocol.resource.has(current)) {\n                const defs = Protocol.resource.getAll(current);\n                if (defs.length === 1) {\n                    // Fast path for the very common case\n                    defs[0].register(this);\n                }\n                else {\n                    const len = defs.length;\n                    for (let d = 0; d < len; ++d) {\n                        defs[d].register(this);\n                    }\n                }\n            }\n            else if (isClass(current)) {\n                Registration.singleton(current, current).register(this);\n            }\n            else {\n                keys = Object.keys(current);\n                j = 0;\n                jj = keys.length;\n                for (; j < jj; ++j) {\n                    value = current[keys[j]];\n                    if (!isObject(value)) {\n                        continue;\n                    }\n                    // note: we could remove this if-branch and call this.register directly\n                    // - the extra check is just a perf tweak to create fewer unnecessary arrays by the spread operator\n                    if (isRegistry(value)) {\n                        value.register(this);\n                    }\n                    else {\n                        this.register(value);\n                    }\n                }\n            }\n        }\n        --this.registerDepth;\n        return this;\n    }\n    registerResolver(key, resolver, isDisposable = false) {\n        validateKey(key);\n        const resolvers = this.resolvers;\n        const result = resolvers.get(key);\n        if (result == null) {\n            resolvers.set(key, resolver);\n            if (isResourceKey(key)) {\n                this.resourceResolvers[key] = resolver;\n            }\n        }\n        else if (result instanceof Resolver && result.strategy === 4 /* array */) {\n            result.state.push(resolver);\n        }\n        else {\n            resolvers.set(key, new Resolver(key, 4 /* array */, [result, resolver]));\n        }\n        if (isDisposable) {\n            this.disposableResolvers.add(resolver);\n        }\n        return resolver;\n    }\n    registerTransformer(key, transformer) {\n        const resolver = this.getResolver(key);\n        if (resolver == null) {\n            return false;\n        }\n        if (resolver.getFactory) {\n            const factory = resolver.getFactory(this);\n            if (factory == null) {\n                return false;\n            }\n            // This type cast is a bit of a hacky one, necessary due to the duplicity of IResolverLike.\n            // Problem is that that interface's type arg can be of type Key, but the getFactory method only works on\n            // type Constructable. So the return type of that optional method has this additional constraint, which\n            // seems to confuse the type checker.\n            return factory.registerTransformer(transformer);\n        }\n        return false;\n    }\n    getResolver(key, autoRegister = true) {\n        validateKey(key);\n        if (key.resolve !== void 0) {\n            return key;\n        }\n        let current = this;\n        let resolver;\n        while (current != null) {\n            resolver = current.resolvers.get(key);\n            if (resolver == null) {\n                if (current.parent == null) {\n                    const handler = this.config.jitRegisterInRoot ? current : this;\n                    return autoRegister ? this.jitRegister(key, handler) : null;\n                }\n                current = current.parent;\n            }\n            else {\n                return resolver;\n            }\n        }\n        return null;\n    }\n    has(key, searchAncestors = false) {\n        return this.resolvers.has(key)\n            ? true\n            : searchAncestors && this.parent != null\n                ? this.parent.has(key, true)\n                : false;\n    }\n    get(key) {\n        validateKey(key);\n        if (key.$isResolver) {\n            return key.resolve(this, this);\n        }\n        let current = this;\n        let resolver;\n        while (current != null) {\n            resolver = current.resolvers.get(key);\n            if (resolver == null) {\n                if (current.parent == null) {\n                    const handler = this.config.jitRegisterInRoot ? current : this;\n                    resolver = this.jitRegister(key, handler);\n                    return resolver.resolve(current, this);\n                }\n                current = current.parent;\n            }\n            else {\n                return resolver.resolve(current, this);\n            }\n        }\n        throw new Error(`Unable to resolve key: ${key}`);\n    }\n    getAll(key) {\n        validateKey(key);\n        let current = this;\n        let resolver;\n        while (current != null) {\n            resolver = current.resolvers.get(key);\n            if (resolver == null) {\n                if (this.parent == null) {\n                    return PLATFORM.emptyArray;\n                }\n                current = current.parent;\n            }\n            else {\n                return buildAllResponse(resolver, current, this);\n            }\n        }\n        return PLATFORM.emptyArray;\n    }\n    getFactory(Type) {\n        let factory = Metadata.getOwn(factoryAnnotationKey, Type);\n        if (factory === void 0) {\n            Metadata.define(factoryAnnotationKey, factory = createFactory(Type), Type);\n            Protocol.annotation.appendTo(Type, factoryAnnotationKey);\n        }\n        return factory;\n    }\n    registerFactory(key, factory) {\n        Protocol.annotation.set(key, factoryKey, factory);\n        Protocol.annotation.appendTo(key, factoryAnnotationKey);\n    }\n    createChild(config) {\n        return new Container(this, config !== null && config !== void 0 ? config : this.config);\n    }\n    disposeResolvers() {\n        var _a;\n        const disposables = Array.from(this.disposableResolvers);\n        while (disposables.length > 0) {\n            (_a = disposables.pop()) === null || _a === void 0 ? void 0 : _a.dispose();\n        }\n    }\n    jitRegister(keyAsValue, handler) {\n        if (typeof keyAsValue !== 'function') {\n            throw new Error(`Attempted to jitRegister something that is not a constructor: '${keyAsValue}'. Did you forget to register this resource?`);\n        }\n        if (InstrinsicTypeNames.has(keyAsValue.name)) {\n            throw new Error(`Attempted to jitRegister an intrinsic type: ${keyAsValue.name}. Did you forget to add @inject(Key)`);\n        }\n        if (isRegistry(keyAsValue)) {\n            const registrationResolver = keyAsValue.register(handler, keyAsValue);\n            if (!(registrationResolver instanceof Object) || registrationResolver.resolve == null) {\n                const newResolver = handler.resolvers.get(keyAsValue);\n                if (newResolver != void 0) {\n                    return newResolver;\n                }\n                throw Reporter.error(40); // did not return a valid resolver from the static register method\n            }\n            return registrationResolver;\n        }\n        else if (Protocol.resource.has(keyAsValue)) {\n            const defs = Protocol.resource.getAll(keyAsValue);\n            if (defs.length === 1) {\n                // Fast path for the very common case\n                defs[0].register(handler);\n            }\n            else {\n                const len = defs.length;\n                for (let d = 0; d < len; ++d) {\n                    defs[d].register(handler);\n                }\n            }\n            const newResolver = handler.resolvers.get(keyAsValue);\n            if (newResolver != void 0) {\n                return newResolver;\n            }\n            throw Reporter.error(40); // did not return a valid resolver from the static register method\n        }\n        else if (keyAsValue.$isInterface) {\n            throw new Error(`Attempted to jitRegister an interface: ${keyAsValue.friendlyName}`);\n        }\n        else {\n            const resolver = this.config.defaultResolver(keyAsValue, handler);\n            handler.resolvers.set(keyAsValue, resolver);\n            return resolver;\n        }\n    }\n}\n/**\n * An implementation of IRegistry that delegates registration to a\n * separately registered class. The ParameterizedRegistry facilitates the\n * passing of parameters to the final registry.\n */\nexport class ParameterizedRegistry {\n    constructor(key, params) {\n        this.key = key;\n        this.params = params;\n    }\n    register(container) {\n        if (container.has(this.key, true)) {\n            const registry = container.get(this.key);\n            registry.register(container, ...this.params);\n        }\n        else {\n            container.register(...this.params.filter(x => typeof x === 'object'));\n        }\n    }\n}\nconst cache = new WeakMap();\nfunction cacheCallbackResult(fun) {\n    return function (handler, requestor, resolver) {\n        if (cache.has(resolver)) {\n            return cache.get(resolver);\n        }\n        const t = fun(handler, requestor, resolver);\n        cache.set(resolver, t);\n        return t;\n    };\n}\n/**\n * you can use the resulting {@linkcode IRegistration} of any of the factory methods\n * to register with the container, e.g.\n * ```\n * class Foo {}\n * const container = DI.createContainer();\n * container.register(Registration.instance(Foo, new Foo()));\n * container.get(Foo);\n * ```\n */\nexport const Registration = {\n    /**\n     * allows you to pass an instance.\n     * Every time you request this {@linkcode Key} you will get this instance back.\n     * ```\n     * Registration.instance(Foo, new Foo()));\n     * ```\n     *\n     * @param key\n     * @param value\n     */\n    instance(key, value) {\n        return new Resolver(key, 0 /* instance */, value);\n    },\n    /**\n     * Creates an instance from the class.\n     * Every time you request this {@linkcode Key} you will get the same one back.\n     * ```\n     * Registration.singleton(Foo, Foo);\n     * ```\n     *\n     * @param key\n     * @param value\n     */\n    singleton(key, value) {\n        return new Resolver(key, 1 /* singleton */, value);\n    },\n    /**\n     * Creates an instance from a class.\n     * Every time you request this {@linkcode Key} you will get a new instance.\n     * ```\n     * Registration.instance(Foo, Foo);\n     * ```\n     *\n     * @param key\n     * @param value\n     */\n    transient(key, value) {\n        return new Resolver(key, 2 /* transient */, value);\n    },\n    /**\n     * Creates an instance from the method passed.\n     * Every time you request this {@linkcode Key} you will get a new instance.\n     * ```\n     * Registration.callback(Foo, () => new Foo());\n     * Registration.callback(Bar, (c: IContainer) => new Bar(c.get(Foo)));\n     * ```\n     *\n     * @param key\n     * @param callback\n     */\n    callback(key, callback) {\n        return new Resolver(key, 3 /* callback */, callback);\n    },\n    /**\n     * Creates an instance from the method passed.\n     * On the first request for the {@linkcode Key} your callback is called and returns an instance.\n     * subsequent requests for the {@linkcode Key}, the initial instance returned will be returned.\n     * If you pass the same {@linkcode Registration} to another container the same cached value will be used.\n     * Should all references to the resolver returned be removed, the cache will expire.\n     * ```\n     * Registration.cachedCallback(Foo, () => new Foo());\n     * Registration.cachedCallback(Bar, (c: IContainer) => new Bar(c.get(Foo)));\n     * ```\n     *\n     * @param key\n     * @param callback\n     */\n    cachedCallback(key, callback) {\n        return new Resolver(key, 3 /* callback */, cacheCallbackResult(callback));\n    },\n    /**\n     * creates an alternate {@linkcode Key} to retrieve an instance by.\n     * Returns the same scope as the original {@linkcode Key}.\n     * ```\n     * Register.singleton(Foo, Foo)\n     * Register.aliasTo(Foo, MyFoos);\n     *\n     * container.getAll(MyFoos) // contains an instance of Foo\n     * ```\n     *\n     * @param originalKey\n     * @param aliasKey\n     */\n    aliasTo(originalKey, aliasKey) {\n        return new Resolver(aliasKey, 5 /* alias */, originalKey);\n    },\n    /**\n     * @internal\n     * @param key\n     * @param params\n     */\n    defer(key, ...params) {\n        return new ParameterizedRegistry(key, params);\n    }\n};\nexport class InstanceProvider {\n    constructor() {\n        this.instance = null;\n    }\n    prepare(instance) {\n        this.instance = instance;\n    }\n    get $isResolver() { return true; }\n    resolve() {\n        if (this.instance === undefined) { // unmet precondition: call prepare\n            throw Reporter.error(50); // TODO: organize error codes\n        }\n        return this.instance;\n    }\n    dispose() {\n        this.instance = null;\n    }\n}\n/** @internal */\nexport function validateKey(key) {\n    if (key === null || key === void 0) {\n        throw Reporter.error(5);\n    }\n}\nfunction buildAllResponse(resolver, handler, requestor) {\n    if (resolver instanceof Resolver && resolver.strategy === 4 /* array */) {\n        const state = resolver.state;\n        let i = state.length;\n        const results = new Array(i);\n        while (i--) {\n            results[i] = state[i].resolve(handler, requestor);\n        }\n        return results;\n    }\n    return [resolver.resolve(handler, requestor)];\n}\n//# sourceMappingURL=di.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { all, DI, ignore, optional, Registration } from './di';\nimport { toLookup } from './functions';\nimport { Protocol } from './resource';\nimport { Metadata } from '@aurelia/metadata';\n/**\n * Flags to enable/disable color usage in the logging output.\n */\nexport var ColorOptions;\n(function (ColorOptions) {\n    /**\n     * Do not use ASCII color codes in logging output.\n     */\n    ColorOptions[ColorOptions[\"noColors\"] = 0] = \"noColors\";\n    /**\n     * Use ASCII color codes in logging output. By default, timestamps and the TRC and DBG prefix are colored grey. INF white, WRN yellow, and ERR and FTL red.\n     */\n    ColorOptions[ColorOptions[\"colors\"] = 1] = \"colors\";\n})(ColorOptions || (ColorOptions = {}));\nexport const ILogConfig = DI.createInterface('ILogConfig').withDefault(x => x.instance(new LogConfig(0 /* noColors */, 3 /* warn */)));\nexport const ISink = DI.createInterface('ISink').noDefault();\nexport const ILogEventFactory = DI.createInterface('ILogEventFactory').withDefault(x => x.singleton(DefaultLogEventFactory));\nexport const ILogger = DI.createInterface('ILogger').withDefault(x => x.singleton(DefaultLogger));\nexport const ILogScopes = DI.createInterface('ILogScope').noDefault();\nexport const LoggerSink = Object.freeze({\n    key: Protocol.annotation.keyFor('logger-sink-handles'),\n    define(target, definition) {\n        Metadata.define(this.key, definition.handles, target.prototype);\n        return target;\n    },\n    getHandles(target) {\n        return Metadata.get(this.key, target);\n    },\n});\nexport function sink(definition) {\n    return function (target) {\n        return LoggerSink.define(target, definition);\n    };\n}\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\nexport const format = toLookup({\n    red(str) {\n        return `\\u001b[31m${str}\\u001b[39m`;\n    },\n    green(str) {\n        return `\\u001b[32m${str}\\u001b[39m`;\n    },\n    yellow(str) {\n        return `\\u001b[33m${str}\\u001b[39m`;\n    },\n    blue(str) {\n        return `\\u001b[34m${str}\\u001b[39m`;\n    },\n    magenta(str) {\n        return `\\u001b[35m${str}\\u001b[39m`;\n    },\n    cyan(str) {\n        return `\\u001b[36m${str}\\u001b[39m`;\n    },\n    white(str) {\n        return `\\u001b[37m${str}\\u001b[39m`;\n    },\n    grey(str) {\n        return `\\u001b[90m${str}\\u001b[39m`;\n    },\n});\nexport class LogConfig {\n    constructor(colorOptions, level) {\n        this.colorOptions = colorOptions;\n        this.level = level;\n    }\n}\nconst getLogLevelString = (function () {\n    const logLevelString = [\n        toLookup({\n            TRC: 'TRC',\n            DBG: 'DBG',\n            INF: 'INF',\n            WRN: 'WRN',\n            ERR: 'ERR',\n            FTL: 'FTL',\n            QQQ: '???',\n        }),\n        toLookup({\n            TRC: format.grey('TRC'),\n            DBG: format.grey('DBG'),\n            INF: format.white('INF'),\n            WRN: format.yellow('WRN'),\n            ERR: format.red('ERR'),\n            FTL: format.red('FTL'),\n            QQQ: format.grey('???'),\n        }),\n    ];\n    return function (level, colorOptions) {\n        if (level <= 0 /* trace */) {\n            return logLevelString[colorOptions].TRC;\n        }\n        if (level <= 1 /* debug */) {\n            return logLevelString[colorOptions].DBG;\n        }\n        if (level <= 2 /* info */) {\n            return logLevelString[colorOptions].INF;\n        }\n        if (level <= 3 /* warn */) {\n            return logLevelString[colorOptions].WRN;\n        }\n        if (level <= 4 /* error */) {\n            return logLevelString[colorOptions].ERR;\n        }\n        if (level <= 5 /* fatal */) {\n            return logLevelString[colorOptions].FTL;\n        }\n        return logLevelString[colorOptions].QQQ;\n    };\n})();\nfunction getScopeString(scope, colorOptions) {\n    if (colorOptions === 0 /* noColors */) {\n        return scope.join('.');\n    }\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    return scope.map(format.cyan).join('.');\n}\nfunction getIsoString(timestamp, colorOptions) {\n    if (colorOptions === 0 /* noColors */) {\n        return new Date(timestamp).toISOString();\n    }\n    return format.grey(new Date(timestamp).toISOString());\n}\nexport class DefaultLogEvent {\n    constructor(severity, message, optionalParams, scope, colorOptions, timestamp) {\n        this.severity = severity;\n        this.message = message;\n        this.optionalParams = optionalParams;\n        this.scope = scope;\n        this.colorOptions = colorOptions;\n        this.timestamp = timestamp;\n    }\n    toString() {\n        const { severity, message, scope, colorOptions, timestamp } = this;\n        if (scope.length === 0) {\n            return `${getIsoString(timestamp, colorOptions)} [${getLogLevelString(severity, colorOptions)}] ${message}`;\n        }\n        return `${getIsoString(timestamp, colorOptions)} [${getLogLevelString(severity, colorOptions)} ${getScopeString(scope, colorOptions)}] ${message}`;\n    }\n}\nlet DefaultLogEventFactory = class DefaultLogEventFactory {\n    constructor(config) {\n        this.config = config;\n    }\n    createLogEvent(logger, level, message, optionalParams) {\n        return new DefaultLogEvent(level, message, optionalParams, logger.scope, this.config.colorOptions, Date.now());\n    }\n};\nDefaultLogEventFactory = __decorate([\n    __param(0, ILogConfig),\n    __metadata(\"design:paramtypes\", [Object])\n], DefaultLogEventFactory);\nexport { DefaultLogEventFactory };\nexport class ConsoleSink {\n    constructor($console) {\n        this.handleEvent = function emit(event) {\n            const optionalParams = event.optionalParams;\n            if (optionalParams === void 0 || optionalParams.length === 0) {\n                switch (event.severity) {\n                    case 0 /* trace */:\n                    case 1 /* debug */:\n                        return $console.debug(event.toString());\n                    case 2 /* info */:\n                        return $console.info(event.toString());\n                    case 3 /* warn */:\n                        return $console.warn(event.toString());\n                    case 4 /* error */:\n                    case 5 /* fatal */:\n                        return $console.error(event.toString());\n                }\n            }\n            else {\n                switch (event.severity) {\n                    case 0 /* trace */:\n                    case 1 /* debug */:\n                        return $console.debug(event.toString(), ...optionalParams);\n                    case 2 /* info */:\n                        return $console.info(event.toString(), ...optionalParams);\n                    case 3 /* warn */:\n                        return $console.warn(event.toString(), ...optionalParams);\n                    case 4 /* error */:\n                    case 5 /* fatal */:\n                        return $console.error(event.toString(), ...optionalParams);\n                }\n            }\n        };\n    }\n}\nlet DefaultLogger = class DefaultLogger {\n    constructor(config, factory, sinks, scope = [], parent = null) {\n        var _a, _b, _c, _d, _e, _f;\n        this.config = config;\n        this.factory = factory;\n        this.scope = scope;\n        this.scopedLoggers = Object.create(null);\n        let traceSinks;\n        let debugSinks;\n        let infoSinks;\n        let warnSinks;\n        let errorSinks;\n        let fatalSinks;\n        if (parent === null) {\n            this.root = this;\n            this.parent = this;\n            traceSinks = this.traceSinks = [];\n            debugSinks = this.debugSinks = [];\n            infoSinks = this.infoSinks = [];\n            warnSinks = this.warnSinks = [];\n            errorSinks = this.errorSinks = [];\n            fatalSinks = this.fatalSinks = [];\n            for (const $sink of sinks) {\n                const handles = LoggerSink.getHandles($sink);\n                if ((_a = handles === null || handles === void 0 ? void 0 : handles.includes(0 /* trace */)) !== null && _a !== void 0 ? _a : true) {\n                    traceSinks.push($sink);\n                }\n                if ((_b = handles === null || handles === void 0 ? void 0 : handles.includes(1 /* debug */)) !== null && _b !== void 0 ? _b : true) {\n                    debugSinks.push($sink);\n                }\n                if ((_c = handles === null || handles === void 0 ? void 0 : handles.includes(2 /* info */)) !== null && _c !== void 0 ? _c : true) {\n                    infoSinks.push($sink);\n                }\n                if ((_d = handles === null || handles === void 0 ? void 0 : handles.includes(3 /* warn */)) !== null && _d !== void 0 ? _d : true) {\n                    warnSinks.push($sink);\n                }\n                if ((_e = handles === null || handles === void 0 ? void 0 : handles.includes(4 /* error */)) !== null && _e !== void 0 ? _e : true) {\n                    errorSinks.push($sink);\n                }\n                if ((_f = handles === null || handles === void 0 ? void 0 : handles.includes(5 /* fatal */)) !== null && _f !== void 0 ? _f : true) {\n                    fatalSinks.push($sink);\n                }\n            }\n        }\n        else {\n            this.root = parent.root;\n            this.parent = parent;\n            traceSinks = this.traceSinks = parent.traceSinks;\n            debugSinks = this.debugSinks = parent.debugSinks;\n            infoSinks = this.infoSinks = parent.infoSinks;\n            warnSinks = this.warnSinks = parent.warnSinks;\n            errorSinks = this.errorSinks = parent.errorSinks;\n            fatalSinks = this.fatalSinks = parent.fatalSinks;\n        }\n        const emit = ($sinks, level, msgOrGetMsg, optionalParams) => {\n            const message = typeof msgOrGetMsg === 'function' ? msgOrGetMsg() : msgOrGetMsg;\n            const event = factory.createLogEvent(this, level, message, optionalParams);\n            for (let i = 0, ii = $sinks.length; i < ii; ++i) {\n                $sinks[i].handleEvent(event);\n            }\n        };\n        this.trace = function trace(messageOrGetMessage, ...optionalParams) {\n            if (config.level <= 0 /* trace */) {\n                emit(traceSinks, 0 /* trace */, messageOrGetMessage, optionalParams);\n            }\n        };\n        this.debug = function debug(messageOrGetMessage, ...optionalParams) {\n            if (config.level <= 1 /* debug */) {\n                emit(debugSinks, 1 /* debug */, messageOrGetMessage, optionalParams);\n            }\n        };\n        this.info = function info(messageOrGetMessage, ...optionalParams) {\n            if (config.level <= 2 /* info */) {\n                emit(infoSinks, 2 /* info */, messageOrGetMessage, optionalParams);\n            }\n        };\n        this.warn = function warn(messageOrGetMessage, ...optionalParams) {\n            if (config.level <= 3 /* warn */) {\n                emit(warnSinks, 3 /* warn */, messageOrGetMessage, optionalParams);\n            }\n        };\n        this.error = function error(messageOrGetMessage, ...optionalParams) {\n            if (config.level <= 4 /* error */) {\n                emit(errorSinks, 4 /* error */, messageOrGetMessage, optionalParams);\n            }\n        };\n        this.fatal = function fatal(messageOrGetMessage, ...optionalParams) {\n            if (config.level <= 5 /* fatal */) {\n                emit(fatalSinks, 5 /* fatal */, messageOrGetMessage, optionalParams);\n            }\n        };\n    }\n    scopeTo(name) {\n        const scopedLoggers = this.scopedLoggers;\n        let scopedLogger = scopedLoggers[name];\n        if (scopedLogger === void 0) {\n            scopedLogger = scopedLoggers[name] = new DefaultLogger(this.config, this.factory, (void 0), this.scope.concat(name), this);\n        }\n        return scopedLogger;\n    }\n};\nDefaultLogger = __decorate([\n    __param(0, ILogConfig),\n    __param(1, ILogEventFactory),\n    __param(2, all(ISink)),\n    __param(3, optional(ILogScopes)),\n    __param(4, ignore),\n    __metadata(\"design:paramtypes\", [Object, Object, Array, Array, Object])\n], DefaultLogger);\nexport { DefaultLogger };\n/**\n * A basic `ILogger` configuration that configures a single `console` sink based on provided options.\n *\n * NOTE: You *must* register the return value of `.create` with the container / au instance, not this `LoggerConfiguration` object itself.\n *\n * @example\n * ```ts\n * container.register(LoggerConfiguration.create());\n *\n * container.register(LoggerConfiguration.create({$console: console}))\n *\n * container.register(LoggerConfiguration.create({$console: console, level: LogLevel.debug}))\n *\n * container.register(LoggerConfiguration.create({\n *  $console: {\n *     debug: PLATFORM.noop,\n *     info: PLATFORM.noop,\n *     warn: PLATFORM.noop,\n *     error: msg => {\n *       throw new Error(msg);\n *     }\n *  },\n *  level: LogLevel.debug\n * }))\n *\n * ```\n */\nexport const LoggerConfiguration = toLookup({\n    /**\n     * @param $console - The `console` object to use. Can be the native `window.console` / `global.console`, but can also be a wrapper or mock that implements the same interface.\n     * @param level - The global `LogLevel` to configure. Defaults to `warn` or higher.\n     * @param colorOptions - Whether to use colors or not. Defaults to `noColors`. Colors are especially nice in nodejs environments but don't necessarily work (well) in all environments, such as browsers.\n     */\n    create({ $console, level = 3 /* warn */, colorOptions = 0 /* noColors */, sinks = [], } = {}) {\n        return toLookup({\n            register(container) {\n                container.register(Registration.instance(ILogConfig, new LogConfig(colorOptions, level)));\n                if ($console !== void 0 && $console !== null) {\n                    container.register(Registration.instance(ISink, new ConsoleSink($console)));\n                }\n                for (const $sink of sinks) {\n                    container.register(Registration.singleton(ISink, $sink));\n                }\n                return container;\n            },\n        });\n    },\n});\n//# sourceMappingURL=logger.js.map","import { PLATFORM } from './platform';\nexport const Profiler = (function () {\n    const now = PLATFORM.now;\n    const timers = [];\n    let profileMap;\n    const profiler = {\n        createTimer,\n        enable,\n        disable,\n        report,\n        enabled: false\n    };\n    return profiler;\n    function createTimer(name) {\n        timers.push(name);\n        let depth = 0;\n        let mark = 0;\n        return {\n            enter,\n            leave\n        };\n        function enter() {\n            if (++depth === 1) {\n                mark = now();\n                ++profileMap[name].topLevelCount;\n            }\n            ++profileMap[name].totalCount;\n        }\n        function leave() {\n            if (--depth === 0) {\n                profileMap[name].duration += (now() - mark);\n            }\n        }\n    }\n    function enable() {\n        profileMap = {};\n        for (const timer of timers) {\n            profileMap[timer] = {\n                name: timer,\n                duration: 0,\n                topLevelCount: 0,\n                totalCount: 0\n            };\n        }\n        profiler.enabled = true;\n    }\n    function disable() {\n        profiler.enabled = false;\n    }\n    function report(cb) {\n        Object.keys(profileMap).map(key => profileMap[key]).sort((a, b) => b.duration - a.duration).forEach(p => {\n            cb(p.name, p.duration, p.topLevelCount, p.totalCount);\n        });\n    }\n})();\n//# sourceMappingURL=profiler.js.map","import { DI } from './di';\nimport { Reporter } from './reporter';\n/**\n * Represents a handler for an EventAggregator event.\n */\nclass Handler {\n    constructor(\n    /** @internal */\n    messageType, \n    /** @internal */\n    callback) {\n        this.messageType = messageType;\n        this.callback = callback;\n    }\n    handle(message) {\n        if (message instanceof this.messageType) {\n            this.callback.call(null, message);\n        }\n    }\n}\nfunction invokeCallback(callback, data, event) {\n    try {\n        callback(data, event);\n    }\n    catch (e) {\n        Reporter.error(0, e); // TODO: create error code\n    }\n}\nfunction invokeHandler(handler, data) {\n    try {\n        handler.handle(data);\n    }\n    catch (e) {\n        Reporter.error(0, e); // TODO: create error code\n    }\n}\nexport const IEventAggregator = DI.createInterface('IEventAggregator').withDefault(x => x.singleton(EventAggregator));\n/**\n * Enables loosely coupled publish/subscribe messaging.\n */\nexport class EventAggregator {\n    constructor() {\n        /** @internal */\n        this.eventLookup = {};\n        /** @internal */\n        this.messageHandlers = [];\n    }\n    publish(channelOrInstance, data) {\n        let subscribers;\n        let i;\n        if (!channelOrInstance) {\n            throw Reporter.error(0); // TODO: create error code for 'Event was invalid.'\n        }\n        if (typeof channelOrInstance === 'string') {\n            const channel = channelOrInstance;\n            subscribers = this.eventLookup[channel];\n            if (subscribers != null) {\n                subscribers = subscribers.slice();\n                i = subscribers.length;\n                while (i--) {\n                    invokeCallback(subscribers[i], data, channel);\n                }\n            }\n        }\n        else {\n            const instance = channelOrInstance;\n            subscribers = this.messageHandlers.slice();\n            i = subscribers.length;\n            while (i--) {\n                invokeHandler(subscribers[i], instance);\n            }\n        }\n    }\n    subscribe(channelOrType, callback) {\n        let handler;\n        let subscribers;\n        if (!channelOrType) {\n            throw Reporter.error(0); // TODO: create error code for 'Event channel/type was invalid.'\n        }\n        if (typeof channelOrType === 'string') {\n            const channel = channelOrType;\n            handler = callback;\n            if (this.eventLookup[channel] === void 0) {\n                this.eventLookup[channel] = [];\n            }\n            subscribers = this.eventLookup[channel];\n        }\n        else {\n            handler = new Handler(channelOrType, callback);\n            subscribers = this.messageHandlers;\n        }\n        subscribers.push(handler);\n        return {\n            dispose() {\n                const idx = subscribers.indexOf(handler);\n                if (idx !== -1) {\n                    subscribers.splice(idx, 1);\n                }\n            }\n        };\n    }\n    subscribeOnce(channelOrType, callback) {\n        const sub = this.subscribe(channelOrType, (data, event) => {\n            sub.dispose();\n            return callback(data, event);\n        });\n        return sub;\n    }\n}\n//# sourceMappingURL=eventaggregator.js.map","// TODO: see if we can de-duplicate these 3 decorators and their functions without killing performance or readability\nexport function subscriberCollection() {\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    return function (target) {\n        const proto = target.prototype;\n        proto._subscriberFlags = 0 /* None */;\n        proto.addSubscriber = addSubscriber;\n        proto.removeSubscriber = removeSubscriber;\n        proto.hasSubscriber = hasSubscriber;\n        proto.hasSubscribers = hasSubscribers;\n        proto.callSubscribers = callSubscribers;\n        if (proto.subscribe === void 0)\n            proto.subscribe = addSubscriber;\n        if (proto.unsubscribe === void 0)\n            proto.unsubscribe = removeSubscriber;\n    };\n}\nexport function proxySubscriberCollection() {\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    return function (target) {\n        const proto = target.prototype;\n        proto._proxySubscriberFlags = 0 /* None */;\n        proto.addProxySubscriber = addProxySubscriber;\n        proto.removeProxySubscriber = removeProxySubscriber;\n        proto.hasProxySubscriber = hasProxySubscriber;\n        proto.hasProxySubscribers = hasProxySubscribers;\n        proto.callProxySubscribers = callProxySubscribers;\n        if (proto.subscribeToProxy === void 0)\n            proto.subscribeToProxy = addProxySubscriber;\n        if (proto.unsubscribeFromProxy === void 0)\n            proto.unsubscribeFromProxy = removeProxySubscriber;\n    };\n}\nexport function collectionSubscriberCollection() {\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    return function (target) {\n        const proto = target.prototype;\n        proto._collectionSubscriberFlags = 0 /* None */;\n        proto.addCollectionSubscriber = addCollectionSubscriber;\n        proto.removeCollectionSubscriber = removeCollectionSubscriber;\n        proto.hasCollectionSubscriber = hasCollectionSubscriber;\n        proto.hasCollectionSubscribers = hasCollectionSubscribers;\n        proto.callCollectionSubscribers = callCollectionSubscribers;\n        if (proto.subscribeToCollection === void 0)\n            proto.subscribeToCollection = addCollectionSubscriber;\n        if (proto.unsubscribeFromCollection === void 0)\n            proto.unsubscribeFromCollection = removeCollectionSubscriber;\n    };\n}\nfunction addSubscriber(subscriber) {\n    if (this.hasSubscriber(subscriber)) {\n        return false;\n    }\n    const subscriberFlags = this._subscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) === 0) {\n        this._subscriber0 = subscriber;\n        this._subscriberFlags |= 1 /* Subscriber0 */;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) === 0) {\n        this._subscriber1 = subscriber;\n        this._subscriberFlags |= 2 /* Subscriber1 */;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) === 0) {\n        this._subscriber2 = subscriber;\n        this._subscriberFlags |= 4 /* Subscriber2 */;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) === 0) {\n        this._subscribersRest = [subscriber];\n        this._subscriberFlags |= 8 /* SubscribersRest */;\n    }\n    else {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this._subscribersRest.push(subscriber); // Non-null is implied by else branch of (subscriberFlags & SF.SubscribersRest) === 0\n    }\n    return true;\n}\nfunction addProxySubscriber(subscriber) {\n    if (this.hasProxySubscriber(subscriber)) {\n        return false;\n    }\n    const subscriberFlags = this._proxySubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) === 0) {\n        this._proxySubscriber0 = subscriber;\n        this._proxySubscriberFlags |= 1 /* Subscriber0 */;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) === 0) {\n        this._proxySubscriber1 = subscriber;\n        this._proxySubscriberFlags |= 2 /* Subscriber1 */;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) === 0) {\n        this._proxySubscriber2 = subscriber;\n        this._proxySubscriberFlags |= 4 /* Subscriber2 */;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) === 0) {\n        this._proxySubscribersRest = [subscriber];\n        this._proxySubscriberFlags |= 8 /* SubscribersRest */;\n    }\n    else {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this._proxySubscribersRest.push(subscriber); // Non-null is implied by else branch of (subscriberFlags & SF.SubscribersRest) === 0\n    }\n    return true;\n}\nfunction addCollectionSubscriber(subscriber) {\n    if (this.hasCollectionSubscriber(subscriber)) {\n        return false;\n    }\n    const subscriberFlags = this._collectionSubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) === 0) {\n        this._collectionSubscriber0 = subscriber;\n        this._collectionSubscriberFlags |= 1 /* Subscriber0 */;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) === 0) {\n        this._collectionSubscriber1 = subscriber;\n        this._collectionSubscriberFlags |= 2 /* Subscriber1 */;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) === 0) {\n        this._collectionSubscriber2 = subscriber;\n        this._collectionSubscriberFlags |= 4 /* Subscriber2 */;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) === 0) {\n        this._collectionSubscribersRest = [subscriber];\n        this._collectionSubscriberFlags |= 8 /* SubscribersRest */;\n    }\n    else {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this._collectionSubscribersRest.push(subscriber); // Non-null is implied by else branch of (subscriberFlags & SF.SubscribersRest) === 0\n    }\n    return true;\n}\nfunction removeSubscriber(subscriber) {\n    const subscriberFlags = this._subscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._subscriber0 === subscriber) {\n        this._subscriber0 = void 0;\n        this._subscriberFlags = (this._subscriberFlags | 1 /* Subscriber0 */) ^ 1 /* Subscriber0 */;\n        return true;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._subscriber1 === subscriber) {\n        this._subscriber1 = void 0;\n        this._subscriberFlags = (this._subscriberFlags | 2 /* Subscriber1 */) ^ 2 /* Subscriber1 */;\n        return true;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._subscriber2 === subscriber) {\n        this._subscriber2 = void 0;\n        this._subscriberFlags = (this._subscriberFlags | 4 /* Subscriber2 */) ^ 4 /* Subscriber2 */;\n        return true;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._subscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                subscribers.splice(i, 1);\n                if (ii === 1) {\n                    this._subscriberFlags = (this._subscriberFlags | 8 /* SubscribersRest */) ^ 8 /* SubscribersRest */;\n                }\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction removeProxySubscriber(subscriber) {\n    const subscriberFlags = this._proxySubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._proxySubscriber0 === subscriber) {\n        this._proxySubscriber0 = void 0;\n        this._proxySubscriberFlags = (this._proxySubscriberFlags | 1 /* Subscriber0 */) ^ 1 /* Subscriber0 */;\n        return true;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._proxySubscriber1 === subscriber) {\n        this._proxySubscriber1 = void 0;\n        this._proxySubscriberFlags = (this._proxySubscriberFlags | 2 /* Subscriber1 */) ^ 2 /* Subscriber1 */;\n        return true;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._proxySubscriber2 === subscriber) {\n        this._proxySubscriber2 = void 0;\n        this._proxySubscriberFlags = (this._proxySubscriberFlags | 4 /* Subscriber2 */) ^ 4 /* Subscriber2 */;\n        return true;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._proxySubscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                subscribers.splice(i, 1);\n                if (ii === 1) {\n                    this._proxySubscriberFlags = (this._proxySubscriberFlags | 8 /* SubscribersRest */) ^ 8 /* SubscribersRest */;\n                }\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction removeCollectionSubscriber(subscriber) {\n    const subscriberFlags = this._collectionSubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._collectionSubscriber0 === subscriber) {\n        this._collectionSubscriber0 = void 0;\n        this._collectionSubscriberFlags = (this._collectionSubscriberFlags | 1 /* Subscriber0 */) ^ 1 /* Subscriber0 */;\n        return true;\n    }\n    else if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._collectionSubscriber1 === subscriber) {\n        this._collectionSubscriber1 = void 0;\n        this._collectionSubscriberFlags = (this._collectionSubscriberFlags | 2 /* Subscriber1 */) ^ 2 /* Subscriber1 */;\n        return true;\n    }\n    else if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._collectionSubscriber2 === subscriber) {\n        this._collectionSubscriber2 = void 0;\n        this._collectionSubscriberFlags = (this._collectionSubscriberFlags | 4 /* Subscriber2 */) ^ 4 /* Subscriber2 */;\n        return true;\n    }\n    else if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._collectionSubscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                subscribers.splice(i, 1);\n                if (ii === 1) {\n                    this._collectionSubscriberFlags = (this._collectionSubscriberFlags | 8 /* SubscribersRest */) ^ 8 /* SubscribersRest */;\n                }\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction hasSubscribers() {\n    return this._subscriberFlags !== 0 /* None */;\n}\nfunction hasProxySubscribers() {\n    return this._proxySubscriberFlags !== 0 /* None */;\n}\nfunction hasCollectionSubscribers() {\n    return this._collectionSubscriberFlags !== 0 /* None */;\n}\nfunction hasSubscriber(subscriber) {\n    // Flags here is just a perf tweak\n    // Compared to not using flags, it's a moderate speed-up when this collection does not have the subscriber;\n    // and minor slow-down when it does, and the former is more common than the latter.\n    const subscriberFlags = this._subscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._subscriber0 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._subscriber1 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._subscriber2 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._subscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction hasProxySubscriber(subscriber) {\n    const subscriberFlags = this._proxySubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._proxySubscriber0 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._proxySubscriber1 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._proxySubscriber2 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._proxySubscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction hasCollectionSubscriber(subscriber) {\n    const subscriberFlags = this._collectionSubscriberFlags;\n    if ((subscriberFlags & 1 /* Subscriber0 */) > 0 && this._collectionSubscriber0 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 2 /* Subscriber1 */) > 0 && this._collectionSubscriber1 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 4 /* Subscriber2 */) > 0 && this._collectionSubscriber2 === subscriber) {\n        return true;\n    }\n    if ((subscriberFlags & 8 /* SubscribersRest */) > 0) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const subscribers = this._collectionSubscribersRest; // Non-null is implied by (subscriberFlags & SF.SubscribersRest) > 0\n        for (let i = 0, ii = subscribers.length; i < ii; ++i) {\n            if (subscribers[i] === subscriber) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction callSubscribers(newValue, previousValue, flags) {\n    /**\n     * Note: change handlers may have the side-effect of adding/removing subscribers to this collection during this\n     * callSubscribers invocation, so we're caching them all before invoking any.\n     * Subscribers added during this invocation are not invoked (and they shouldn't be).\n     * Subscribers removed during this invocation will still be invoked (and they also shouldn't be,\n     * however this is accounted for via $isBound and similar flags on the subscriber objects)\n     */\n    const subscriber0 = this._subscriber0;\n    const subscriber1 = this._subscriber1;\n    const subscriber2 = this._subscriber2;\n    let subscribers = this._subscribersRest;\n    if (subscribers !== void 0) {\n        subscribers = subscribers.slice();\n    }\n    if (subscriber0 !== void 0) {\n        callSubscriber(subscriber0, newValue, previousValue, flags, subscriber0.id === void 0 ? 0 : this[subscriber0.id]);\n    }\n    if (subscriber1 !== void 0) {\n        callSubscriber(subscriber1, newValue, previousValue, flags, subscriber1.id === void 0 ? 0 : this[subscriber1.id]);\n    }\n    if (subscriber2 !== void 0) {\n        callSubscriber(subscriber2, newValue, previousValue, flags, subscriber2.id === void 0 ? 0 : this[subscriber2.id]);\n    }\n    if (subscribers !== void 0) {\n        const { length } = subscribers;\n        let subscriber;\n        for (let i = 0; i < length; ++i) {\n            subscriber = subscribers[i];\n            if (subscriber !== void 0) {\n                callSubscriber(subscriber, newValue, previousValue, flags, subscriber.id === void 0 ? 0 : this[subscriber.id]);\n            }\n        }\n    }\n}\nfunction callSubscriber(subscriber, newValue, previousValue, flags, ownFlags) {\n    subscriber.handleChange(newValue, previousValue, ((flags | 48 /* update */) ^ 48 /* update */) | ownFlags);\n}\nfunction callProxySubscribers(key, newValue, previousValue, flags) {\n    const subscriber0 = this._proxySubscriber0;\n    const subscriber1 = this._proxySubscriber1;\n    const subscriber2 = this._proxySubscriber2;\n    let subscribers = this._proxySubscribersRest;\n    if (subscribers !== void 0) {\n        subscribers = subscribers.slice();\n    }\n    if (subscriber0 !== void 0) {\n        subscriber0.handleProxyChange(key, newValue, previousValue, flags);\n    }\n    if (subscriber1 !== void 0) {\n        subscriber1.handleProxyChange(key, newValue, previousValue, flags);\n    }\n    if (subscriber2 !== void 0) {\n        subscriber2.handleProxyChange(key, newValue, previousValue, flags);\n    }\n    if (subscribers !== void 0) {\n        const { length } = subscribers;\n        let subscriber;\n        for (let i = 0; i < length; ++i) {\n            subscriber = subscribers[i];\n            if (subscriber !== void 0) {\n                subscriber.handleProxyChange(key, newValue, previousValue, flags);\n            }\n        }\n    }\n}\nfunction callCollectionSubscribers(indexMap, flags) {\n    const subscriber0 = this._collectionSubscriber0;\n    const subscriber1 = this._collectionSubscriber1;\n    const subscriber2 = this._collectionSubscriber2;\n    let subscribers = this._collectionSubscribersRest;\n    if (subscribers !== void 0) {\n        subscribers = subscribers.slice();\n    }\n    if (subscriber0 !== void 0) {\n        subscriber0.handleCollectionChange(indexMap, flags);\n    }\n    if (subscriber1 !== void 0) {\n        subscriber1.handleCollectionChange(indexMap, flags);\n    }\n    if (subscriber2 !== void 0) {\n        subscriber2.handleCollectionChange(indexMap, flags);\n    }\n    if (subscribers !== void 0) {\n        const { length } = subscribers;\n        let subscriber;\n        for (let i = 0; i < length; ++i) {\n            subscriber = subscribers[i];\n            if (subscriber !== void 0) {\n                subscriber.handleCollectionChange(indexMap, flags);\n            }\n        }\n    }\n}\n//# sourceMappingURL=subscriber-collection.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar ProxyObserver_1;\nimport { PLATFORM } from '@aurelia/kernel';\nimport { proxySubscriberCollection, subscriberCollection } from './subscriber-collection';\nconst lookup = new WeakMap();\nlet ProxySubscriberCollection = class ProxySubscriberCollection {\n    constructor(proxy, raw, key) {\n        this.proxy = proxy;\n        this.raw = raw;\n        this.key = key;\n        this.inBatch = false;\n        this.subscribe = this.addSubscriber;\n        this.unsubscribe = this.removeSubscriber;\n        if (raw[key] instanceof Object) { // Ensure we observe array indices and newly created object properties\n            raw[key] = ProxyObserver.getOrCreate(raw[key]).proxy;\n        }\n    }\n    setValue(value, flags) {\n        const oldValue = this.raw[this.key];\n        if (oldValue !== value) {\n            this.raw[this.key] = value;\n            this.callSubscribers(value, oldValue, flags | 2 /* proxyStrategy */ | 16 /* updateTargetInstance */);\n        }\n    }\n    getValue() {\n        return this.raw[this.key];\n    }\n    flushBatch(flags) {\n        return;\n    }\n};\nProxySubscriberCollection = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Object, Object])\n], ProxySubscriberCollection);\nexport { ProxySubscriberCollection };\nlet ProxyObserver = ProxyObserver_1 = class ProxyObserver {\n    constructor(obj) {\n        this.raw = obj;\n        this.proxy = new Proxy(obj, this);\n        lookup.set(obj, this.proxy);\n        this.subscribers = {};\n    }\n    static getProxyOrSelf(obj) {\n        if (obj.$raw === void 0) {\n            const proxy = lookup.get(obj);\n            if (proxy === void 0) {\n                return obj;\n            }\n            return proxy;\n        }\n        return obj;\n    }\n    static getRawIfProxy(obj) {\n        const raw = obj.$raw;\n        if (raw === void 0) {\n            return obj;\n        }\n        return raw;\n    }\n    static getOrCreate(obj, key) {\n        let proxyObserver;\n        if (obj.$raw === void 0) {\n            const proxy = lookup.get(obj);\n            if (proxy === void 0) {\n                proxyObserver = new ProxyObserver_1(obj);\n            }\n            else {\n                proxyObserver = proxy.$observer;\n            }\n        }\n        else {\n            proxyObserver = obj.$observer;\n        }\n        if (key === void 0) {\n            return proxyObserver;\n        }\n        let subscribers = proxyObserver.subscribers[key];\n        if (subscribers === void 0) {\n            const raw = this.getRawIfProxy(obj);\n            const proxy = proxyObserver.proxy;\n            subscribers = proxyObserver.subscribers[key] = new ProxySubscriberCollection(proxy, raw, key);\n        }\n        return subscribers;\n    }\n    static isProxy(obj) {\n        return obj.$raw !== void 0;\n    }\n    get(target, p, receiver) {\n        if (p === '$observer') {\n            return this;\n        }\n        if (p === '$raw') {\n            return target;\n        }\n        return target[p];\n    }\n    set(target, p, value, receiver) {\n        const oldValue = target[p];\n        if (oldValue !== value) {\n            target[p] = value;\n            this.callPropertySubscribers(value, oldValue, p);\n            this.callProxySubscribers(p, value, oldValue, 2 /* proxyStrategy */ | 16 /* updateTargetInstance */);\n        }\n        return true;\n    }\n    deleteProperty(target, p) {\n        const oldValue = target[p];\n        if (Reflect.deleteProperty(target, p)) {\n            if (oldValue !== void 0) {\n                this.callPropertySubscribers(undefined, oldValue, p);\n                this.callProxySubscribers(p, undefined, oldValue, 2 /* proxyStrategy */ | 16 /* updateTargetInstance */);\n            }\n            return true;\n        }\n        return false;\n    }\n    defineProperty(target, p, attributes) {\n        const oldValue = target[p];\n        if (Reflect.defineProperty(target, p, attributes)) {\n            if (attributes.value !== oldValue) {\n                this.callPropertySubscribers(attributes.value, oldValue, p);\n                this.callProxySubscribers(p, attributes.value, oldValue, 2 /* proxyStrategy */ | 16 /* updateTargetInstance */);\n            }\n            return true;\n        }\n        return false;\n    }\n    apply(target, thisArg, argArray = PLATFORM.emptyArray) {\n        // eslint-disable-next-line @typescript-eslint/ban-types\n        return Reflect.apply(target, target, argArray); // Reflect API dictates this\n    }\n    subscribe(subscriber, key) {\n        if (key === void 0) {\n            this.addProxySubscriber(subscriber);\n        }\n        else {\n            let subscribers = this.subscribers[key];\n            if (subscribers === void 0) {\n                subscribers = this.subscribers[key] = new ProxySubscriberCollection(this.proxy, this.raw, key);\n            }\n            subscribers.addSubscriber(subscriber);\n        }\n    }\n    unsubscribe(subscriber, key) {\n        if (key === void 0) {\n            this.removeProxySubscriber(subscriber);\n        }\n        else {\n            const subscribers = this.subscribers[key];\n            if (subscribers !== undefined) {\n                subscribers.removeSubscriber(subscriber);\n            }\n        }\n    }\n    callPropertySubscribers(newValue, oldValue, key) {\n        const subscribers = this.subscribers[key];\n        if (subscribers !== void 0) {\n            subscribers.callSubscribers(newValue, oldValue, 2 /* proxyStrategy */ | 16 /* updateTargetInstance */);\n        }\n    }\n};\nProxyObserver = ProxyObserver_1 = __decorate([\n    proxySubscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object])\n], ProxyObserver);\nexport { ProxyObserver };\n//# sourceMappingURL=proxy-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DI, Registration, } from '@aurelia/kernel';\nexport var ViewModelKind;\n(function (ViewModelKind) {\n    ViewModelKind[ViewModelKind[\"customElement\"] = 0] = \"customElement\";\n    ViewModelKind[ViewModelKind[\"customAttribute\"] = 1] = \"customAttribute\";\n    ViewModelKind[ViewModelKind[\"synthetic\"] = 2] = \"synthetic\";\n})(ViewModelKind || (ViewModelKind = {}));\nexport const IController = DI.createInterface('IController').noDefault();\n/**\n * Describing characteristics of a mounting operation a controller will perform\n */\nexport var MountStrategy;\n(function (MountStrategy) {\n    MountStrategy[MountStrategy[\"insertBefore\"] = 1] = \"insertBefore\";\n    MountStrategy[MountStrategy[\"append\"] = 2] = \"append\";\n})(MountStrategy || (MountStrategy = {}));\nexport const IViewFactory = DI.createInterface('IViewFactory').noDefault();\nexport const ILifecycle = DI.createInterface('ILifecycle').withDefault(x => x.singleton(Lifecycle));\nlet BoundQueue = class BoundQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.depth = 0;\n        this.head = void 0;\n        this.tail = void 0;\n    }\n    begin() {\n        ++this.depth;\n    }\n    end(flags) {\n        if (flags === void 0) {\n            flags = 0 /* none */;\n        }\n        if (--this.depth === 0) {\n            this.process(flags);\n        }\n    }\n    inline(fn, flags) {\n        this.begin();\n        fn();\n        this.end(flags);\n    }\n    add(controller) {\n        if (this.head === void 0) {\n            this.head = controller;\n        }\n        else {\n            controller.prevBound = this.tail;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.tail.nextBound = controller; // implied by boundHead not being undefined\n        }\n        this.tail = controller;\n    }\n    remove(controller) {\n        if (controller.prevBound !== void 0) {\n            controller.prevBound.nextBound = controller.nextBound;\n        }\n        if (controller.nextBound !== void 0) {\n            controller.nextBound.prevBound = controller.prevBound;\n        }\n        controller.prevBound = void 0;\n        controller.nextBound = void 0;\n        if (this.tail === controller) {\n            this.tail = controller.prevBound;\n        }\n        if (this.head === controller) {\n            this.head = controller.nextBound;\n        }\n    }\n    process(flags) {\n        while (this.head !== void 0) {\n            let cur = this.head;\n            this.head = this.tail = void 0;\n            let next;\n            do {\n                cur.afterBind(flags);\n                next = cur.nextBound;\n                cur.nextBound = void 0;\n                cur.prevBound = void 0;\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                cur = next; // we're checking it for undefined the next line\n            } while (cur !== void 0);\n        }\n    }\n};\nBoundQueue = __decorate([\n    __param(0, ILifecycle),\n    __metadata(\"design:paramtypes\", [Object])\n], BoundQueue);\nexport { BoundQueue };\nlet UnboundQueue = class UnboundQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.depth = 0;\n        this.head = void 0;\n        this.tail = void 0;\n    }\n    begin() {\n        ++this.depth;\n    }\n    end(flags) {\n        if (flags === void 0) {\n            flags = 0 /* none */;\n        }\n        if (--this.depth === 0) {\n            this.process(flags);\n        }\n    }\n    inline(fn, flags) {\n        this.begin();\n        fn();\n        this.end(flags);\n    }\n    add(controller) {\n        if (this.head === void 0) {\n            this.head = controller;\n        }\n        else {\n            controller.prevUnbound = this.tail;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.tail.nextUnbound = controller; // implied by unboundHead not being undefined\n        }\n        this.tail = controller;\n    }\n    remove(controller) {\n        if (controller.prevUnbound !== void 0) {\n            controller.prevUnbound.nextUnbound = controller.nextUnbound;\n        }\n        if (controller.nextUnbound !== void 0) {\n            controller.nextUnbound.prevUnbound = controller.prevUnbound;\n        }\n        controller.prevUnbound = void 0;\n        controller.nextUnbound = void 0;\n        if (this.tail === controller) {\n            this.tail = controller.prevUnbound;\n        }\n        if (this.head === controller) {\n            this.head = controller.nextUnbound;\n        }\n    }\n    process(flags) {\n        while (this.head !== void 0) {\n            let cur = this.head;\n            this.head = this.tail = void 0;\n            let next;\n            do {\n                cur.afterUnbind(flags);\n                next = cur.nextUnbound;\n                cur.nextUnbound = void 0;\n                cur.prevUnbound = void 0;\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                cur = next; // we're checking it for undefined the next line\n            } while (cur !== void 0);\n        }\n    }\n};\nUnboundQueue = __decorate([\n    __param(0, ILifecycle),\n    __metadata(\"design:paramtypes\", [Object])\n], UnboundQueue);\nexport { UnboundQueue };\nlet AttachedQueue = class AttachedQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.depth = 0;\n        this.head = void 0;\n        this.tail = void 0;\n    }\n    begin() {\n        ++this.depth;\n    }\n    end(flags) {\n        if (flags === void 0) {\n            flags = 0 /* none */;\n        }\n        if (--this.depth === 0) {\n            // temporary, until everything else works and we're ready for integrating mount/unmount in the RAF queue\n            this.lifecycle.mount.process(flags);\n            this.process(flags);\n        }\n    }\n    inline(fn, flags) {\n        this.begin();\n        fn();\n        this.end(flags);\n    }\n    add(controller) {\n        if (this.head === void 0) {\n            this.head = controller;\n        }\n        else {\n            controller.prevAttached = this.tail;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.tail.nextAttached = controller; // implied by attachedHead not being undefined\n        }\n        this.tail = controller;\n    }\n    remove(controller) {\n        if (controller.prevAttached !== void 0) {\n            controller.prevAttached.nextAttached = controller.nextAttached;\n        }\n        if (controller.nextAttached !== void 0) {\n            controller.nextAttached.prevAttached = controller.prevAttached;\n        }\n        controller.prevAttached = void 0;\n        controller.nextAttached = void 0;\n        if (this.tail === controller) {\n            this.tail = controller.prevAttached;\n        }\n        if (this.head === controller) {\n            this.head = controller.nextAttached;\n        }\n    }\n    process(flags) {\n        while (this.head !== void 0) {\n            let cur = this.head;\n            this.head = this.tail = void 0;\n            let next;\n            do {\n                cur.afterAttach(flags);\n                next = cur.nextAttached;\n                cur.nextAttached = void 0;\n                cur.prevAttached = void 0;\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                cur = next; // we're checking it for undefined the next line\n            } while (cur !== void 0);\n        }\n    }\n};\nAttachedQueue = __decorate([\n    __param(0, ILifecycle),\n    __metadata(\"design:paramtypes\", [Object])\n], AttachedQueue);\nexport { AttachedQueue };\nlet DetachedQueue = class DetachedQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.depth = 0;\n        this.head = void 0;\n        this.tail = void 0;\n    }\n    begin() {\n        ++this.depth;\n    }\n    end(flags) {\n        if (flags === void 0) {\n            flags = 0 /* none */;\n        }\n        if (--this.depth === 0) {\n            // temporary, until everything else works and we're ready for integrating mount/unmount in the RAF queue\n            this.lifecycle.unmount.process(flags);\n            this.process(flags);\n        }\n    }\n    inline(fn, flags) {\n        this.begin();\n        fn();\n        this.end(flags);\n    }\n    add(controller) {\n        if (this.head === void 0) {\n            this.head = controller;\n        }\n        else {\n            controller.prevDetached = this.tail;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.tail.nextDetached = controller; // implied by detachedHead not being undefined\n        }\n        this.tail = controller;\n    }\n    remove(controller) {\n        if (controller.prevDetached !== void 0) {\n            controller.prevDetached.nextDetached = controller.nextDetached;\n        }\n        if (controller.nextDetached !== void 0) {\n            controller.nextDetached.prevDetached = controller.prevDetached;\n        }\n        controller.prevDetached = void 0;\n        controller.nextDetached = void 0;\n        if (this.tail === controller) {\n            this.tail = controller.prevDetached;\n        }\n        if (this.head === controller) {\n            this.head = controller.nextDetached;\n        }\n    }\n    process(flags) {\n        while (this.head !== void 0) {\n            let cur = this.head;\n            this.head = this.tail = void 0;\n            let next;\n            do {\n                cur.afterDetach(flags);\n                next = cur.nextDetached;\n                cur.nextDetached = void 0;\n                cur.prevDetached = void 0;\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                cur = next; // we're checking it for undefined the next line\n            } while (cur !== void 0);\n        }\n    }\n};\nDetachedQueue = __decorate([\n    __param(0, ILifecycle),\n    __metadata(\"design:paramtypes\", [Object])\n], DetachedQueue);\nexport { DetachedQueue };\nlet MountQueue = class MountQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.depth = 0;\n        this.head = void 0;\n        this.tail = void 0;\n    }\n    add(controller) {\n        if (this.head === void 0) {\n            this.head = controller;\n        }\n        else {\n            controller.prevMount = this.tail;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.tail.nextMount = controller; // implied by mountHead not being undefined\n        }\n        this.tail = controller;\n    }\n    remove(controller) {\n        if (controller.prevMount !== void 0) {\n            controller.prevMount.nextMount = controller.nextMount;\n        }\n        if (controller.nextMount !== void 0) {\n            controller.nextMount.prevMount = controller.prevMount;\n        }\n        controller.prevMount = void 0;\n        controller.nextMount = void 0;\n        if (this.tail === controller) {\n            this.tail = controller.prevMount;\n        }\n        if (this.head === controller) {\n            this.head = controller.nextMount;\n        }\n    }\n    process(flags) {\n        let i = 0;\n        while (this.head !== void 0) {\n            let cur = this.head;\n            this.head = this.tail = void 0;\n            let next;\n            do {\n                ++i;\n                cur.mount(flags);\n                next = cur.nextMount;\n                cur.nextMount = void 0;\n                cur.prevMount = void 0;\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                cur = next; // we're checking it for undefined the next line\n            } while (cur !== void 0);\n        }\n    }\n};\nMountQueue = __decorate([\n    __param(0, ILifecycle),\n    __metadata(\"design:paramtypes\", [Object])\n], MountQueue);\nexport { MountQueue };\nlet UnmountQueue = class UnmountQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.head = void 0;\n        this.tail = void 0;\n    }\n    add(controller) {\n        if (this.head === void 0) {\n            this.head = controller;\n        }\n        else {\n            controller.prevUnmount = this.tail;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.tail.nextUnmount = controller; // implied by unmountHead not being undefined\n        }\n        this.tail = controller;\n    }\n    remove(controller) {\n        if (controller.prevUnmount !== void 0) {\n            controller.prevUnmount.nextUnmount = controller.nextUnmount;\n        }\n        if (controller.nextUnmount !== void 0) {\n            controller.nextUnmount.prevUnmount = controller.prevUnmount;\n        }\n        controller.prevUnmount = void 0;\n        controller.nextUnmount = void 0;\n        if (this.tail === controller) {\n            this.tail = controller.prevUnmount;\n        }\n        if (this.head === controller) {\n            this.head = controller.nextUnmount;\n        }\n    }\n    process(flags) {\n        let i = 0;\n        while (this.head !== void 0) {\n            let cur = this.head;\n            this.head = this.tail = void 0;\n            let next;\n            do {\n                ++i;\n                cur.unmount(flags);\n                next = cur.nextUnmount;\n                cur.nextUnmount = void 0;\n                cur.prevUnmount = void 0;\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                cur = next; // we're checking it for undefined the next line\n            } while (cur !== void 0);\n        }\n    }\n};\nUnmountQueue = __decorate([\n    __param(0, ILifecycle),\n    __metadata(\"design:paramtypes\", [Object])\n], UnmountQueue);\nexport { UnmountQueue };\nlet BatchQueue = class BatchQueue {\n    constructor(lifecycle) {\n        this.lifecycle = lifecycle;\n        this.queue = [];\n        this.depth = 0;\n    }\n    begin() {\n        ++this.depth;\n    }\n    end(flags) {\n        if (flags === void 0) {\n            flags = 0 /* none */;\n        }\n        if (--this.depth === 0) {\n            this.process(flags);\n        }\n    }\n    inline(fn, flags) {\n        this.begin();\n        fn();\n        this.end(flags);\n    }\n    add(requestor) {\n        this.queue.push(requestor);\n    }\n    remove(requestor) {\n        const index = this.queue.indexOf(requestor);\n        if (index > -1) {\n            this.queue.splice(index, 1);\n        }\n    }\n    process(flags) {\n        flags |= 512 /* fromBatch */;\n        while (this.queue.length > 0) {\n            const batch = this.queue.slice();\n            this.queue = [];\n            const { length } = batch;\n            for (let i = 0; i < length; ++i) {\n                batch[i].flushBatch(flags);\n            }\n        }\n    }\n};\nBatchQueue = __decorate([\n    __param(0, ILifecycle),\n    __metadata(\"design:paramtypes\", [Object])\n], BatchQueue);\nexport { BatchQueue };\nexport class Lifecycle {\n    constructor() {\n        this.batch = new BatchQueue(this);\n        this.mount = new MountQueue(this);\n        this.unmount = new UnmountQueue(this);\n        this.afterBind = new BoundQueue(this);\n        this.afterUnbind = new UnboundQueue(this);\n        this.afterAttach = new AttachedQueue(this);\n        this.afterDetach = new DetachedQueue(this);\n    }\n    static register(container) {\n        return Registration.singleton(ILifecycle, this).register(container);\n    }\n}\n//# sourceMappingURL=lifecycle.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { Reporter } from '@aurelia/kernel';\nimport { ILifecycle } from '../lifecycle';\nimport { subscriberCollection } from './subscriber-collection';\n/**\n * Observer for the mutation of object property value employing getter-setter strategy.\n * This is used for observing object properties that has no decorator.\n */\nlet SetterObserver = class SetterObserver {\n    constructor(lifecycle, flags, obj, propertyKey) {\n        this.lifecycle = lifecycle;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.inBatch = false;\n        this.observing = false;\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        if (this.observing) {\n            const currentValue = this.currentValue;\n            this.currentValue = newValue;\n            if (this.lifecycle.batch.depth === 0) {\n                this.callSubscribers(newValue, currentValue, this.persistentFlags | flags);\n            }\n            else if (!this.inBatch) {\n                this.inBatch = true;\n                this.oldValue = currentValue;\n                this.lifecycle.batch.add(this);\n            }\n        }\n        else {\n            // If subscribe() has been called, the target property descriptor is replaced by these getter/setter methods,\n            // so calling obj[propertyKey] will actually return this.currentValue.\n            // However, if subscribe() was not yet called (indicated by !this.observing), the target descriptor\n            // is unmodified and we need to explicitly set the property value.\n            // This will happen in one-time, to-view and two-way bindings during $bind, meaning that the $bind will not actually update the target value.\n            // This wasn't visible in vCurrent due to connect-queue always doing a delayed update, so in many cases it didn't matter whether $bind updated the target or not.\n            this.obj[this.propertyKey] = newValue;\n        }\n    }\n    flushBatch(flags) {\n        this.inBatch = false;\n        const currentValue = this.currentValue;\n        const oldValue = this.oldValue;\n        this.oldValue = currentValue;\n        this.callSubscribers(currentValue, oldValue, this.persistentFlags | flags);\n    }\n    subscribe(subscriber) {\n        if (this.observing === false) {\n            this.observing = true;\n            this.currentValue = this.obj[this.propertyKey];\n            if (!Reflect.defineProperty(this.obj, this.propertyKey, {\n                enumerable: true,\n                configurable: true,\n                get: () => {\n                    return this.getValue();\n                },\n                set: value => {\n                    this.setValue(value, 0 /* none */);\n                },\n            })) {\n                Reporter.write(1, this.propertyKey, this.obj);\n            }\n        }\n        this.addSubscriber(subscriber);\n    }\n};\nSetterObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Number, Object, String])\n], SetterObserver);\nexport { SetterObserver };\n//# sourceMappingURL=setter-observer.js.map","import { PLATFORM, Reporter } from '@aurelia/kernel';\nimport { ProxyObserver } from './proxy-observer';\nimport { SetterObserver } from './setter-observer';\nvar RuntimeError;\n(function (RuntimeError) {\n    RuntimeError[RuntimeError[\"NilScope\"] = 250] = \"NilScope\";\n    RuntimeError[RuntimeError[\"NilOverrideContext\"] = 252] = \"NilOverrideContext\";\n    RuntimeError[RuntimeError[\"NilParentScope\"] = 253] = \"NilParentScope\";\n})(RuntimeError || (RuntimeError = {}));\nconst marker = Object.freeze({});\n/** @internal */\nexport class InternalObserversLookup {\n    getOrCreate(lifecycle, flags, obj, key) {\n        if (this[key] === void 0) {\n            this[key] = new SetterObserver(lifecycle, flags, obj, key);\n        }\n        return this[key];\n    }\n}\nexport class BindingContext {\n    constructor(keyOrObj, value) {\n        this.$synthetic = true;\n        if (keyOrObj !== void 0) {\n            if (value !== void 0) {\n                // if value is defined then it's just a property and a value to initialize with\n                this[keyOrObj] = value;\n            }\n            else {\n                // can either be some random object or another bindingContext to clone from\n                for (const prop in keyOrObj) {\n                    if (Object.prototype.hasOwnProperty.call(keyOrObj, prop)) {\n                        this[prop] = keyOrObj[prop];\n                    }\n                }\n            }\n        }\n    }\n    static create(flags, keyOrObj, value) {\n        const bc = new BindingContext(keyOrObj, value);\n        if (flags & 2 /* proxyStrategy */) {\n            return ProxyObserver.getOrCreate(bc).proxy;\n        }\n        return bc;\n    }\n    static get(scope, name, ancestor, flags, part) {\n        if (scope == null) {\n            throw Reporter.error(250 /* NilScope */);\n        }\n        let overrideContext = scope.overrideContext;\n        if (ancestor > 0) {\n            // jump up the required number of ancestor contexts (eg $parent.$parent requires two jumps)\n            while (ancestor > 0) {\n                if (overrideContext.parentOverrideContext == null) {\n                    return void 0;\n                }\n                ancestor--;\n                overrideContext = overrideContext.parentOverrideContext;\n            }\n            return name in overrideContext ? overrideContext : overrideContext.bindingContext;\n        }\n        // traverse the context and it's ancestors, searching for a context that has the name.\n        while (overrideContext && !(name in overrideContext) && !(overrideContext.bindingContext && name in overrideContext.bindingContext)) {\n            overrideContext = overrideContext.parentOverrideContext;\n        }\n        if (overrideContext) {\n            // we located a context with the property.  return it.\n            return name in overrideContext ? overrideContext : overrideContext.bindingContext;\n        }\n        // the name wasn't found. see if parent scope traversal is allowed and if so, try that\n        if ((flags & 67108864 /* allowParentScopeTraversal */) > 0) {\n            let parent = scope.parentScope;\n            while (parent !== null) {\n                if (parent.scopeParts.includes(part)) {\n                    const result = this.get(parent, name, ancestor, flags\n                        // unset the flag; only allow one level of scope boundary traversal\n                        & ~67108864 /* allowParentScopeTraversal */\n                        // tell the scope to return null if the name could not be found\n                        | 4194304 /* isTraversingParentScope */);\n                    if (result === marker) {\n                        return scope.bindingContext || scope.overrideContext;\n                    }\n                    else {\n                        return result;\n                    }\n                }\n                else {\n                    parent = parent.parentScope;\n                }\n            }\n            if (parent === null) {\n                throw new Error(`No target scope could be found for part \"${part}\"`);\n            }\n        }\n        // still nothing found. return the root binding context (or null\n        // if this is a parent scope traversal, to ensure we fall back to the\n        // correct level)\n        if (flags & 4194304 /* isTraversingParentScope */) {\n            return marker;\n        }\n        return scope.bindingContext || scope.overrideContext;\n    }\n    getObservers(flags) {\n        if (this.$observers == null) {\n            this.$observers = new InternalObserversLookup();\n        }\n        return this.$observers;\n    }\n}\nexport class Scope {\n    constructor(parentScope, bindingContext, overrideContext) {\n        this.parentScope = parentScope;\n        this.scopeParts = PLATFORM.emptyArray;\n        this.bindingContext = bindingContext;\n        this.overrideContext = overrideContext;\n    }\n    static create(flags, bc, oc) {\n        return new Scope(null, bc, oc == null ? OverrideContext.create(flags, bc, oc) : oc);\n    }\n    static fromOverride(flags, oc) {\n        if (oc == null) {\n            throw Reporter.error(252 /* NilOverrideContext */);\n        }\n        return new Scope(null, oc.bindingContext, oc);\n    }\n    static fromParent(flags, ps, bc) {\n        if (ps == null) {\n            throw Reporter.error(253 /* NilParentScope */);\n        }\n        return new Scope(ps, bc, OverrideContext.create(flags, bc, ps.overrideContext));\n    }\n}\nexport class OverrideContext {\n    constructor(bindingContext, parentOverrideContext) {\n        this.$synthetic = true;\n        this.bindingContext = bindingContext;\n        this.parentOverrideContext = parentOverrideContext;\n    }\n    static create(flags, bc, poc) {\n        return new OverrideContext(bc, poc === void 0 ? null : poc);\n    }\n    getObservers() {\n        if (this.$observers === void 0) {\n            this.$observers = new InternalObserversLookup();\n        }\n        return this.$observers;\n    }\n}\n//# sourceMappingURL=binding-context.js.map","import { DI } from '@aurelia/kernel';\nexport const ISignaler = DI.createInterface('ISignaler').withDefault(x => x.singleton(Signaler));\n/** @internal */\nexport class Signaler {\n    constructor() {\n        this.signals = Object.create(null);\n    }\n    dispatchSignal(name, flags) {\n        const listeners = this.signals[name];\n        if (listeners === undefined) {\n            return;\n        }\n        for (const listener of listeners.keys()) {\n            listener.handleChange(undefined, undefined, flags | 16 /* updateTargetInstance */);\n        }\n    }\n    addSignalListener(name, listener) {\n        const signals = this.signals;\n        const listeners = signals[name];\n        if (listeners === undefined) {\n            signals[name] = new Set([listener]);\n        }\n        else {\n            listeners.add(listener);\n        }\n    }\n    removeSignalListener(name, listener) {\n        const listeners = this.signals[name];\n        if (listeners) {\n            listeners.delete(listener);\n        }\n    }\n}\n//# sourceMappingURL=signaler.js.map","import { DI, Registration, Metadata, Protocol, } from '@aurelia/kernel';\n/**\n * TargetedInstructionType enum values become the property names for the associated renderers when they are injected\n * into the `Renderer`.\n *\n * Additional instruction types can be added as long as they are 2 characters long and do not clash with existing ones.\n *\n * By convention, the instruction types for a particular runtime start with the same first letter, and the second letter\n * starts counting from letter `a`. The standard runtime instruction types all start with the letter `r`.\n */\nexport var TargetedInstructionType;\n(function (TargetedInstructionType) {\n    TargetedInstructionType[\"hydrateElement\"] = \"ra\";\n    TargetedInstructionType[\"hydrateAttribute\"] = \"rb\";\n    TargetedInstructionType[\"hydrateTemplateController\"] = \"rc\";\n    TargetedInstructionType[\"hydrateLetElement\"] = \"rd\";\n    TargetedInstructionType[\"setProperty\"] = \"re\";\n    TargetedInstructionType[\"interpolation\"] = \"rf\";\n    TargetedInstructionType[\"propertyBinding\"] = \"rg\";\n    TargetedInstructionType[\"callBinding\"] = \"rh\";\n    TargetedInstructionType[\"letBinding\"] = \"ri\";\n    TargetedInstructionType[\"refBinding\"] = \"rj\";\n    TargetedInstructionType[\"iteratorBinding\"] = \"rk\";\n})(TargetedInstructionType || (TargetedInstructionType = {}));\nconst parentPartsOwnPartsLookup = new WeakMap();\n/**\n * Efficiently merge parts, performing the minimal amount of work / using the minimal amount of memory.\n *\n * If either of the two part records is undefined, the other will simply be returned.\n *\n * If both are undefined, undefined will be returned.\n *\n * If neither are undefined, a new object will be returned where parts of the second value will be written last (and thus may overwrite duplicate named parts).\n *\n * This function is idempotent via a WeakMap cache: results are cached and if the same two variables are provided again, the same object will be returned.\n */\nexport function mergeParts(parentParts, ownParts) {\n    if (parentParts === ownParts) {\n        return parentParts;\n    }\n    if (parentParts === void 0) {\n        return ownParts;\n    }\n    if (ownParts === void 0) {\n        return parentParts;\n    }\n    let ownPartsLookup = parentPartsOwnPartsLookup.get(parentParts);\n    if (ownPartsLookup === void 0) {\n        parentPartsOwnPartsLookup.set(parentParts, ownPartsLookup = new WeakMap());\n    }\n    let mergedParts = ownPartsLookup.get(ownParts);\n    if (mergedParts === void 0) {\n        ownPartsLookup.set(ownParts, mergedParts = {\n            ...parentParts,\n            ...ownParts,\n        });\n    }\n    return mergedParts;\n}\nexport const ITargetedInstruction = DI.createInterface('ITargetedInstruction').noDefault();\nexport function isTargetedInstruction(value) {\n    const type = value.type;\n    return typeof type === 'string' && type.length === 2;\n}\nexport class HooksDefinition {\n    constructor(target) {\n        this.hasCreate = 'create' in target;\n        this.hasBeforeCompile = 'beforeCompile' in target;\n        this.hasAfterCompile = 'afterCompile' in target;\n        this.hasAfterCompileChildren = 'afterCompileChildren' in target;\n        this.hasBeforeBind = 'beforeBind' in target;\n        this.hasAfterBind = 'afterBind' in target;\n        this.hasBeforeUnbind = 'beforeUnbind' in target;\n        this.hasAfterUnbind = 'afterUnbind' in target;\n        this.hasBeforeAttach = 'beforeAttach' in target;\n        this.hasAfterAttach = 'afterAttach' in target;\n        this.hasBeforeDetach = 'beforeDetach' in target;\n        this.hasAfterDetach = 'afterDetach' in target;\n        this.hasCaching = 'caching' in target;\n    }\n}\nHooksDefinition.none = new HooksDefinition({});\nexport function alias(...aliases) {\n    return function (target) {\n        const key = Protocol.annotation.keyFor('aliases');\n        const existing = Metadata.getOwn(key, target);\n        if (existing === void 0) {\n            Metadata.define(key, aliases, target);\n        }\n        else {\n            existing.push(...aliases);\n        }\n    };\n}\nexport function registerAliases(aliases, resource, key, container) {\n    for (let i = 0, ii = aliases.length; i < ii; ++i) {\n        Registration.aliasTo(key, resource.keyFrom(aliases[i])).register(container);\n    }\n}\n//# sourceMappingURL=definitions.js.map","// TODO: add connect-queue (or something similar) back in when everything else is working, to improve startup time\nconst slice = Array.prototype.slice;\nconst slotNames = [];\nconst versionSlotNames = [];\nlet lastSlot = -1;\nfunction ensureEnoughSlotNames(currentSlot) {\n    if (currentSlot === lastSlot) {\n        lastSlot += 5;\n        const ii = slotNames.length = versionSlotNames.length = lastSlot + 1;\n        for (let i = currentSlot + 1; i < ii; ++i) {\n            slotNames[i] = `_observer${i}`;\n            versionSlotNames[i] = `_observerVersion${i}`;\n        }\n    }\n}\nensureEnoughSlotNames(-1);\n/** @internal */\nexport function addObserver(observer) {\n    // find the observer.\n    const observerSlots = this.observerSlots == null ? 0 : this.observerSlots;\n    let i = observerSlots;\n    while (i-- && this[slotNames[i]] !== observer)\n        ;\n    // if we are not already observing, put the observer in an open slot and subscribe.\n    if (i === -1) {\n        i = 0;\n        while (this[slotNames[i]]) {\n            i++;\n        }\n        this[slotNames[i]] = observer;\n        observer.subscribe(this);\n        observer[this.id] |= 16 /* updateTargetInstance */;\n        // increment the slot count.\n        if (i === observerSlots) {\n            this.observerSlots = i + 1;\n        }\n    }\n    // set the \"version\" when the observer was used.\n    if (this.version == null) {\n        this.version = 0;\n    }\n    this[versionSlotNames[i]] = this.version;\n    ensureEnoughSlotNames(i);\n}\n/** @internal */\nexport function observeProperty(flags, obj, propertyName) {\n    const observer = this.observerLocator.getObserver(flags, obj, propertyName);\n    /* Note: we need to cast here because we can indeed get an accessor instead of an observer,\n     *  in which case the call to observer.subscribe will throw. It's not very clean and we can solve this in 2 ways:\n     *  1. Fail earlier: only let the locator resolve observers from .getObserver, and throw if no branches are left (e.g. it would otherwise return an accessor)\n     *  2. Fail silently (without throwing): give all accessors a no-op subscribe method\n     *\n     * We'll probably want to implement some global configuration (like a \"strict\" toggle) so users can pick between enforced correctness vs. ease-of-use\n     */\n    this.addObserver(observer);\n}\n/** @internal */\nexport function unobserve(all) {\n    const slots = this.observerSlots;\n    let slotName;\n    let observer;\n    if (all === true) {\n        for (let i = 0; i < slots; ++i) {\n            slotName = slotNames[i];\n            observer = this[slotName];\n            if (observer != null) {\n                this[slotName] = void 0;\n                observer.unsubscribe(this);\n                observer[this.id] &= ~16 /* updateTargetInstance */;\n            }\n        }\n    }\n    else {\n        const version = this.version;\n        for (let i = 0; i < slots; ++i) {\n            if (this[versionSlotNames[i]] !== version) {\n                slotName = slotNames[i];\n                observer = this[slotName];\n                if (observer != null) {\n                    this[slotName] = void 0;\n                    observer.unsubscribe(this);\n                    observer[this.id] &= ~16 /* updateTargetInstance */;\n                }\n            }\n        }\n    }\n}\nfunction connectableDecorator(target) {\n    const proto = target.prototype;\n    if (!Object.prototype.hasOwnProperty.call(proto, 'observeProperty'))\n        proto.observeProperty = observeProperty;\n    if (!Object.prototype.hasOwnProperty.call(proto, 'unobserve'))\n        proto.unobserve = unobserve;\n    if (!Object.prototype.hasOwnProperty.call(proto, 'addObserver'))\n        proto.addObserver = addObserver;\n    return target;\n}\nexport function connectable(target) {\n    return target == null ? connectableDecorator : connectableDecorator(target);\n}\nlet value = 0;\nconnectable.assignIdTo = (instance) => {\n    instance.id = ++value;\n};\n// @connectable\nexport class BindingMediator {\n    constructor(key, binding, observerLocator, locator) {\n        this.key = key;\n        this.binding = binding;\n        this.observerLocator = observerLocator;\n        this.locator = locator;\n        this.observeProperty = observeProperty;\n        this.unobserve = unobserve;\n        this.addObserver = addObserver;\n        connectable.assignIdTo(this);\n    }\n    $bind(flags, scope, part) {\n        throw new Error('Method not implemented.');\n    }\n    $unbind(flags) {\n        throw new Error('Method not implemented.');\n    }\n    handleChange(newValue, previousValue, flags) {\n        this.binding[this.key](newValue, previousValue, flags);\n    }\n}\n//# sourceMappingURL=connectable.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { Registration, Metadata, Protocol, mergeArrays, firstDefined, DI, fromAnnotationOrDefinitionOrTypeOrDefault, } from '@aurelia/kernel';\nimport { registerAliases } from '../definitions';\nimport { connectable } from '../binding/connectable';\nexport var BindingBehaviorStrategy;\n(function (BindingBehaviorStrategy) {\n    BindingBehaviorStrategy[BindingBehaviorStrategy[\"singleton\"] = 1] = \"singleton\";\n    BindingBehaviorStrategy[BindingBehaviorStrategy[\"interceptor\"] = 2] = \"interceptor\";\n})(BindingBehaviorStrategy || (BindingBehaviorStrategy = {}));\nexport function bindingBehavior(nameOrDef) {\n    return function (target) {\n        return BindingBehavior.define(nameOrDef, target);\n    };\n}\nexport class BindingBehaviorDefinition {\n    constructor(Type, name, aliases, key, strategy) {\n        this.Type = Type;\n        this.name = name;\n        this.aliases = aliases;\n        this.key = key;\n        this.strategy = strategy;\n    }\n    static create(nameOrDef, Type) {\n        let name;\n        let def;\n        if (typeof nameOrDef === 'string') {\n            name = nameOrDef;\n            def = { name };\n        }\n        else {\n            name = nameOrDef.name;\n            def = nameOrDef;\n        }\n        const inheritsFromInterceptor = Object.getPrototypeOf(Type) === BindingInterceptor;\n        return new BindingBehaviorDefinition(Type, firstDefined(BindingBehavior.getAnnotation(Type, 'name'), name), mergeArrays(BindingBehavior.getAnnotation(Type, 'aliases'), def.aliases, Type.aliases), BindingBehavior.keyFrom(name), fromAnnotationOrDefinitionOrTypeOrDefault('strategy', def, Type, () => inheritsFromInterceptor ? 2 /* interceptor */ : 1 /* singleton */));\n    }\n    register(container) {\n        const { Type, key, aliases, strategy } = this;\n        switch (strategy) {\n            case 1 /* singleton */:\n                Registration.singleton(key, Type).register(container);\n                break;\n            case 2 /* interceptor */:\n                Registration.instance(key, new BindingBehaviorFactory(container, Type)).register(container);\n                break;\n        }\n        Registration.aliasTo(key, Type).register(container);\n        registerAliases(aliases, BindingBehavior, key, container);\n    }\n}\nexport class BindingBehaviorFactory {\n    constructor(container, Type) {\n        this.container = container;\n        this.Type = Type;\n        this.deps = DI.getDependencies(Type);\n    }\n    construct(binding, expr) {\n        const container = this.container;\n        const deps = this.deps;\n        switch (deps.length) {\n            case 0:\n            case 1:\n            case 2:\n                return new this.Type(binding, expr);\n            case 3:\n                return new this.Type(container.get(deps[0]), binding, expr);\n            case 4:\n                return new this.Type(container.get(deps[0]), container.get(deps[1]), binding, expr);\n            default:\n                return new this.Type(...deps.map(d => container.get(d)), binding, expr);\n        }\n    }\n}\nlet BindingInterceptor = class BindingInterceptor {\n    constructor(binding, expr) {\n        this.binding = binding;\n        this.expr = expr;\n        this.interceptor = this;\n        let interceptor;\n        while (binding.interceptor !== this) {\n            interceptor = binding.interceptor;\n            binding.interceptor = this;\n            binding = interceptor;\n        }\n    }\n    get id() {\n        return this.binding.id;\n    }\n    get observerLocator() {\n        return this.binding.observerLocator;\n    }\n    get locator() {\n        return this.binding.locator;\n    }\n    get $scope() {\n        return this.binding.$scope;\n    }\n    get part() {\n        return this.binding.part;\n    }\n    get $state() {\n        return this.binding.$state;\n    }\n    updateTarget(value, flags) {\n        this.binding.updateTarget(value, flags);\n    }\n    updateSource(value, flags) {\n        this.binding.updateSource(value, flags);\n    }\n    callSource(args) {\n        return this.binding.callSource(args);\n    }\n    handleChange(newValue, previousValue, flags) {\n        this.binding.handleChange(newValue, previousValue, flags);\n    }\n    $bind(flags, scope, part) {\n        this.binding.$bind(flags, scope, part);\n    }\n    $unbind(flags) {\n        this.binding.$unbind(flags);\n    }\n};\nBindingInterceptor = __decorate([\n    connectable,\n    __metadata(\"design:paramtypes\", [Object, Object])\n], BindingInterceptor);\nexport { BindingInterceptor };\nexport const BindingBehavior = {\n    name: Protocol.resource.keyFor('binding-behavior'),\n    keyFrom(name) {\n        return `${BindingBehavior.name}:${name}`;\n    },\n    isType(value) {\n        return typeof value === 'function' && Metadata.hasOwn(BindingBehavior.name, value);\n    },\n    define(nameOrDef, Type) {\n        const definition = BindingBehaviorDefinition.create(nameOrDef, Type);\n        Metadata.define(BindingBehavior.name, definition, definition.Type);\n        Metadata.define(BindingBehavior.name, definition, definition);\n        Protocol.resource.appendTo(Type, BindingBehavior.name);\n        return definition.Type;\n    },\n    getDefinition(Type) {\n        const def = Metadata.getOwn(BindingBehavior.name, Type);\n        if (def === void 0) {\n            throw new Error(`No definition found for type ${Type.name}`);\n        }\n        return def;\n    },\n    annotate(Type, prop, value) {\n        Metadata.define(Protocol.annotation.keyFor(prop), value, Type);\n    },\n    getAnnotation(Type, prop) {\n        return Metadata.getOwn(Protocol.annotation.keyFor(prop), Type);\n    },\n};\n//# sourceMappingURL=binding-behavior.js.map","import { Registration, Metadata, Protocol, mergeArrays, firstDefined, } from '@aurelia/kernel';\nimport { registerAliases } from '../definitions';\nexport function valueConverter(nameOrDef) {\n    return function (target) {\n        return ValueConverter.define(nameOrDef, target);\n    };\n}\nexport class ValueConverterDefinition {\n    constructor(Type, name, aliases, key) {\n        this.Type = Type;\n        this.name = name;\n        this.aliases = aliases;\n        this.key = key;\n    }\n    static create(nameOrDef, Type) {\n        let name;\n        let def;\n        if (typeof nameOrDef === 'string') {\n            name = nameOrDef;\n            def = { name };\n        }\n        else {\n            name = nameOrDef.name;\n            def = nameOrDef;\n        }\n        return new ValueConverterDefinition(Type, firstDefined(ValueConverter.getAnnotation(Type, 'name'), name), mergeArrays(ValueConverter.getAnnotation(Type, 'aliases'), def.aliases, Type.aliases), ValueConverter.keyFrom(name));\n    }\n    register(container) {\n        const { Type, key, aliases } = this;\n        Registration.singleton(key, Type).register(container);\n        Registration.aliasTo(key, Type).register(container);\n        registerAliases(aliases, ValueConverter, key, container);\n    }\n}\nexport const ValueConverter = {\n    name: Protocol.resource.keyFor('value-converter'),\n    keyFrom(name) {\n        return `${ValueConverter.name}:${name}`;\n    },\n    isType(value) {\n        return typeof value === 'function' && Metadata.hasOwn(ValueConverter.name, value);\n    },\n    define(nameOrDef, Type) {\n        const definition = ValueConverterDefinition.create(nameOrDef, Type);\n        Metadata.define(ValueConverter.name, definition, definition.Type);\n        Metadata.define(ValueConverter.name, definition, definition);\n        Protocol.resource.appendTo(Type, ValueConverter.name);\n        return definition.Type;\n    },\n    getDefinition(Type) {\n        const def = Metadata.getOwn(ValueConverter.name, Type);\n        if (def === void 0) {\n            throw new Error(`No definition found for type ${Type.name}`);\n        }\n        return def;\n    },\n    annotate(Type, prop, value) {\n        Metadata.define(Protocol.annotation.keyFor(prop), value, Type);\n    },\n    getAnnotation(Type, prop) {\n        return Metadata.getOwn(Protocol.annotation.keyFor(prop), Type);\n    },\n};\n//# sourceMappingURL=value-converter.js.map","import { PLATFORM, Reporter, isNumberOrBigInt, isStringOrDate, } from '@aurelia/kernel';\nimport { BindingContext } from '../observation/binding-context';\nimport { ProxyObserver } from '../observation/proxy-observer';\nimport { ISignaler } from '../observation/signaler';\nimport { BindingBehavior, BindingBehaviorFactory, } from '../resources/binding-behavior';\nimport { ValueConverter, } from '../resources/value-converter';\nexport function connects(expr) {\n    return (expr.$kind & 32 /* Connects */) === 32 /* Connects */;\n}\nexport function observes(expr) {\n    return (expr.$kind & 64 /* Observes */) === 64 /* Observes */;\n}\nexport function callsFunction(expr) {\n    return (expr.$kind & 128 /* CallsFunction */) === 128 /* CallsFunction */;\n}\nexport function hasAncestor(expr) {\n    return (expr.$kind & 256 /* HasAncestor */) === 256 /* HasAncestor */;\n}\nexport function isAssignable(expr) {\n    return (expr.$kind & 8192 /* IsAssignable */) === 8192 /* IsAssignable */;\n}\nexport function isLeftHandSide(expr) {\n    return (expr.$kind & 1024 /* IsLeftHandSide */) === 1024 /* IsLeftHandSide */;\n}\nexport function isPrimary(expr) {\n    return (expr.$kind & 512 /* IsPrimary */) === 512 /* IsPrimary */;\n}\nexport function isResource(expr) {\n    return (expr.$kind & 32768 /* IsResource */) === 32768 /* IsResource */;\n}\nexport function hasBind(expr) {\n    return (expr.$kind & 2048 /* HasBind */) === 2048 /* HasBind */;\n}\nexport function hasUnbind(expr) {\n    return (expr.$kind & 4096 /* HasUnbind */) === 4096 /* HasUnbind */;\n}\nexport function isLiteral(expr) {\n    return (expr.$kind & 16384 /* IsLiteral */) === 16384 /* IsLiteral */;\n}\nexport function arePureLiterals(expressions) {\n    if (expressions === void 0 || expressions.length === 0) {\n        return true;\n    }\n    for (let i = 0; i < expressions.length; ++i) {\n        if (!isPureLiteral(expressions[i])) {\n            return false;\n        }\n    }\n    return true;\n}\nexport function isPureLiteral(expr) {\n    if (isLiteral(expr)) {\n        switch (expr.$kind) {\n            case 17955 /* ArrayLiteral */:\n                return arePureLiterals(expr.elements);\n            case 17956 /* ObjectLiteral */:\n                return arePureLiterals(expr.values);\n            case 17958 /* Template */:\n                return arePureLiterals(expr.expressions);\n            case 17925 /* PrimitiveLiteral */:\n                return true;\n        }\n    }\n    return false;\n}\nvar RuntimeError;\n(function (RuntimeError) {\n    RuntimeError[RuntimeError[\"NoLocator\"] = 202] = \"NoLocator\";\n    RuntimeError[RuntimeError[\"NoBehaviorFound\"] = 203] = \"NoBehaviorFound\";\n    RuntimeError[RuntimeError[\"BehaviorAlreadyApplied\"] = 204] = \"BehaviorAlreadyApplied\";\n    RuntimeError[RuntimeError[\"NoConverterFound\"] = 205] = \"NoConverterFound\";\n    RuntimeError[RuntimeError[\"NoBinding\"] = 206] = \"NoBinding\";\n    RuntimeError[RuntimeError[\"NotAFunction\"] = 207] = \"NotAFunction\";\n    RuntimeError[RuntimeError[\"UnknownOperator\"] = 208] = \"UnknownOperator\";\n    RuntimeError[RuntimeError[\"NilScope\"] = 250] = \"NilScope\";\n})(RuntimeError || (RuntimeError = {}));\nexport class CustomExpression {\n    constructor(value) {\n        this.value = value;\n    }\n    evaluate(flags, scope, locator, part) {\n        return this.value;\n    }\n}\nexport class BindingBehaviorExpression {\n    constructor(expression, name, args) {\n        this.expression = expression;\n        this.name = name;\n        this.args = args;\n        this.$kind = 38962 /* BindingBehavior */;\n        this.behaviorKey = BindingBehavior.keyFrom(name);\n    }\n    evaluate(flags, scope, locator, part) {\n        return this.expression.evaluate(flags, scope, locator, part);\n    }\n    assign(flags, scope, locator, value, part) {\n        return this.expression.assign(flags, scope, locator, value, part);\n    }\n    connect(flags, scope, binding, part) {\n        this.expression.connect(flags, scope, binding, part);\n    }\n    bind(flags, scope, binding) {\n        if (scope == null) {\n            throw Reporter.error(250 /* NilScope */, this);\n        }\n        if (!binding) {\n            throw Reporter.error(206 /* NoBinding */, this);\n        }\n        const locator = binding.locator;\n        if (!locator) {\n            throw Reporter.error(202 /* NoLocator */, this);\n        }\n        if (hasBind(this.expression)) {\n            this.expression.bind(flags, scope, binding);\n        }\n        const behaviorKey = this.behaviorKey;\n        const behavior = locator.get(behaviorKey);\n        if (!behavior) {\n            throw Reporter.error(203 /* NoBehaviorFound */, this);\n        }\n        if (!(behavior instanceof BindingBehaviorFactory)) {\n            if (binding[behaviorKey] === void 0) {\n                binding[behaviorKey] = behavior;\n                behavior.bind.call(behavior, flags, scope, binding, ...evalList(flags, scope, locator, this.args));\n            }\n            else {\n                Reporter.write(204 /* BehaviorAlreadyApplied */, this);\n            }\n        }\n    }\n    unbind(flags, scope, binding) {\n        const behaviorKey = this.behaviorKey;\n        if (binding[behaviorKey] !== void 0) {\n            binding[behaviorKey].unbind(flags, scope, binding);\n            binding[behaviorKey] = void 0;\n        }\n        if (hasUnbind(this.expression)) {\n            this.expression.unbind(flags, scope, binding);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitBindingBehavior(this);\n    }\n}\nexport class ValueConverterExpression {\n    constructor(expression, name, args) {\n        this.expression = expression;\n        this.name = name;\n        this.args = args;\n        this.$kind = 36913 /* ValueConverter */;\n        this.converterKey = ValueConverter.keyFrom(name);\n    }\n    evaluate(flags, scope, locator, part) {\n        if (!locator) {\n            throw Reporter.error(202 /* NoLocator */, this);\n        }\n        const converter = locator.get(this.converterKey);\n        if (!converter) {\n            throw Reporter.error(205 /* NoConverterFound */, this);\n        }\n        if ('toView' in converter) {\n            const args = this.args;\n            const len = args.length;\n            const result = Array(len + 1);\n            result[0] = this.expression.evaluate(flags, scope, locator, part);\n            for (let i = 0; i < len; ++i) {\n                result[i + 1] = args[i].evaluate(flags, scope, locator, part);\n            }\n            return converter.toView.call(converter, ...result);\n        }\n        return this.expression.evaluate(flags, scope, locator, part);\n    }\n    assign(flags, scope, locator, value, part) {\n        if (!locator) {\n            throw Reporter.error(202 /* NoLocator */, this);\n        }\n        const converter = locator.get(this.converterKey);\n        if (!converter) {\n            throw Reporter.error(205 /* NoConverterFound */, this);\n        }\n        if ('fromView' in converter) {\n            value = converter.fromView.call(converter, value, ...(evalList(flags, scope, locator, this.args)));\n        }\n        return this.expression.assign(flags, scope, locator, value, part);\n    }\n    connect(flags, scope, binding, part) {\n        if (scope == null) {\n            throw Reporter.error(250 /* NilScope */, this);\n        }\n        if (!binding) {\n            throw Reporter.error(206 /* NoBinding */, this);\n        }\n        const locator = binding.locator;\n        if (!locator) {\n            throw Reporter.error(202 /* NoLocator */, this);\n        }\n        this.expression.connect(flags, scope, binding, part);\n        const args = this.args;\n        for (let i = 0, ii = args.length; i < ii; ++i) {\n            args[i].connect(flags, scope, binding, part);\n        }\n        const converter = locator.get(this.converterKey);\n        if (!converter) {\n            throw Reporter.error(205 /* NoConverterFound */, this);\n        }\n        const signals = converter.signals;\n        if (signals === void 0) {\n            return;\n        }\n        const signaler = locator.get(ISignaler);\n        for (let i = 0, ii = signals.length; i < ii; ++i) {\n            signaler.addSignalListener(signals[i], binding);\n        }\n    }\n    unbind(flags, scope, binding) {\n        const locator = binding.locator;\n        const converter = locator.get(this.converterKey);\n        const signals = converter.signals;\n        if (signals === void 0) {\n            return;\n        }\n        const signaler = locator.get(ISignaler);\n        for (let i = 0, ii = signals.length; i < ii; ++i) {\n            signaler.removeSignalListener(signals[i], binding);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitValueConverter(this);\n    }\n}\nexport class AssignExpression {\n    constructor(target, value) {\n        this.target = target;\n        this.value = value;\n        this.$kind = 8208 /* Assign */;\n    }\n    evaluate(flags, scope, locator, part) {\n        return this.target.assign(flags, scope, locator, this.value.evaluate(flags, scope, locator), part);\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    assign(flags, scope, locator, value, part) {\n        this.value.assign(flags, scope, locator, value, part);\n        return this.target.assign(flags, scope, locator, value, part);\n    }\n    accept(visitor) {\n        return visitor.visitAssign(this);\n    }\n}\nexport class ConditionalExpression {\n    constructor(condition, yes, no) {\n        this.condition = condition;\n        this.yes = yes;\n        this.no = no;\n        this.$kind = 63 /* Conditional */;\n    }\n    evaluate(flags, scope, locator, part) {\n        return (!!this.condition.evaluate(flags, scope, locator, part))\n            ? this.yes.evaluate(flags, scope, locator, part)\n            : this.no.evaluate(flags, scope, locator, part);\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const condition = this.condition;\n        if (condition.evaluate(flags, scope, null, part)) {\n            this.condition.connect(flags, scope, binding, part);\n            this.yes.connect(flags, scope, binding, part);\n        }\n        else {\n            this.condition.connect(flags, scope, binding, part);\n            this.no.connect(flags, scope, binding, part);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitConditional(this);\n    }\n}\nexport class AccessThisExpression {\n    constructor(ancestor = 0) {\n        this.ancestor = ancestor;\n        this.$kind = 1793 /* AccessThis */;\n    }\n    evaluate(flags, scope, locator, part) {\n        if (scope == null) {\n            throw Reporter.error(250 /* NilScope */, this);\n        }\n        if ((flags & 67108864 /* allowParentScopeTraversal */) > 0) {\n            let parent = scope.parentScope;\n            while (parent !== null) {\n                if (!parent.scopeParts.includes(part)) {\n                    parent = parent.parentScope;\n                }\n            }\n            if (parent === null) {\n                throw new Error(`No target scope cold be found for part \"${part}\"`);\n            }\n        }\n        let oc = scope.overrideContext;\n        let i = this.ancestor;\n        while (i-- && oc) {\n            oc = oc.parentOverrideContext;\n        }\n        return i < 1 && oc ? oc.bindingContext : void 0;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitAccessThis(this);\n    }\n}\nAccessThisExpression.$this = new AccessThisExpression(0);\nAccessThisExpression.$parent = new AccessThisExpression(1);\nexport class AccessScopeExpression {\n    constructor(name, ancestor = 0) {\n        this.name = name;\n        this.ancestor = ancestor;\n        this.$kind = 10082 /* AccessScope */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const obj = BindingContext.get(scope, this.name, this.ancestor, flags, part);\n        const evaluatedValue = obj[this.name];\n        if (flags & 4 /* isStrictBindingStrategy */) {\n            return evaluatedValue;\n        }\n        return evaluatedValue == null ? '' : evaluatedValue;\n    }\n    assign(flags, scope, locator, value, part) {\n        const obj = BindingContext.get(scope, this.name, this.ancestor, flags, part);\n        if (obj instanceof Object) {\n            if (obj.$observers !== void 0 && obj.$observers[this.name] !== void 0) {\n                obj.$observers[this.name].setValue(value, flags);\n                return value;\n            }\n            else {\n                return obj[this.name] = value;\n            }\n        }\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const context = BindingContext.get(scope, this.name, this.ancestor, flags, part);\n        binding.observeProperty(flags, context, this.name);\n    }\n    accept(visitor) {\n        return visitor.visitAccessScope(this);\n    }\n}\nexport class AccessMemberExpression {\n    constructor(object, name) {\n        this.object = object;\n        this.name = name;\n        this.$kind = 9323 /* AccessMember */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const instance = this.object.evaluate(flags, scope, locator, part);\n        if (flags & 4 /* isStrictBindingStrategy */) {\n            return instance == null ? instance : instance[this.name];\n        }\n        return instance ? instance[this.name] : '';\n    }\n    assign(flags, scope, locator, value, part) {\n        const obj = this.object.evaluate(flags, scope, locator, part);\n        if (obj instanceof Object) {\n            if (obj.$observers !== void 0 && obj.$observers[this.name] !== void 0) {\n                obj.$observers[this.name].setValue(value, flags);\n            }\n            else {\n                obj[this.name] = value;\n            }\n        }\n        else {\n            this.object.assign(flags, scope, locator, { [this.name]: value });\n        }\n        return value;\n    }\n    connect(flags, scope, binding, part) {\n        const obj = this.object.evaluate(flags, scope, null, part);\n        if ((flags & 134217728 /* observeLeafPropertiesOnly */) === 0) {\n            this.object.connect(flags, scope, binding, part);\n        }\n        if (obj instanceof Object) {\n            binding.observeProperty(flags, obj, this.name);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitAccessMember(this);\n    }\n}\nexport class AccessKeyedExpression {\n    constructor(object, key) {\n        this.object = object;\n        this.key = key;\n        this.$kind = 9324 /* AccessKeyed */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const instance = this.object.evaluate(flags, scope, locator, part);\n        if (instance instanceof Object) {\n            const key = this.key.evaluate(flags, scope, locator, part);\n            return instance[key];\n        }\n        return void 0;\n    }\n    assign(flags, scope, locator, value, part) {\n        const instance = this.object.evaluate(flags, scope, locator, part);\n        const key = this.key.evaluate(flags, scope, locator, part);\n        return instance[key] = value;\n    }\n    connect(flags, scope, binding, part) {\n        const obj = this.object.evaluate(flags, scope, null, part);\n        if ((flags & 134217728 /* observeLeafPropertiesOnly */) === 0) {\n            this.object.connect(flags, scope, binding, part);\n        }\n        if (obj instanceof Object) {\n            this.key.connect(flags, scope, binding, part);\n            const key = this.key.evaluate(flags, scope, null, part);\n            // (note: string indexers behave the same way as numeric indexers as long as they represent numbers)\n            binding.observeProperty(flags, obj, key);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitAccessKeyed(this);\n    }\n}\nexport class CallScopeExpression {\n    constructor(name, args, ancestor = 0) {\n        this.name = name;\n        this.args = args;\n        this.ancestor = ancestor;\n        this.$kind = 1448 /* CallScope */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const args = evalList(flags, scope, locator, this.args, part);\n        const context = BindingContext.get(scope, this.name, this.ancestor, flags, part);\n        const func = getFunction(flags, context, this.name);\n        if (func) {\n            return func.apply(context, args);\n        }\n        return void 0;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const args = this.args;\n        for (let i = 0, ii = args.length; i < ii; ++i) {\n            args[i].connect(flags, scope, binding, part);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitCallScope(this);\n    }\n}\nexport class CallMemberExpression {\n    constructor(object, name, args) {\n        this.object = object;\n        this.name = name;\n        this.args = args;\n        this.$kind = 1161 /* CallMember */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const instance = this.object.evaluate(flags, scope, locator, part);\n        const args = evalList(flags, scope, locator, this.args, part);\n        const func = getFunction(flags, instance, this.name);\n        if (func) {\n            return func.apply(instance, args);\n        }\n        return void 0;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const obj = this.object.evaluate(flags, scope, null, part);\n        if ((flags & 134217728 /* observeLeafPropertiesOnly */) === 0) {\n            this.object.connect(flags, scope, binding, part);\n        }\n        if (getFunction(flags & ~2097152 /* mustEvaluate */, obj, this.name)) {\n            const args = this.args;\n            for (let i = 0, ii = args.length; i < ii; ++i) {\n                args[i].connect(flags, scope, binding, part);\n            }\n        }\n    }\n    accept(visitor) {\n        return visitor.visitCallMember(this);\n    }\n}\nexport class CallFunctionExpression {\n    constructor(func, args) {\n        this.func = func;\n        this.args = args;\n        this.$kind = 1162 /* CallFunction */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const func = this.func.evaluate(flags, scope, locator, part);\n        if (typeof func === 'function') {\n            return func(...evalList(flags, scope, locator, this.args, part));\n        }\n        if (!(flags & 2097152 /* mustEvaluate */) && (func == null)) {\n            return void 0;\n        }\n        throw Reporter.error(207 /* NotAFunction */, this);\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const func = this.func.evaluate(flags, scope, null, part);\n        this.func.connect(flags, scope, binding, part);\n        if (typeof func === 'function') {\n            const args = this.args;\n            for (let i = 0, ii = args.length; i < ii; ++i) {\n                args[i].connect(flags, scope, binding, part);\n            }\n        }\n    }\n    accept(visitor) {\n        return visitor.visitCallFunction(this);\n    }\n}\nexport class BinaryExpression {\n    constructor(operation, left, right) {\n        this.operation = operation;\n        this.left = left;\n        this.right = right;\n        this.$kind = 46 /* Binary */;\n        // what we're doing here is effectively moving the large switch statement from evaluate to the constructor\n        // so that the check only needs to be done once, and evaluate (which is called many times) will have a lot less\n        // work to do; we can do this because the operation can't change after it's parsed\n        this.evaluate = this[operation];\n    }\n    evaluate(flags, scope, locator, part) {\n        throw Reporter.error(208 /* UnknownOperator */, this);\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        this.left.connect(flags, scope, binding, part);\n        this.right.connect(flags, scope, binding, part);\n    }\n    ['&&'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) && this.right.evaluate(f, s, l, p);\n    }\n    ['||'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) || this.right.evaluate(f, s, l, p);\n    }\n    ['=='](f, s, l, p) {\n        // eslint-disable-next-line eqeqeq\n        return this.left.evaluate(f, s, l, p) == this.right.evaluate(f, s, l, p);\n    }\n    ['==='](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) === this.right.evaluate(f, s, l, p);\n    }\n    ['!='](f, s, l, p) {\n        // eslint-disable-next-line eqeqeq\n        return this.left.evaluate(f, s, l, p) != this.right.evaluate(f, s, l, p);\n    }\n    ['!=='](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) !== this.right.evaluate(f, s, l, p);\n    }\n    ['instanceof'](f, s, l, p) {\n        const right = this.right.evaluate(f, s, l, p);\n        if (typeof right === 'function') {\n            return this.left.evaluate(f, s, l, p) instanceof right;\n        }\n        return false;\n    }\n    ['in'](f, s, l, p) {\n        const right = this.right.evaluate(f, s, l, p);\n        if (right instanceof Object) {\n            return this.left.evaluate(f, s, l, p) in right;\n        }\n        return false;\n    }\n    // note: autoConvertAdd (and the null check) is removed because the default spec behavior is already largely similar\n    // and where it isn't, you kind of want it to behave like the spec anyway (e.g. return NaN when adding a number to undefined)\n    // this makes bugs in user code easier to track down for end users\n    // also, skipping these checks and leaving it to the runtime is a nice little perf boost and simplifies our code\n    ['+'](f, s, l, p) {\n        const left = this.left.evaluate(f, s, l, p);\n        const right = this.right.evaluate(f, s, l, p);\n        if ((f & 4 /* isStrictBindingStrategy */) > 0) {\n            return left + right;\n        }\n        // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n        if (!left || !right) {\n            if (isNumberOrBigInt(left) || isNumberOrBigInt(right)) {\n                // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions, @typescript-eslint/no-unnecessary-condition\n                return (left || 0) + (right || 0);\n            }\n            if (isStringOrDate(left) || isStringOrDate(right)) {\n                // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions, @typescript-eslint/no-unnecessary-condition\n                return (left || '') + (right || '');\n            }\n        }\n        return left + right;\n    }\n    ['-'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) - this.right.evaluate(f, s, l, p);\n    }\n    ['*'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) * this.right.evaluate(f, s, l, p);\n    }\n    ['/'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) / this.right.evaluate(f, s, l, p);\n    }\n    ['%'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) % this.right.evaluate(f, s, l, p);\n    }\n    ['<'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) < this.right.evaluate(f, s, l, p);\n    }\n    ['>'](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) > this.right.evaluate(f, s, l, p);\n    }\n    ['<='](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) <= this.right.evaluate(f, s, l, p);\n    }\n    ['>='](f, s, l, p) {\n        return this.left.evaluate(f, s, l, p) >= this.right.evaluate(f, s, l, p);\n    }\n    accept(visitor) {\n        return visitor.visitBinary(this);\n    }\n}\nexport class UnaryExpression {\n    constructor(operation, expression) {\n        this.operation = operation;\n        this.expression = expression;\n        this.$kind = 39 /* Unary */;\n        // see Binary (we're doing the same thing here)\n        this.evaluate = this[operation];\n    }\n    evaluate(flags, scope, locator, part) {\n        throw Reporter.error(208 /* UnknownOperator */, this);\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        this.expression.connect(flags, scope, binding, part);\n    }\n    ['void'](f, s, l, p) {\n        return void this.expression.evaluate(f, s, l, p);\n    }\n    ['typeof'](f, s, l, p) {\n        return typeof this.expression.evaluate(f | 4 /* isStrictBindingStrategy */, s, l, p);\n    }\n    ['!'](f, s, l, p) {\n        return !this.expression.evaluate(f, s, l, p);\n    }\n    ['-'](f, s, l, p) {\n        return -this.expression.evaluate(f, s, l, p);\n    }\n    ['+'](f, s, l, p) {\n        return +this.expression.evaluate(f, s, l, p);\n    }\n    accept(visitor) {\n        return visitor.visitUnary(this);\n    }\n}\nexport class PrimitiveLiteralExpression {\n    constructor(value) {\n        this.value = value;\n        this.$kind = 17925 /* PrimitiveLiteral */;\n    }\n    evaluate(flags, scope, locator, part) {\n        return this.value;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitPrimitiveLiteral(this);\n    }\n}\nPrimitiveLiteralExpression.$undefined = new PrimitiveLiteralExpression(void 0);\nPrimitiveLiteralExpression.$null = new PrimitiveLiteralExpression(null);\nPrimitiveLiteralExpression.$true = new PrimitiveLiteralExpression(true);\nPrimitiveLiteralExpression.$false = new PrimitiveLiteralExpression(false);\nPrimitiveLiteralExpression.$empty = new PrimitiveLiteralExpression('');\nexport class HtmlLiteralExpression {\n    constructor(parts) {\n        this.parts = parts;\n        this.$kind = 51 /* HtmlLiteral */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const elements = this.parts;\n        let result = '';\n        let value;\n        for (let i = 0, ii = elements.length; i < ii; ++i) {\n            value = elements[i].evaluate(flags, scope, locator, part);\n            if (value == null) {\n                continue;\n            }\n            result += value;\n        }\n        return result;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        for (let i = 0, ii = this.parts.length; i < ii; ++i) {\n            this.parts[i].connect(flags, scope, binding, part);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitHtmlLiteral(this);\n    }\n}\nexport class ArrayLiteralExpression {\n    constructor(elements) {\n        this.elements = elements;\n        this.$kind = 17955 /* ArrayLiteral */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const elements = this.elements;\n        const length = elements.length;\n        const result = Array(length);\n        for (let i = 0; i < length; ++i) {\n            result[i] = elements[i].evaluate(flags, scope, locator, part);\n        }\n        return result;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const elements = this.elements;\n        for (let i = 0, ii = elements.length; i < ii; ++i) {\n            elements[i].connect(flags, scope, binding, part);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitArrayLiteral(this);\n    }\n}\nArrayLiteralExpression.$empty = new ArrayLiteralExpression(PLATFORM.emptyArray);\nexport class ObjectLiteralExpression {\n    constructor(keys, values) {\n        this.keys = keys;\n        this.values = values;\n        this.$kind = 17956 /* ObjectLiteral */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const instance = {};\n        const keys = this.keys;\n        const values = this.values;\n        for (let i = 0, ii = keys.length; i < ii; ++i) {\n            instance[keys[i]] = values[i].evaluate(flags, scope, locator, part);\n        }\n        return instance;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const keys = this.keys;\n        const values = this.values;\n        for (let i = 0, ii = keys.length; i < ii; ++i) {\n            values[i].connect(flags, scope, binding, part);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitObjectLiteral(this);\n    }\n}\nObjectLiteralExpression.$empty = new ObjectLiteralExpression(PLATFORM.emptyArray, PLATFORM.emptyArray);\nexport class TemplateExpression {\n    constructor(cooked, expressions = PLATFORM.emptyArray) {\n        this.cooked = cooked;\n        this.expressions = expressions;\n        this.$kind = 17958 /* Template */;\n    }\n    evaluate(flags, scope, locator, part) {\n        const expressions = this.expressions;\n        const cooked = this.cooked;\n        let result = cooked[0];\n        for (let i = 0, ii = expressions.length; i < ii; ++i) {\n            result += expressions[i].evaluate(flags, scope, locator, part);\n            result += cooked[i + 1];\n        }\n        return result;\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const expressions = this.expressions;\n        for (let i = 0, ii = expressions.length; i < ii; ++i) {\n            expressions[i].connect(flags, scope, binding, part);\n            i++;\n        }\n    }\n    accept(visitor) {\n        return visitor.visitTemplate(this);\n    }\n}\nTemplateExpression.$empty = new TemplateExpression(['']);\nexport class TaggedTemplateExpression {\n    constructor(cooked, raw, func, expressions = PLATFORM.emptyArray) {\n        this.cooked = cooked;\n        this.func = func;\n        this.expressions = expressions;\n        this.$kind = 1197 /* TaggedTemplate */;\n        cooked.raw = raw;\n    }\n    evaluate(flags, scope, locator, part) {\n        const expressions = this.expressions;\n        const len = expressions.length;\n        const results = Array(len);\n        for (let i = 0, ii = len; i < ii; ++i) {\n            results[i] = expressions[i].evaluate(flags, scope, locator, part);\n        }\n        const func = this.func.evaluate(flags, scope, locator, part);\n        if (typeof func !== 'function') {\n            throw Reporter.error(207 /* NotAFunction */, this);\n        }\n        return func(this.cooked, ...results);\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        const expressions = this.expressions;\n        for (let i = 0, ii = expressions.length; i < ii; ++i) {\n            expressions[i].connect(flags, scope, binding);\n        }\n        this.func.connect(flags, scope, binding);\n    }\n    accept(visitor) {\n        return visitor.visitTaggedTemplate(this);\n    }\n}\nexport class ArrayBindingPattern {\n    // We'll either have elements, or keys+values, but never all 3\n    constructor(elements) {\n        this.elements = elements;\n        this.$kind = 65556 /* ArrayBindingPattern */;\n    }\n    evaluate(flags, scope, locator, part) {\n        // TODO\n        return void 0;\n    }\n    assign(flags, scope, locator, obj, part) {\n        // TODO\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitArrayBindingPattern(this);\n    }\n}\nexport class ObjectBindingPattern {\n    // We'll either have elements, or keys+values, but never all 3\n    constructor(keys, values) {\n        this.keys = keys;\n        this.values = values;\n        this.$kind = 65557 /* ObjectBindingPattern */;\n    }\n    evaluate(flags, scope, locator, part) {\n        // TODO\n        return void 0;\n    }\n    assign(flags, scope, locator, obj, part) {\n        // TODO\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitObjectBindingPattern(this);\n    }\n}\nexport class BindingIdentifier {\n    constructor(name) {\n        this.name = name;\n        this.$kind = 65558 /* BindingIdentifier */;\n    }\n    evaluate(flags, scope, locator, part) {\n        return this.name;\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitBindingIdentifier(this);\n    }\n}\nconst toStringTag = Object.prototype.toString;\n// https://tc39.github.io/ecma262/#sec-iteration-statements\n// https://tc39.github.io/ecma262/#sec-for-in-and-for-of-statements\nexport class ForOfStatement {\n    constructor(declaration, iterable) {\n        this.declaration = declaration;\n        this.iterable = iterable;\n        this.$kind = 6199 /* ForOfStatement */;\n    }\n    evaluate(flags, scope, locator, part) {\n        return this.iterable.evaluate(flags, scope, locator, part);\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    count(flags, result) {\n        switch (toStringTag.call(result)) {\n            case '[object Array]': return result.length;\n            case '[object Map]': return result.size;\n            case '[object Set]': return result.size;\n            case '[object Number]': return result;\n            case '[object Null]': return 0;\n            case '[object Undefined]': return 0;\n            default: throw Reporter.error(0); // TODO: Set error code\n        }\n    }\n    iterate(flags, result, func) {\n        switch (toStringTag.call(result)) {\n            case '[object Array]': return $array(flags | 8388608 /* isOriginalArray */, result, func);\n            case '[object Map]': return $map(flags | 8388608 /* isOriginalArray */, result, func);\n            case '[object Set]': return $set(flags | 8388608 /* isOriginalArray */, result, func);\n            case '[object Number]': return $number(flags | 8388608 /* isOriginalArray */, result, func);\n            case '[object Null]': return;\n            case '[object Undefined]': return;\n            default: throw Reporter.error(0); // TODO: Set error code\n        }\n    }\n    connect(flags, scope, binding, part) {\n        this.declaration.connect(flags, scope, binding, part);\n        this.iterable.connect(flags, scope, binding, part);\n    }\n    bind(flags, scope, binding) {\n        if (hasBind(this.iterable)) {\n            this.iterable.bind(flags, scope, binding);\n        }\n    }\n    unbind(flags, scope, binding) {\n        if (hasUnbind(this.iterable)) {\n            this.iterable.unbind(flags, scope, binding);\n        }\n    }\n    accept(visitor) {\n        return visitor.visitForOfStatement(this);\n    }\n}\n/*\n* Note: this implementation is far simpler than the one in vCurrent and might be missing important stuff (not sure yet)\n* so while this implementation is identical to Template and we could reuse that one, we don't want to lock outselves in to potentially the wrong abstraction\n* but this class might be a candidate for removal if it turns out it does provide all we need\n*/\nexport class Interpolation {\n    constructor(parts, expressions = PLATFORM.emptyArray) {\n        this.parts = parts;\n        this.expressions = expressions;\n        this.$kind = 24 /* Interpolation */;\n        this.isMulti = expressions.length > 1;\n        this.firstExpression = expressions[0];\n    }\n    evaluate(flags, scope, locator, part) {\n        if (this.isMulti) {\n            const expressions = this.expressions;\n            const parts = this.parts;\n            let result = parts[0];\n            for (let i = 0, ii = expressions.length; i < ii; ++i) {\n                result += expressions[i].evaluate(flags, scope, locator, part);\n                result += parts[i + 1];\n            }\n            return result;\n        }\n        else {\n            const parts = this.parts;\n            return `${parts[0]}${this.firstExpression.evaluate(flags, scope, locator, part)}${parts[1]}`;\n        }\n    }\n    assign(flags, scope, locator, obj, part) {\n        return void 0;\n    }\n    connect(flags, scope, binding, part) {\n        return;\n    }\n    accept(visitor) {\n        return visitor.visitInterpolation(this);\n    }\n}\n/// Evaluate the [list] in context of the [scope].\nfunction evalList(flags, scope, locator, list, part) {\n    const len = list.length;\n    const result = Array(len);\n    for (let i = 0; i < len; ++i) {\n        result[i] = list[i].evaluate(flags, scope, locator, part);\n    }\n    return result;\n}\nfunction getFunction(flags, obj, name) {\n    const func = obj == null ? null : obj[name];\n    if (typeof func === 'function') {\n        return func;\n    }\n    if (!(flags & 2097152 /* mustEvaluate */) && func == null) {\n        return null;\n    }\n    throw Reporter.error(207 /* NotAFunction */, obj, name, func);\n}\nconst proxyAndOriginalArray = 2 /* proxyStrategy */ | 8388608 /* isOriginalArray */;\nfunction $array(flags, result, func) {\n    if ((flags & proxyAndOriginalArray) === proxyAndOriginalArray) {\n        // If we're in proxy mode, and the array is the original \"items\" (and not an array we created here to iterate over e.g. a set)\n        // then replace all items (which are Objects) with proxies so their properties are observed in the source view model even if no\n        // observers are explicitly created\n        const rawArray = ProxyObserver.getRawIfProxy(result);\n        const len = rawArray.length;\n        let item;\n        let i = 0;\n        for (; i < len; ++i) {\n            item = rawArray[i];\n            if (item instanceof Object) {\n                item = rawArray[i] = ProxyObserver.getOrCreate(item).proxy;\n            }\n            func(rawArray, i, item);\n        }\n    }\n    else {\n        for (let i = 0, ii = result.length; i < ii; ++i) {\n            func(result, i, result[i]);\n        }\n    }\n}\nfunction $map(flags, result, func) {\n    const arr = Array(result.size);\n    let i = -1;\n    for (const entry of result.entries()) {\n        arr[++i] = entry;\n    }\n    $array(flags & ~8388608 /* isOriginalArray */, arr, func);\n}\nfunction $set(flags, result, func) {\n    const arr = Array(result.size);\n    let i = -1;\n    for (const key of result.keys()) {\n        arr[++i] = key;\n    }\n    $array(flags & ~8388608 /* isOriginalArray */, arr, func);\n}\nfunction $number(flags, result, func) {\n    const arr = Array(result);\n    for (let i = 0; i < result; ++i) {\n        arr[i] = i;\n    }\n    $array(flags & ~8388608 /* isOriginalArray */, arr, func);\n}\n//# sourceMappingURL=ast.js.map","/*\n* Note: the oneTime binding now has a non-zero value for 2 reasons:\n*  - plays nicer with bitwise operations (more consistent code, more explicit settings)\n*  - allows for potentially having something like BindingMode.oneTime | BindingMode.fromView, where an initial value is set once to the view but updates from the view also propagate back to the view model\n*\n* Furthermore, the \"default\" mode would be for simple \".bind\" expressions to make it explicit for our logic that the default is being used.\n* This essentially adds extra information which binding could use to do smarter things and allows bindingBehaviors that add a mode instead of simply overwriting it\n*/\nexport var BindingMode;\n(function (BindingMode) {\n    BindingMode[BindingMode[\"oneTime\"] = 1] = \"oneTime\";\n    BindingMode[BindingMode[\"toView\"] = 2] = \"toView\";\n    BindingMode[BindingMode[\"fromView\"] = 4] = \"fromView\";\n    BindingMode[BindingMode[\"twoWay\"] = 6] = \"twoWay\";\n    BindingMode[BindingMode[\"default\"] = 8] = \"default\";\n})(BindingMode || (BindingMode = {}));\nexport var BindingStrategy;\n(function (BindingStrategy) {\n    /**\n     * Configures all components \"below\" this one to operate in getterSetter binding mode.\n     * This is the default; if no strategy is specified, this one is implied.\n     *\n     * This strategy is the most compatible, convenient and has the best performance on frequently updated bindings on components that are infrequently replaced.\n     * However, it also consumes the most resources on initialization.\n     */\n    BindingStrategy[BindingStrategy[\"getterSetter\"] = 1] = \"getterSetter\";\n    /**\n     * Configures all components \"below\" this one to operate in proxy binding mode.\n     * No getters/setters are created.\n     *\n     * This strategy consumes significantly fewer resources than `getterSetter` on initialization and has the best performance on infrequently updated bindings on\n     * components that are frequently replaced.\n     * However, it consumes more resources on updates.\n     */\n    BindingStrategy[BindingStrategy[\"proxies\"] = 2] = \"proxies\";\n})(BindingStrategy || (BindingStrategy = {}));\nconst mandatoryStrategy = 1 /* getterSetter */ | 2 /* proxies */;\nexport function ensureValidStrategy(strategy) {\n    if ((strategy & mandatoryStrategy) === 0) {\n        // TODO: probably want to validate that user isn't trying to mix getterSetter/proxy\n        // TODO: also need to make sure that strategy can be changed away from proxies inside the component tree (not here though, but just making a note)\n        return strategy | 1 /* getterSetter */;\n    }\n    return strategy;\n}\nexport var State;\n(function (State) {\n    State[State[\"none\"] = 0] = \"none\";\n    State[State[\"isBinding\"] = 1] = \"isBinding\";\n    State[State[\"isUnbinding\"] = 2] = \"isUnbinding\";\n    State[State[\"isBound\"] = 4] = \"isBound\";\n    State[State[\"isBoundOrBinding\"] = 5] = \"isBoundOrBinding\";\n    State[State[\"isBoundOrUnbinding\"] = 6] = \"isBoundOrUnbinding\";\n    State[State[\"isAttaching\"] = 8] = \"isAttaching\";\n    State[State[\"isDetaching\"] = 16] = \"isDetaching\";\n    State[State[\"isAttached\"] = 32] = \"isAttached\";\n    State[State[\"isAttachedOrAttaching\"] = 40] = \"isAttachedOrAttaching\";\n    State[State[\"isAttachedOrDetaching\"] = 48] = \"isAttachedOrDetaching\";\n    State[State[\"isMounted\"] = 64] = \"isMounted\";\n    State[State[\"hasLockedScope\"] = 256] = \"hasLockedScope\";\n    State[State[\"canBeCached\"] = 512] = \"canBeCached\";\n})(State || (State = {}));\nexport var LifecycleFlags;\n(function (LifecycleFlags) {\n    LifecycleFlags[LifecycleFlags[\"none\"] = 0] = \"none\";\n    // Bitmask for flags that need to be stored on a binding during $bind for mutation\n    // callbacks outside of $bind\n    LifecycleFlags[LifecycleFlags[\"persistentBindingFlags\"] = 2080374799] = \"persistentBindingFlags\";\n    LifecycleFlags[LifecycleFlags[\"allowParentScopeTraversal\"] = 67108864] = \"allowParentScopeTraversal\";\n    LifecycleFlags[LifecycleFlags[\"observeLeafPropertiesOnly\"] = 134217728] = \"observeLeafPropertiesOnly\";\n    LifecycleFlags[LifecycleFlags[\"targetObserverFlags\"] = 805306383] = \"targetObserverFlags\";\n    LifecycleFlags[LifecycleFlags[\"noTargetObserverQueue\"] = 268435456] = \"noTargetObserverQueue\";\n    LifecycleFlags[LifecycleFlags[\"persistentTargetObserverQueue\"] = 536870912] = \"persistentTargetObserverQueue\";\n    LifecycleFlags[LifecycleFlags[\"secondaryExpression\"] = 1073741824] = \"secondaryExpression\";\n    LifecycleFlags[LifecycleFlags[\"bindingStrategy\"] = 15] = \"bindingStrategy\";\n    LifecycleFlags[LifecycleFlags[\"getterSetterStrategy\"] = 1] = \"getterSetterStrategy\";\n    LifecycleFlags[LifecycleFlags[\"proxyStrategy\"] = 2] = \"proxyStrategy\";\n    LifecycleFlags[LifecycleFlags[\"isStrictBindingStrategy\"] = 4] = \"isStrictBindingStrategy\";\n    LifecycleFlags[LifecycleFlags[\"update\"] = 48] = \"update\";\n    LifecycleFlags[LifecycleFlags[\"updateTargetInstance\"] = 16] = \"updateTargetInstance\";\n    LifecycleFlags[LifecycleFlags[\"updateSourceExpression\"] = 32] = \"updateSourceExpression\";\n    LifecycleFlags[LifecycleFlags[\"from\"] = 524224] = \"from\";\n    LifecycleFlags[LifecycleFlags[\"fromFlush\"] = 960] = \"fromFlush\";\n    LifecycleFlags[LifecycleFlags[\"fromAsyncFlush\"] = 64] = \"fromAsyncFlush\";\n    LifecycleFlags[LifecycleFlags[\"fromSyncFlush\"] = 128] = \"fromSyncFlush\";\n    LifecycleFlags[LifecycleFlags[\"fromTick\"] = 256] = \"fromTick\";\n    LifecycleFlags[LifecycleFlags[\"fromBatch\"] = 512] = \"fromBatch\";\n    LifecycleFlags[LifecycleFlags[\"fromStartTask\"] = 1024] = \"fromStartTask\";\n    LifecycleFlags[LifecycleFlags[\"fromStopTask\"] = 2048] = \"fromStopTask\";\n    LifecycleFlags[LifecycleFlags[\"fromBind\"] = 4096] = \"fromBind\";\n    LifecycleFlags[LifecycleFlags[\"fromUnbind\"] = 8192] = \"fromUnbind\";\n    LifecycleFlags[LifecycleFlags[\"fromAttach\"] = 16384] = \"fromAttach\";\n    LifecycleFlags[LifecycleFlags[\"fromDetach\"] = 32768] = \"fromDetach\";\n    LifecycleFlags[LifecycleFlags[\"fromCache\"] = 65536] = \"fromCache\";\n    LifecycleFlags[LifecycleFlags[\"fromDOMEvent\"] = 131072] = \"fromDOMEvent\";\n    LifecycleFlags[LifecycleFlags[\"fromLifecycleTask\"] = 262144] = \"fromLifecycleTask\";\n    LifecycleFlags[LifecycleFlags[\"allowPublishRoundtrip\"] = 524288] = \"allowPublishRoundtrip\";\n    LifecycleFlags[LifecycleFlags[\"isPublishing\"] = 1048576] = \"isPublishing\";\n    LifecycleFlags[LifecycleFlags[\"mustEvaluate\"] = 2097152] = \"mustEvaluate\";\n    LifecycleFlags[LifecycleFlags[\"isTraversingParentScope\"] = 4194304] = \"isTraversingParentScope\";\n    LifecycleFlags[LifecycleFlags[\"isOriginalArray\"] = 8388608] = \"isOriginalArray\";\n    LifecycleFlags[LifecycleFlags[\"isCollectionMutation\"] = 16777216] = \"isCollectionMutation\";\n    LifecycleFlags[LifecycleFlags[\"reorderNodes\"] = 33554432] = \"reorderNodes\";\n})(LifecycleFlags || (LifecycleFlags = {}));\nexport var ExpressionKind;\n(function (ExpressionKind) {\n    ExpressionKind[ExpressionKind[\"Connects\"] = 32] = \"Connects\";\n    ExpressionKind[ExpressionKind[\"Observes\"] = 64] = \"Observes\";\n    ExpressionKind[ExpressionKind[\"CallsFunction\"] = 128] = \"CallsFunction\";\n    ExpressionKind[ExpressionKind[\"HasAncestor\"] = 256] = \"HasAncestor\";\n    ExpressionKind[ExpressionKind[\"IsPrimary\"] = 512] = \"IsPrimary\";\n    ExpressionKind[ExpressionKind[\"IsLeftHandSide\"] = 1024] = \"IsLeftHandSide\";\n    ExpressionKind[ExpressionKind[\"HasBind\"] = 2048] = \"HasBind\";\n    ExpressionKind[ExpressionKind[\"HasUnbind\"] = 4096] = \"HasUnbind\";\n    ExpressionKind[ExpressionKind[\"IsAssignable\"] = 8192] = \"IsAssignable\";\n    ExpressionKind[ExpressionKind[\"IsLiteral\"] = 16384] = \"IsLiteral\";\n    ExpressionKind[ExpressionKind[\"IsResource\"] = 32768] = \"IsResource\";\n    ExpressionKind[ExpressionKind[\"IsForDeclaration\"] = 65536] = \"IsForDeclaration\";\n    ExpressionKind[ExpressionKind[\"Type\"] = 31] = \"Type\";\n    // ---------------------------------------------------------------------------------------------------------------------------\n    ExpressionKind[ExpressionKind[\"AccessThis\"] = 1793] = \"AccessThis\";\n    ExpressionKind[ExpressionKind[\"AccessScope\"] = 10082] = \"AccessScope\";\n    ExpressionKind[ExpressionKind[\"ArrayLiteral\"] = 17955] = \"ArrayLiteral\";\n    ExpressionKind[ExpressionKind[\"ObjectLiteral\"] = 17956] = \"ObjectLiteral\";\n    ExpressionKind[ExpressionKind[\"PrimitiveLiteral\"] = 17925] = \"PrimitiveLiteral\";\n    ExpressionKind[ExpressionKind[\"Template\"] = 17958] = \"Template\";\n    ExpressionKind[ExpressionKind[\"Unary\"] = 39] = \"Unary\";\n    ExpressionKind[ExpressionKind[\"CallScope\"] = 1448] = \"CallScope\";\n    ExpressionKind[ExpressionKind[\"CallMember\"] = 1161] = \"CallMember\";\n    ExpressionKind[ExpressionKind[\"CallFunction\"] = 1162] = \"CallFunction\";\n    ExpressionKind[ExpressionKind[\"AccessMember\"] = 9323] = \"AccessMember\";\n    ExpressionKind[ExpressionKind[\"AccessKeyed\"] = 9324] = \"AccessKeyed\";\n    ExpressionKind[ExpressionKind[\"TaggedTemplate\"] = 1197] = \"TaggedTemplate\";\n    ExpressionKind[ExpressionKind[\"Binary\"] = 46] = \"Binary\";\n    ExpressionKind[ExpressionKind[\"Conditional\"] = 63] = \"Conditional\";\n    ExpressionKind[ExpressionKind[\"Assign\"] = 8208] = \"Assign\";\n    ExpressionKind[ExpressionKind[\"ValueConverter\"] = 36913] = \"ValueConverter\";\n    ExpressionKind[ExpressionKind[\"BindingBehavior\"] = 38962] = \"BindingBehavior\";\n    ExpressionKind[ExpressionKind[\"HtmlLiteral\"] = 51] = \"HtmlLiteral\";\n    ExpressionKind[ExpressionKind[\"ArrayBindingPattern\"] = 65556] = \"ArrayBindingPattern\";\n    ExpressionKind[ExpressionKind[\"ObjectBindingPattern\"] = 65557] = \"ObjectBindingPattern\";\n    ExpressionKind[ExpressionKind[\"BindingIdentifier\"] = 65558] = \"BindingIdentifier\";\n    ExpressionKind[ExpressionKind[\"ForOfStatement\"] = 6199] = \"ForOfStatement\";\n    ExpressionKind[ExpressionKind[\"Interpolation\"] = 24] = \"Interpolation\"; //\n})(ExpressionKind || (ExpressionKind = {}));\n//# sourceMappingURL=flags.js.map","/** @internal */\nexport var SubscriberFlags;\n(function (SubscriberFlags) {\n    SubscriberFlags[SubscriberFlags[\"None\"] = 0] = \"None\";\n    SubscriberFlags[SubscriberFlags[\"Subscriber0\"] = 1] = \"Subscriber0\";\n    SubscriberFlags[SubscriberFlags[\"Subscriber1\"] = 2] = \"Subscriber1\";\n    SubscriberFlags[SubscriberFlags[\"Subscriber2\"] = 4] = \"Subscriber2\";\n    SubscriberFlags[SubscriberFlags[\"SubscribersRest\"] = 8] = \"SubscribersRest\";\n    SubscriberFlags[SubscriberFlags[\"Any\"] = 15] = \"Any\";\n})(SubscriberFlags || (SubscriberFlags = {}));\nexport var DelegationStrategy;\n(function (DelegationStrategy) {\n    DelegationStrategy[DelegationStrategy[\"none\"] = 0] = \"none\";\n    DelegationStrategy[DelegationStrategy[\"capturing\"] = 1] = \"capturing\";\n    DelegationStrategy[DelegationStrategy[\"bubbling\"] = 2] = \"bubbling\";\n})(DelegationStrategy || (DelegationStrategy = {}));\nexport var CollectionKind;\n(function (CollectionKind) {\n    CollectionKind[CollectionKind[\"indexed\"] = 8] = \"indexed\";\n    CollectionKind[CollectionKind[\"keyed\"] = 4] = \"keyed\";\n    CollectionKind[CollectionKind[\"array\"] = 9] = \"array\";\n    CollectionKind[CollectionKind[\"map\"] = 6] = \"map\";\n    CollectionKind[CollectionKind[\"set\"] = 7] = \"set\";\n})(CollectionKind || (CollectionKind = {}));\nexport function copyIndexMap(existing, deletedItems) {\n    const { length } = existing;\n    const arr = Array(length);\n    let i = 0;\n    while (i < length) {\n        arr[i] = existing[i];\n        ++i;\n    }\n    if (deletedItems !== void 0) {\n        arr.deletedItems = deletedItems.slice(0);\n    }\n    else if (existing.deletedItems !== void 0) {\n        arr.deletedItems = existing.deletedItems.slice(0);\n    }\n    else {\n        arr.deletedItems = [];\n    }\n    arr.isIndexMap = true;\n    return arr;\n}\nexport function createIndexMap(length = 0) {\n    const arr = Array(length);\n    let i = 0;\n    while (i < length) {\n        arr[i] = i++;\n    }\n    arr.deletedItems = [];\n    arr.isIndexMap = true;\n    return arr;\n}\nexport function cloneIndexMap(indexMap) {\n    const clone = indexMap.slice();\n    clone.deletedItems = indexMap.deletedItems.slice();\n    clone.isIndexMap = true;\n    return clone;\n}\nexport function isIndexMap(value) {\n    return value instanceof Array && value.isIndexMap === true;\n}\n//# sourceMappingURL=observation.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { subscriberCollection } from './subscriber-collection';\nlet CollectionLengthObserver = class CollectionLengthObserver {\n    constructor(obj) {\n        this.obj = obj;\n        this.currentValue = obj.length;\n    }\n    getValue() {\n        return this.obj.length;\n    }\n    setValue(newValue, flags) {\n        const { currentValue } = this;\n        if (newValue !== currentValue) {\n            this.currentValue = newValue;\n            this.callSubscribers(newValue, currentValue, flags | 16 /* updateTargetInstance */);\n        }\n    }\n};\nCollectionLengthObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Array])\n], CollectionLengthObserver);\nexport { CollectionLengthObserver };\n//# sourceMappingURL=collection-length-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { ILifecycle } from '../lifecycle';\nimport { createIndexMap } from '../observation';\nimport { CollectionLengthObserver } from './collection-length-observer';\nimport { collectionSubscriberCollection, subscriberCollection } from './subscriber-collection';\nconst observerLookup = new WeakMap();\n// https://tc39.github.io/ecma262/#sec-sortcompare\nfunction sortCompare(x, y) {\n    if (x === y) {\n        return 0;\n    }\n    x = x === null ? 'null' : x.toString();\n    y = y === null ? 'null' : y.toString();\n    return x < y ? -1 : 1;\n}\nfunction preSortCompare(x, y) {\n    if (x === void 0) {\n        if (y === void 0) {\n            return 0;\n        }\n        else {\n            return 1;\n        }\n    }\n    if (y === void 0) {\n        return -1;\n    }\n    return 0;\n}\nfunction insertionSort(arr, indexMap, from, to, compareFn) {\n    let velement, ielement, vtmp, itmp, order;\n    let i, j;\n    for (i = from + 1; i < to; i++) {\n        velement = arr[i];\n        ielement = indexMap[i];\n        for (j = i - 1; j >= from; j--) {\n            vtmp = arr[j];\n            itmp = indexMap[j];\n            order = compareFn(vtmp, velement);\n            if (order > 0) {\n                arr[j + 1] = vtmp;\n                indexMap[j + 1] = itmp;\n            }\n            else {\n                break;\n            }\n        }\n        arr[j + 1] = velement;\n        indexMap[j + 1] = ielement;\n    }\n}\nfunction quickSort(arr, indexMap, from, to, compareFn) {\n    let thirdIndex = 0, i = 0;\n    let v0, v1, v2;\n    let i0, i1, i2;\n    let c01, c02, c12;\n    let vtmp, itmp;\n    let vpivot, ipivot, lowEnd, highStart;\n    let velement, ielement, order, vtopElement;\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n        if (to - from <= 10) {\n            insertionSort(arr, indexMap, from, to, compareFn);\n            return;\n        }\n        thirdIndex = from + ((to - from) >> 1);\n        v0 = arr[from];\n        i0 = indexMap[from];\n        v1 = arr[to - 1];\n        i1 = indexMap[to - 1];\n        v2 = arr[thirdIndex];\n        i2 = indexMap[thirdIndex];\n        c01 = compareFn(v0, v1);\n        if (c01 > 0) {\n            vtmp = v0;\n            itmp = i0;\n            v0 = v1;\n            i0 = i1;\n            v1 = vtmp;\n            i1 = itmp;\n        }\n        c02 = compareFn(v0, v2);\n        if (c02 >= 0) {\n            vtmp = v0;\n            itmp = i0;\n            v0 = v2;\n            i0 = i2;\n            v2 = v1;\n            i2 = i1;\n            v1 = vtmp;\n            i1 = itmp;\n        }\n        else {\n            c12 = compareFn(v1, v2);\n            if (c12 > 0) {\n                vtmp = v1;\n                itmp = i1;\n                v1 = v2;\n                i1 = i2;\n                v2 = vtmp;\n                i2 = itmp;\n            }\n        }\n        arr[from] = v0;\n        indexMap[from] = i0;\n        arr[to - 1] = v2;\n        indexMap[to - 1] = i2;\n        vpivot = v1;\n        ipivot = i1;\n        lowEnd = from + 1;\n        highStart = to - 1;\n        arr[thirdIndex] = arr[lowEnd];\n        indexMap[thirdIndex] = indexMap[lowEnd];\n        arr[lowEnd] = vpivot;\n        indexMap[lowEnd] = ipivot;\n        partition: for (i = lowEnd + 1; i < highStart; i++) {\n            velement = arr[i];\n            ielement = indexMap[i];\n            order = compareFn(velement, vpivot);\n            if (order < 0) {\n                arr[i] = arr[lowEnd];\n                indexMap[i] = indexMap[lowEnd];\n                arr[lowEnd] = velement;\n                indexMap[lowEnd] = ielement;\n                lowEnd++;\n            }\n            else if (order > 0) {\n                do {\n                    highStart--;\n                    // eslint-disable-next-line eqeqeq\n                    if (highStart == i) {\n                        break partition;\n                    }\n                    vtopElement = arr[highStart];\n                    order = compareFn(vtopElement, vpivot);\n                } while (order > 0);\n                arr[i] = arr[highStart];\n                indexMap[i] = indexMap[highStart];\n                arr[highStart] = velement;\n                indexMap[highStart] = ielement;\n                if (order < 0) {\n                    velement = arr[i];\n                    ielement = indexMap[i];\n                    arr[i] = arr[lowEnd];\n                    indexMap[i] = indexMap[lowEnd];\n                    arr[lowEnd] = velement;\n                    indexMap[lowEnd] = ielement;\n                    lowEnd++;\n                }\n            }\n        }\n        if (to - highStart < lowEnd - from) {\n            quickSort(arr, indexMap, highStart, to, compareFn);\n            to = lowEnd;\n        }\n        else {\n            quickSort(arr, indexMap, from, lowEnd, compareFn);\n            from = highStart;\n        }\n    }\n}\nconst proto = Array.prototype;\nconst $push = proto.push;\nconst $unshift = proto.unshift;\nconst $pop = proto.pop;\nconst $shift = proto.shift;\nconst $splice = proto.splice;\nconst $reverse = proto.reverse;\nconst $sort = proto.sort;\nconst native = { push: $push, unshift: $unshift, pop: $pop, shift: $shift, splice: $splice, reverse: $reverse, sort: $sort };\nconst methods = ['push', 'unshift', 'pop', 'shift', 'splice', 'reverse', 'sort'];\nconst observe = {\n    // https://tc39.github.io/ecma262/#sec-array.prototype.push\n    push: function (...args) {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            return $push.apply($this, args);\n        }\n        const len = $this.length;\n        const argCount = args.length;\n        if (argCount === 0) {\n            return len;\n        }\n        $this.length = o.indexMap.length = len + argCount;\n        let i = len;\n        while (i < $this.length) {\n            $this[i] = args[i - len];\n            o.indexMap[i] = -2;\n            i++;\n        }\n        o.notify();\n        return $this.length;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.unshift\n    unshift: function (...args) {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            return $unshift.apply($this, args);\n        }\n        const argCount = args.length;\n        const inserts = new Array(argCount);\n        let i = 0;\n        while (i < argCount) {\n            inserts[i++] = -2;\n        }\n        $unshift.apply(o.indexMap, inserts);\n        const len = $unshift.apply($this, args);\n        o.notify();\n        return len;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.pop\n    pop: function () {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            return $pop.call($this);\n        }\n        const indexMap = o.indexMap;\n        const element = $pop.call($this);\n        // only mark indices as deleted if they actually existed in the original array\n        const index = indexMap.length - 1;\n        if (indexMap[index] > -1) {\n            indexMap.deletedItems.push(indexMap[index]);\n        }\n        $pop.call(indexMap);\n        o.notify();\n        return element;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.shift\n    shift: function () {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            return $shift.call($this);\n        }\n        const indexMap = o.indexMap;\n        const element = $shift.call($this);\n        // only mark indices as deleted if they actually existed in the original array\n        if (indexMap[0] > -1) {\n            indexMap.deletedItems.push(indexMap[0]);\n        }\n        $shift.call(indexMap);\n        o.notify();\n        return element;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.splice\n    splice: function (...args) {\n        const start = args[0];\n        const deleteCount = args[1];\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            return $splice.apply($this, args);\n        }\n        const len = this.length;\n        const relativeStart = start | 0;\n        const actualStart = relativeStart < 0 ? Math.max((len + relativeStart), 0) : Math.min(relativeStart, len);\n        const indexMap = o.indexMap;\n        const argCount = args.length;\n        const actualDeleteCount = argCount === 0 ? 0 : argCount === 1 ? len - actualStart : deleteCount;\n        if (actualDeleteCount > 0) {\n            let i = actualStart;\n            const to = i + actualDeleteCount;\n            while (i < to) {\n                if (indexMap[i] > -1) {\n                    indexMap.deletedItems.push(indexMap[i]);\n                }\n                i++;\n            }\n        }\n        if (argCount > 2) {\n            const itemCount = argCount - 2;\n            const inserts = new Array(itemCount);\n            let i = 0;\n            while (i < itemCount) {\n                inserts[i++] = -2;\n            }\n            $splice.call(indexMap, start, deleteCount, ...inserts);\n        }\n        else {\n            $splice.apply(indexMap, args);\n        }\n        const deleted = $splice.apply($this, args);\n        o.notify();\n        return deleted;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.reverse\n    reverse: function () {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            $reverse.call($this);\n            return this;\n        }\n        const len = $this.length;\n        const middle = (len / 2) | 0;\n        let lower = 0;\n        while (lower !== middle) {\n            const upper = len - lower - 1;\n            const lowerValue = $this[lower];\n            const lowerIndex = o.indexMap[lower];\n            const upperValue = $this[upper];\n            const upperIndex = o.indexMap[upper];\n            $this[lower] = upperValue;\n            o.indexMap[lower] = upperIndex;\n            $this[upper] = lowerValue;\n            o.indexMap[upper] = lowerIndex;\n            lower++;\n        }\n        o.notify();\n        return this;\n    },\n    // https://tc39.github.io/ecma262/#sec-array.prototype.sort\n    // https://github.com/v8/v8/blob/master/src/js/array.js\n    sort: function (compareFn) {\n        let $this = this;\n        if ($this.$raw !== void 0) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === void 0) {\n            $sort.call($this, compareFn);\n            return this;\n        }\n        const len = $this.length;\n        if (len < 2) {\n            return this;\n        }\n        quickSort($this, o.indexMap, 0, len, preSortCompare);\n        let i = 0;\n        while (i < len) {\n            if ($this[i] === void 0) {\n                break;\n            }\n            i++;\n        }\n        if (compareFn === void 0 || typeof compareFn !== 'function' /* spec says throw a TypeError, should we do that too? */) {\n            compareFn = sortCompare;\n        }\n        quickSort($this, o.indexMap, 0, i, compareFn);\n        o.notify();\n        return this;\n    }\n};\nconst descriptorProps = {\n    writable: true,\n    enumerable: false,\n    configurable: true\n};\nconst def = Reflect.defineProperty;\nfor (const method of methods) {\n    def(observe[method], 'observing', { value: true, writable: false, configurable: false, enumerable: false });\n}\nlet enableArrayObservationCalled = false;\nexport function enableArrayObservation() {\n    for (const method of methods) {\n        if (proto[method].observing !== true) {\n            def(proto, method, { ...descriptorProps, value: observe[method] });\n        }\n    }\n}\nexport function disableArrayObservation() {\n    for (const method of methods) {\n        if (proto[method].observing === true) {\n            def(proto, method, { ...descriptorProps, value: native[method] });\n        }\n    }\n}\nlet ArrayObserver = class ArrayObserver {\n    constructor(flags, lifecycle, array) {\n        if (!enableArrayObservationCalled) {\n            enableArrayObservationCalled = true;\n            enableArrayObservation();\n        }\n        this.inBatch = false;\n        this.indexObservers = {};\n        this.collection = array;\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        this.indexMap = createIndexMap(array.length);\n        this.lifecycle = lifecycle;\n        this.lengthObserver = (void 0);\n        observerLookup.set(array, this);\n    }\n    notify() {\n        if (this.lifecycle.batch.depth > 0) {\n            if (!this.inBatch) {\n                this.inBatch = true;\n                this.lifecycle.batch.add(this);\n            }\n        }\n        else {\n            this.flushBatch(0 /* none */);\n        }\n    }\n    getLengthObserver() {\n        if (this.lengthObserver === void 0) {\n            this.lengthObserver = new CollectionLengthObserver(this.collection);\n        }\n        return this.lengthObserver;\n    }\n    getIndexObserver(index) {\n        return this.getOrCreateIndexObserver(index);\n    }\n    flushBatch(flags) {\n        this.inBatch = false;\n        const indexMap = this.indexMap;\n        const length = this.collection.length;\n        this.indexMap = createIndexMap(length);\n        this.callCollectionSubscribers(indexMap, 16 /* updateTargetInstance */ | this.persistentFlags);\n        if (this.lengthObserver !== void 0) {\n            this.lengthObserver.setValue(length, 16 /* updateTargetInstance */);\n        }\n    }\n    /**\n     * @internal used by friend class ArrayIndexObserver only\n     */\n    addIndexObserver(indexObserver) {\n        this.addCollectionSubscriber(indexObserver);\n    }\n    /**\n     * @internal used by friend class ArrayIndexObserver only\n     */\n    removeIndexObserver(indexObserver) {\n        this.removeCollectionSubscriber(indexObserver);\n    }\n    /**\n     * @internal\n     */\n    getOrCreateIndexObserver(index) {\n        const indexObservers = this.indexObservers;\n        let observer = indexObservers[index];\n        if (observer === void 0) {\n            observer = indexObservers[index] = new ArrayIndexObserver(this, index);\n        }\n        return observer;\n    }\n};\nArrayObserver = __decorate([\n    collectionSubscriberCollection(),\n    __metadata(\"design:paramtypes\", [Number, Object, Object])\n], ArrayObserver);\nexport { ArrayObserver };\nlet ArrayIndexObserver = class ArrayIndexObserver {\n    constructor(owner, index) {\n        this.owner = owner;\n        this.index = index;\n        this.subscriberCount = 0;\n        this.currentValue = this.getValue();\n    }\n    getValue() {\n        return this.owner.collection[this.index];\n    }\n    setValue(newValue, flags) {\n        if (newValue === this.getValue()) {\n            return;\n        }\n        const arrayObserver = this.owner;\n        const index = this.index;\n        const indexMap = arrayObserver.indexMap;\n        if (indexMap[index] > -1) {\n            indexMap.deletedItems.push(indexMap[index]);\n        }\n        indexMap[index] = -2;\n        // do not need to update current value here\n        // as it will be updated inside handle collection change\n        arrayObserver.collection[index] = newValue;\n        arrayObserver.notify();\n    }\n    /**\n     * From interface `ICollectionSubscriber`\n     */\n    handleCollectionChange(indexMap, flags) {\n        const index = this.index;\n        const noChange = indexMap[index] === index;\n        if (noChange) {\n            return;\n        }\n        const prevValue = this.currentValue;\n        const currValue = this.currentValue = this.getValue();\n        // hmm\n        if (prevValue !== currValue) {\n            this.callSubscribers(currValue, prevValue, flags);\n        }\n    }\n    subscribe(subscriber) {\n        if (this.addSubscriber(subscriber) && ++this.subscriberCount === 1) {\n            this.owner.addIndexObserver(this);\n        }\n    }\n    unsubscribe(subscriber) {\n        if (this.removeSubscriber(subscriber) && --this.subscriberCount === 0) {\n            this.owner.removeIndexObserver(this);\n        }\n    }\n};\nArrayIndexObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [ArrayObserver, Number])\n], ArrayIndexObserver);\nexport { ArrayIndexObserver };\nexport function getArrayObserver(flags, lifecycle, array) {\n    const observer = observerLookup.get(array);\n    if (observer === void 0) {\n        return new ArrayObserver(flags, lifecycle, array);\n    }\n    return observer;\n}\n/**\n * Applies offsets to the non-negative indices in the IndexMap\n * based on added and deleted items relative to those indices.\n *\n * e.g. turn `[-2, 0, 1]` into `[-2, 1, 2]`, allowing the values at the indices to be\n * used for sorting/reordering items if needed\n */\nexport function applyMutationsToIndices(indexMap) {\n    let offset = 0;\n    let j = 0;\n    const len = indexMap.length;\n    for (let i = 0; i < len; ++i) {\n        while (indexMap.deletedItems[j] <= i - offset) {\n            ++j;\n            --offset;\n        }\n        if (indexMap[i] === -2) {\n            ++offset;\n        }\n        else {\n            indexMap[i] += offset;\n        }\n    }\n}\n/**\n * After `applyMutationsToIndices`, this function can be used to reorder items in a derived\n * array (e.g.  the items in the `views` in the repeater are derived from the `items` property)\n */\nexport function synchronizeIndices(items, indexMap) {\n    const copy = items.slice();\n    const len = indexMap.length;\n    let to = 0;\n    let from = 0;\n    while (to < len) {\n        from = indexMap[to];\n        if (from !== -2) {\n            items[to] = copy[from];\n        }\n        ++to;\n    }\n}\n//# sourceMappingURL=array-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n/* eslint-disable eqeqeq, compat/compat */\nimport { PLATFORM, Reporter, isArrayIndex } from '@aurelia/kernel';\nimport { IObserverLocator } from './observer-locator';\nimport { subscriberCollection } from './subscriber-collection';\nexport function computed(config) {\n    return function (target, key) {\n        /**\n         * The 'computed' property defined on prototype needs to be non-enumerable to prevent getting this in loops,\n         * iterating over object properties, such as for..in.\n         *\n         * The 'value' of the property should not have any prototype. Otherwise if by mistake the target passed\n         * here is `Object`, then we are in soup. Because then every instance of `Object` will have the `computed`\n         * property, including the `value` (in the descriptor of the property), when assigned `{}`. This might\n         * lead to infinite recursion for the cases as mentioned above.\n         */\n        if (target.computed == null) {\n            Reflect.defineProperty(target, 'computed', {\n                writable: true,\n                configurable: true,\n                enumerable: false,\n                value: Object.create(null)\n            });\n        }\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n        target.computed[key] = config;\n    };\n}\nconst computedOverrideDefaults = { static: false, volatile: false };\n/* @internal */\nexport function createComputedObserver(flags, observerLocator, dirtyChecker, lifecycle, instance, propertyName, descriptor) {\n    if (descriptor.configurable === false) {\n        return dirtyChecker.createProperty(instance, propertyName);\n    }\n    if (descriptor.get != null) {\n        const { constructor: { prototype: { computed: givenOverrides } } } = instance;\n        // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions, @typescript-eslint/no-unnecessary-type-assertion\n        const overrides = givenOverrides && givenOverrides[propertyName] || computedOverrideDefaults;\n        if (descriptor.set != null) {\n            if (overrides.volatile) {\n                return new GetterObserver(flags, overrides, instance, propertyName, descriptor, observerLocator);\n            }\n            return new CustomSetterObserver(instance, propertyName, descriptor);\n        }\n        return new GetterObserver(flags, overrides, instance, propertyName, descriptor, observerLocator);\n    }\n    throw Reporter.error(18, propertyName);\n}\n// Used when the getter is dependent solely on changes that happen within the setter.\nlet CustomSetterObserver = class CustomSetterObserver {\n    constructor(obj, propertyKey, descriptor) {\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.descriptor = descriptor;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.observing = false;\n    }\n    setValue(newValue) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion, @typescript-eslint/no-unnecessary-type-assertion\n        this.descriptor.set.call(this.obj, newValue); // Non-null is implied because descriptors without setters won't end up here\n        if (this.currentValue !== newValue) {\n            this.oldValue = this.currentValue;\n            this.currentValue = newValue;\n            this.callSubscribers(newValue, this.oldValue, 16 /* updateTargetInstance */);\n        }\n    }\n    subscribe(subscriber) {\n        if (!this.observing) {\n            this.convertProperty();\n        }\n        this.addSubscriber(subscriber);\n    }\n    unsubscribe(subscriber) {\n        this.removeSubscriber(subscriber);\n    }\n    convertProperty() {\n        this.observing = true;\n        this.currentValue = this.obj[this.propertyKey];\n        const set = (newValue) => { this.setValue(newValue); };\n        Reflect.defineProperty(this.obj, this.propertyKey, { set, get: this.descriptor.get });\n    }\n};\nCustomSetterObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, String, Object])\n], CustomSetterObserver);\nexport { CustomSetterObserver };\n// Used when there is no setter, and the getter is dependent on other properties of the object;\n// Used when there is a setter but the value of the getter can change based on properties set outside of the setter.\nlet GetterObserver = class GetterObserver {\n    constructor(flags, overrides, obj, propertyKey, descriptor, observerLocator) {\n        this.overrides = overrides;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.descriptor = descriptor;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.propertyDeps = [];\n        this.collectionDeps = [];\n        this.subscriberCount = 0;\n        this.isCollecting = false;\n        this.proxy = new Proxy(obj, createGetterTraps(flags, observerLocator, this));\n        const get = () => this.getValue();\n        Reflect.defineProperty(obj, propertyKey, { get, set: descriptor.set });\n    }\n    addPropertyDep(subscribable) {\n        if (!this.propertyDeps.includes(subscribable)) {\n            this.propertyDeps.push(subscribable);\n        }\n    }\n    addCollectionDep(subscribable) {\n        if (!this.collectionDeps.includes(subscribable)) {\n            this.collectionDeps.push(subscribable);\n        }\n    }\n    getValue() {\n        if (this.subscriberCount > 0 || this.isCollecting) {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.currentValue = Reflect.apply(this.descriptor.get, this.proxy, PLATFORM.emptyArray); // Non-null is implied because descriptors without getters won't end up here\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.currentValue = Reflect.apply(this.descriptor.get, this.obj, PLATFORM.emptyArray); // Non-null is implied because descriptors without getters won't end up here\n        }\n        return this.currentValue;\n    }\n    subscribe(subscriber) {\n        this.addSubscriber(subscriber);\n        if (++this.subscriberCount === 1) {\n            this.getValueAndCollectDependencies(true);\n        }\n    }\n    unsubscribe(subscriber) {\n        this.removeSubscriber(subscriber);\n        if (--this.subscriberCount === 0) {\n            this.unsubscribeAllDependencies();\n        }\n    }\n    handleChange() {\n        const oldValue = this.currentValue;\n        const newValue = this.getValueAndCollectDependencies(false);\n        if (oldValue !== newValue) {\n            this.callSubscribers(newValue, oldValue, 16 /* updateTargetInstance */);\n        }\n    }\n    handleCollectionChange() {\n        const oldValue = this.currentValue;\n        const newValue = this.getValueAndCollectDependencies(false);\n        if (oldValue !== newValue) {\n            this.callSubscribers(newValue, oldValue, 16 /* updateTargetInstance */);\n        }\n    }\n    getValueAndCollectDependencies(requireCollect) {\n        const dynamicDependencies = !this.overrides.static || requireCollect;\n        if (dynamicDependencies) {\n            this.unsubscribeAllDependencies();\n            this.isCollecting = true;\n        }\n        this.currentValue = this.getValue();\n        if (dynamicDependencies) {\n            this.propertyDeps.forEach(x => { x.subscribe(this); });\n            this.collectionDeps.forEach(x => { x.subscribeToCollection(this); });\n            this.isCollecting = false;\n        }\n        return this.currentValue;\n    }\n    doNotCollect(target, key, receiver) {\n        return !this.isCollecting\n            || key === '$observers'\n            || key === '$synthetic'\n            || key === 'constructor';\n    }\n    unsubscribeAllDependencies() {\n        this.propertyDeps.forEach(x => { x.unsubscribe(this); });\n        this.propertyDeps.length = 0;\n        this.collectionDeps.forEach(x => { x.unsubscribeFromCollection(this); });\n        this.collectionDeps.length = 0;\n    }\n};\nGetterObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Number, Object, Object, String, Object, Object])\n], GetterObserver);\nexport { GetterObserver };\nconst toStringTag = Object.prototype.toString;\n/**\n * _@param observer The owning observer of current evaluation, will subscribe to all observers created via proxy\n */\nfunction createGetterTraps(flags, observerLocator, observer) {\n    return {\n        get: function (target, key, receiver) {\n            if (observer.doNotCollect(target, key, receiver)) {\n                return Reflect.get(target, key, receiver);\n            }\n            // The length and iterator properties need to be invoked on the original object\n            // (for Map and Set at least) or they will throw.\n            switch (toStringTag.call(target)) {\n                case '[object Array]':\n                    if (key === 'length' || isArrayIndex(key)) {\n                        observer.addCollectionDep(observerLocator.getArrayObserver(flags, target));\n                        return proxyOrValue(flags, target, key, observerLocator, observer);\n                    }\n                    break;\n                case '[object Map]':\n                    if (key === 'size') {\n                        observer.addCollectionDep(observerLocator.getMapObserver(flags, target));\n                        return Reflect.get(target, key, target);\n                    }\n                    break;\n                case '[object Set]':\n                    if (key === 'size') {\n                        observer.addCollectionDep(observerLocator.getSetObserver(flags, target));\n                        return Reflect.get(target, key, target);\n                    }\n                    break;\n            }\n            observer.addPropertyDep(observerLocator.getObserver(flags, target, key));\n            return proxyOrValue(flags, target, key, observerLocator, observer);\n        }\n    };\n}\n/**\n * _@param observer The owning observer of current evaluation, will subscribe to all observers created via proxy\n */\nfunction proxyOrValue(flags, target, key, observerLocator, observer) {\n    const value = Reflect.get(target, key, target);\n    if (typeof value !== 'object' || typeof value === 'function' || value === null) {\n        return value;\n    }\n    return new Proxy(value, createGetterTraps(flags, observerLocator, observer));\n}\n//# sourceMappingURL=computed-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DI, Reporter } from '@aurelia/kernel';\nimport { subscriberCollection } from './subscriber-collection';\nimport { IScheduler } from '@aurelia/scheduler';\nexport const IDirtyChecker = DI.createInterface('IDirtyChecker').withDefault(x => x.singleton(DirtyChecker));\nexport const DirtyCheckSettings = {\n    /**\n     * Default: `6`\n     *\n     * Adjust the global dirty check frequency.\n     * Measures in \"frames per check\", such that (given an FPS of 60):\n     * - A value of 1 will result in 60 dirty checks per second\n     * - A value of 6 will result in 10 dirty checks per second\n     */\n    framesPerCheck: 6,\n    /**\n     * Default: `false`\n     *\n     * Disable dirty-checking entirely. Properties that cannot be observed without dirty checking\n     * or an adapter, will simply not be observed.\n     */\n    disabled: false,\n    /**\n     * Default: `true`\n     *\n     * Log a warning message to the console if a property is being dirty-checked.\n     */\n    warn: true,\n    /**\n     * Default: `false`\n     *\n     * Throw an error if a property is being dirty-checked.\n     */\n    throw: false,\n    /**\n     * Resets all dirty checking settings to the framework's defaults.\n     */\n    resetToDefault() {\n        this.framesPerCheck = 6;\n        this.disabled = false;\n        this.warn = true;\n        this.throw = false;\n    }\n};\n/** @internal */\nlet DirtyChecker = class DirtyChecker {\n    constructor(scheduler) {\n        this.scheduler = scheduler;\n        this.tracked = [];\n        this.task = null;\n        this.elapsedFrames = 0;\n    }\n    createProperty(obj, propertyName) {\n        if (DirtyCheckSettings.throw) {\n            throw Reporter.error(800, propertyName); // TODO: create/organize error code\n        }\n        if (DirtyCheckSettings.warn) {\n            Reporter.write(801, propertyName);\n        }\n        return new DirtyCheckProperty(this, obj, propertyName);\n    }\n    addProperty(property) {\n        this.tracked.push(property);\n        if (this.tracked.length === 1) {\n            this.task = this.scheduler.queueRenderTask(() => this.check(), { persistent: true });\n        }\n    }\n    removeProperty(property) {\n        this.tracked.splice(this.tracked.indexOf(property), 1);\n        if (this.tracked.length === 0) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n    check(delta) {\n        if (DirtyCheckSettings.disabled) {\n            return;\n        }\n        if (++this.elapsedFrames < DirtyCheckSettings.framesPerCheck) {\n            return;\n        }\n        this.elapsedFrames = 0;\n        const tracked = this.tracked;\n        const len = tracked.length;\n        let current;\n        let i = 0;\n        for (; i < len; ++i) {\n            current = tracked[i];\n            if (current.isDirty()) {\n                current.flush(256 /* fromTick */);\n            }\n        }\n    }\n};\nDirtyChecker = __decorate([\n    __param(0, IScheduler),\n    __metadata(\"design:paramtypes\", [Object])\n], DirtyChecker);\nexport { DirtyChecker };\nlet DirtyCheckProperty = class DirtyCheckProperty {\n    constructor(dirtyChecker, obj, propertyKey) {\n        this.dirtyChecker = dirtyChecker;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n    }\n    isDirty() {\n        return this.oldValue !== this.obj[this.propertyKey];\n    }\n    flush(flags) {\n        const oldValue = this.oldValue;\n        const newValue = this.obj[this.propertyKey];\n        this.callSubscribers(newValue, oldValue, flags | 16 /* updateTargetInstance */);\n        this.oldValue = newValue;\n    }\n    subscribe(subscriber) {\n        if (!this.hasSubscribers()) {\n            this.oldValue = this.obj[this.propertyKey];\n            this.dirtyChecker.addProperty(this);\n        }\n        this.addSubscriber(subscriber);\n    }\n    unsubscribe(subscriber) {\n        if (this.removeSubscriber(subscriber) && !this.hasSubscribers()) {\n            this.dirtyChecker.removeProperty(this);\n        }\n    }\n};\nDirtyCheckProperty = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Object, String])\n], DirtyCheckProperty);\nexport { DirtyCheckProperty };\n//# sourceMappingURL=dirty-checker.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { subscriberCollection } from './subscriber-collection';\nlet CollectionSizeObserver = class CollectionSizeObserver {\n    constructor(obj) {\n        this.obj = obj;\n        this.currentValue = obj.size;\n    }\n    getValue() {\n        return this.obj.size;\n    }\n    setValue(newValue, flags) {\n        const { currentValue } = this;\n        if (newValue !== currentValue) {\n            this.currentValue = newValue;\n            this.callSubscribers(newValue, currentValue, flags | 16 /* updateTargetInstance */);\n        }\n    }\n};\nCollectionSizeObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object])\n], CollectionSizeObserver);\nexport { CollectionSizeObserver };\n//# sourceMappingURL=collection-size-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { ILifecycle } from '../lifecycle';\nimport { createIndexMap } from '../observation';\nimport { CollectionSizeObserver } from './collection-size-observer';\nimport { collectionSubscriberCollection } from './subscriber-collection';\nconst observerLookup = new WeakMap();\nconst proto = Map.prototype;\nconst $set = proto.set;\nconst $clear = proto.clear;\nconst $delete = proto.delete;\nconst native = { set: $set, clear: $clear, delete: $delete };\nconst methods = ['set', 'clear', 'delete'];\n// note: we can't really do much with Map due to the internal data structure not being accessible so we're just using the native calls\n// fortunately, map/delete/clear are easy to reconstruct for the indexMap\nconst observe = {\n    // https://tc39.github.io/ecma262/#sec-map.prototype.map\n    set: function (key, value) {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === undefined) {\n            $set.call($this, key, value);\n            return this;\n        }\n        const oldValue = $this.get(key);\n        const oldSize = $this.size;\n        $set.call($this, key, value);\n        const newSize = $this.size;\n        if (newSize === oldSize) {\n            let i = 0;\n            for (const entry of $this.entries()) {\n                if (entry[0] === key) {\n                    if (entry[1] !== oldValue) {\n                        o.indexMap.deletedItems.push(o.indexMap[i]);\n                        o.indexMap[i] = -2;\n                        o.notify();\n                    }\n                    return this;\n                }\n                i++;\n            }\n            return this;\n        }\n        o.indexMap[oldSize] = -2;\n        o.notify();\n        return this;\n    },\n    // https://tc39.github.io/ecma262/#sec-map.prototype.clear\n    clear: function () {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === undefined) {\n            return $clear.call($this);\n        }\n        const size = $this.size;\n        if (size > 0) {\n            const indexMap = o.indexMap;\n            let i = 0;\n            for (const entry of $this.keys()) {\n                if (indexMap[i] > -1) {\n                    indexMap.deletedItems.push(indexMap[i]);\n                }\n                i++;\n            }\n            $clear.call($this);\n            indexMap.length = 0;\n            o.notify();\n        }\n        return undefined;\n    },\n    // https://tc39.github.io/ecma262/#sec-map.prototype.delete\n    delete: function (value) {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === undefined) {\n            return $delete.call($this, value);\n        }\n        const size = $this.size;\n        if (size === 0) {\n            return false;\n        }\n        let i = 0;\n        const indexMap = o.indexMap;\n        for (const entry of $this.keys()) {\n            if (entry === value) {\n                if (indexMap[i] > -1) {\n                    indexMap.deletedItems.push(indexMap[i]);\n                }\n                indexMap.splice(i, 1);\n                const deleteResult = $delete.call($this, value);\n                if (deleteResult === true) {\n                    o.notify();\n                }\n                return deleteResult;\n            }\n            ++i;\n        }\n        return false;\n    }\n};\nconst descriptorProps = {\n    writable: true,\n    enumerable: false,\n    configurable: true\n};\nconst def = Reflect.defineProperty;\nfor (const method of methods) {\n    def(observe[method], 'observing', { value: true, writable: false, configurable: false, enumerable: false });\n}\nlet enableMapObservationCalled = false;\nexport function enableMapObservation() {\n    for (const method of methods) {\n        if (proto[method].observing !== true) {\n            def(proto, method, { ...descriptorProps, value: observe[method] });\n        }\n    }\n}\nexport function disableMapObservation() {\n    for (const method of methods) {\n        if (proto[method].observing === true) {\n            def(proto, method, { ...descriptorProps, value: native[method] });\n        }\n    }\n}\nconst slice = Array.prototype.slice;\nlet MapObserver = class MapObserver {\n    constructor(flags, lifecycle, map) {\n        if (!enableMapObservationCalled) {\n            enableMapObservationCalled = true;\n            enableMapObservation();\n        }\n        this.inBatch = false;\n        this.collection = map;\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        this.indexMap = createIndexMap(map.size);\n        this.lifecycle = lifecycle;\n        this.lengthObserver = (void 0);\n        observerLookup.set(map, this);\n    }\n    notify() {\n        if (this.lifecycle.batch.depth > 0) {\n            if (!this.inBatch) {\n                this.inBatch = true;\n                this.lifecycle.batch.add(this);\n            }\n        }\n        else {\n            this.flushBatch(0 /* none */);\n        }\n    }\n    getLengthObserver() {\n        if (this.lengthObserver === void 0) {\n            this.lengthObserver = new CollectionSizeObserver(this.collection);\n        }\n        return this.lengthObserver;\n    }\n    getIndexObserver(index) {\n        throw new Error('Map index observation not supported');\n    }\n    flushBatch(flags) {\n        this.inBatch = false;\n        const { indexMap, collection } = this;\n        const { size } = collection;\n        this.indexMap = createIndexMap(size);\n        this.callCollectionSubscribers(indexMap, 16 /* updateTargetInstance */ | this.persistentFlags);\n        if (this.lengthObserver !== void 0) {\n            this.lengthObserver.setValue(size, 16 /* updateTargetInstance */);\n        }\n    }\n};\nMapObserver = __decorate([\n    collectionSubscriberCollection(),\n    __metadata(\"design:paramtypes\", [Number, Object, Object])\n], MapObserver);\nexport { MapObserver };\nexport function getMapObserver(flags, lifecycle, map) {\n    const observer = observerLookup.get(map);\n    if (observer === void 0) {\n        return new MapObserver(flags, lifecycle, map);\n    }\n    return observer;\n}\n//# sourceMappingURL=map-observer.js.map","import { PLATFORM } from '@aurelia/kernel';\nconst slice = Array.prototype.slice;\nconst noop = PLATFORM.noop;\n// note: string.length is the only property of any primitive that is not a function,\n// so we can hardwire it to that and simply return undefined for anything else\n// note#2: a modified primitive constructor prototype would not work (and really, it shouldn't..)\nexport class PrimitiveObserver {\n    constructor(obj, propertyKey) {\n        this.doNotCache = true;\n        // we don't need to store propertyName because only 'length' can return a useful value\n        if (propertyKey === 'length') {\n            // deliberately not checking for typeof string as users probably still want to know via an error that their string is undefined\n            this.obj = obj;\n            this.getValue = this.getStringLength;\n        }\n        else {\n            this.getValue = this.returnUndefined;\n        }\n    }\n    getStringLength() {\n        return this.obj.length;\n    }\n    returnUndefined() {\n        return undefined;\n    }\n}\nPrimitiveObserver.prototype.setValue = noop;\nPrimitiveObserver.prototype.subscribe = noop;\nPrimitiveObserver.prototype.unsubscribe = noop;\nPrimitiveObserver.prototype.dispose = noop;\n//# sourceMappingURL=primitive-observer.js.map","export class PropertyAccessor {\n    constructor(obj, propertyKey) {\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        if (obj.$observers !== void 0\n            && obj.$observers[propertyKey] !== void 0\n            && obj.$observers[propertyKey].setValue !== void 0) {\n            this.setValue = this.setValueDirect;\n        }\n    }\n    getValue() {\n        return this.obj[this.propertyKey];\n    }\n    setValue(value, flags) {\n        this.obj[this.propertyKey] = value;\n    }\n    setValueDirect(value, flags) {\n        this.obj.$observers[this.propertyKey].setValue(value, flags);\n    }\n}\n//# sourceMappingURL=property-accessor.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { ILifecycle } from '../lifecycle';\nimport { createIndexMap } from '../observation';\nimport { CollectionSizeObserver } from './collection-size-observer';\nimport { collectionSubscriberCollection } from './subscriber-collection';\nconst observerLookup = new WeakMap();\nconst proto = Set.prototype;\nconst $add = proto.add;\nconst $clear = proto.clear;\nconst $delete = proto.delete;\nconst native = { add: $add, clear: $clear, delete: $delete };\nconst methods = ['add', 'clear', 'delete'];\n// note: we can't really do much with Set due to the internal data structure not being accessible so we're just using the native calls\n// fortunately, add/delete/clear are easy to reconstruct for the indexMap\nconst observe = {\n    // https://tc39.github.io/ecma262/#sec-set.prototype.add\n    add: function (value) {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === undefined) {\n            $add.call($this, value);\n            return this;\n        }\n        const oldSize = $this.size;\n        $add.call($this, value);\n        const newSize = $this.size;\n        if (newSize === oldSize) {\n            return this;\n        }\n        o.indexMap[oldSize] = -2;\n        o.notify();\n        return this;\n    },\n    // https://tc39.github.io/ecma262/#sec-set.prototype.clear\n    clear: function () {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === undefined) {\n            return $clear.call($this);\n        }\n        const size = $this.size;\n        if (size > 0) {\n            const indexMap = o.indexMap;\n            let i = 0;\n            for (const entry of $this.keys()) {\n                if (indexMap[i] > -1) {\n                    indexMap.deletedItems.push(indexMap[i]);\n                }\n                i++;\n            }\n            $clear.call($this);\n            indexMap.length = 0;\n            o.notify();\n        }\n        return undefined;\n    },\n    // https://tc39.github.io/ecma262/#sec-set.prototype.delete\n    delete: function (value) {\n        let $this = this;\n        if ($this.$raw !== undefined) {\n            $this = $this.$raw;\n        }\n        const o = observerLookup.get($this);\n        if (o === undefined) {\n            return $delete.call($this, value);\n        }\n        const size = $this.size;\n        if (size === 0) {\n            return false;\n        }\n        let i = 0;\n        const indexMap = o.indexMap;\n        for (const entry of $this.keys()) {\n            if (entry === value) {\n                if (indexMap[i] > -1) {\n                    indexMap.deletedItems.push(indexMap[i]);\n                }\n                indexMap.splice(i, 1);\n                const deleteResult = $delete.call($this, value);\n                if (deleteResult === true) {\n                    o.notify();\n                }\n                return deleteResult;\n            }\n            i++;\n        }\n        return false;\n    }\n};\nconst descriptorProps = {\n    writable: true,\n    enumerable: false,\n    configurable: true\n};\nconst def = Reflect.defineProperty;\nfor (const method of methods) {\n    def(observe[method], 'observing', { value: true, writable: false, configurable: false, enumerable: false });\n}\nlet enableSetObservationCalled = false;\nexport function enableSetObservation() {\n    for (const method of methods) {\n        if (proto[method].observing !== true) {\n            def(proto, method, { ...descriptorProps, value: observe[method] });\n        }\n    }\n}\nexport function disableSetObservation() {\n    for (const method of methods) {\n        if (proto[method].observing === true) {\n            def(proto, method, { ...descriptorProps, value: native[method] });\n        }\n    }\n}\nconst slice = Array.prototype.slice;\nlet SetObserver = class SetObserver {\n    constructor(flags, lifecycle, observedSet) {\n        if (!enableSetObservationCalled) {\n            enableSetObservationCalled = true;\n            enableSetObservation();\n        }\n        this.inBatch = false;\n        this.collection = observedSet;\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        this.indexMap = createIndexMap(observedSet.size);\n        this.lifecycle = lifecycle;\n        this.lengthObserver = (void 0);\n        observerLookup.set(observedSet, this);\n    }\n    notify() {\n        if (this.lifecycle.batch.depth > 0) {\n            if (!this.inBatch) {\n                this.inBatch = true;\n                this.lifecycle.batch.add(this);\n            }\n        }\n        else {\n            this.flushBatch(0 /* none */);\n        }\n    }\n    getLengthObserver() {\n        if (this.lengthObserver === void 0) {\n            this.lengthObserver = new CollectionSizeObserver(this.collection);\n        }\n        return this.lengthObserver;\n    }\n    getIndexObserver(index) {\n        throw new Error('Set index observation not supported');\n    }\n    flushBatch(flags) {\n        this.inBatch = false;\n        const { indexMap, collection } = this;\n        const { size } = collection;\n        this.indexMap = createIndexMap(size);\n        this.callCollectionSubscribers(indexMap, 16 /* updateTargetInstance */ | this.persistentFlags);\n        if (this.lengthObserver !== void 0) {\n            this.lengthObserver.setValue(size, 16 /* updateTargetInstance */);\n        }\n    }\n};\nSetObserver = __decorate([\n    collectionSubscriberCollection(),\n    __metadata(\"design:paramtypes\", [Number, Object, Object])\n], SetObserver);\nexport { SetObserver };\nexport function getSetObserver(flags, lifecycle, observedSet) {\n    const observer = observerLookup.get(observedSet);\n    if (observer === void 0) {\n        return new SetObserver(flags, lifecycle, observedSet);\n    }\n    return observer;\n}\n//# sourceMappingURL=set-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DI, Registration, Reporter, isArrayIndex, } from '@aurelia/kernel';\nimport { ILifecycle } from '../lifecycle';\nimport { getArrayObserver } from './array-observer';\nimport { createComputedObserver } from './computed-observer';\nimport { IDirtyChecker } from './dirty-checker';\nimport { getMapObserver } from './map-observer';\nimport { PrimitiveObserver } from './primitive-observer';\nimport { PropertyAccessor } from './property-accessor';\nimport { ProxyObserver } from './proxy-observer';\nimport { getSetObserver } from './set-observer';\nimport { SetterObserver } from './setter-observer';\nimport { IScheduler } from '@aurelia/scheduler';\nconst toStringTag = Object.prototype.toString;\nexport const IObserverLocator = DI.createInterface('IObserverLocator').noDefault();\nexport const ITargetObserverLocator = DI.createInterface('ITargetObserverLocator').noDefault();\nexport const ITargetAccessorLocator = DI.createInterface('ITargetAccessorLocator').noDefault();\nfunction getPropertyDescriptor(subject, name) {\n    let pd = Object.getOwnPropertyDescriptor(subject, name);\n    let proto = Object.getPrototypeOf(subject);\n    while (pd == null && proto != null) {\n        pd = Object.getOwnPropertyDescriptor(proto, name);\n        proto = Object.getPrototypeOf(proto);\n    }\n    return pd;\n}\n/** @internal */\nlet ObserverLocator = class ObserverLocator {\n    constructor(lifecycle, scheduler, dirtyChecker, targetObserverLocator, targetAccessorLocator) {\n        this.lifecycle = lifecycle;\n        this.scheduler = scheduler;\n        this.dirtyChecker = dirtyChecker;\n        this.targetObserverLocator = targetObserverLocator;\n        this.targetAccessorLocator = targetAccessorLocator;\n        this.adapters = [];\n    }\n    static register(container) {\n        return Registration.singleton(IObserverLocator, this).register(container);\n    }\n    getObserver(flags, obj, propertyName) {\n        if (flags & 2 /* proxyStrategy */ && typeof obj === 'object') {\n            return ProxyObserver.getOrCreate(obj, propertyName); // TODO: fix typings (and ensure proper contracts ofc)\n        }\n        if (isBindingContext(obj)) {\n            return obj.getObservers(flags).getOrCreate(this.lifecycle, flags, obj, propertyName);\n        }\n        let observersLookup = obj.$observers;\n        if (observersLookup && propertyName in observersLookup) {\n            return observersLookup[propertyName];\n        }\n        const observer = this.createPropertyObserver(flags, obj, propertyName);\n        if (!observer.doNotCache) {\n            if (observersLookup === void 0) {\n                observersLookup = this.getOrCreateObserversLookup(obj);\n            }\n            observersLookup[propertyName] = observer;\n        }\n        return observer;\n    }\n    addAdapter(adapter) {\n        this.adapters.push(adapter);\n    }\n    getAccessor(flags, obj, propertyName) {\n        if (this.targetAccessorLocator.handles(flags, obj)) {\n            if (this.targetObserverLocator.overridesAccessor(flags, obj, propertyName)) {\n                return this.getObserver(flags, obj, propertyName);\n            }\n            return this.targetAccessorLocator.getAccessor(flags, this.scheduler, this.lifecycle, obj, propertyName);\n        }\n        if (flags & 2 /* proxyStrategy */) {\n            return ProxyObserver.getOrCreate(obj, propertyName);\n        }\n        return new PropertyAccessor(obj, propertyName);\n    }\n    getArrayObserver(flags, observedArray) {\n        return getArrayObserver(flags, this.lifecycle, observedArray);\n    }\n    getMapObserver(flags, observedMap) {\n        return getMapObserver(flags, this.lifecycle, observedMap);\n    }\n    getSetObserver(flags, observedSet) {\n        return getSetObserver(flags, this.lifecycle, observedSet);\n    }\n    getOrCreateObserversLookup(obj) {\n        return obj.$observers || this.createObserversLookup(obj);\n    }\n    createObserversLookup(obj) {\n        const value = {};\n        if (!Reflect.defineProperty(obj, '$observers', {\n            enumerable: false,\n            configurable: false,\n            writable: false,\n            value: value\n        })) {\n            Reporter.write(0, obj);\n        }\n        return value;\n    }\n    getAdapterObserver(flags, obj, propertyName, descriptor) {\n        for (let i = 0, ii = this.adapters.length; i < ii; i++) {\n            const adapter = this.adapters[i];\n            const observer = adapter.getObserver(flags, obj, propertyName, descriptor);\n            if (observer != null) {\n                return observer;\n            }\n        }\n        return null;\n    }\n    createPropertyObserver(flags, obj, propertyName) {\n        if (!(obj instanceof Object)) {\n            return new PrimitiveObserver(obj, propertyName);\n        }\n        let isNode = false;\n        if (this.targetObserverLocator.handles(flags, obj)) {\n            const observer = this.targetObserverLocator.getObserver(flags, this.scheduler, this.lifecycle, this, obj, propertyName);\n            if (observer != null) {\n                return observer;\n            }\n            isNode = true;\n        }\n        const tag = toStringTag.call(obj);\n        switch (tag) {\n            case '[object Array]':\n                if (propertyName === 'length') {\n                    return this.getArrayObserver(flags, obj).getLengthObserver();\n                }\n                // is numer only returns true for integer\n                if (isArrayIndex(propertyName)) {\n                    return this.getArrayObserver(flags, obj).getIndexObserver(Number(propertyName));\n                }\n                break;\n            case '[object Map]':\n                if (propertyName === 'size') {\n                    return this.getMapObserver(flags, obj).getLengthObserver();\n                }\n                break;\n            case '[object Set]':\n                if (propertyName === 'size') {\n                    return this.getSetObserver(flags, obj).getLengthObserver();\n                }\n                break;\n        }\n        const descriptor = getPropertyDescriptor(obj, propertyName);\n        if (descriptor != null && (descriptor.get != null || descriptor.set != null)) {\n            if (descriptor.get != null && descriptor.get.getObserver != null) {\n                return descriptor.get.getObserver(obj);\n            }\n            // attempt to use an adapter before resorting to dirty checking.\n            const adapterObserver = this.getAdapterObserver(flags, obj, propertyName, descriptor);\n            if (adapterObserver != null) {\n                return adapterObserver;\n            }\n            if (isNode) {\n                // TODO: use MutationObserver\n                return this.dirtyChecker.createProperty(obj, propertyName);\n            }\n            return createComputedObserver(flags, this, this.dirtyChecker, this.lifecycle, obj, propertyName, descriptor);\n        }\n        return new SetterObserver(this.lifecycle, flags, obj, propertyName);\n    }\n};\nObserverLocator = __decorate([\n    __param(0, ILifecycle),\n    __param(1, IScheduler),\n    __param(2, IDirtyChecker),\n    __param(3, ITargetObserverLocator),\n    __param(4, ITargetAccessorLocator),\n    __metadata(\"design:paramtypes\", [Object, Object, Object, Object, Object])\n], ObserverLocator);\nexport { ObserverLocator };\nexport function getCollectionObserver(flags, lifecycle, collection) {\n    // If the collection is wrapped by a proxy then `$observer` will return the proxy observer instead of the collection observer, which is not what we want\n    // when we ask for getCollectionObserver\n    const rawCollection = collection instanceof Object ? ProxyObserver.getRawIfProxy(collection) : collection;\n    switch (toStringTag.call(collection)) {\n        case '[object Array]':\n            return getArrayObserver(flags, lifecycle, rawCollection);\n        case '[object Map]':\n            return getMapObserver(flags, lifecycle, rawCollection);\n        case '[object Set]':\n            return getSetObserver(flags, lifecycle, rawCollection);\n    }\n    return void 0;\n}\nfunction isBindingContext(obj) {\n    return obj.$synthetic === true;\n}\n//# sourceMappingURL=observer-locator.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { IServiceLocator, Reporter, } from '@aurelia/kernel';\nimport { BindingMode, } from '../flags';\nimport { ILifecycle } from '../lifecycle';\nimport { IObserverLocator } from '../observation/observer-locator';\nimport { hasBind, hasUnbind, } from './ast';\nimport { connectable, } from './connectable';\n// BindingMode is not a const enum (and therefore not inlined), so assigning them to a variable to save a member accessor is a minor perf tweak\nconst { oneTime, toView, fromView } = BindingMode;\n// pre-combining flags for bitwise checks is a minor perf tweak\nconst toViewOrOneTime = toView | oneTime;\nlet PropertyBinding = class PropertyBinding {\n    constructor(sourceExpression, target, targetProperty, mode, observerLocator, locator) {\n        this.sourceExpression = sourceExpression;\n        this.target = target;\n        this.targetProperty = targetProperty;\n        this.mode = mode;\n        this.observerLocator = observerLocator;\n        this.locator = locator;\n        this.interceptor = this;\n        this.$state = 0 /* none */;\n        this.$scope = void 0;\n        this.targetObserver = void 0;\n        this.persistentFlags = 0 /* none */;\n        connectable.assignIdTo(this);\n        this.$lifecycle = locator.get(ILifecycle);\n    }\n    ;\n    updateTarget(value, flags) {\n        flags |= this.persistentFlags;\n        this.targetObserver.setValue(value, flags);\n    }\n    updateSource(value, flags) {\n        flags |= this.persistentFlags;\n        this.sourceExpression.assign(flags, this.$scope, this.locator, value, this.part);\n    }\n    handleChange(newValue, _previousValue, flags) {\n        if ((this.$state & 4 /* isBound */) === 0) {\n            return;\n        }\n        flags |= this.persistentFlags;\n        if ((flags & 16 /* updateTargetInstance */) > 0) {\n            const previousValue = this.targetObserver.getValue();\n            // if the only observable is an AccessScope then we can assume the passed-in newValue is the correct and latest value\n            if (this.sourceExpression.$kind !== 10082 /* AccessScope */ || this.observerSlots > 1) {\n                newValue = this.sourceExpression.evaluate(flags, this.$scope, this.locator, this.part);\n            }\n            if (newValue !== previousValue) {\n                this.interceptor.updateTarget(newValue, flags);\n            }\n            if ((this.mode & oneTime) === 0) {\n                this.version++;\n                this.sourceExpression.connect(flags, this.$scope, this.interceptor, this.part);\n                this.interceptor.unobserve(false);\n            }\n            return;\n        }\n        if ((flags & 32 /* updateSourceExpression */) > 0) {\n            if (newValue !== this.sourceExpression.evaluate(flags, this.$scope, this.locator, this.part)) {\n                this.interceptor.updateSource(newValue, flags);\n            }\n            return;\n        }\n        throw Reporter.error(15, flags);\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags | 4096 /* fromBind */);\n        }\n        // add isBinding flag\n        this.$state |= 1 /* isBinding */;\n        // Force property binding to always be strict\n        flags |= 4 /* isStrictBindingStrategy */;\n        // Store flags which we can only receive during $bind and need to pass on\n        // to the AST during evaluate/connect/assign\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        this.$scope = scope;\n        this.part = part;\n        let sourceExpression = this.sourceExpression;\n        if (hasBind(sourceExpression)) {\n            sourceExpression.bind(flags, scope, this.interceptor);\n        }\n        let targetObserver = this.targetObserver;\n        if (!targetObserver) {\n            if (this.mode & fromView) {\n                targetObserver = this.targetObserver = this.observerLocator.getObserver(flags, this.target, this.targetProperty);\n            }\n            else {\n                targetObserver = this.targetObserver = this.observerLocator.getAccessor(flags, this.target, this.targetProperty);\n            }\n        }\n        if (this.mode !== BindingMode.oneTime && targetObserver.bind) {\n            targetObserver.bind(flags);\n        }\n        // during bind, binding behavior might have changed sourceExpression\n        sourceExpression = this.sourceExpression;\n        if (this.mode & toViewOrOneTime) {\n            this.interceptor.updateTarget(sourceExpression.evaluate(flags, scope, this.locator, part), flags);\n        }\n        if (this.mode & toView) {\n            sourceExpression.connect(flags, scope, this.interceptor, part);\n        }\n        if (this.mode & fromView) {\n            targetObserver.subscribe(this.interceptor);\n            if ((this.mode & toView) === 0) {\n                this.interceptor.updateSource(targetObserver.getValue(), flags);\n            }\n            targetObserver[this.id] |= 32 /* updateSourceExpression */;\n        }\n        // add isBound flag and remove isBinding flag\n        this.$state |= 4 /* isBound */;\n        this.$state &= ~1 /* isBinding */;\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        // add isUnbinding flag\n        this.$state |= 2 /* isUnbinding */;\n        // clear persistent flags\n        this.persistentFlags = 0 /* none */;\n        if (hasUnbind(this.sourceExpression)) {\n            this.sourceExpression.unbind(flags, this.$scope, this.interceptor);\n        }\n        this.$scope = void 0;\n        if (this.targetObserver.unbind) {\n            this.targetObserver.unbind(flags);\n        }\n        if (this.targetObserver.unsubscribe) {\n            this.targetObserver.unsubscribe(this.interceptor);\n            this.targetObserver[this.id] &= ~32 /* updateSourceExpression */;\n        }\n        this.interceptor.unobserve(true);\n        // remove isBound and isUnbinding flags\n        this.$state &= ~(4 /* isBound */ | 2 /* isUnbinding */);\n    }\n};\nPropertyBinding = __decorate([\n    connectable(),\n    __metadata(\"design:paramtypes\", [Object, Object, String, Number, Object, Object])\n], PropertyBinding);\nexport { PropertyBinding };\n//# sourceMappingURL=property-binding.js.map","import { hasBind, hasUnbind, } from './ast';\nexport class CallBinding {\n    constructor(sourceExpression, target, targetProperty, observerLocator, locator) {\n        this.sourceExpression = sourceExpression;\n        this.locator = locator;\n        this.interceptor = this;\n        this.$state = 0 /* none */;\n        this.targetObserver = observerLocator.getObserver(0 /* none */, target, targetProperty);\n    }\n    callSource(args) {\n        const overrideContext = this.$scope.overrideContext;\n        Object.assign(overrideContext, args);\n        const result = this.sourceExpression.evaluate(2097152 /* mustEvaluate */, this.$scope, this.locator, this.part);\n        for (const prop in args) {\n            Reflect.deleteProperty(overrideContext, prop);\n        }\n        return result;\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags | 4096 /* fromBind */);\n        }\n        // add isBinding flag\n        this.$state |= 1 /* isBinding */;\n        this.$scope = scope;\n        this.part = part;\n        if (hasBind(this.sourceExpression)) {\n            this.sourceExpression.bind(flags, scope, this.interceptor);\n        }\n        this.targetObserver.setValue(($args) => this.interceptor.callSource($args), flags);\n        // add isBound flag and remove isBinding flag\n        this.$state |= 4 /* isBound */;\n        this.$state &= ~1 /* isBinding */;\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        // add isUnbinding flag\n        this.$state |= 2 /* isUnbinding */;\n        if (hasUnbind(this.sourceExpression)) {\n            this.sourceExpression.unbind(flags, this.$scope, this.interceptor);\n        }\n        this.$scope = void 0;\n        this.targetObserver.setValue(null, flags);\n        // remove isBound and isUnbinding flags\n        this.$state &= ~(4 /* isBound */ | 2 /* isUnbinding */);\n    }\n    observeProperty(flags, obj, propertyName) {\n        return;\n    }\n    handleChange(newValue, previousValue, flags) {\n        return;\n    }\n}\n//# sourceMappingURL=call-binding.js.map","import { DI, PLATFORM, Reporter, } from '@aurelia/kernel';\nimport { AccessMemberExpression, AccessScopeExpression, CallMemberExpression, CallScopeExpression, PrimitiveLiteralExpression, } from './ast';\nexport const IExpressionParser = DI.createInterface('IExpressionParser').withDefault(x => x.singleton(ExpressionParser));\n/** @internal */\nexport class ExpressionParser {\n    constructor() {\n        this.expressionLookup = Object.create(null);\n        this.forOfLookup = Object.create(null);\n        this.interpolationLookup = Object.create(null);\n    }\n    parse(expression, bindingType) {\n        switch (bindingType) {\n            case 2048 /* Interpolation */: {\n                let found = this.interpolationLookup[expression];\n                if (found === void 0) {\n                    found = this.interpolationLookup[expression] = this.parseCore(expression, bindingType);\n                }\n                return found;\n            }\n            case 539 /* ForCommand */: {\n                let found = this.forOfLookup[expression];\n                if (found === void 0) {\n                    found = this.forOfLookup[expression] = this.parseCore(expression, bindingType);\n                }\n                return found;\n            }\n            default: {\n                // Allow empty strings for normal bindings and those that are empty by default (such as a custom attribute without an equals sign)\n                // But don't cache it, because empty strings are always invalid for any other type of binding\n                if (expression.length === 0 && (bindingType & (53 /* BindCommand */ | 49 /* OneTimeCommand */ | 50 /* ToViewCommand */))) {\n                    return PrimitiveLiteralExpression.$empty;\n                }\n                let found = this.expressionLookup[expression];\n                if (found === void 0) {\n                    found = this.expressionLookup[expression] = this.parseCore(expression, bindingType);\n                }\n                return found;\n            }\n        }\n    }\n    cache(expressions) {\n        const { forOfLookup, expressionLookup, interpolationLookup } = this;\n        for (const expression in expressions) {\n            const expr = expressions[expression];\n            switch (expr.$kind) {\n                case 24 /* Interpolation */:\n                    interpolationLookup[expression] = expr;\n                    break;\n                case 6199 /* ForOfStatement */:\n                    forOfLookup[expression] = expr;\n                    break;\n                default:\n                    expressionLookup[expression] = expr;\n            }\n        }\n    }\n    parseCore(expression, bindingType) {\n        try {\n            const parts = expression.split('.');\n            const firstPart = parts[0];\n            let current;\n            if (firstPart.endsWith('()')) {\n                current = new CallScopeExpression(firstPart.replace('()', ''), PLATFORM.emptyArray);\n            }\n            else {\n                current = new AccessScopeExpression(parts[0]);\n            }\n            let index = 1;\n            while (index < parts.length) {\n                const currentPart = parts[index];\n                if (currentPart.endsWith('()')) {\n                    current = new CallMemberExpression(current, currentPart.replace('()', ''), PLATFORM.emptyArray);\n                }\n                else {\n                    current = new AccessMemberExpression(current, parts[index]);\n                }\n                index++;\n            }\n            return current;\n        }\n        catch (e) {\n            throw Reporter.error(3, e);\n        }\n    }\n}\n/* eslint-disable @typescript-eslint/indent */\nexport var BindingType;\n(function (BindingType) {\n    BindingType[BindingType[\"None\"] = 0] = \"None\";\n    BindingType[BindingType[\"IgnoreCustomAttr\"] = 4096] = \"IgnoreCustomAttr\";\n    BindingType[BindingType[\"Interpolation\"] = 2048] = \"Interpolation\";\n    BindingType[BindingType[\"IsRef\"] = 5376] = \"IsRef\";\n    BindingType[BindingType[\"IsIterator\"] = 512] = \"IsIterator\";\n    BindingType[BindingType[\"IsCustom\"] = 256] = \"IsCustom\";\n    BindingType[BindingType[\"IsFunction\"] = 128] = \"IsFunction\";\n    BindingType[BindingType[\"IsEvent\"] = 64] = \"IsEvent\";\n    BindingType[BindingType[\"IsProperty\"] = 32] = \"IsProperty\";\n    BindingType[BindingType[\"IsCommand\"] = 16] = \"IsCommand\";\n    BindingType[BindingType[\"IsPropertyCommand\"] = 48] = \"IsPropertyCommand\";\n    BindingType[BindingType[\"IsEventCommand\"] = 80] = \"IsEventCommand\";\n    BindingType[BindingType[\"DelegationStrategyDelta\"] = 6] = \"DelegationStrategyDelta\";\n    BindingType[BindingType[\"Command\"] = 15] = \"Command\";\n    BindingType[BindingType[\"OneTimeCommand\"] = 49] = \"OneTimeCommand\";\n    BindingType[BindingType[\"ToViewCommand\"] = 50] = \"ToViewCommand\";\n    BindingType[BindingType[\"FromViewCommand\"] = 51] = \"FromViewCommand\";\n    BindingType[BindingType[\"TwoWayCommand\"] = 52] = \"TwoWayCommand\";\n    BindingType[BindingType[\"BindCommand\"] = 53] = \"BindCommand\";\n    BindingType[BindingType[\"TriggerCommand\"] = 4182] = \"TriggerCommand\";\n    BindingType[BindingType[\"CaptureCommand\"] = 4183] = \"CaptureCommand\";\n    BindingType[BindingType[\"DelegateCommand\"] = 4184] = \"DelegateCommand\";\n    BindingType[BindingType[\"CallCommand\"] = 153] = \"CallCommand\";\n    BindingType[BindingType[\"OptionsCommand\"] = 26] = \"OptionsCommand\";\n    BindingType[BindingType[\"ForCommand\"] = 539] = \"ForCommand\";\n    BindingType[BindingType[\"CustomCommand\"] = 284] = \"CustomCommand\";\n})(BindingType || (BindingType = {}));\n/* eslint-enable @typescript-eslint/indent */\n//# sourceMappingURL=expression-parser.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { IServiceLocator } from '@aurelia/kernel';\nimport { BindingMode, } from '../flags';\nimport { IObserverLocator } from '../observation/observer-locator';\nimport { connectable, } from './connectable';\nconst { toView, oneTime } = BindingMode;\nexport class MultiInterpolationBinding {\n    constructor(observerLocator, interpolation, target, targetProperty, mode, locator) {\n        this.observerLocator = observerLocator;\n        this.interpolation = interpolation;\n        this.target = target;\n        this.targetProperty = targetProperty;\n        this.mode = mode;\n        this.locator = locator;\n        this.interceptor = this;\n        this.$state = 0 /* none */;\n        this.$scope = void 0;\n        // Note: the child expressions of an Interpolation expression are full Aurelia expressions, meaning they may include\n        // value converters and binding behaviors.\n        // Each expression represents one ${interpolation}, and for each we create a child TextBinding unless there is only one,\n        // in which case the renderer will create the TextBinding directly\n        const expressions = interpolation.expressions;\n        const parts = this.parts = Array(expressions.length);\n        for (let i = 0, ii = expressions.length; i < ii; ++i) {\n            parts[i] = new InterpolationBinding(expressions[i], interpolation, target, targetProperty, mode, observerLocator, locator, i === 0);\n        }\n    }\n    ;\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags);\n        }\n        this.$state |= 4 /* isBound */;\n        this.$scope = scope;\n        this.part = part;\n        const parts = this.parts;\n        for (let i = 0, ii = parts.length; i < ii; ++i) {\n            parts[i].interceptor.$bind(flags, scope, part);\n        }\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        this.$state &= ~4 /* isBound */;\n        this.$scope = void 0;\n        const parts = this.parts;\n        for (let i = 0, ii = parts.length; i < ii; ++i) {\n            parts[i].interceptor.$unbind(flags);\n        }\n    }\n}\nlet InterpolationBinding = class InterpolationBinding {\n    constructor(sourceExpression, interpolation, target, targetProperty, mode, observerLocator, locator, isFirst) {\n        this.sourceExpression = sourceExpression;\n        this.interpolation = interpolation;\n        this.target = target;\n        this.targetProperty = targetProperty;\n        this.mode = mode;\n        this.observerLocator = observerLocator;\n        this.locator = locator;\n        this.isFirst = isFirst;\n        this.interceptor = this;\n        this.$state = 0 /* none */;\n        connectable.assignIdTo(this);\n        this.targetObserver = observerLocator.getAccessor(0 /* none */, target, targetProperty);\n    }\n    updateTarget(value, flags) {\n        this.targetObserver.setValue(value, flags | 16 /* updateTargetInstance */);\n    }\n    handleChange(_newValue, _previousValue, flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        const previousValue = this.targetObserver.getValue();\n        const newValue = this.interpolation.evaluate(flags, this.$scope, this.locator, this.part);\n        if (newValue !== previousValue) {\n            this.interceptor.updateTarget(newValue, flags);\n        }\n        if ((this.mode & oneTime) === 0) {\n            this.version++;\n            this.sourceExpression.connect(flags, this.$scope, this.interceptor, this.part);\n            this.interceptor.unobserve(false);\n        }\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags);\n        }\n        this.$state |= 4 /* isBound */;\n        this.$scope = scope;\n        this.part = part;\n        const sourceExpression = this.sourceExpression;\n        if (sourceExpression.bind) {\n            sourceExpression.bind(flags, scope, this.interceptor);\n        }\n        if (this.mode !== BindingMode.oneTime && this.targetObserver.bind) {\n            this.targetObserver.bind(flags);\n        }\n        // since the interpolation already gets the whole value, we only need to let the first\n        // text binding do the update if there are multiple\n        if (this.isFirst) {\n            this.interceptor.updateTarget(this.interpolation.evaluate(flags, scope, this.locator, part), flags);\n        }\n        if (this.mode & toView) {\n            sourceExpression.connect(flags, scope, this.interceptor, part);\n        }\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        this.$state &= ~4 /* isBound */;\n        const sourceExpression = this.sourceExpression;\n        if (sourceExpression.unbind) {\n            sourceExpression.unbind(flags, this.$scope, this.interceptor);\n        }\n        if (this.targetObserver.unbind) {\n            this.targetObserver.unbind(flags);\n        }\n        this.$scope = void 0;\n        this.interceptor.unobserve(true);\n    }\n};\nInterpolationBinding = __decorate([\n    connectable(),\n    __metadata(\"design:paramtypes\", [Object, Object, Object, String, Number, Object, Object, Boolean])\n], InterpolationBinding);\nexport { InterpolationBinding };\n//# sourceMappingURL=interpolation-binding.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { IServiceLocator, Reporter, } from '@aurelia/kernel';\nimport { ILifecycle, } from '../lifecycle';\nimport { IObserverLocator } from '../observation/observer-locator';\nimport { connectable, } from './connectable';\nlet LetBinding = class LetBinding {\n    constructor(sourceExpression, targetProperty, observerLocator, locator, toBindingContext = false) {\n        this.sourceExpression = sourceExpression;\n        this.targetProperty = targetProperty;\n        this.observerLocator = observerLocator;\n        this.locator = locator;\n        this.toBindingContext = toBindingContext;\n        this.interceptor = this;\n        this.$state = 0 /* none */;\n        this.$scope = void 0;\n        this.target = null;\n        connectable.assignIdTo(this);\n        this.$lifecycle = locator.get(ILifecycle);\n    }\n    handleChange(_newValue, _previousValue, flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        if (flags & 16 /* updateTargetInstance */) {\n            const { target, targetProperty } = this;\n            const previousValue = target[targetProperty];\n            const newValue = this.sourceExpression.evaluate(flags, this.$scope, this.locator, this.part);\n            if (newValue !== previousValue) {\n                target[targetProperty] = newValue;\n            }\n            return;\n        }\n        throw Reporter.error(15, flags);\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags | 4096 /* fromBind */);\n        }\n        // add isBinding flag\n        this.$state |= 1 /* isBinding */;\n        this.$scope = scope;\n        this.part = part;\n        this.target = (this.toBindingContext ? scope.bindingContext : scope.overrideContext);\n        const sourceExpression = this.sourceExpression;\n        if (sourceExpression.bind) {\n            sourceExpression.bind(flags, scope, this.interceptor);\n        }\n        // sourceExpression might have been changed during bind\n        this.target[this.targetProperty] = this.sourceExpression.evaluate(flags | 4096 /* fromBind */, scope, this.locator, part);\n        this.sourceExpression.connect(flags, scope, this.interceptor, part);\n        // add isBound flag and remove isBinding flag\n        this.$state |= 4 /* isBound */;\n        this.$state &= ~1 /* isBinding */;\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        // add isUnbinding flag\n        this.$state |= 2 /* isUnbinding */;\n        const sourceExpression = this.sourceExpression;\n        if (sourceExpression.unbind) {\n            sourceExpression.unbind(flags, this.$scope, this.interceptor);\n        }\n        this.$scope = void 0;\n        this.interceptor.unobserve(true);\n        // remove isBound and isUnbinding flags\n        this.$state &= ~(4 /* isBound */ | 2 /* isUnbinding */);\n    }\n};\nLetBinding = __decorate([\n    connectable(),\n    __metadata(\"design:paramtypes\", [Object, String, Object, Object, Boolean])\n], LetBinding);\nexport { LetBinding };\n//# sourceMappingURL=let-binding.js.map","import { hasBind, hasUnbind, } from './ast';\nexport class RefBinding {\n    constructor(sourceExpression, target, locator) {\n        this.sourceExpression = sourceExpression;\n        this.target = target;\n        this.locator = locator;\n        this.interceptor = this;\n        this.$state = 0 /* none */;\n        this.$scope = void 0;\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags | 4096 /* fromBind */);\n        }\n        // add isBinding flag\n        this.$state |= 1 /* isBinding */;\n        this.$scope = scope;\n        this.part = part;\n        if (hasBind(this.sourceExpression)) {\n            this.sourceExpression.bind(flags, scope, this);\n        }\n        this.sourceExpression.assign(flags | 32 /* updateSourceExpression */, this.$scope, this.locator, this.target, part);\n        // add isBound flag and remove isBinding flag\n        this.$state |= 4 /* isBound */;\n        this.$state &= ~1 /* isBinding */;\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        // add isUnbinding flag\n        this.$state |= 2 /* isUnbinding */;\n        let sourceExpression = this.sourceExpression;\n        if (sourceExpression.evaluate(flags, this.$scope, this.locator, this.part) === this.target) {\n            sourceExpression.assign(flags, this.$scope, this.locator, null, this.part);\n        }\n        // source expression might have been modified durring assign, via a BB\n        sourceExpression = this.sourceExpression;\n        if (hasUnbind(sourceExpression)) {\n            sourceExpression.unbind(flags, this.$scope, this.interceptor);\n        }\n        this.$scope = void 0;\n        // remove isBound and isUnbinding flags\n        this.$state &= ~(4 /* isBound */ | 2 /* isUnbinding */);\n    }\n    observeProperty(flags, obj, propertyName) {\n        return;\n    }\n    handleChange(newValue, previousValue, flags) {\n        return;\n    }\n}\n//# sourceMappingURL=ref-binding.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar BindableObserver_1;\nimport { Reporter, PLATFORM } from '@aurelia/kernel';\nimport { ILifecycle } from '../lifecycle';\nimport { ProxyObserver } from './proxy-observer';\nimport { subscriberCollection } from './subscriber-collection';\nlet BindableObserver = BindableObserver_1 = class BindableObserver {\n    constructor(lifecycle, flags, obj, propertyKey, cbName, $set) {\n        this.lifecycle = lifecycle;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.$set = $set;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.inBatch = false;\n        let isProxy = false;\n        if (ProxyObserver.isProxy(obj)) {\n            isProxy = true;\n            obj.$observer.subscribe(this, propertyKey);\n            this.obj = obj.$raw;\n        }\n        this.callback = this.obj[cbName];\n        const propertyChangedCallback = this.propertyChangedCallback = this.obj.propertyChanged;\n        const hasPropertyChangedCallback = this.hasPropertyChangedCallback = typeof propertyChangedCallback === 'function';\n        const shouldInterceptSet = this.shouldInterceptSet = $set !== PLATFORM.noop;\n        // when user declare @bindable({ set })\n        // it's expected to work from the start,\n        // regardless where the assignment comes from: either direct view model assignment or from binding during render\n        // so if either getter/setter config is present, alter the accessor straight await\n        if (this.callback === void 0 && !hasPropertyChangedCallback && !shouldInterceptSet) {\n            this.observing = false;\n        }\n        else {\n            this.observing = true;\n            const currentValue = obj[propertyKey];\n            this.currentValue = shouldInterceptSet && currentValue !== void 0\n                ? $set(currentValue)\n                : currentValue;\n            if (!isProxy) {\n                this.createGetterSetter();\n            }\n        }\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n    }\n    handleChange(newValue, oldValue, flags) {\n        this.setValue(newValue, flags);\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        if (this.shouldInterceptSet) {\n            newValue = this.$set(newValue);\n        }\n        if (this.observing) {\n            const currentValue = this.currentValue;\n            // eslint-disable-next-line compat/compat\n            if (Object.is(newValue, currentValue)) {\n                return;\n            }\n            this.currentValue = newValue;\n            if (this.lifecycle.batch.depth === 0) {\n                this.callSubscribers(newValue, currentValue, this.persistentFlags | flags);\n                if ((flags & 4096 /* fromBind */) === 0 || (flags & 32 /* updateSourceExpression */) > 0) {\n                    const callback = this.callback;\n                    if (callback !== void 0) {\n                        callback.call(this.obj, newValue, currentValue, this.persistentFlags | flags);\n                    }\n                    if (this.hasPropertyChangedCallback) {\n                        // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n                        this.propertyChangedCallback.call(this.obj, this.propertyKey, newValue, currentValue, this.persistentFlags | flags);\n                    }\n                }\n            }\n            else if (!this.inBatch) {\n                this.inBatch = true;\n                this.oldValue = currentValue;\n                this.lifecycle.batch.add(this);\n            }\n        }\n        else {\n            // See SetterObserver.setValue for explanation\n            this.obj[this.propertyKey] = newValue;\n        }\n    }\n    subscribe(subscriber) {\n        if (this.observing === false) {\n            this.observing = true;\n            const currentValue = this.obj[this.propertyKey];\n            this.currentValue = this.shouldInterceptSet\n                ? this.$set(currentValue)\n                : currentValue;\n            this.createGetterSetter();\n        }\n        this.addSubscriber(subscriber);\n    }\n    createGetterSetter() {\n        if (!Reflect.defineProperty(this.obj, this.propertyKey, {\n            enumerable: true,\n            configurable: true,\n            get: () => this.currentValue,\n            set: (value) => {\n                this.setValue(value, 0 /* none */);\n            }\n        })) {\n            Reporter.write(1, this.propertyKey, this.obj);\n        }\n    }\n};\nBindableObserver = BindableObserver_1 = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Number, Object, String, String, Function])\n], BindableObserver);\nexport { BindableObserver };\n//# sourceMappingURL=bindable-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { BindingMode } from '../../flags';\nimport { bindingBehavior } from '../binding-behavior';\nexport class BindingModeBehavior {\n    constructor(mode) {\n        this.mode = mode;\n        this.originalModes = new WeakMap();\n    }\n    bind(flags, scope, binding) {\n        this.originalModes.set(binding, binding.mode);\n        binding.mode = this.mode;\n    }\n    unbind(flags, scope, binding) {\n        binding.mode = this.originalModes.get(binding);\n    }\n}\nlet OneTimeBindingBehavior = class OneTimeBindingBehavior extends BindingModeBehavior {\n    constructor() {\n        super(BindingMode.oneTime);\n    }\n};\nOneTimeBindingBehavior = __decorate([\n    bindingBehavior('oneTime'),\n    __metadata(\"design:paramtypes\", [])\n], OneTimeBindingBehavior);\nexport { OneTimeBindingBehavior };\nlet ToViewBindingBehavior = class ToViewBindingBehavior extends BindingModeBehavior {\n    constructor() {\n        super(BindingMode.toView);\n    }\n};\nToViewBindingBehavior = __decorate([\n    bindingBehavior('toView'),\n    __metadata(\"design:paramtypes\", [])\n], ToViewBindingBehavior);\nexport { ToViewBindingBehavior };\nlet FromViewBindingBehavior = class FromViewBindingBehavior extends BindingModeBehavior {\n    constructor() {\n        super(BindingMode.fromView);\n    }\n};\nFromViewBindingBehavior = __decorate([\n    bindingBehavior('fromView'),\n    __metadata(\"design:paramtypes\", [])\n], FromViewBindingBehavior);\nexport { FromViewBindingBehavior };\nlet TwoWayBindingBehavior = class TwoWayBindingBehavior extends BindingModeBehavior {\n    constructor() {\n        super(BindingMode.twoWay);\n    }\n};\nTwoWayBindingBehavior = __decorate([\n    bindingBehavior('twoWay'),\n    __metadata(\"design:paramtypes\", [])\n], TwoWayBindingBehavior);\nexport { TwoWayBindingBehavior };\n//# sourceMappingURL=binding-mode.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { bindingBehavior, BindingInterceptor } from '../binding-behavior';\nimport { IScheduler } from '@aurelia/scheduler';\nimport { BindingBehaviorExpression } from '../../binding/ast';\nlet DebounceBindingBehavior = class DebounceBindingBehavior extends BindingInterceptor {\n    constructor(binding, expr) {\n        super(binding, expr);\n        this.opts = { delay: 0 };\n        this.firstArg = null;\n        this.task = null;\n        this.taskQueue = binding.locator.get(IScheduler).getPostRenderTaskQueue();\n        if (expr.args.length > 0) {\n            this.firstArg = expr.args[0];\n        }\n    }\n    callSource(args) {\n        this.queueTask(() => this.binding.callSource(args));\n        return void 0;\n    }\n    handleChange(newValue, previousValue, flags) {\n        this.queueTask(() => this.binding.handleChange(newValue, previousValue, flags));\n    }\n    queueTask(callback) {\n        if (this.task !== null) {\n            this.task.cancel();\n        }\n        this.task = this.taskQueue.queueTask(callback, this.opts);\n    }\n    $bind(flags, scope, part) {\n        if (this.firstArg !== null) {\n            const delay = Number(this.firstArg.evaluate(flags, scope, this.locator, part));\n            if (!isNaN(delay)) {\n                this.opts.delay = delay;\n            }\n        }\n        this.binding.$bind(flags, scope, part);\n    }\n};\nDebounceBindingBehavior = __decorate([\n    bindingBehavior('debounce'),\n    __metadata(\"design:paramtypes\", [Object, BindingBehaviorExpression])\n], DebounceBindingBehavior);\nexport { DebounceBindingBehavior };\n//# sourceMappingURL=debounce.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Reporter } from '@aurelia/kernel';\nimport { ISignaler } from '../../observation/signaler';\nimport { bindingBehavior } from '../binding-behavior';\nlet SignalBindingBehavior = class SignalBindingBehavior {\n    constructor(signaler) {\n        this.signaler = signaler;\n    }\n    bind(flags, scope, binding, ...args) {\n        if (!binding.updateTarget) {\n            throw Reporter.error(11);\n        }\n        if (arguments.length === 4) {\n            const name = args[0];\n            this.signaler.addSignalListener(name, binding);\n            binding.signal = name;\n        }\n        else if (arguments.length > 4) {\n            const names = Array.prototype.slice.call(args.length + 3, 3);\n            let i = names.length;\n            while (i--) {\n                const name = names[i];\n                this.signaler.addSignalListener(name, binding);\n            }\n            binding.signal = names;\n        }\n        else {\n            throw Reporter.error(12);\n        }\n    }\n    unbind(flags, scope, binding) {\n        const name = binding.signal;\n        binding.signal = null;\n        if (Array.isArray(name)) {\n            const names = name;\n            let i = names.length;\n            while (i--) {\n                this.signaler.removeSignalListener(names[i], binding);\n            }\n        }\n        else {\n            this.signaler.removeSignalListener(name, binding);\n        }\n    }\n};\nSignalBindingBehavior = __decorate([\n    bindingBehavior('signal'),\n    __param(0, ISignaler),\n    __metadata(\"design:paramtypes\", [Object])\n], SignalBindingBehavior);\nexport { SignalBindingBehavior };\n//# sourceMappingURL=signals.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { bindingBehavior, BindingInterceptor } from '../binding-behavior';\nimport { IScheduler, Now } from '@aurelia/scheduler';\nimport { BindingBehaviorExpression } from '../../binding/ast';\nlet ThrottleBindingBehavior = class ThrottleBindingBehavior extends BindingInterceptor {\n    constructor(binding, expr) {\n        super(binding, expr);\n        this.opts = { delay: 0 };\n        this.firstArg = null;\n        this.task = null;\n        this.lastCall = 0;\n        this.taskQueue = binding.locator.get(IScheduler).getPostRenderTaskQueue();\n        this.now = binding.locator.get(Now);\n        if (expr.args.length > 0) {\n            this.firstArg = expr.args[0];\n        }\n    }\n    callSource(args) {\n        this.queueTask(() => this.binding.callSource(args));\n        return void 0;\n    }\n    handleChange(newValue, previousValue, flags) {\n        this.queueTask(() => this.binding.handleChange(newValue, previousValue, flags));\n    }\n    queueTask(callback) {\n        const opts = this.opts;\n        const now = this.now;\n        const nextDelay = this.lastCall + opts.delay - now();\n        if (nextDelay > 0) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            opts.delay = nextDelay;\n            this.task = this.taskQueue.queueTask(() => {\n                this.lastCall = now();\n                callback();\n            }, opts);\n        }\n        else {\n            this.lastCall = now();\n            callback();\n        }\n    }\n    $bind(flags, scope, part) {\n        if (this.firstArg !== null) {\n            const delay = Number(this.firstArg.evaluate(flags, scope, this.locator, part));\n            if (!isNaN(delay)) {\n                this.opts.delay = delay;\n            }\n        }\n        this.binding.$bind(flags, scope, part);\n    }\n};\nThrottleBindingBehavior = __decorate([\n    bindingBehavior('throttle'),\n    __metadata(\"design:paramtypes\", [Object, BindingBehaviorExpression])\n], ThrottleBindingBehavior);\nexport { ThrottleBindingBehavior };\n//# sourceMappingURL=throttle.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { kebabCase, Metadata, Protocol, firstDefined, getPrototypeChain, PLATFORM, } from '@aurelia/kernel';\nimport { BindingMode, } from '../flags';\nexport function bindable(configOrTarget, prop) {\n    let config;\n    function decorator($target, $prop) {\n        if (arguments.length > 1) {\n            // Non invocation:\n            // - @bindable\n            // Invocation with or w/o opts:\n            // - @bindable()\n            // - @bindable({...opts})\n            config.property = $prop;\n        }\n        Metadata.define(Bindable.name, BindableDefinition.create($prop, config), $target.constructor, $prop);\n        Protocol.annotation.appendTo($target.constructor, Bindable.keyFrom($prop));\n    }\n    if (arguments.length > 1) {\n        // Non invocation:\n        // - @bindable\n        config = {};\n        decorator(configOrTarget, prop);\n        return;\n    }\n    else if (typeof configOrTarget === 'string') {\n        // ClassDecorator\n        // - @bindable('bar')\n        // Direct call:\n        // - @bindable('bar')(Foo)\n        config = {};\n        return decorator;\n    }\n    // Invocation with or w/o opts:\n    // - @bindable()\n    // - @bindable({...opts})\n    config = configOrTarget === void 0 ? {} : configOrTarget;\n    return decorator;\n}\nfunction isBindableAnnotation(key) {\n    return key.startsWith(Bindable.name);\n}\nexport const Bindable = {\n    name: Protocol.annotation.keyFor('bindable'),\n    keyFrom(name) {\n        return `${Bindable.name}:${name}`;\n    },\n    from(...bindableLists) {\n        const bindables = {};\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        const isArray = Array.isArray;\n        function addName(name) {\n            bindables[name] = BindableDefinition.create(name);\n        }\n        function addDescription(name, def) {\n            bindables[name] = def instanceof BindableDefinition ? def : BindableDefinition.create(name, def);\n        }\n        function addList(maybeList) {\n            if (isArray(maybeList)) {\n                maybeList.forEach(addName);\n            }\n            else if (maybeList instanceof BindableDefinition) {\n                bindables[maybeList.property] = maybeList;\n            }\n            else if (maybeList !== void 0) {\n                Object.keys(maybeList).forEach(name => addDescription(name, maybeList[name]));\n            }\n        }\n        bindableLists.forEach(addList);\n        return bindables;\n    },\n    for(Type) {\n        let def;\n        const builder = {\n            add(configOrProp) {\n                let prop;\n                let config;\n                if (typeof configOrProp === 'string') {\n                    prop = configOrProp;\n                    config = { property: prop };\n                }\n                else {\n                    prop = configOrProp.property;\n                    config = configOrProp;\n                }\n                def = BindableDefinition.create(prop, config);\n                if (!Metadata.hasOwn(Bindable.name, Type, prop)) {\n                    Protocol.annotation.appendTo(Type, Bindable.keyFrom(prop));\n                }\n                Metadata.define(Bindable.name, def, Type, prop);\n                return builder;\n            },\n            mode(mode) {\n                def.mode = mode;\n                return builder;\n            },\n            callback(callback) {\n                def.callback = callback;\n                return builder;\n            },\n            attribute(attribute) {\n                def.attribute = attribute;\n                return builder;\n            },\n            primary() {\n                def.primary = true;\n                return builder;\n            },\n            set(setInterpreter) {\n                def.set = setInterpreter;\n                return builder;\n            }\n        };\n        return builder;\n    },\n    getAll(Type) {\n        const propStart = Bindable.name.length + 1;\n        const defs = [];\n        const prototypeChain = getPrototypeChain(Type);\n        let iProto = prototypeChain.length;\n        let iDefs = 0;\n        let keys;\n        let keysLen;\n        let Class;\n        while (--iProto >= 0) {\n            Class = prototypeChain[iProto];\n            keys = Protocol.annotation.getKeys(Class).filter(isBindableAnnotation);\n            keysLen = keys.length;\n            for (let i = 0; i < keysLen; ++i) {\n                defs[iDefs++] = Metadata.getOwn(Bindable.name, Class, keys[i].slice(propStart));\n            }\n        }\n        return defs;\n    },\n};\nexport class BindableDefinition {\n    constructor(attribute, callback, mode, primary, property, set) {\n        this.attribute = attribute;\n        this.callback = callback;\n        this.mode = mode;\n        this.primary = primary;\n        this.property = property;\n        this.set = set;\n    }\n    static create(prop, def = {}) {\n        return new BindableDefinition(firstDefined(def.attribute, kebabCase(prop)), firstDefined(def.callback, `${prop}Changed`), firstDefined(def.mode, BindingMode.toView), firstDefined(def.primary, false), firstDefined(def.property, prop), firstDefined(def.set, PLATFORM.noop));\n    }\n}\n/* eslint-disable @typescript-eslint/no-unused-vars,spaced-comment */\n/**\n * This function serves two purposes:\n * - A playground for contributors to try their changes to the APIs.\n * - Cause the API surface to be properly type-checked and protected against accidental type regressions.\n *\n * It will be automatically removed by dead code elimination.\n */\nfunction apiTypeCheck() {\n    let Foo = \n    // > expected error - class decorator only accepts a string\n    //@bindable({})\n    class Foo {\n    };\n    __decorate([\n        bindable,\n        bindable(),\n        bindable({})\n        // > expected error - 'property' does not exist on decorator input object\n        //@bindable({ property: 'prop' })\n        ,\n        bindable({ mode: BindingMode.twoWay }),\n        bindable({ callback: 'propChanged' }),\n        bindable({ attribute: 'prop' }),\n        bindable({ primary: true }),\n        bindable({ set: value => String(value) }),\n        bindable({ set: value => Number(value) }),\n        bindable({\n            mode: BindingMode.twoWay,\n            callback: 'propChanged',\n            attribute: 'prop',\n            primary: true,\n            set: value => String(value)\n        }),\n        __metadata(\"design:type\", Object)\n    ], Foo.prototype, \"prop\", void 0);\n    Foo = __decorate([\n        bindable('prop')\n        // > expected error - class decorator only accepts a string\n        //@bindable({})\n    ], Foo);\n    Bindable.for(Foo)\n        // > expected error - there is no add() function with only optional params on the fluent api\n        //.add()\n        // > expected error - 'property' is a required property on the fluent api\n        //.add({})\n        .add({ property: 'prop' })\n        .add({ property: 'prop', mode: BindingMode.twoWay })\n        .add({ property: 'prop', callback: 'propChanged' })\n        .add({ property: 'prop', attribute: 'prop' })\n        .add({ property: 'prop', primary: true })\n        .add({ property: 'prop', mode: BindingMode.twoWay, callback: 'propChanged', attribute: 'prop', primary: true })\n        .add('prop')\n        // > expected error - the add() method that accepts an object literal does not return a fluent api\n        //.add({ property: 'prop' }).mode(BindingMode.twoWay)\n        //.add({ property: 'prop' }).callback('propChanged')\n        //.add({ property: 'prop' }).attribute('prop')\n        //.add({ property: 'prop' }).primary()\n        // > expected error - fluent api methods can only be invoked once per bindable\n        //.add('prop').mode(BindingMode.twoWay).mode(BindingMode.twoWay)\n        //.add('prop').mode(BindingMode.twoWay).callback('propChanged').mode(BindingMode.twoWay)\n        //.add('prop').mode(BindingMode.twoWay).callback('propChanged').callback('propChanged') // etc\n        // > expected error - wrong invocation order\n        //.add('prop').callback('propChanged').mode(BindingMode.twoWay)\n        //.add('prop').primary().mode(BindingMode.twoWay)  // etc\n        .add('prop').mode(BindingMode.twoWay)\n        .add('prop').mode(BindingMode.twoWay).callback('propChanged')\n        .add('prop').mode(BindingMode.twoWay).callback('propChanged').attribute('prop')\n        .add('prop').mode(BindingMode.twoWay).callback('propChanged').attribute('prop').primary()\n        .add('prop').mode(BindingMode.twoWay).set((value) => Number(value))\n        .add('prop').mode(BindingMode.twoWay).callback('propChanged').set(value => Number(value))\n        .add('prop').callback('propChanged')\n        .add('prop').callback('propChanged').attribute('prop')\n        .add('prop').callback('propChanged').attribute('prop').primary()\n        .add('prop').attribute('prop')\n        .add('prop').attribute('prop').primary()\n        .add('prop').primary();\n}\n/* eslint-enable @typescript-eslint/no-unused-vars,spaced-comment */\n//# sourceMappingURL=bindable.js.map","import { Registration, Protocol, Metadata, mergeArrays, firstDefined, } from '@aurelia/kernel';\nimport { HooksDefinition, registerAliases, } from '../definitions';\nimport { BindingMode, } from '../flags';\nimport { Bindable } from '../templating/bindable';\nexport function customAttribute(nameOrDef) {\n    return function (target) {\n        return CustomAttribute.define(nameOrDef, target);\n    };\n}\nexport function templateController(nameOrDef) {\n    return function (target) {\n        return CustomAttribute.define(typeof nameOrDef === 'string'\n            ? { isTemplateController: true, name: nameOrDef }\n            : { isTemplateController: true, ...nameOrDef }, target);\n    };\n}\nexport class CustomAttributeDefinition {\n    constructor(Type, name, aliases, key, defaultBindingMode, isTemplateController, bindables, strategy, hooks, noMultiBindings) {\n        this.Type = Type;\n        this.name = name;\n        this.aliases = aliases;\n        this.key = key;\n        this.defaultBindingMode = defaultBindingMode;\n        this.isTemplateController = isTemplateController;\n        this.bindables = bindables;\n        this.strategy = strategy;\n        this.hooks = hooks;\n        this.noMultiBindings = noMultiBindings;\n    }\n    static create(nameOrDef, Type) {\n        let name;\n        let def;\n        if (typeof nameOrDef === 'string') {\n            name = nameOrDef;\n            def = { name };\n        }\n        else {\n            name = nameOrDef.name;\n            def = nameOrDef;\n        }\n        return new CustomAttributeDefinition(Type, firstDefined(CustomAttribute.getAnnotation(Type, 'name'), name), mergeArrays(CustomAttribute.getAnnotation(Type, 'aliases'), def.aliases, Type.aliases), CustomAttribute.keyFrom(name), firstDefined(CustomAttribute.getAnnotation(Type, 'defaultBindingMode'), def.defaultBindingMode, Type.defaultBindingMode, BindingMode.toView), firstDefined(CustomAttribute.getAnnotation(Type, 'isTemplateController'), def.isTemplateController, Type.isTemplateController, false), Bindable.from(...Bindable.getAll(Type), CustomAttribute.getAnnotation(Type, 'bindables'), Type.bindables, def.bindables), firstDefined(CustomAttribute.getAnnotation(Type, 'strategy'), def.strategy, Type.strategy, 1 /* getterSetter */), firstDefined(CustomAttribute.getAnnotation(Type, 'hooks'), def.hooks, Type.hooks, new HooksDefinition(Type.prototype)), firstDefined(CustomAttribute.getAnnotation(Type, 'noMultiBindings'), def.noMultiBindings, Type.noMultiBindings, false));\n    }\n    register(container) {\n        const { Type, key, aliases } = this;\n        Registration.transient(key, Type).register(container);\n        Registration.aliasTo(key, Type).register(container);\n        registerAliases(aliases, CustomAttribute, key, container);\n    }\n}\nexport const CustomAttribute = {\n    name: Protocol.resource.keyFor('custom-attribute'),\n    keyFrom(name) {\n        return `${CustomAttribute.name}:${name}`;\n    },\n    isType(value) {\n        return typeof value === 'function' && Metadata.hasOwn(CustomAttribute.name, value);\n    },\n    for(node, name) {\n        return Metadata.getOwn(CustomAttribute.keyFrom(name), node);\n    },\n    define(nameOrDef, Type) {\n        const definition = CustomAttributeDefinition.create(nameOrDef, Type);\n        Metadata.define(CustomAttribute.name, definition, definition.Type);\n        Metadata.define(CustomAttribute.name, definition, definition);\n        Protocol.resource.appendTo(Type, CustomAttribute.name);\n        return definition.Type;\n    },\n    getDefinition(Type) {\n        const def = Metadata.getOwn(CustomAttribute.name, Type);\n        if (def === void 0) {\n            throw new Error(`No definition found for type ${Type.name}`);\n        }\n        return def;\n    },\n    annotate(Type, prop, value) {\n        Metadata.define(Protocol.annotation.keyFor(prop), value, Type);\n    },\n    getAnnotation(Type, prop) {\n        return Metadata.getOwn(Protocol.annotation.keyFor(prop), Type);\n    },\n};\n//# sourceMappingURL=custom-attribute.js.map","import { DI, PLATFORM, Reporter, } from '@aurelia/kernel';\nexport const INode = DI.createInterface('INode').noDefault();\nexport const IRenderLocation = DI.createInterface('IRenderLocation').noDefault();\nexport const IDOM = DI.createInterface('IDOM').noDefault();\nconst ni = function (...args) {\n    throw Reporter.error(1000); // TODO: create error code (not implemented exception)\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n}; // this function doesn't need typing because it is never directly called\nconst niDOM = {\n    addEventListener: ni,\n    appendChild: ni,\n    cloneNode: ni,\n    convertToRenderLocation: ni,\n    createDocumentFragment: ni,\n    createNodeSequence: ni,\n    createElement: ni,\n    createCustomEvent: ni,\n    dispatchEvent: ni,\n    createNodeObserver: ni,\n    createTemplate: ni,\n    createTextNode: ni,\n    getEffectiveParentNode: ni,\n    setEffectiveParentNode: ni,\n    insertBefore: ni,\n    isMarker: ni,\n    isNodeInstance: ni,\n    isRenderLocation: ni,\n    makeTarget: ni,\n    registerElementResolver: ni,\n    remove: ni,\n    removeEventListener: ni,\n    setAttribute: ni\n};\nexport const DOM = {\n    ...niDOM,\n    scheduler: (void 0),\n    get isInitialized() {\n        return Reflect.get(this, '$initialized') === true;\n    },\n    initialize(dom) {\n        if (this.isInitialized) {\n            throw Reporter.error(1001); // TODO: create error code (already initialized, check isInitialized property and call destroy() if you want to assign a different dom)\n        }\n        const descriptors = {};\n        const protos = [dom];\n        let proto = Object.getPrototypeOf(dom);\n        while (proto && proto !== Object.prototype) {\n            protos.unshift(proto);\n            proto = Object.getPrototypeOf(proto);\n        }\n        for (proto of protos) {\n            Object.assign(descriptors, Object.getOwnPropertyDescriptors(proto));\n        }\n        const keys = [];\n        let key;\n        let descriptor;\n        for (key in descriptors) {\n            descriptor = descriptors[key];\n            if (descriptor.configurable && descriptor.writable) {\n                Reflect.defineProperty(this, key, descriptor);\n                keys.push(key);\n            }\n        }\n        Reflect.set(this, '$domKeys', keys);\n        Reflect.set(this, '$initialized', true);\n    },\n    destroy() {\n        if (!this.isInitialized) {\n            throw Reporter.error(1002); // TODO: create error code (already destroyed)\n        }\n        const keys = Reflect.get(this, '$domKeys');\n        keys.forEach(key => {\n            Reflect.deleteProperty(this, key);\n        });\n        Object.assign(this, niDOM);\n        Reflect.set(this, '$domKeys', PLATFORM.emptyArray);\n        Reflect.set(this, '$initialized', false);\n    }\n};\n// This is an implementation of INodeSequence that represents \"no DOM\" to render.\n// It's used in various places to avoid null and to encode\n// the explicit idea of \"no view\".\nconst emptySequence = {\n    isMounted: false,\n    isLinked: false,\n    next: void 0,\n    childNodes: PLATFORM.emptyArray,\n    firstChild: null,\n    lastChild: null,\n    findTargets() { return PLATFORM.emptyArray; },\n    insertBefore(refNode) { },\n    appendTo(parent) { },\n    remove() { },\n    addToLinked() { },\n    unlink() { },\n    link(next) { },\n};\nexport const NodeSequence = {\n    empty: emptySequence\n};\n//# sourceMappingURL=dom.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { nextId } from '@aurelia/kernel';\nimport { IRenderLocation } from '../../dom';\nimport { IViewFactory } from '../../lifecycle';\nimport { templateController } from '../custom-attribute';\nclass FlagsTemplateController {\n    constructor(factory, location, flags) {\n        this.factory = factory;\n        this.flags = flags;\n        this.id = nextId('au$component');\n        this.view = this.factory.create();\n        this.view.hold(location, 1 /* insertBefore */);\n    }\n    beforeBind(flags) {\n        this.view.parent = this.$controller;\n        return this.view.bind(flags | this.flags, this.$controller.scope);\n    }\n    beforeAttach(flags) {\n        this.view.attach(flags);\n    }\n    beforeDetach(flags) {\n        this.view.detach(flags);\n    }\n    beforeUnbind(flags) {\n        const task = this.view.unbind(flags);\n        this.view.parent = void 0;\n        return task;\n    }\n}\nlet InfrequentMutations = class InfrequentMutations extends FlagsTemplateController {\n    constructor(factory, location) {\n        super(factory, location, 268435456 /* noTargetObserverQueue */);\n    }\n};\nInfrequentMutations = __decorate([\n    templateController('infrequent-mutations'),\n    __param(0, IViewFactory), __param(1, IRenderLocation),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], InfrequentMutations);\nexport { InfrequentMutations };\nlet FrequentMutations = class FrequentMutations extends FlagsTemplateController {\n    constructor(factory, location) {\n        super(factory, location, 536870912 /* persistentTargetObserverQueue */);\n    }\n};\nFrequentMutations = __decorate([\n    templateController('frequent-mutations'),\n    __param(0, IViewFactory), __param(1, IRenderLocation),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], FrequentMutations);\nexport { FrequentMutations };\nlet ObserveShallow = class ObserveShallow extends FlagsTemplateController {\n    constructor(factory, location) {\n        super(factory, location, 134217728 /* observeLeafPropertiesOnly */);\n    }\n};\nObserveShallow = __decorate([\n    templateController('observe-shallow'),\n    __param(0, IViewFactory), __param(1, IRenderLocation),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], ObserveShallow);\nexport { ObserveShallow };\n//# sourceMappingURL=flags.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DI, IServiceLocator, Registration, } from '@aurelia/kernel';\nexport const LifecycleTask = {\n    done: {\n        done: true,\n        canCancel() { return false; },\n        cancel() { return; },\n        wait() { return Promise.resolve(); }\n    }\n};\nexport var TaskSlot;\n(function (TaskSlot) {\n    TaskSlot[TaskSlot[\"beforeCreate\"] = 0] = \"beforeCreate\";\n    TaskSlot[TaskSlot[\"beforeRender\"] = 1] = \"beforeRender\";\n    TaskSlot[TaskSlot[\"beforeBind\"] = 2] = \"beforeBind\";\n    TaskSlot[TaskSlot[\"beforeAttach\"] = 3] = \"beforeAttach\";\n})(TaskSlot || (TaskSlot = {}));\nexport const IStartTask = DI.createInterface('IStartTask').noDefault();\nvar TaskType;\n(function (TaskType) {\n    TaskType[TaskType[\"with\"] = 0] = \"with\";\n    TaskType[TaskType[\"from\"] = 1] = \"from\";\n})(TaskType || (TaskType = {}));\n// eslint-disable-next-line @typescript-eslint/class-name-casing\nexport const StartTask = class $StartTask {\n    constructor(type) {\n        this.type = type;\n        this._slot = void 0;\n        this._promiseOrTask = void 0;\n        this._container = void 0;\n        this._key = void 0;\n        this._callback = void 0;\n        this._task = void 0;\n    }\n    get slot() {\n        if (this._slot === void 0) {\n            throw new Error('StartTask.slot is not set');\n        }\n        return this._slot;\n    }\n    get promiseOrTask() {\n        if (this._promiseOrTask === void 0) {\n            throw new Error('StartTask.promiseOrTask is not set');\n        }\n        return this._promiseOrTask;\n    }\n    get container() {\n        if (this._container === void 0) {\n            throw new Error('StartTask.container is not set');\n        }\n        return this._container;\n    }\n    get key() {\n        if (this._key === void 0) {\n            throw new Error('StartTask.key is not set');\n        }\n        return this._key;\n    }\n    get callback() {\n        if (this._callback === void 0) {\n            throw new Error('StartTask.callback is not set');\n        }\n        return this._callback;\n    }\n    get task() {\n        if (this._task === void 0) {\n            throw new Error('StartTask.task is not set');\n        }\n        return this._task;\n    }\n    static with(key) {\n        const task = new $StartTask(0 /* with */);\n        task._key = key;\n        return task;\n    }\n    static from(promiseOrTask) {\n        const task = new $StartTask(1 /* from */);\n        task._promiseOrTask = promiseOrTask;\n        return task;\n    }\n    beforeCreate() {\n        return this.at(0 /* beforeCreate */);\n    }\n    beforeRender() {\n        return this.at(1 /* beforeRender */);\n    }\n    beforeBind() {\n        return this.at(2 /* beforeBind */);\n    }\n    beforeAttach() {\n        return this.at(3 /* beforeAttach */);\n    }\n    at(slot) {\n        this._slot = slot;\n        return this;\n    }\n    call(fn) {\n        this._callback = fn;\n        return this;\n    }\n    register(container) {\n        return this._container = container.register(Registration.instance(IStartTask, this));\n    }\n    resolveTask() {\n        if (this._task === void 0) {\n            switch (this.type) {\n                case 0 /* with */:\n                    this._task = new ProviderTask(this.container, this.key, this.callback);\n                    break;\n                case 1 /* from */:\n                    this._task = new TerminalTask(this.promiseOrTask);\n                    break;\n            }\n        }\n        return this.task;\n    }\n};\nexport const IStartTaskManager = DI.createInterface('IStartTaskManager').noDefault();\nlet StartTaskManager = class StartTaskManager {\n    constructor(locator) {\n        this.locator = locator;\n    }\n    static register(container) {\n        return Registration.singleton(IStartTaskManager, this).register(container);\n    }\n    runBeforeCreate(locator = this.locator) {\n        return this.run(0 /* beforeCreate */, locator);\n    }\n    runBeforeRender(locator = this.locator) {\n        return this.run(1 /* beforeRender */, locator);\n    }\n    runBeforeBind(locator = this.locator) {\n        return this.run(2 /* beforeBind */, locator);\n    }\n    runBeforeAttach(locator = this.locator) {\n        return this.run(3 /* beforeAttach */, locator);\n    }\n    run(slot, locator = this.locator) {\n        const tasks = locator.getAll(IStartTask)\n            .filter(startTask => startTask.slot === slot)\n            .map(startTask => startTask.resolveTask())\n            .filter(task => !task.done);\n        if (tasks.length === 0) {\n            return LifecycleTask.done;\n        }\n        return new AggregateTerminalTask(tasks);\n    }\n};\nStartTaskManager = __decorate([\n    __param(0, IServiceLocator),\n    __metadata(\"design:paramtypes\", [Object])\n], StartTaskManager);\nexport { StartTaskManager };\nexport class PromiseTask {\n    constructor(promise, next, context, ...args) {\n        this.done = false;\n        this.hasStarted = false;\n        this.isCancelled = false;\n        this.promise = promise.then(value => {\n            if (this.isCancelled === true) {\n                return;\n            }\n            this.hasStarted = true;\n            if (next !== null) {\n                const nextResult = next.call(context, value, ...args);\n                if (nextResult === void 0) {\n                    this.done = true;\n                }\n                else {\n                    const nextPromise = nextResult.then instanceof Function\n                        ? nextResult\n                        : nextResult.wait();\n                    return nextPromise.then(() => {\n                        this.done = true;\n                    });\n                }\n            }\n        });\n    }\n    canCancel() {\n        return !this.hasStarted;\n    }\n    cancel() {\n        if (this.canCancel()) {\n            this.isCancelled = true;\n        }\n    }\n    wait() {\n        return this.promise;\n    }\n}\nexport class ProviderTask {\n    constructor(container, key, callback) {\n        this.container = container;\n        this.key = key;\n        this.callback = callback;\n        this.done = false;\n    }\n    canCancel() {\n        return false;\n    }\n    cancel() {\n        return;\n    }\n    wait() {\n        if (this.promise === void 0) {\n            const instance = this.container.get(this.key);\n            const maybePromiseOrTask = this.callback.call(void 0, instance);\n            this.promise = maybePromiseOrTask === void 0\n                ? Promise.resolve()\n                : maybePromiseOrTask.then instanceof Function\n                    ? maybePromiseOrTask\n                    : maybePromiseOrTask.wait();\n            this.promise = this.promise.then(() => {\n                this.done = true;\n                this.container = (void 0);\n                this.key = (void 0);\n                this.callback = (void 0);\n            }).catch(e => { throw e; });\n        }\n        return this.promise;\n    }\n}\nexport class ContinuationTask {\n    constructor(antecedent, next, context, ...args) {\n        this.done = false;\n        this.hasStarted = false;\n        this.isCancelled = false;\n        const promise = antecedent.then instanceof Function\n            ? antecedent\n            : antecedent.wait();\n        this.promise = promise.then(() => {\n            if (this.isCancelled === true) {\n                return;\n            }\n            this.hasStarted = true;\n            const nextResult = next.call(context, ...args);\n            if (nextResult === void 0) {\n                this.done = true;\n            }\n            else {\n                const nextPromise = nextResult.then instanceof Function\n                    ? nextResult\n                    : nextResult.wait();\n                return nextPromise.then(() => {\n                    this.done = true;\n                });\n            }\n        });\n    }\n    canCancel() {\n        return !this.hasStarted;\n    }\n    cancel() {\n        if (this.canCancel()) {\n            this.isCancelled = true;\n        }\n    }\n    wait() {\n        return this.promise;\n    }\n}\nexport class TerminalTask {\n    constructor(antecedent) {\n        this.done = false;\n        this.promise = antecedent.then instanceof Function\n            ? antecedent\n            : antecedent.wait();\n        this.promise.then(() => {\n            this.done = true;\n        }).catch(e => { throw e; });\n    }\n    canCancel() {\n        return false;\n    }\n    cancel() {\n        return;\n    }\n    wait() {\n        return this.promise;\n    }\n}\nexport class AggregateContinuationTask {\n    constructor(antecedents, next, context, ...args) {\n        this.done = false;\n        this.hasStarted = false;\n        this.isCancelled = false;\n        this.promise = Promise.all(antecedents.map(t => t.wait())).then(() => {\n            if (this.isCancelled === true) {\n                return;\n            }\n            this.hasStarted = true;\n            const nextResult = next.call(context, ...args);\n            if (nextResult === void 0) {\n                this.done = true;\n            }\n            else {\n                return nextResult.wait().then(() => {\n                    this.done = true;\n                });\n            }\n        });\n    }\n    canCancel() {\n        return !this.hasStarted;\n    }\n    cancel() {\n        if (this.canCancel()) {\n            this.isCancelled = true;\n        }\n    }\n    wait() {\n        return this.promise;\n    }\n}\nexport class AggregateTerminalTask {\n    constructor(antecedents) {\n        this.done = false;\n        this.promise = Promise.all(antecedents.map(t => t.wait())).then(() => {\n            this.done = true;\n        });\n    }\n    canCancel() {\n        return false;\n    }\n    cancel() {\n        return;\n    }\n    wait() {\n        return this.promise;\n    }\n}\nexport function hasAsyncWork(value) {\n    return !(value === void 0 || value.done === true);\n}\n//# sourceMappingURL=lifecycle-task.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { nextId } from '@aurelia/kernel';\nimport { IRenderLocation } from '../../dom';\nimport { IViewFactory } from '../../lifecycle';\nimport { ContinuationTask, LifecycleTask, PromiseTask } from '../../lifecycle-task';\nimport { bindable } from '../../templating/bindable';\nimport { templateController } from '../custom-attribute';\nlet If = class If {\n    constructor(ifFactory, location) {\n        this.ifFactory = ifFactory;\n        this.location = location;\n        this.id = nextId('au$component');\n        this.elseFactory = void 0;\n        this.elseView = void 0;\n        this.ifView = void 0;\n        this.view = void 0;\n        this.task = LifecycleTask.done;\n        this.value = false;\n    }\n    ;\n    beforeBind(flags) {\n        if (this.task.done) {\n            this.task = this.swap(this.value, flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.swap, this, this.value, flags);\n        }\n        return this.task;\n    }\n    beforeAttach(flags) {\n        if (this.task.done) {\n            this.attachView(flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.attachView, this, flags);\n        }\n    }\n    beforeDetach(flags) {\n        if (this.view !== void 0) {\n            if (this.task.done) {\n                this.view.detach(flags);\n            }\n            else {\n                this.task = new ContinuationTask(this.task, this.view.detach, this.view, flags);\n            }\n        }\n        return this.task;\n    }\n    beforeUnbind(flags) {\n        if (this.view !== void 0) {\n            if (this.task.done) {\n                this.task = this.view.unbind(flags);\n            }\n            else {\n                this.task = new ContinuationTask(this.task, this.view.unbind, this.view, flags);\n            }\n        }\n        return this.task;\n    }\n    caching(flags) {\n        if (this.ifView !== void 0 && this.ifView.release(flags)) {\n            this.ifView = void 0;\n        }\n        if (this.elseView !== void 0 && this.elseView.release(flags)) {\n            this.elseView = void 0;\n        }\n        this.view = void 0;\n    }\n    valueChanged(newValue, oldValue, flags) {\n        if ((this.$controller.state & 4 /* isBound */) === 0) {\n            return;\n        }\n        if (this.task.done) {\n            this.task = this.swap(this.value, flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.swap, this, this.value, flags);\n        }\n    }\n    /** @internal */\n    updateView(value, flags) {\n        let view;\n        if (value) {\n            view = this.ifView = this.ensureView(this.ifView, this.ifFactory, flags);\n        }\n        else if (this.elseFactory != void 0) {\n            view = this.elseView = this.ensureView(this.elseView, this.elseFactory, flags);\n        }\n        else {\n            view = void 0;\n        }\n        return view;\n    }\n    /** @internal */\n    ensureView(view, factory, flags) {\n        if (view === void 0) {\n            view = factory.create(flags);\n        }\n        view.hold(this.location, 1 /* insertBefore */);\n        return view;\n    }\n    swap(value, flags) {\n        let task = LifecycleTask.done;\n        if ((value === true && this.elseView !== void 0)\n            || (value !== true && this.ifView !== void 0)) {\n            task = this.deactivate(flags);\n        }\n        if (task.done) {\n            const view = this.updateView(value, flags);\n            task = this.activate(view, flags);\n        }\n        else {\n            task = new PromiseTask(task.wait().then(() => this.updateView(value, flags)), this.activate, this, flags);\n        }\n        return task;\n    }\n    deactivate(flags) {\n        const view = this.view;\n        if (view === void 0) {\n            return LifecycleTask.done;\n        }\n        view.detach(flags); // TODO: link this up with unbind\n        const task = view.unbind(flags);\n        view.parent = void 0;\n        return task;\n    }\n    activate(view, flags) {\n        this.view = view;\n        if (view === void 0) {\n            return LifecycleTask.done;\n        }\n        let task = this.bindView(flags);\n        if ((this.$controller.state & 32 /* isAttached */) === 0) {\n            return task;\n        }\n        if (task.done) {\n            this.attachView(flags);\n        }\n        else {\n            task = new ContinuationTask(task, this.attachView, this, flags);\n        }\n        return task;\n    }\n    bindView(flags) {\n        if (this.view !== void 0 && (this.$controller.state & 5 /* isBoundOrBinding */) > 0) {\n            this.view.parent = this.$controller;\n            return this.view.bind(flags, this.$controller.scope, this.$controller.part);\n        }\n        return LifecycleTask.done;\n    }\n    attachView(flags) {\n        if (this.view !== void 0 && (this.$controller.state & 40 /* isAttachedOrAttaching */) > 0) {\n            this.view.attach(flags);\n        }\n    }\n};\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Boolean)\n], If.prototype, \"value\", void 0);\nIf = __decorate([\n    templateController('if'),\n    __param(0, IViewFactory),\n    __param(1, IRenderLocation),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], If);\nexport { If };\nlet Else = class Else {\n    constructor(factory) {\n        this.factory = factory;\n        this.id = nextId('au$component');\n    }\n    link(ifBehavior) {\n        if (ifBehavior instanceof If) {\n            ifBehavior.elseFactory = this.factory;\n        }\n        else if (ifBehavior.viewModel instanceof If) {\n            ifBehavior.viewModel.elseFactory = this.factory;\n        }\n        else {\n            throw new Error(`Unsupported IfBehavior`); // TODO: create error code\n        }\n    }\n};\nElse = __decorate([\n    templateController('else'),\n    __param(0, IViewFactory),\n    __metadata(\"design:paramtypes\", [Object])\n], Else);\nexport { Else };\n//# sourceMappingURL=if.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { compareNumber, nextId } from '@aurelia/kernel';\nimport { IRenderLocation } from '../../dom';\nimport { IViewFactory, IController } from '../../lifecycle';\nimport { AggregateContinuationTask, ContinuationTask, LifecycleTask, } from '../../lifecycle-task';\nimport { applyMutationsToIndices, synchronizeIndices } from '../../observation/array-observer';\nimport { BindingContext, Scope } from '../../observation/binding-context';\nimport { getCollectionObserver } from '../../observation/observer-locator';\nimport { bindable } from '../../templating/bindable';\nimport { templateController } from '../custom-attribute';\nlet Repeat = class Repeat {\n    constructor(location, renderable, factory) {\n        this.location = location;\n        this.renderable = renderable;\n        this.factory = factory;\n        this.id = nextId('au$component');\n        this.hasPendingInstanceMutation = false;\n        this.observer = void 0;\n        this.views = [];\n        this.key = void 0;\n        this.task = LifecycleTask.done;\n        this.normalizedItems = void 0;\n    }\n    beforeBind(flags) {\n        this.checkCollectionObserver(flags);\n        const bindings = this.renderable.bindings;\n        const { length } = bindings;\n        let binding;\n        for (let i = 0; i < length; ++i) {\n            binding = bindings[i];\n            if (binding.target === this && binding.targetProperty === 'items') {\n                this.forOf = binding.sourceExpression;\n                break;\n            }\n        }\n        this.local = this.forOf.declaration.evaluate(flags, this.$controller.scope, null);\n        this.normalizeToArray(flags);\n        this.processViewsKeyed(void 0, flags);\n        return this.task;\n    }\n    beforeAttach(flags) {\n        if (this.task.done) {\n            this.attachViews(void 0, flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.attachViews, this, void 0, flags);\n        }\n    }\n    beforeDetach(flags) {\n        if (this.task.done) {\n            this.detachViewsByRange(0, this.views.length, flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.detachViewsByRange, this, 0, this.views.length, flags);\n        }\n    }\n    beforeUnbind(flags) {\n        this.checkCollectionObserver(flags);\n        if (this.task.done) {\n            this.task = this.unbindAndRemoveViewsByRange(0, this.views.length, flags, false);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.unbindAndRemoveViewsByRange, this, 0, this.views.length, flags, false);\n        }\n        return this.task;\n    }\n    // called by SetterObserver\n    itemsChanged(flags) {\n        flags |= this.$controller.flags;\n        this.checkCollectionObserver(flags);\n        flags |= 16 /* updateTargetInstance */;\n        this.normalizeToArray(flags);\n        this.processViewsKeyed(void 0, flags);\n    }\n    // called by a CollectionObserver\n    handleCollectionChange(indexMap, flags) {\n        flags |= this.$controller.flags;\n        flags |= (960 /* fromFlush */ | 16 /* updateTargetInstance */);\n        this.normalizeToArray(flags);\n        this.processViewsKeyed(indexMap, flags);\n    }\n    processViewsKeyed(indexMap, flags) {\n        const oldLength = this.views.length;\n        if (indexMap === void 0) {\n            if ((this.$controller.state & 5 /* isBoundOrBinding */) > 0) {\n                this.detachViewsByRange(0, oldLength, flags);\n                if (this.task.done) {\n                    this.task = this.unbindAndRemoveViewsByRange(0, oldLength, flags, false);\n                }\n                else {\n                    this.task = new ContinuationTask(this.task, this.unbindAndRemoveViewsByRange, this, 0, oldLength, flags, false);\n                }\n                if (this.task.done) {\n                    this.task = this.createAndBindAllViews(flags);\n                }\n                else {\n                    this.task = new ContinuationTask(this.task, this.createAndBindAllViews, this, flags);\n                }\n            }\n            if ((this.$controller.state & 40 /* isAttachedOrAttaching */) > 0) {\n                if (this.task.done) {\n                    this.attachViewsKeyed(flags);\n                }\n                else {\n                    this.task = new ContinuationTask(this.task, this.attachViewsKeyed, this, flags);\n                }\n            }\n        }\n        else {\n            applyMutationsToIndices(indexMap);\n            if ((this.$controller.state & 5 /* isBoundOrBinding */) > 0) {\n                // first detach+unbind+(remove from array) the deleted view indices\n                if (indexMap.deletedItems.length > 0) {\n                    indexMap.deletedItems.sort(compareNumber);\n                    if (this.task.done) {\n                        this.detachViewsByKey(indexMap, flags);\n                    }\n                    else {\n                        this.task = new ContinuationTask(this.task, this.detachViewsByKey, this, indexMap, flags);\n                    }\n                    if (this.task.done) {\n                        this.task = this.unbindAndRemoveViewsByKey(indexMap, flags);\n                    }\n                    else {\n                        this.task = new ContinuationTask(this.task, this.unbindAndRemoveViewsByKey, this, indexMap, flags);\n                    }\n                }\n                // then insert new views at the \"added\" indices to bring the views array in aligment with indexMap size\n                if (this.task.done) {\n                    this.task = this.createAndBindNewViewsByKey(indexMap, flags);\n                }\n                else {\n                    this.task = new ContinuationTask(this.task, this.createAndBindNewViewsByKey, this, indexMap, flags);\n                }\n            }\n            if ((this.$controller.state & 40 /* isAttachedOrAttaching */) > 0) {\n                if (this.task.done) {\n                    this.sortViewsByKey(oldLength, indexMap, flags);\n                }\n                else {\n                    this.task = new ContinuationTask(this.task, this.sortViewsByKey, this, oldLength, indexMap, flags);\n                }\n            }\n        }\n    }\n    // todo: subscribe to collection from inner expression\n    checkCollectionObserver(flags) {\n        const oldObserver = this.observer;\n        if ((flags & 8192 /* fromUnbind */)) {\n            if (oldObserver !== void 0) {\n                oldObserver.unsubscribeFromCollection(this);\n            }\n        }\n        else if ((this.$controller.state & 5 /* isBoundOrBinding */) > 0) {\n            const newObserver = this.observer = getCollectionObserver(flags, this.$controller.lifecycle, this.items);\n            if (oldObserver !== newObserver && oldObserver) {\n                oldObserver.unsubscribeFromCollection(this);\n            }\n            if (newObserver) {\n                newObserver.subscribeToCollection(this);\n            }\n        }\n    }\n    normalizeToArray(flags) {\n        const items = this.items;\n        if (items instanceof Array) {\n            this.normalizedItems = items;\n            return;\n        }\n        const forOf = this.forOf;\n        if (forOf === void 0) {\n            return;\n        }\n        const normalizedItems = [];\n        this.forOf.iterate(flags, items, (arr, index, item) => {\n            normalizedItems[index] = item;\n        });\n        this.normalizedItems = normalizedItems;\n    }\n    detachViewsByRange(iStart, iEnd, flags) {\n        const views = this.views;\n        this.$controller.lifecycle.afterDetach.begin();\n        let view;\n        for (let i = iStart; i < iEnd; ++i) {\n            view = views[i];\n            view.release(flags);\n            view.detach(flags);\n        }\n        this.$controller.lifecycle.afterDetach.end(flags);\n    }\n    unbindAndRemoveViewsByRange(iStart, iEnd, flags, adjustLength) {\n        const views = this.views;\n        let tasks = void 0;\n        let task;\n        this.$controller.lifecycle.afterUnbind.begin();\n        let view;\n        for (let i = iStart; i < iEnd; ++i) {\n            view = views[i];\n            task = view.unbind(flags);\n            view.parent = void 0;\n            if (!task.done) {\n                if (tasks === undefined) {\n                    tasks = [];\n                }\n                tasks.push(task);\n            }\n        }\n        if (adjustLength) {\n            this.views.length = iStart;\n        }\n        if (tasks === undefined) {\n            this.$controller.lifecycle.afterUnbind.end(flags);\n            return LifecycleTask.done;\n        }\n        return new AggregateContinuationTask(tasks, this.$controller.lifecycle.afterUnbind.end, this.$controller.lifecycle.afterUnbind, flags);\n    }\n    detachViewsByKey(indexMap, flags) {\n        const views = this.views;\n        this.$controller.lifecycle.afterDetach.begin();\n        const deleted = indexMap.deletedItems;\n        const deletedLen = deleted.length;\n        let view;\n        for (let i = 0; i < deletedLen; ++i) {\n            view = views[deleted[i]];\n            view.release(flags);\n            view.detach(flags);\n        }\n        this.$controller.lifecycle.afterDetach.end(flags);\n    }\n    unbindAndRemoveViewsByKey(indexMap, flags) {\n        const views = this.views;\n        let tasks = void 0;\n        let task;\n        this.$controller.lifecycle.afterUnbind.begin();\n        const deleted = indexMap.deletedItems;\n        const deletedLen = deleted.length;\n        let view;\n        let i = 0;\n        for (; i < deletedLen; ++i) {\n            view = views[deleted[i]];\n            task = view.unbind(flags);\n            view.parent = void 0;\n            if (!task.done) {\n                if (tasks === undefined) {\n                    tasks = [];\n                }\n                tasks.push(task);\n            }\n        }\n        i = 0;\n        let j = 0;\n        for (; i < deletedLen; ++i) {\n            j = deleted[i] - i;\n            this.views.splice(j, 1);\n        }\n        if (tasks === undefined) {\n            this.$controller.lifecycle.afterUnbind.end(flags);\n            return LifecycleTask.done;\n        }\n        return new AggregateContinuationTask(tasks, this.$controller.lifecycle.afterUnbind.end, this.$controller.lifecycle.afterUnbind, flags);\n    }\n    createAndBindAllViews(flags) {\n        let tasks = void 0;\n        let task;\n        let view;\n        let viewScope;\n        const $controller = this.$controller;\n        const lifecycle = $controller.lifecycle;\n        const parentScope = $controller.scope;\n        lifecycle.afterBind.begin();\n        const part = $controller.part;\n        const factory = this.factory;\n        const local = this.local;\n        const items = this.items;\n        const newLen = this.forOf.count(flags, items);\n        const views = this.views = Array(newLen);\n        this.forOf.iterate(flags, items, (arr, i, item) => {\n            view = views[i] = factory.create(flags);\n            view.parent = $controller;\n            viewScope = Scope.fromParent(flags, parentScope, BindingContext.create(flags, local, item));\n            setContextualProperties(viewScope.overrideContext, i, newLen);\n            task = view.bind(flags, viewScope, part);\n            if (!task.done) {\n                if (tasks === undefined) {\n                    tasks = [];\n                }\n                tasks.push(task);\n            }\n        });\n        if (tasks === undefined) {\n            lifecycle.afterBind.end(flags);\n            return LifecycleTask.done;\n        }\n        return new AggregateContinuationTask(tasks, lifecycle.afterBind.end, lifecycle.afterBind, flags);\n    }\n    createAndBindNewViewsByKey(indexMap, flags) {\n        let tasks = void 0;\n        let task;\n        let view;\n        let viewScope;\n        const factory = this.factory;\n        const views = this.views;\n        const local = this.local;\n        const normalizedItems = this.normalizedItems;\n        const $controller = this.$controller;\n        const lifecycle = $controller.lifecycle;\n        const parentScope = $controller.scope;\n        lifecycle.afterBind.begin();\n        const part = $controller.part;\n        const mapLen = indexMap.length;\n        for (let i = 0; i < mapLen; ++i) {\n            if (indexMap[i] === -2) {\n                view = factory.create(flags);\n                // TODO: test with map/set/undefined/null, make sure we can use strong typing here as well, etc\n                view.parent = $controller;\n                viewScope = Scope.fromParent(flags, parentScope, BindingContext.create(flags, local, normalizedItems[i]));\n                setContextualProperties(viewScope.overrideContext, i, mapLen);\n                // update all the rest oc\n                task = view.bind(flags, viewScope, part);\n                views.splice(i, 0, view);\n                if (!task.done) {\n                    if (tasks === undefined) {\n                        tasks = [];\n                    }\n                    tasks.push(task);\n                }\n            }\n        }\n        if (views.length !== mapLen) {\n            // TODO: create error code and use reporter with more informative message\n            throw new Error(`viewsLen=${views.length}, mapLen=${mapLen}`);\n        }\n        if (tasks === undefined) {\n            lifecycle.afterBind.end(flags);\n            return LifecycleTask.done;\n        }\n        return new AggregateContinuationTask(tasks, lifecycle.afterBind.end, lifecycle.afterBind, flags);\n    }\n    attachViews(indexMap, flags) {\n        let view;\n        const views = this.views;\n        const location = this.location;\n        const lifecycle = this.$controller.lifecycle;\n        lifecycle.afterAttach.begin();\n        if (indexMap === void 0) {\n            for (let i = 0, ii = views.length; i < ii; ++i) {\n                view = views[i];\n                view.hold(location, 1 /* insertBefore */);\n                view.nodes.unlink();\n                view.attach(flags);\n            }\n        }\n        else {\n            for (let i = 0, ii = views.length; i < ii; ++i) {\n                if (indexMap[i] !== i) {\n                    view = views[i];\n                    view.hold(location, 1 /* insertBefore */);\n                    view.nodes.unlink();\n                    view.attach(flags);\n                }\n            }\n        }\n        lifecycle.afterAttach.end(flags);\n    }\n    attachViewsKeyed(flags) {\n        let view;\n        const { views, location } = this;\n        this.$controller.lifecycle.afterAttach.begin();\n        for (let i = 0, ii = views.length; i < ii; ++i) {\n            view = views[i];\n            view.hold(location, 1 /* insertBefore */);\n            view.nodes.unlink();\n            view.attach(flags);\n        }\n        this.$controller.lifecycle.afterAttach.end(flags);\n    }\n    sortViewsByKey(oldLength, indexMap, flags) {\n        // TODO: integrate with tasks\n        const location = this.location;\n        const views = this.views;\n        const newLen = indexMap.length;\n        synchronizeIndices(views, indexMap);\n        // this algorithm retrieves the indices of the longest increasing subsequence of items in the repeater\n        // the items on those indices are not moved; this minimizes the number of DOM operations that need to be performed\n        const seq = longestIncreasingSubsequence(indexMap);\n        const seqLen = seq.length;\n        this.$controller.lifecycle.afterAttach.begin();\n        flags |= 33554432 /* reorderNodes */;\n        let next;\n        let j = seqLen - 1;\n        let i = newLen - 1;\n        let view;\n        for (; i >= 0; --i) {\n            view = views[i];\n            if (indexMap[i] === -2) {\n                setContextualProperties(view.scope.overrideContext, i, newLen);\n                view.hold(location, 1 /* insertBefore */);\n                view.attach(flags);\n            }\n            else if (j < 0 || seqLen === 1 || i !== seq[j]) {\n                setContextualProperties(view.scope.overrideContext, i, newLen);\n                view.attach(flags);\n            }\n            else {\n                if (oldLength !== newLen) {\n                    setContextualProperties(view.scope.overrideContext, i, newLen);\n                }\n                --j;\n            }\n            next = views[i + 1];\n            if (next !== void 0) {\n                view.nodes.link(next.nodes);\n            }\n            else {\n                view.nodes.link(location);\n            }\n        }\n        this.$controller.lifecycle.afterAttach.end(flags);\n    }\n};\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Object)\n], Repeat.prototype, \"items\", void 0);\nRepeat = __decorate([\n    templateController('repeat'),\n    __param(0, IRenderLocation),\n    __param(1, IController),\n    __param(2, IViewFactory),\n    __metadata(\"design:paramtypes\", [Object, Object, Object])\n], Repeat);\nexport { Repeat };\nlet maxLen = 16;\nlet prevIndices = new Int32Array(maxLen);\nlet tailIndices = new Int32Array(maxLen);\n// Based on inferno's lis_algorithm @ https://github.com/infernojs/inferno/blob/master/packages/inferno/src/DOM/patching.ts#L732\n// with some tweaks to make it just a bit faster + account for IndexMap (and some names changes for readability)\n/** @internal */\nexport function longestIncreasingSubsequence(indexMap) {\n    const len = indexMap.length;\n    if (len > maxLen) {\n        maxLen = len;\n        prevIndices = new Int32Array(len);\n        tailIndices = new Int32Array(len);\n    }\n    let cursor = 0;\n    let cur = 0;\n    let prev = 0;\n    let i = 0;\n    let j = 0;\n    let low = 0;\n    let high = 0;\n    let mid = 0;\n    for (; i < len; i++) {\n        cur = indexMap[i];\n        if (cur !== -2) {\n            j = prevIndices[cursor];\n            prev = indexMap[j];\n            if (prev !== -2 && prev < cur) {\n                tailIndices[i] = j;\n                prevIndices[++cursor] = i;\n                continue;\n            }\n            low = 0;\n            high = cursor;\n            while (low < high) {\n                mid = (low + high) >> 1;\n                prev = indexMap[prevIndices[mid]];\n                if (prev !== -2 && prev < cur) {\n                    low = mid + 1;\n                }\n                else {\n                    high = mid;\n                }\n            }\n            prev = indexMap[prevIndices[low]];\n            if (cur < prev || prev === -2) {\n                if (low > 0) {\n                    tailIndices[i] = prevIndices[low - 1];\n                }\n                prevIndices[low] = i;\n            }\n        }\n    }\n    i = ++cursor;\n    const result = new Int32Array(i);\n    cur = prevIndices[cursor - 1];\n    while (cursor-- > 0) {\n        result[cursor] = cur;\n        cur = tailIndices[cur];\n    }\n    while (i-- > 0)\n        prevIndices[i] = 0;\n    return result;\n}\nfunction setContextualProperties(oc, index, length) {\n    const isFirst = index === 0;\n    const isLast = index === length - 1;\n    const isEven = index % 2 === 0;\n    oc.$index = index;\n    oc.$first = isFirst;\n    oc.$last = isLast;\n    oc.$middle = !isFirst && !isLast;\n    oc.$even = isEven;\n    oc.$odd = !isEven;\n    oc.$length = length;\n}\n//# sourceMappingURL=repeat.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { nextId } from '@aurelia/kernel';\nimport { IRenderLocation } from '../../dom';\nimport { IViewFactory } from '../../lifecycle';\nimport { templateController } from '../custom-attribute';\nlet Replaceable = class Replaceable {\n    constructor(factory, location) {\n        this.factory = factory;\n        this.location = location;\n        this.id = nextId('au$component');\n        this.view = this.factory.create();\n        this.view.hold(location, 1 /* insertBefore */);\n    }\n    beforeBind(flags) {\n        this.view.parent = this.$controller;\n        return this.view.bind(flags | 67108864 /* allowParentScopeTraversal */, this.$controller.scope, this.factory.name);\n    }\n    beforeAttach(flags) {\n        this.view.attach(flags);\n    }\n    beforeDetach(flags) {\n        this.view.detach(flags);\n    }\n    beforeUnbind(flags) {\n        const task = this.view.unbind(flags);\n        this.view.parent = void 0;\n        return task;\n    }\n};\nReplaceable = __decorate([\n    templateController('replaceable'),\n    __param(0, IViewFactory),\n    __param(1, IRenderLocation),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], Replaceable);\nexport { Replaceable };\n//# sourceMappingURL=replaceable.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { nextId } from '@aurelia/kernel';\nimport { IRenderLocation } from '../../dom';\nimport { IViewFactory } from '../../lifecycle';\nimport { templateController } from '../custom-attribute';\nimport { bindable } from '../../templating/bindable';\nimport { Scope } from '../../observation/binding-context';\nlet With = class With {\n    constructor(factory, location) {\n        this.factory = factory;\n        this.location = location;\n        this.id = nextId('au$component');\n        this.id = nextId('au$component');\n        this.view = this.factory.create();\n        this.view.hold(location, 1 /* insertBefore */);\n    }\n    valueChanged(newValue, oldValue, flags) {\n        if ((this.$controller.state & 5 /* isBoundOrBinding */) > 0) {\n            this.bindChild(4096 /* fromBind */);\n        }\n    }\n    beforeBind(flags) {\n        this.view.parent = this.$controller;\n        this.bindChild(flags);\n    }\n    beforeAttach(flags) {\n        this.view.attach(flags);\n    }\n    beforeDetach(flags) {\n        this.view.detach(flags);\n    }\n    beforeUnbind(flags) {\n        this.view.unbind(flags);\n        this.view.parent = void 0;\n    }\n    bindChild(flags) {\n        const scope = Scope.fromParent(flags, this.$controller.scope, this.value === void 0 ? {} : this.value);\n        this.view.bind(flags, scope, this.$controller.part);\n    }\n};\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Object)\n], With.prototype, \"value\", void 0);\nWith = __decorate([\n    templateController('with'),\n    __param(0, IViewFactory),\n    __param(1, IRenderLocation),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], With);\nexport { With };\n//# sourceMappingURL=with.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar ChildrenObserver_1;\n/* eslint-disable @typescript-eslint/no-use-before-define */\nimport { Protocol, Metadata, firstDefined, getPrototypeChain, Reporter } from '@aurelia/kernel';\nimport { CustomElement } from '../resources/custom-element';\nimport { subscriberCollection } from '../observation/subscriber-collection';\nexport function children(configOrTarget, prop) {\n    let config;\n    function decorator($target, $prop) {\n        if (arguments.length > 1) {\n            // Non invocation:\n            // - @children\n            // Invocation with or w/o opts:\n            // - @children()\n            // - @children({...opts})\n            config.property = $prop;\n        }\n        Metadata.define(Children.name, ChildrenDefinition.create($prop, config), $target.constructor, $prop);\n        Protocol.annotation.appendTo($target.constructor, Children.keyFrom($prop));\n    }\n    if (arguments.length > 1) {\n        // Non invocation:\n        // - @children\n        config = {};\n        decorator(configOrTarget, prop);\n        return;\n    }\n    else if (typeof configOrTarget === 'string') {\n        // ClassDecorator\n        // - @children('bar')\n        // Direct call:\n        // - @children('bar')(Foo)\n        config = {};\n        return decorator;\n    }\n    // Invocation with or w/o opts:\n    // - @children()\n    // - @children({...opts})\n    config = configOrTarget === void 0 ? {} : configOrTarget;\n    return decorator;\n}\nfunction isChildrenObserverAnnotation(key) {\n    return key.startsWith(Children.name);\n}\nexport const Children = {\n    name: Protocol.annotation.keyFor('children-observer'),\n    keyFrom(name) {\n        return `${Children.name}:${name}`;\n    },\n    from(...childrenObserverLists) {\n        const childrenObservers = {};\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        const isArray = Array.isArray;\n        function addName(name) {\n            childrenObservers[name] = ChildrenDefinition.create(name);\n        }\n        function addDescription(name, def) {\n            childrenObservers[name] = ChildrenDefinition.create(name, def);\n        }\n        function addList(maybeList) {\n            if (isArray(maybeList)) {\n                maybeList.forEach(addName);\n            }\n            else if (maybeList instanceof ChildrenDefinition) {\n                childrenObservers[maybeList.property] = maybeList;\n            }\n            else if (maybeList !== void 0) {\n                Object.keys(maybeList).forEach(name => addDescription(name, maybeList));\n            }\n        }\n        childrenObserverLists.forEach(addList);\n        return childrenObservers;\n    },\n    getAll(Type) {\n        const propStart = Children.name.length + 1;\n        const defs = [];\n        const prototypeChain = getPrototypeChain(Type);\n        let iProto = prototypeChain.length;\n        let iDefs = 0;\n        let keys;\n        let keysLen;\n        let Class;\n        while (--iProto >= 0) {\n            Class = prototypeChain[iProto];\n            keys = Protocol.annotation.getKeys(Class).filter(isChildrenObserverAnnotation);\n            keysLen = keys.length;\n            for (let i = 0; i < keysLen; ++i) {\n                defs[iDefs++] = Metadata.getOwn(Children.name, Class, keys[i].slice(propStart));\n            }\n        }\n        return defs;\n    },\n};\nexport class ChildrenDefinition {\n    constructor(callback, property, options, query, filter, map) {\n        this.callback = callback;\n        this.property = property;\n        this.options = options;\n        this.query = query;\n        this.filter = filter;\n        this.map = map;\n    }\n    static create(prop, def = {}) {\n        return new ChildrenDefinition(firstDefined(def.callback, `${prop}Changed`), firstDefined(def.property, prop), def.options, def.query, def.filter, def.map);\n    }\n}\n/** @internal */\nlet ChildrenObserver = ChildrenObserver_1 = class ChildrenObserver {\n    constructor(controller, obj, flags, propertyKey, cbName, query = defaultChildQuery, filter = defaultChildFilter, map = defaultChildMap, options) {\n        this.controller = controller;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.query = query;\n        this.filter = filter;\n        this.map = map;\n        this.options = options;\n        this.observing = false;\n        this.children = (void 0);\n        this.callback = obj[cbName];\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        this.createGetterSetter();\n    }\n    getValue() {\n        this.tryStartObserving();\n        return this.children;\n    }\n    setValue(newValue) { }\n    subscribe(subscriber) {\n        this.tryStartObserving();\n        this.addSubscriber(subscriber);\n    }\n    tryStartObserving() {\n        if (!this.observing) {\n            this.observing = true;\n            const projector = this.controller.projector;\n            this.children = filterChildren(projector, this.query, this.filter, this.map);\n            projector.subscribeToChildrenChange(() => { this.onChildrenChanged(); }, this.options);\n        }\n    }\n    onChildrenChanged() {\n        this.children = filterChildren(this.controller.projector, this.query, this.filter, this.map);\n        if (this.callback !== void 0) {\n            this.callback.call(this.obj);\n        }\n        this.callSubscribers(this.children, undefined, this.persistentFlags | 16 /* updateTargetInstance */);\n    }\n    createGetterSetter() {\n        if (!Reflect.defineProperty(this.obj, this.propertyKey, {\n            enumerable: true,\n            configurable: true,\n            get: () => this.getValue(),\n            set: () => { return; },\n        })) {\n            Reporter.write(1, this.propertyKey, this.obj);\n        }\n    }\n};\nChildrenObserver = ChildrenObserver_1 = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Object, Number, String, String, Object, Object, Object, Object])\n], ChildrenObserver);\nexport { ChildrenObserver };\nfunction defaultChildQuery(projector) {\n    return projector.children;\n}\nfunction defaultChildFilter(node, controller, viewModel) {\n    return !!viewModel;\n}\nfunction defaultChildMap(node, controller, viewModel) {\n    return viewModel;\n}\n/** @internal */\nexport function filterChildren(projector, query, filter, map) {\n    const nodes = query(projector);\n    const children = [];\n    for (let i = 0, ii = nodes.length; i < ii; ++i) {\n        const node = nodes[i];\n        const controller = CustomElement.for(node);\n        const viewModel = controller ? controller.viewModel : null;\n        if (filter(node, controller, viewModel)) {\n            children.push(map(node, controller, viewModel));\n        }\n    }\n    return children;\n}\n//# sourceMappingURL=children.js.map","import { DI, Registration, Protocol, Metadata, mergeArrays, fromDefinitionOrDefault, pascalCase, fromAnnotationOrTypeOrDefault, fromAnnotationOrDefinitionOrTypeOrDefault, } from '@aurelia/kernel';\nimport { registerAliases, HooksDefinition, } from '../definitions';\nimport { DOM } from '../dom';\nimport { Bindable } from '../templating/bindable';\nimport { Children } from '../templating/children';\nexport function customElement(nameOrDef) {\n    return function (target) {\n        return CustomElement.define(nameOrDef, target);\n    };\n}\nexport function useShadowDOM(targetOrOptions) {\n    if (targetOrOptions === void 0) {\n        return function ($target) {\n            CustomElement.annotate($target, 'shadowOptions', { mode: 'open' });\n        };\n    }\n    if (typeof targetOrOptions !== 'function') {\n        return function ($target) {\n            CustomElement.annotate($target, 'shadowOptions', targetOrOptions);\n        };\n    }\n    CustomElement.annotate(targetOrOptions, 'shadowOptions', { mode: 'open' });\n}\nexport function containerless(target) {\n    if (target === void 0) {\n        return function ($target) {\n            CustomElement.annotate($target, 'containerless', true);\n        };\n    }\n    CustomElement.annotate(target, 'containerless', true);\n}\nexport function strict(target) {\n    if (target === void 0) {\n        return function ($target) {\n            CustomElement.annotate($target, 'isStrictBinding', true);\n        };\n    }\n    CustomElement.annotate(target, 'isStrictBinding', true);\n}\nconst definitionLookup = new WeakMap();\nexport class CustomElementDefinition {\n    constructor(Type, name, aliases, key, cache, template, instructions, dependencies, injectable, needsCompile, surrogates, bindables, childrenObservers, containerless, isStrictBinding, shadowOptions, hasSlots, strategy, hooks, scopeParts) {\n        this.Type = Type;\n        this.name = name;\n        this.aliases = aliases;\n        this.key = key;\n        this.cache = cache;\n        this.template = template;\n        this.instructions = instructions;\n        this.dependencies = dependencies;\n        this.injectable = injectable;\n        this.needsCompile = needsCompile;\n        this.surrogates = surrogates;\n        this.bindables = bindables;\n        this.childrenObservers = childrenObservers;\n        this.containerless = containerless;\n        this.isStrictBinding = isStrictBinding;\n        this.shadowOptions = shadowOptions;\n        this.hasSlots = hasSlots;\n        this.strategy = strategy;\n        this.hooks = hooks;\n        this.scopeParts = scopeParts;\n    }\n    static create(nameOrDef, Type = null) {\n        if (Type === null) {\n            const def = nameOrDef;\n            if (typeof def === 'string') {\n                throw new Error(`Cannot create a custom element definition with only a name and no type: ${nameOrDef}`);\n            }\n            // eslint-disable-next-line @typescript-eslint/unbound-method\n            const name = fromDefinitionOrDefault('name', def, CustomElement.generateName);\n            if (typeof def.Type === 'function') {\n                // This needs to be a clone (it will usually be the compiler calling this signature)\n                // TODO: we need to make sure it's documented that passing in the type via the definition (while passing in null\n                // as the \"Type\" parameter) effectively skips type analysis, so it should only be used this way for cloning purposes.\n                Type = def.Type;\n            }\n            else {\n                Type = CustomElement.generateType(pascalCase(name));\n            }\n            return new CustomElementDefinition(Type, name, mergeArrays(def.aliases), fromDefinitionOrDefault('key', def, () => CustomElement.keyFrom(name)), fromDefinitionOrDefault('cache', def, () => 0), fromDefinitionOrDefault('template', def, () => null), mergeArrays(def.instructions), mergeArrays(def.dependencies), fromDefinitionOrDefault('injectable', def, () => null), fromDefinitionOrDefault('needsCompile', def, () => true), mergeArrays(def.surrogates), Bindable.from(def.bindables), Children.from(def.childrenObservers), fromDefinitionOrDefault('containerless', def, () => false), fromDefinitionOrDefault('isStrictBinding', def, () => false), fromDefinitionOrDefault('shadowOptions', def, () => null), fromDefinitionOrDefault('hasSlots', def, () => false), fromDefinitionOrDefault('strategy', def, () => 1 /* getterSetter */), fromDefinitionOrDefault('hooks', def, () => HooksDefinition.none), mergeArrays(def.scopeParts));\n        }\n        // If a type is passed in, we ignore the Type property on the definition if it exists.\n        // TODO: document this behavior\n        if (typeof nameOrDef === 'string') {\n            return new CustomElementDefinition(Type, nameOrDef, mergeArrays(CustomElement.getAnnotation(Type, 'aliases'), Type.aliases), CustomElement.keyFrom(nameOrDef), fromAnnotationOrTypeOrDefault('cache', Type, () => 0), fromAnnotationOrTypeOrDefault('template', Type, () => null), mergeArrays(CustomElement.getAnnotation(Type, 'instructions'), Type.instructions), mergeArrays(CustomElement.getAnnotation(Type, 'dependencies'), Type.dependencies), fromAnnotationOrTypeOrDefault('injectable', Type, () => null), fromAnnotationOrTypeOrDefault('needsCompile', Type, () => true), mergeArrays(CustomElement.getAnnotation(Type, 'surrogates'), Type.surrogates), Bindable.from(...Bindable.getAll(Type), CustomElement.getAnnotation(Type, 'bindables'), Type.bindables), Children.from(...Children.getAll(Type), CustomElement.getAnnotation(Type, 'childrenObservers'), Type.childrenObservers), fromAnnotationOrTypeOrDefault('containerless', Type, () => false), fromAnnotationOrTypeOrDefault('isStrictBinding', Type, () => false), fromAnnotationOrTypeOrDefault('shadowOptions', Type, () => null), fromAnnotationOrTypeOrDefault('hasSlots', Type, () => false), fromAnnotationOrTypeOrDefault('strategy', Type, () => 1 /* getterSetter */), \n            // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n            fromAnnotationOrTypeOrDefault('hooks', Type, () => new HooksDefinition(Type.prototype)), mergeArrays(CustomElement.getAnnotation(Type, 'scopeParts'), Type.scopeParts));\n        }\n        // This is the typical default behavior, e.g. from regular CustomElement.define invocations or from @customElement deco\n        // The ViewValueConverter also uses this signature and passes in a definition where everything except for the 'hooks'\n        // property needs to be copied. So we have that exception for 'hooks', but we may need to revisit that default behavior\n        // if this turns out to be too opinionated.\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        const name = fromDefinitionOrDefault('name', nameOrDef, CustomElement.generateName);\n        return new CustomElementDefinition(Type, name, mergeArrays(CustomElement.getAnnotation(Type, 'aliases'), nameOrDef.aliases, Type.aliases), CustomElement.keyFrom(name), fromAnnotationOrDefinitionOrTypeOrDefault('cache', nameOrDef, Type, () => 0), fromAnnotationOrDefinitionOrTypeOrDefault('template', nameOrDef, Type, () => null), mergeArrays(CustomElement.getAnnotation(Type, 'instructions'), nameOrDef.instructions, Type.instructions), mergeArrays(CustomElement.getAnnotation(Type, 'dependencies'), nameOrDef.dependencies, Type.dependencies), fromAnnotationOrDefinitionOrTypeOrDefault('injectable', nameOrDef, Type, () => null), fromAnnotationOrDefinitionOrTypeOrDefault('needsCompile', nameOrDef, Type, () => true), mergeArrays(CustomElement.getAnnotation(Type, 'surrogates'), nameOrDef.surrogates, Type.surrogates), Bindable.from(...Bindable.getAll(Type), CustomElement.getAnnotation(Type, 'bindables'), Type.bindables, nameOrDef.bindables), Children.from(...Children.getAll(Type), CustomElement.getAnnotation(Type, 'childrenObservers'), Type.childrenObservers, nameOrDef.childrenObservers), fromAnnotationOrDefinitionOrTypeOrDefault('containerless', nameOrDef, Type, () => false), fromAnnotationOrDefinitionOrTypeOrDefault('isStrictBinding', nameOrDef, Type, () => false), fromAnnotationOrDefinitionOrTypeOrDefault('shadowOptions', nameOrDef, Type, () => null), fromAnnotationOrDefinitionOrTypeOrDefault('hasSlots', nameOrDef, Type, () => false), fromAnnotationOrDefinitionOrTypeOrDefault('strategy', nameOrDef, Type, () => 1 /* getterSetter */), \n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n        fromAnnotationOrTypeOrDefault('hooks', Type, () => new HooksDefinition(Type.prototype)), mergeArrays(CustomElement.getAnnotation(Type, 'scopeParts'), nameOrDef.scopeParts, Type.scopeParts));\n    }\n    static getOrCreate(partialDefinition) {\n        if (partialDefinition instanceof CustomElementDefinition) {\n            return partialDefinition;\n        }\n        if (definitionLookup.has(partialDefinition)) {\n            return definitionLookup.get(partialDefinition);\n        }\n        const definition = CustomElementDefinition.create(partialDefinition);\n        definitionLookup.set(partialDefinition, definition);\n        // Make sure the full definition can be retrieved from dynamically created classes as well\n        Metadata.define(CustomElement.name, definition, definition.Type);\n        return definition;\n    }\n    register(container) {\n        const { Type, key, aliases } = this;\n        Registration.transient(key, Type).register(container);\n        Registration.aliasTo(key, Type).register(container);\n        registerAliases(aliases, CustomElement, key, container);\n    }\n}\nexport const CustomElement = {\n    name: Protocol.resource.keyFor('custom-element'),\n    keyFrom(name) {\n        return `${CustomElement.name}:${name}`;\n    },\n    isType(value) {\n        return typeof value === 'function' && Metadata.hasOwn(CustomElement.name, value);\n    },\n    for(node, nameOrSearchParents, searchParents) {\n        if (nameOrSearchParents === void 0) {\n            return Metadata.getOwn(CustomElement.name, node);\n        }\n        if (typeof nameOrSearchParents === 'string') {\n            if (searchParents !== true) {\n                const controller = Metadata.getOwn(CustomElement.name, node);\n                if (controller === void 0) {\n                    return (void 0);\n                }\n                if (controller.is(nameOrSearchParents)) {\n                    return controller;\n                }\n                return (void 0);\n            }\n            let cur = node;\n            while (cur !== null) {\n                const controller = Metadata.getOwn(CustomElement.name, cur);\n                if (controller !== void 0 && controller.is(nameOrSearchParents)) {\n                    return controller;\n                }\n                cur = DOM.getEffectiveParentNode(cur);\n            }\n            return (void 0);\n        }\n        let cur = node;\n        while (cur !== null) {\n            const controller = Metadata.getOwn(CustomElement.name, cur);\n            if (controller !== void 0) {\n                return controller;\n            }\n            cur = DOM.getEffectiveParentNode(cur);\n        }\n        return (void 0);\n    },\n    define(nameOrDef, Type) {\n        const definition = CustomElementDefinition.create(nameOrDef, Type);\n        Metadata.define(CustomElement.name, definition, definition.Type);\n        Metadata.define(CustomElement.name, definition, definition);\n        Protocol.resource.appendTo(definition.Type, CustomElement.name);\n        return definition.Type;\n    },\n    getDefinition(Type) {\n        const def = Metadata.getOwn(CustomElement.name, Type);\n        if (def === void 0) {\n            throw new Error(`No definition found for type ${Type.name}`);\n        }\n        return def;\n    },\n    annotate(Type, prop, value) {\n        Metadata.define(Protocol.annotation.keyFor(prop), value, Type);\n    },\n    getAnnotation(Type, prop) {\n        return Metadata.getOwn(Protocol.annotation.keyFor(prop), Type);\n    },\n    generateName: (function () {\n        let id = 0;\n        return function () {\n            return `unnamed-${++id}`;\n        };\n    })(),\n    createInjectable() {\n        const $injectable = function (target, property, index) {\n            const annotationParamtypes = DI.getOrCreateAnnotationParamTypes(target);\n            annotationParamtypes[index] = $injectable;\n            return target;\n        };\n        $injectable.register = function (container) {\n            // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n            return {\n                resolve(container, requestor) {\n                    if (requestor.has($injectable, true)) {\n                        return requestor.get($injectable);\n                    }\n                    else {\n                        return null;\n                    }\n                },\n            };\n        };\n        return $injectable;\n    },\n    generateType: (function () {\n        const nameDescriptor = {\n            value: '',\n            writable: false,\n            enumerable: false,\n            configurable: true,\n        };\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const defaultProto = {};\n        return function (name, proto = defaultProto) {\n            // Anonymous class ensures that minification cannot cause unintended side-effects, and keeps the class\n            // looking similarly from the outside (when inspected via debugger, etc).\n            const Type = class {\n            };\n            // Define the name property so that Type.name can be used by end users / plugin authors if they really need to,\n            // even when minified.\n            nameDescriptor.value = name;\n            Reflect.defineProperty(Type, 'name', nameDescriptor);\n            // Assign anything from the prototype that was passed in\n            if (proto !== defaultProto) {\n                Object.assign(Type.prototype, proto);\n            }\n            return Type;\n        };\n    })(),\n};\nexport const IProjectorLocator = DI.createInterface('IProjectorLocator').noDefault();\n//# sourceMappingURL=custom-element.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DI } from '@aurelia/kernel';\nimport { valueConverter } from '../value-converter';\nconst SCRIPT_REGEX = /<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi;\nexport const ISanitizer = DI.createInterface('ISanitizer').withDefault(x => x.singleton(class {\n    sanitize(input) {\n        return input.replace(SCRIPT_REGEX, '');\n    }\n}));\n/**\n * Simple html sanitization converter to preserve whitelisted elements and attributes on a bound property containing html.\n */\nlet SanitizeValueConverter = class SanitizeValueConverter {\n    constructor(sanitizer) {\n        this.sanitizer = sanitizer;\n    }\n    /**\n     * Process the provided markup that flows to the view.\n     *\n     * @param untrustedMarkup - The untrusted markup to be sanitized.\n     */\n    toView(untrustedMarkup) {\n        if (untrustedMarkup == null) {\n            return null;\n        }\n        return this.sanitizer.sanitize(untrustedMarkup);\n    }\n};\nSanitizeValueConverter = __decorate([\n    valueConverter('sanitize'),\n    __param(0, ISanitizer),\n    __metadata(\"design:paramtypes\", [Object])\n], SanitizeValueConverter);\nexport { SanitizeValueConverter };\n//# sourceMappingURL=sanitize.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { all, Registration, Metadata, DI, } from '@aurelia/kernel';\nimport { CallBinding } from './binding/call-binding';\nimport { IExpressionParser } from './binding/expression-parser';\nimport { InterpolationBinding, MultiInterpolationBinding } from './binding/interpolation-binding';\nimport { LetBinding } from './binding/let-binding';\nimport { PropertyBinding } from './binding/property-binding';\nimport { RefBinding } from './binding/ref-binding';\nimport { mergeParts } from './definitions';\nimport { BindingMode } from './flags';\nimport { ILifecycle, } from './lifecycle';\nimport { IObserverLocator } from './observation/observer-locator';\nimport { CustomAttribute, } from './resources/custom-attribute';\nimport { CustomElement, } from './resources/custom-element';\nimport { Controller } from './templating/controller';\nimport { getRenderContext } from './templating/render-context';\nimport { BindingBehaviorExpression } from './binding/ast';\nimport { BindingBehaviorFactory } from './resources/binding-behavior';\nexport const ITemplateCompiler = DI.createInterface('ITemplateCompiler').noDefault();\nexport const IInstructionRenderer = DI.createInterface('IInstructionRenderer').noDefault();\nexport const IRenderer = DI.createInterface('IRenderer').noDefault();\nexport function instructionRenderer(instructionType) {\n    return function decorator(target) {\n        // wrap the constructor to set the instructionType to the instance (for better performance than when set on the prototype)\n        const decoratedTarget = function (...args) {\n            const instance = new target(...args);\n            instance.instructionType = instructionType;\n            return instance;\n        };\n        // make sure we register the decorated constructor with DI\n        decoratedTarget.register = function register(container) {\n            Registration.singleton(IInstructionRenderer, decoratedTarget).register(container);\n        };\n        // copy over any metadata such as annotations (set by preceding decorators) as well as static properties set by the user\n        // also copy the name, to be less confusing to users (so they can still use constructor.name for whatever reason)\n        // the length (number of ctor arguments) is copied for the same reason\n        const metadataKeys = Metadata.getOwnKeys(target);\n        for (const key of metadataKeys) {\n            Metadata.define(key, Metadata.getOwn(key, target), decoratedTarget);\n        }\n        const ownProperties = Object.getOwnPropertyDescriptors(target);\n        Object.keys(ownProperties).filter(prop => prop !== 'prototype').forEach(prop => {\n            Reflect.defineProperty(decoratedTarget, prop, ownProperties[prop]);\n        });\n        return decoratedTarget;\n    };\n}\n/* @internal */\nlet Renderer = class Renderer {\n    constructor(instructionRenderers) {\n        const record = this.instructionRenderers = {};\n        instructionRenderers.forEach(item => {\n            // Binding the functions to the renderer instances and calling the functions directly,\n            // prevents the `render` call sites from going megamorphic.\n            // Consumes slightly more memory but significantly less CPU.\n            record[item.instructionType] = item.render.bind(item);\n        });\n    }\n    static register(container) {\n        return Registration.singleton(IRenderer, this).register(container);\n    }\n    render(flags, context, controller, targets, definition, host, parts) {\n        const targetInstructions = definition.instructions;\n        if (targets.length !== targetInstructions.length) {\n            throw new Error(`The compiled template is not aligned with the render instructions. There are ${targets.length} targets and ${targetInstructions.length} instructions.`);\n        }\n        for (let i = 0, ii = targets.length; i < ii; ++i) {\n            this.renderInstructions(\n            /* flags        */ flags, \n            /* context      */ context, \n            /* instructions */ targetInstructions[i], \n            /* controller   */ controller, \n            /* target       */ targets[i], \n            /* parts        */ parts);\n        }\n        if (host !== void 0 && host !== null) {\n            this.renderInstructions(\n            /* flags        */ flags, \n            /* context      */ context, \n            /* instructions */ definition.surrogates, \n            /* controller   */ controller, \n            /* target       */ host, \n            /* parts        */ parts);\n        }\n    }\n    renderInstructions(flags, context, instructions, controller, target, parts) {\n        const instructionRenderers = this.instructionRenderers;\n        let current;\n        for (let i = 0, ii = instructions.length; i < ii; ++i) {\n            current = instructions[i];\n            instructionRenderers[current.type](flags, context, controller, target, current, parts);\n        }\n    }\n};\nRenderer = __decorate([\n    __param(0, all(IInstructionRenderer)),\n    __metadata(\"design:paramtypes\", [Array])\n], Renderer);\nexport { Renderer };\nexport function ensureExpression(parser, srcOrExpr, bindingType) {\n    if (typeof srcOrExpr === 'string') {\n        return parser.parse(srcOrExpr, bindingType);\n    }\n    return srcOrExpr;\n}\nexport function getTarget(potentialTarget) {\n    if (potentialTarget.bindingContext !== void 0) {\n        return potentialTarget.bindingContext;\n    }\n    return potentialTarget;\n}\nexport function getRefTarget(refHost, refTargetName) {\n    if (refTargetName === 'element') {\n        return refHost;\n    }\n    switch (refTargetName) {\n        case 'controller':\n            // this means it supports returning undefined\n            return CustomElement.for(refHost);\n        case 'view':\n            // todo: returns node sequences for fun?\n            throw new Error('Not supported API');\n        case 'view-model':\n            // this means it supports returning undefined\n            return CustomElement.for(refHost).viewModel;\n        default: {\n            const caController = CustomAttribute.for(refHost, refTargetName);\n            if (caController !== void 0) {\n                return caController.viewModel;\n            }\n            const ceController = CustomElement.for(refHost, refTargetName);\n            if (ceController === void 0) {\n                throw new Error(`Attempted to reference \"${refTargetName}\", but it was not found amongst the target's API.`);\n            }\n            return ceController.viewModel;\n        }\n    }\n}\nlet SetPropertyRenderer = \n/** @internal */\nclass SetPropertyRenderer {\n    render(flags, context, controller, target, instruction) {\n        const obj = getTarget(target);\n        if (obj.$observers !== void 0 && obj.$observers[instruction.to] !== void 0) {\n            obj.$observers[instruction.to].setValue(instruction.value, 4096 /* fromBind */);\n        }\n        else {\n            obj[instruction.to] = instruction.value;\n        }\n    }\n};\nSetPropertyRenderer = __decorate([\n    instructionRenderer(\"re\" /* setProperty */)\n    /** @internal */\n], SetPropertyRenderer);\nexport { SetPropertyRenderer };\nlet CustomElementRenderer = \n/** @internal */\nclass CustomElementRenderer {\n    render(flags, context, controller, target, instruction, parts) {\n        parts = mergeParts(parts, instruction.parts);\n        const factory = context.getComponentFactory(\n        /* parentController */ controller, \n        /* host             */ target, \n        /* instruction      */ instruction, \n        /* viewFactory      */ void 0, \n        /* location         */ target);\n        const key = CustomElement.keyFrom(instruction.res);\n        const component = factory.createComponent(key);\n        const lifecycle = context.get(ILifecycle);\n        const childController = Controller.forCustomElement(\n        /* viewModel       */ component, \n        /* lifecycle       */ lifecycle, \n        /* host            */ target, \n        /* parentContainer */ context, \n        /* parts           */ parts, \n        /* flags           */ flags);\n        flags = childController.flags;\n        Metadata.define(key, childController, target);\n        context.renderInstructions(\n        /* flags        */ flags, \n        /* instructions */ instruction.instructions, \n        /* controller   */ controller, \n        /* target       */ childController, \n        /* parts        */ parts);\n        controller.addController(childController);\n        factory.dispose();\n    }\n};\nCustomElementRenderer = __decorate([\n    instructionRenderer(\"ra\" /* hydrateElement */)\n    /** @internal */\n], CustomElementRenderer);\nexport { CustomElementRenderer };\nlet CustomAttributeRenderer = \n/** @internal */\nclass CustomAttributeRenderer {\n    render(flags, context, controller, target, instruction, parts) {\n        const factory = context.getComponentFactory(\n        /* parentController */ controller, \n        /* host             */ target, \n        /* instruction      */ instruction, \n        /* viewFactory      */ void 0, \n        /* location         */ void 0);\n        const key = CustomAttribute.keyFrom(instruction.res);\n        const component = factory.createComponent(key);\n        const lifecycle = context.get(ILifecycle);\n        const childController = Controller.forCustomAttribute(\n        /* viewModel */ component, \n        /* lifecycle */ lifecycle, \n        /* host      */ target, \n        /* flags     */ flags);\n        Metadata.define(key, childController, target);\n        context.renderInstructions(\n        /* flags        */ flags, \n        /* instructions */ instruction.instructions, \n        /* controller   */ controller, \n        /* target       */ childController, \n        /* parts        */ parts);\n        controller.addController(childController);\n        factory.dispose();\n    }\n};\nCustomAttributeRenderer = __decorate([\n    instructionRenderer(\"rb\" /* hydrateAttribute */)\n    /** @internal */\n], CustomAttributeRenderer);\nexport { CustomAttributeRenderer };\nlet TemplateControllerRenderer = \n/** @internal */\nclass TemplateControllerRenderer {\n    render(flags, parentContext, controller, target, instruction, parts) {\n        parts = mergeParts(parts, instruction.parts);\n        const viewFactory = getRenderContext(instruction.def, parentContext, parts).getViewFactory();\n        const renderLocation = parentContext.dom.convertToRenderLocation(target);\n        const componentFactory = parentContext.getComponentFactory(\n        /* parentController */ controller, \n        /* host             */ target, \n        /* instruction      */ instruction, \n        /* viewFactory      */ viewFactory, \n        /* location         */ renderLocation);\n        const key = CustomAttribute.keyFrom(instruction.res);\n        const component = componentFactory.createComponent(key);\n        const lifecycle = parentContext.get(ILifecycle);\n        const childController = Controller.forCustomAttribute(\n        /* viewModel */ component, \n        /* lifecycle */ lifecycle, \n        /* host      */ target, \n        /* flags     */ flags);\n        Metadata.define(key, childController, renderLocation);\n        if (instruction.link) {\n            const controllers = controller.controllers;\n            component.link(controllers[controllers.length - 1]);\n        }\n        parentContext.renderInstructions(\n        /* flags        */ flags, \n        /* instructions */ instruction.instructions, \n        /* controller   */ controller, \n        /* target       */ childController, \n        /* parts        */ parts);\n        controller.addController(childController);\n        componentFactory.dispose();\n    }\n};\nTemplateControllerRenderer = __decorate([\n    instructionRenderer(\"rc\" /* hydrateTemplateController */)\n    /** @internal */\n], TemplateControllerRenderer);\nexport { TemplateControllerRenderer };\nlet LetElementRenderer = \n/** @internal */\nclass LetElementRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, context, controller, target, instruction) {\n        context.dom.remove(target);\n        const childInstructions = instruction.instructions;\n        const toBindingContext = instruction.toBindingContext;\n        let childInstruction;\n        let expr;\n        let binding;\n        for (let i = 0, ii = childInstructions.length; i < ii; ++i) {\n            childInstruction = childInstructions[i];\n            expr = ensureExpression(this.parser, childInstruction.from, 48 /* IsPropertyCommand */);\n            binding = applyBindingBehavior(new LetBinding(expr, childInstruction.to, this.observerLocator, context, toBindingContext), expr, context);\n            controller.addBinding(binding);\n        }\n    }\n};\nLetElementRenderer = __decorate([\n    instructionRenderer(\"rd\" /* hydrateLetElement */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], LetElementRenderer);\nexport { LetElementRenderer };\nlet CallBindingRenderer = \n/** @internal */\nclass CallBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, context, controller, target, instruction) {\n        const expr = ensureExpression(this.parser, instruction.from, 153 /* CallCommand */);\n        const binding = applyBindingBehavior(new CallBinding(expr, getTarget(target), instruction.to, this.observerLocator, context), expr, context);\n        controller.addBinding(binding);\n    }\n};\nCallBindingRenderer = __decorate([\n    instructionRenderer(\"rh\" /* callBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], CallBindingRenderer);\nexport { CallBindingRenderer };\nlet RefBindingRenderer = \n/** @internal */\nclass RefBindingRenderer {\n    constructor(parser) {\n        this.parser = parser;\n    }\n    render(flags, context, controller, target, instruction) {\n        const expr = ensureExpression(this.parser, instruction.from, 5376 /* IsRef */);\n        const binding = applyBindingBehavior(new RefBinding(expr, getRefTarget(target, instruction.to), context), expr, context);\n        controller.addBinding(binding);\n    }\n};\nRefBindingRenderer = __decorate([\n    instructionRenderer(\"rj\" /* refBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __metadata(\"design:paramtypes\", [Object])\n], RefBindingRenderer);\nexport { RefBindingRenderer };\nlet InterpolationBindingRenderer = \n/** @internal */\nclass InterpolationBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, context, controller, target, instruction) {\n        let binding;\n        const expr = ensureExpression(this.parser, instruction.from, 2048 /* Interpolation */);\n        if (expr.isMulti) {\n            binding = applyBindingBehavior(new MultiInterpolationBinding(this.observerLocator, expr, getTarget(target), instruction.to, BindingMode.toView, context), expr, context);\n        }\n        else {\n            binding = applyBindingBehavior(new InterpolationBinding(expr.firstExpression, expr, getTarget(target), instruction.to, BindingMode.toView, this.observerLocator, context, true), expr, context);\n        }\n        controller.addBinding(binding);\n    }\n};\nInterpolationBindingRenderer = __decorate([\n    instructionRenderer(\"rf\" /* interpolation */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], InterpolationBindingRenderer);\nexport { InterpolationBindingRenderer };\nlet PropertyBindingRenderer = \n/** @internal */\nclass PropertyBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, context, controller, target, instruction) {\n        const expr = ensureExpression(this.parser, instruction.from, 48 /* IsPropertyCommand */ | instruction.mode);\n        const binding = applyBindingBehavior(new PropertyBinding(expr, getTarget(target), instruction.to, instruction.mode, this.observerLocator, context), expr, context);\n        controller.addBinding(binding);\n    }\n};\nPropertyBindingRenderer = __decorate([\n    instructionRenderer(\"rg\" /* propertyBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], PropertyBindingRenderer);\nexport { PropertyBindingRenderer };\nlet IteratorBindingRenderer = \n/** @internal */\nclass IteratorBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, context, controller, target, instruction) {\n        const expr = ensureExpression(this.parser, instruction.from, 539 /* ForCommand */);\n        const binding = applyBindingBehavior(new PropertyBinding(expr, getTarget(target), instruction.to, BindingMode.toView, this.observerLocator, context), expr, context);\n        controller.addBinding(binding);\n    }\n};\nIteratorBindingRenderer = __decorate([\n    instructionRenderer(\"rk\" /* iteratorBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], IteratorBindingRenderer);\nexport { IteratorBindingRenderer };\nlet behaviorExpressionIndex = 0;\nconst behaviorExpressions = [];\nexport function applyBindingBehavior(binding, expression, locator) {\n    while (expression instanceof BindingBehaviorExpression) {\n        behaviorExpressions[behaviorExpressionIndex++] = expression;\n        expression = expression.expression;\n    }\n    while (behaviorExpressionIndex > 0) {\n        const behaviorExpression = behaviorExpressions[--behaviorExpressionIndex];\n        const behaviorOrFactory = locator.get(behaviorExpression.behaviorKey);\n        if (behaviorOrFactory instanceof BindingBehaviorFactory) {\n            binding = behaviorOrFactory.construct(binding, behaviorExpression);\n        }\n    }\n    behaviorExpressions.length = 0;\n    return binding;\n}\n//# sourceMappingURL=renderer.js.map","import { InstanceProvider, Reporter, } from '@aurelia/kernel';\nimport { ITargetedInstruction, mergeParts, } from '../definitions';\nimport { IDOM, IRenderLocation } from '../dom';\nimport { IController, ILifecycle, IViewFactory, } from '../lifecycle';\nimport { IRenderer, ITemplateCompiler } from '../renderer';\nimport { CustomElementDefinition } from '../resources/custom-element';\nimport { ViewFactory } from './view';\nconst definitionContainerLookup = new WeakMap();\nconst definitionContainerPartsLookup = new WeakMap();\nconst fragmentCache = new WeakMap();\nexport function isRenderContext(value) {\n    return value instanceof RenderContext;\n}\nexport function getRenderContext(partialDefinition, parentContainer, parts) {\n    const definition = CustomElementDefinition.getOrCreate(partialDefinition);\n    if (isRenderContext(parentContainer)) {\n        parts = mergeParts(parentContainer.parts, parts);\n    }\n    // injectable completely prevents caching, ensuring that each instance gets a new render context\n    if (definition.injectable !== null) {\n        return new RenderContext(definition, parentContainer, parts);\n    }\n    if (parts === void 0) {\n        let containerLookup = definitionContainerLookup.get(definition);\n        if (containerLookup === void 0) {\n            definitionContainerLookup.set(definition, containerLookup = new WeakMap());\n        }\n        let context = containerLookup.get(parentContainer);\n        if (context === void 0) {\n            containerLookup.set(parentContainer, context = new RenderContext(definition, parentContainer, parts));\n        }\n        return context;\n    }\n    let containerPartsLookup = definitionContainerPartsLookup.get(definition);\n    if (containerPartsLookup === void 0) {\n        definitionContainerPartsLookup.set(definition, containerPartsLookup = new WeakMap());\n    }\n    let partsLookup = containerPartsLookup.get(parentContainer);\n    if (partsLookup === void 0) {\n        containerPartsLookup.set(parentContainer, partsLookup = new WeakMap());\n    }\n    let context = partsLookup.get(parts);\n    if (context === void 0) {\n        partsLookup.set(parts, context = new RenderContext(definition, parentContainer, parts));\n    }\n    return context;\n}\nexport class RenderContext {\n    constructor(definition, parentContainer, parts) {\n        this.definition = definition;\n        this.parentContainer = parentContainer;\n        this.parts = parts;\n        this.viewModelProvider = void 0;\n        this.fragment = null;\n        this.factory = void 0;\n        this.isCompiled = false;\n        this.compiledDefinition = (void 0);\n        const container = this.container = parentContainer.createChild();\n        this.renderer = container.get(IRenderer);\n        container.registerResolver(IViewFactory, this.factoryProvider = new ViewFactoryProvider(), true);\n        container.registerResolver(IController, this.parentControllerProvider = new InstanceProvider(), true);\n        container.registerResolver(ITargetedInstruction, this.instructionProvider = new InstanceProvider(), true);\n        container.registerResolver(IRenderLocation, this.renderLocationProvider = new InstanceProvider(), true);\n        (this.dom = container.get(IDOM)).registerElementResolver(container, this.elementProvider = new InstanceProvider());\n        container.register(...definition.dependencies);\n    }\n    // #region IServiceLocator api\n    has(key, searchAncestors) {\n        return this.container.has(key, searchAncestors);\n    }\n    get(key) {\n        return this.container.get(key);\n    }\n    getAll(key) {\n        return this.container.getAll(key);\n    }\n    // #endregion\n    // #region IContainer api\n    register(...params) {\n        return this.container.register(...params);\n    }\n    registerResolver(key, resolver) {\n        return this.container.registerResolver(key, resolver);\n    }\n    registerTransformer(key, transformer) {\n        return this.container.registerTransformer(key, transformer);\n    }\n    getResolver(key, autoRegister) {\n        return this.container.getResolver(key, autoRegister);\n    }\n    getFactory(key) {\n        return this.container.getFactory(key);\n    }\n    registerFactory(key, factory) {\n        this.container.registerFactory(key, factory);\n    }\n    createChild() {\n        return this.container.createChild();\n    }\n    disposeResolvers() {\n        this.container.disposeResolvers();\n    }\n    // #endregion\n    // #region IRenderContext api\n    compile() {\n        let compiledDefinition;\n        if (this.isCompiled) {\n            return this;\n        }\n        this.isCompiled = true;\n        const definition = this.definition;\n        if (definition.needsCompile) {\n            const container = this.container;\n            const compiler = container.get(ITemplateCompiler);\n            compiledDefinition = this.compiledDefinition = compiler.compile(definition, container);\n        }\n        else {\n            compiledDefinition = this.compiledDefinition = definition;\n        }\n        // Support Recursive Components by adding self to own context\n        compiledDefinition.register(this);\n        if (fragmentCache.has(compiledDefinition)) {\n            this.fragment = fragmentCache.get(compiledDefinition);\n        }\n        else {\n            const template = compiledDefinition.template;\n            if (template === null) {\n                fragmentCache.set(compiledDefinition, null);\n            }\n            else {\n                fragmentCache.set(compiledDefinition, this.fragment = this.dom.createDocumentFragment(template));\n            }\n        }\n        return this;\n    }\n    getViewFactory(name) {\n        let factory = this.factory;\n        if (factory === void 0) {\n            if (name === void 0) {\n                name = this.definition.name;\n            }\n            const lifecycle = this.parentContainer.get(ILifecycle);\n            factory = this.factory = new ViewFactory(name, this, lifecycle, this.parts);\n        }\n        return factory;\n    }\n    beginChildComponentOperation(instance) {\n        const definition = this.definition;\n        if (definition.injectable !== null) {\n            if (this.viewModelProvider === void 0) {\n                this.container.registerResolver(definition.injectable, this.viewModelProvider = new InstanceProvider());\n            }\n            this.viewModelProvider.prepare(instance);\n        }\n        return this;\n    }\n    // #endregion\n    // #region ICompiledRenderContext api\n    createNodes() {\n        return this.dom.createNodeSequence(this.fragment);\n    }\n    // TODO: split up into 2 methods? getComponentFactory + getSyntheticFactory or something\n    getComponentFactory(parentController, host, instruction, viewFactory, location) {\n        if (parentController !== void 0) {\n            this.parentControllerProvider.prepare(parentController);\n        }\n        if (host !== void 0) {\n            // TODO: fix provider input type, Key is probably not a good constraint\n            this.elementProvider.prepare(host);\n        }\n        if (instruction !== void 0) {\n            this.instructionProvider.prepare(instruction);\n        }\n        if (location !== void 0) {\n            this.renderLocationProvider.prepare(location);\n        }\n        if (viewFactory !== void 0) {\n            this.factoryProvider.prepare(viewFactory);\n        }\n        return this;\n    }\n    // #endregion\n    // #region IComponentFactory api\n    createComponent(resourceKey) {\n        return this.container.get(resourceKey);\n    }\n    render(flags, controller, targets, templateDefinition, host, parts) {\n        this.renderer.render(flags, this, controller, targets, templateDefinition, host, parts);\n    }\n    renderInstructions(flags, instructions, controller, target, parts) {\n        this.renderer.renderInstructions(flags, this, instructions, controller, target, parts);\n    }\n    dispose() {\n        this.elementProvider.dispose();\n        this.container.disposeResolvers();\n    }\n}\n/** @internal */\nexport class ViewFactoryProvider {\n    constructor() {\n        this.factory = null;\n    }\n    prepare(factory) {\n        this.factory = factory;\n    }\n    get $isResolver() { return true; }\n    resolve(handler, requestor) {\n        const factory = this.factory;\n        if (factory === null) { // unmet precondition: call prepare\n            throw Reporter.error(50); // TODO: organize error codes\n        }\n        if (typeof factory.name !== 'string' || factory.name.length === 0) { // unmet invariant: factory must have a name\n            throw Reporter.error(51); // TODO: organize error codes\n        }\n        return factory.resolve(requestor);\n    }\n    dispose() {\n        this.factory = null;\n    }\n}\n//# sourceMappingURL=render-context.js.map","import { mergeDistinct, nextId, } from '@aurelia/kernel';\nimport { HooksDefinition, } from '../definitions';\nimport { AggregateContinuationTask, ContinuationTask, hasAsyncWork, LifecycleTask, } from '../lifecycle-task';\nimport { Scope, } from '../observation/binding-context';\nimport { ProxyObserver, } from '../observation/proxy-observer';\nimport { BindableObserver, } from '../observation/bindable-observer';\nimport { IProjectorLocator, CustomElementDefinition, CustomElement, } from '../resources/custom-element';\nimport { CustomAttribute, } from '../resources/custom-attribute';\nimport { getRenderContext, } from './render-context';\nimport { ChildrenObserver } from './children';\nconst controllerLookup = new WeakMap();\nexport class Controller {\n    constructor(vmKind, flags, lifecycle, hooks, \n    /**\n     * The viewFactory. Only present for synthetic views.\n     */\n    viewFactory, \n    /**\n     * The backing viewModel. This is never a proxy. Only present for custom attributes and elements.\n     */\n    viewModel, \n    /**\n     * The binding context. This may be a proxy. If it is not, then it is the same instance as the viewModel. Only present for custom attributes and elements.\n     */\n    bindingContext, \n    /**\n     * The physical host dom node. Only present for custom elements.\n     */\n    host) {\n        this.vmKind = vmKind;\n        this.flags = flags;\n        this.lifecycle = lifecycle;\n        this.hooks = hooks;\n        this.viewFactory = viewFactory;\n        this.viewModel = viewModel;\n        this.bindingContext = bindingContext;\n        this.host = host;\n        this.id = nextId('au$component');\n        this.nextBound = void 0;\n        this.nextUnbound = void 0;\n        this.prevBound = void 0;\n        this.prevUnbound = void 0;\n        this.nextAttached = void 0;\n        this.nextDetached = void 0;\n        this.prevAttached = void 0;\n        this.prevDetached = void 0;\n        this.nextMount = void 0;\n        this.nextUnmount = void 0;\n        this.prevMount = void 0;\n        this.prevUnmount = void 0;\n        this.parent = void 0;\n        this.bindings = void 0;\n        this.controllers = void 0;\n        this.state = 0 /* none */;\n        this.scopeParts = void 0;\n        this.isStrictBinding = false;\n        this.scope = void 0;\n        this.part = void 0;\n        this.projector = void 0;\n        this.nodes = void 0;\n        this.context = void 0;\n        this.location = void 0;\n        this.mountStrategy = 1 /* insertBefore */;\n    }\n    static getCached(viewModel) {\n        return controllerLookup.get(viewModel);\n    }\n    static getCachedOrThrow(viewModel) {\n        const controller = Controller.getCached(viewModel);\n        if (controller === void 0) {\n            throw new Error(`There is no cached controller for the provided ViewModel: ${String(viewModel)}`);\n        }\n        return controller;\n    }\n    static forCustomElement(viewModel, lifecycle, host, parentContainer, parts, flags = 0 /* none */) {\n        if (controllerLookup.has(viewModel)) {\n            return controllerLookup.get(viewModel);\n        }\n        const definition = CustomElement.getDefinition(viewModel.constructor);\n        flags |= definition.strategy;\n        const controller = new Controller(0 /* customElement */, \n        /* flags          */ flags, \n        /* lifecycle      */ lifecycle, \n        /* hooks          */ definition.hooks, \n        /* viewFactory    */ void 0, \n        /* viewModel      */ viewModel, \n        /* bindingContext */ getBindingContext(flags, viewModel), \n        /* host           */ host);\n        controllerLookup.set(viewModel, controller);\n        controller.hydrateCustomElement(definition, parentContainer, parts);\n        return controller;\n    }\n    static forCustomAttribute(viewModel, lifecycle, host, flags = 0 /* none */) {\n        if (controllerLookup.has(viewModel)) {\n            return controllerLookup.get(viewModel);\n        }\n        const definition = CustomAttribute.getDefinition(viewModel.constructor);\n        flags |= definition.strategy;\n        const controller = new Controller(1 /* customAttribute */, \n        /* flags          */ flags, \n        /* lifecycle      */ lifecycle, \n        /* hooks          */ definition.hooks, \n        /* viewFactory    */ void 0, \n        /* viewModel      */ viewModel, \n        /* bindingContext */ getBindingContext(flags, viewModel), \n        /* host           */ host);\n        controllerLookup.set(viewModel, controller);\n        controller.hydrateCustomAttribute(definition);\n        return controller;\n    }\n    static forSyntheticView(viewFactory, lifecycle, context, flags = 0 /* none */) {\n        const controller = new Controller(2 /* synthetic */, \n        /* flags          */ flags, \n        /* lifecycle      */ lifecycle, \n        /* hooks          */ HooksDefinition.none, \n        /* viewFactory    */ viewFactory, \n        /* viewModel      */ void 0, \n        /* bindingContext */ void 0, \n        /* host           */ void 0);\n        controller.hydrateSynthetic(context, viewFactory.parts);\n        return controller;\n    }\n    hydrateCustomElement(definition, parentContainer, parts) {\n        const flags = this.flags |= definition.strategy;\n        const instance = this.viewModel;\n        createObservers(this.lifecycle, definition, flags, instance);\n        createChildrenObservers(this, definition, flags, instance);\n        this.scope = Scope.create(flags, this.bindingContext, null);\n        const hooks = this.hooks;\n        if (hooks.hasCreate) {\n            const result = instance.create(\n            /* controller      */ this, \n            /* parentContainer */ parentContainer, \n            /* definition      */ definition, \n            /* parts           */ parts);\n            if (result !== void 0 && result !== definition) {\n                definition = CustomElementDefinition.getOrCreate(result);\n            }\n        }\n        const context = this.context = getRenderContext(definition, parentContainer, parts);\n        // Support Recursive Components by adding self to own context\n        definition.register(context);\n        if (definition.injectable !== null) {\n            // If the element is registered as injectable, support injecting the instance into children\n            context.beginChildComponentOperation(instance);\n        }\n        if (hooks.hasBeforeCompile) {\n            instance.beforeCompile(this);\n        }\n        const compiledContext = context.compile();\n        const compiledDefinition = compiledContext.compiledDefinition;\n        this.scopeParts = compiledDefinition.scopeParts;\n        this.isStrictBinding = compiledDefinition.isStrictBinding;\n        const projectorLocator = parentContainer.get(IProjectorLocator);\n        this.projector = projectorLocator.getElementProjector(context.dom, this, this.host, compiledDefinition);\n        instance.$controller = this;\n        const nodes = this.nodes = compiledContext.createNodes();\n        if (hooks.hasAfterCompile) {\n            instance.afterCompile(this);\n        }\n        const targets = nodes.findTargets();\n        compiledContext.render(\n        /* flags      */ this.flags, \n        /* controller */ this, \n        /* targets    */ targets, \n        /* definition */ compiledDefinition, \n        /* host       */ this.host, \n        /* parts      */ parts);\n        if (hooks.hasAfterCompileChildren) {\n            instance.afterCompileChildren(this);\n        }\n    }\n    hydrateCustomAttribute(definition) {\n        const flags = this.flags | definition.strategy;\n        const instance = this.viewModel;\n        createObservers(this.lifecycle, definition, flags, instance);\n        instance.$controller = this;\n    }\n    hydrateSynthetic(context, parts) {\n        this.context = context;\n        const compiledContext = context.compile();\n        const compiledDefinition = compiledContext.compiledDefinition;\n        this.scopeParts = compiledDefinition.scopeParts;\n        this.isStrictBinding = compiledDefinition.isStrictBinding;\n        const nodes = this.nodes = compiledContext.createNodes();\n        const targets = nodes.findTargets();\n        compiledContext.render(\n        /* flags      */ this.flags, \n        /* controller */ this, \n        /* targets    */ targets, \n        /* definition */ compiledDefinition, \n        /* host       */ void 0, \n        /* parts      */ parts);\n    }\n    addBinding(binding) {\n        if (this.bindings === void 0) {\n            this.bindings = [binding];\n        }\n        else {\n            this.bindings[this.bindings.length] = binding;\n        }\n    }\n    addController(controller) {\n        if (this.controllers === void 0) {\n            this.controllers = [controller];\n        }\n        else {\n            this.controllers[this.controllers.length] = controller;\n        }\n    }\n    is(name) {\n        switch (this.vmKind) {\n            case 1 /* customAttribute */: {\n                const def = CustomAttribute.getDefinition(this.viewModel.constructor);\n                return def.name === name;\n            }\n            case 0 /* customElement */: {\n                const def = CustomElement.getDefinition(this.viewModel.constructor);\n                return def.name === name;\n            }\n            case 2 /* synthetic */:\n                return this.viewFactory.name === name;\n        }\n    }\n    lockScope(scope) {\n        this.scope = scope;\n        this.state |= 256 /* hasLockedScope */;\n    }\n    hold(location, mountStrategy) {\n        this.state = (this.state | 512 /* canBeCached */) ^ 512 /* canBeCached */;\n        this.location = location;\n        this.mountStrategy = mountStrategy;\n    }\n    release(flags) {\n        this.state |= 512 /* canBeCached */;\n        if ((this.state & 32 /* isAttached */) > 0) {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            return this.viewFactory.canReturnToCache(this); // non-null is implied by the hook\n        }\n        return this.unmountSynthetic(flags);\n    }\n    bind(flags, scope, part) {\n        this.part = part;\n        // TODO: benchmark which of these techniques is fastest:\n        // - the current one (enum with switch)\n        // - set the name of the method in the constructor, e.g. this.bindMethod = 'bindCustomElement'\n        //    and then doing this[this.bindMethod](flags, scope) instead of switch (eliminates branching\n        //    but computed property access might be harmful to browser optimizations)\n        // - make bind() a property and set it to one of the 3 methods in the constructor,\n        //    e.g. this.bind = this.bindCustomElement (eliminates branching + reduces call stack depth by 1,\n        //    but might make the call site megamorphic)\n        flags |= 4096 /* fromBind */;\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                return this.bindCustomElement(flags, scope);\n            case 1 /* customAttribute */:\n                return this.bindCustomAttribute(flags, scope);\n            case 2 /* synthetic */:\n                return this.bindSynthetic(flags, scope);\n        }\n    }\n    unbind(flags) {\n        flags |= 8192 /* fromUnbind */;\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                return this.unbindCustomElement(flags);\n            case 1 /* customAttribute */:\n                return this.unbindCustomAttribute(flags);\n            case 2 /* synthetic */:\n                return this.unbindSynthetic(flags);\n        }\n    }\n    afterBind(flags) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.bindingContext.afterBind(flags); // non-null is implied by the hook\n    }\n    afterUnbind(flags) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.bindingContext.afterUnbind(flags); // non-null is implied by the hook\n    }\n    attach(flags) {\n        if ((this.state & 40 /* isAttachedOrAttaching */) > 0 && (flags & 33554432 /* reorderNodes */) === 0) {\n            return;\n        }\n        flags |= 16384 /* fromAttach */;\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                this.attachCustomElement(flags);\n                break;\n            case 1 /* customAttribute */:\n                this.attachCustomAttribute(flags);\n                break;\n            case 2 /* synthetic */:\n                this.attachSynthetic(flags);\n        }\n    }\n    detach(flags) {\n        if ((this.state & 40 /* isAttachedOrAttaching */) === 0) {\n            return;\n        }\n        flags |= 32768 /* fromDetach */;\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                this.detachCustomElement(flags);\n                break;\n            case 1 /* customAttribute */:\n                this.detachCustomAttribute(flags);\n                break;\n            case 2 /* synthetic */:\n                this.detachSynthetic(flags);\n        }\n    }\n    afterAttach(flags) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.bindingContext.afterAttach(flags); // non-null is implied by the hook\n    }\n    afterDetach(flags) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.bindingContext.afterDetach(flags); // non-null is implied by the hook\n    }\n    mount(flags) {\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                this.mountCustomElement(flags);\n                break;\n            case 2 /* synthetic */:\n                this.mountSynthetic(flags);\n        }\n    }\n    unmount(flags) {\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                this.unmountCustomElement(flags);\n                break;\n            case 2 /* synthetic */:\n                this.unmountSynthetic(flags);\n        }\n    }\n    cache(flags) {\n        switch (this.vmKind) {\n            case 0 /* customElement */:\n                this.cacheCustomElement(flags);\n                break;\n            case 1 /* customAttribute */:\n                this.cacheCustomAttribute(flags);\n                break;\n            case 2 /* synthetic */:\n                this.cacheSynthetic(flags);\n        }\n    }\n    getTargetAccessor(propertyName) {\n        const { bindings } = this;\n        if (bindings !== void 0) {\n            const binding = bindings.find(b => b.targetProperty === propertyName);\n            if (binding !== void 0) {\n                return binding.targetObserver;\n            }\n        }\n        return void 0;\n    }\n    // #region bind/unbind\n    bindCustomElement(flags, scope) {\n        const $scope = this.scope;\n        $scope.parentScope = scope === void 0 ? null : scope;\n        $scope.scopeParts = this.scopeParts;\n        if ((this.state & 4 /* isBound */) > 0) {\n            return LifecycleTask.done;\n        }\n        flags |= 4096 /* fromBind */;\n        this.state |= 1 /* isBinding */;\n        this.lifecycle.afterBind.begin();\n        if (this.hooks.hasBeforeBind) {\n            const ret = this.bindingContext.beforeBind(flags);\n            if (hasAsyncWork(ret)) {\n                // this.scope could be reassigned during beforeBind so reference that instead of $scope.\n                return new ContinuationTask(ret, this.bindBindings, this, flags, this.scope);\n            }\n        }\n        return this.bindBindings(flags, this.scope);\n    }\n    bindCustomAttribute(flags, scope) {\n        if ((this.state & 4 /* isBound */) > 0) {\n            if (this.scope === scope) {\n                return LifecycleTask.done;\n            }\n            flags |= 4096 /* fromBind */;\n            const task = this.unbind(flags);\n            if (!task.done) {\n                return new ContinuationTask(task, this.bind, this, flags, scope);\n            }\n        }\n        else {\n            flags |= 4096 /* fromBind */;\n        }\n        this.state |= 1 /* isBinding */;\n        this.scope = scope;\n        this.lifecycle.afterBind.begin();\n        if (this.hooks.hasBeforeBind) {\n            const ret = this.bindingContext.beforeBind(flags);\n            if (hasAsyncWork(ret)) {\n                return new ContinuationTask(ret, this.endBind, this, flags);\n            }\n        }\n        this.endBind(flags);\n        return LifecycleTask.done;\n    }\n    bindSynthetic(flags, scope) {\n        if (scope == void 0) {\n            throw new Error(`Scope is null or undefined`); // TODO: create error code\n        }\n        scope.scopeParts = mergeDistinct(scope.scopeParts, this.scopeParts, false);\n        if ((this.state & 4 /* isBound */) > 0) {\n            if (this.scope === scope || (this.state & 256 /* hasLockedScope */) > 0) {\n                return LifecycleTask.done;\n            }\n            flags |= 4096 /* fromBind */;\n            const task = this.unbind(flags);\n            if (!task.done) {\n                return new ContinuationTask(task, this.bind, this, flags, scope);\n            }\n        }\n        else {\n            flags |= 4096 /* fromBind */;\n        }\n        if ((this.state & 256 /* hasLockedScope */) === 0) {\n            this.scope = scope;\n        }\n        this.state |= 1 /* isBinding */;\n        this.lifecycle.afterBind.begin();\n        return this.bindBindings(flags, this.scope);\n    }\n    bindBindings(flags, scope) {\n        const { bindings } = this;\n        if (bindings !== void 0) {\n            const { length } = bindings;\n            if (this.isStrictBinding) {\n                flags |= 4 /* isStrictBindingStrategy */;\n            }\n            for (let i = 0; i < length; ++i) {\n                bindings[i].$bind(flags, scope, this.part);\n            }\n        }\n        return this.bindControllers(flags, this.scope);\n    }\n    bindControllers(flags, scope) {\n        let tasks = void 0;\n        let task;\n        const { controllers } = this;\n        if (controllers !== void 0) {\n            const { length } = controllers;\n            for (let i = 0; i < length; ++i) {\n                controllers[i].parent = this;\n                task = controllers[i].bind(flags, scope, this.part);\n                if (!task.done) {\n                    if (tasks === void 0) {\n                        tasks = [];\n                    }\n                    tasks.push(task);\n                }\n            }\n        }\n        if (tasks === void 0) {\n            this.endBind(flags);\n            return LifecycleTask.done;\n        }\n        return new AggregateContinuationTask(tasks, this.endBind, this, flags);\n    }\n    endBind(flags) {\n        if (this.hooks.hasAfterBind) {\n            this.lifecycle.afterBind.add(this);\n        }\n        this.state = this.state ^ 1 /* isBinding */ | 4 /* isBound */;\n        this.lifecycle.afterBind.end(flags);\n    }\n    unbindCustomElement(flags) {\n        if ((this.state & 4 /* isBound */) === 0) {\n            return LifecycleTask.done;\n        }\n        this.scope.parentScope = null;\n        this.state |= 2 /* isUnbinding */;\n        flags |= 8192 /* fromUnbind */;\n        this.lifecycle.afterUnbind.begin();\n        if (this.hooks.hasBeforeUnbind) {\n            const ret = this.bindingContext.beforeUnbind(flags);\n            if (hasAsyncWork(ret)) {\n                return new ContinuationTask(ret, this.unbindControllers, this, flags);\n            }\n        }\n        return this.unbindControllers(flags);\n    }\n    unbindCustomAttribute(flags) {\n        if ((this.state & 4 /* isBound */) === 0) {\n            return LifecycleTask.done;\n        }\n        this.state |= 2 /* isUnbinding */;\n        flags |= 8192 /* fromUnbind */;\n        this.lifecycle.afterUnbind.begin();\n        if (this.hooks.hasBeforeUnbind) {\n            const ret = this.bindingContext.beforeUnbind(flags);\n            if (hasAsyncWork(ret)) {\n                return new ContinuationTask(ret, this.endUnbind, this, flags);\n            }\n        }\n        this.endUnbind(flags);\n        return LifecycleTask.done;\n    }\n    unbindSynthetic(flags) {\n        if ((this.state & 4 /* isBound */) === 0) {\n            return LifecycleTask.done;\n        }\n        this.state |= 2 /* isUnbinding */;\n        flags |= 8192 /* fromUnbind */;\n        this.lifecycle.afterUnbind.begin();\n        return this.unbindControllers(flags);\n    }\n    unbindBindings(flags) {\n        const { bindings } = this;\n        if (bindings !== void 0) {\n            for (let i = bindings.length - 1; i >= 0; --i) {\n                bindings[i].$unbind(flags);\n            }\n        }\n        this.endUnbind(flags);\n    }\n    unbindControllers(flags) {\n        let tasks = void 0;\n        let task;\n        const { controllers } = this;\n        if (controllers !== void 0) {\n            for (let i = controllers.length - 1; i >= 0; --i) {\n                task = controllers[i].unbind(flags);\n                controllers[i].parent = void 0;\n                if (!task.done) {\n                    if (tasks === void 0) {\n                        tasks = [];\n                    }\n                    tasks.push(task);\n                }\n            }\n        }\n        if (tasks === void 0) {\n            this.unbindBindings(flags);\n            return LifecycleTask.done;\n        }\n        return new AggregateContinuationTask(tasks, this.unbindBindings, this, flags);\n    }\n    endUnbind(flags) {\n        switch (this.vmKind) {\n            case 1 /* customAttribute */:\n                this.scope = void 0;\n                break;\n            case 2 /* synthetic */:\n                if ((this.state & 256 /* hasLockedScope */) === 0) {\n                    this.scope = void 0;\n                }\n        }\n        if (this.hooks.hasAfterUnbind) {\n            this.lifecycle.afterUnbind.add(this);\n        }\n        this.state = (this.state | 6 /* isBoundOrUnbinding */) ^ 6 /* isBoundOrUnbinding */;\n        this.lifecycle.afterUnbind.end(flags);\n    }\n    // #endregion\n    // #region attach/detach\n    attachCustomElement(flags) {\n        flags |= 16384 /* fromAttach */;\n        this.state |= 8 /* isAttaching */;\n        this.lifecycle.mount.add(this);\n        this.lifecycle.afterAttach.begin();\n        if (this.hooks.hasBeforeAttach) {\n            this.bindingContext.beforeAttach(flags);\n        }\n        this.attachControllers(flags);\n        if (this.hooks.hasAfterAttach) {\n            this.lifecycle.afterAttach.add(this);\n        }\n        this.state = this.state ^ 8 /* isAttaching */ | 32 /* isAttached */;\n        this.lifecycle.afterAttach.end(flags);\n    }\n    attachCustomAttribute(flags) {\n        flags |= 16384 /* fromAttach */;\n        this.state |= 8 /* isAttaching */;\n        this.lifecycle.afterAttach.begin();\n        if (this.hooks.hasBeforeAttach) {\n            this.bindingContext.beforeAttach(flags);\n        }\n        if (this.hooks.hasAfterAttach) {\n            this.lifecycle.afterAttach.add(this);\n        }\n        this.state = this.state ^ 8 /* isAttaching */ | 32 /* isAttached */;\n        this.lifecycle.afterAttach.end(flags);\n    }\n    attachSynthetic(flags) {\n        if (((this.state & 32 /* isAttached */) > 0 && flags & 33554432 /* reorderNodes */) > 0) {\n            this.lifecycle.mount.add(this);\n        }\n        else {\n            flags |= 16384 /* fromAttach */;\n            this.state |= 8 /* isAttaching */;\n            this.lifecycle.mount.add(this);\n            this.lifecycle.afterAttach.begin();\n            this.attachControllers(flags);\n            this.state = this.state ^ 8 /* isAttaching */ | 32 /* isAttached */;\n            this.lifecycle.afterAttach.end(flags);\n        }\n    }\n    detachCustomElement(flags) {\n        flags |= 32768 /* fromDetach */;\n        this.state |= 16 /* isDetaching */;\n        this.lifecycle.afterDetach.begin();\n        this.lifecycle.unmount.add(this);\n        if (this.hooks.hasBeforeDetach) {\n            this.bindingContext.beforeDetach(flags);\n        }\n        this.detachControllers(flags);\n        if (this.hooks.hasAfterDetach) {\n            this.lifecycle.afterDetach.add(this);\n        }\n        this.state = (this.state | 48 /* isAttachedOrDetaching */) ^ 48 /* isAttachedOrDetaching */;\n        this.lifecycle.afterDetach.end(flags);\n    }\n    detachCustomAttribute(flags) {\n        flags |= 32768 /* fromDetach */;\n        this.state |= 16 /* isDetaching */;\n        this.lifecycle.afterDetach.begin();\n        if (this.hooks.hasBeforeDetach) {\n            this.bindingContext.beforeDetach(flags);\n        }\n        if (this.hooks.hasAfterDetach) {\n            this.lifecycle.afterDetach.add(this);\n        }\n        this.state = (this.state | 48 /* isAttachedOrDetaching */) ^ 48 /* isAttachedOrDetaching */;\n        this.lifecycle.afterDetach.end(flags);\n    }\n    detachSynthetic(flags) {\n        flags |= 32768 /* fromDetach */;\n        this.state |= 16 /* isDetaching */;\n        this.lifecycle.afterDetach.begin();\n        this.lifecycle.unmount.add(this);\n        this.detachControllers(flags);\n        this.state = (this.state | 48 /* isAttachedOrDetaching */) ^ 48 /* isAttachedOrDetaching */;\n        this.lifecycle.afterDetach.end(flags);\n    }\n    attachControllers(flags) {\n        const { controllers } = this;\n        if (controllers !== void 0) {\n            const { length } = controllers;\n            for (let i = 0; i < length; ++i) {\n                controllers[i].attach(flags);\n            }\n        }\n    }\n    detachControllers(flags) {\n        const { controllers } = this;\n        if (controllers !== void 0) {\n            for (let i = controllers.length - 1; i >= 0; --i) {\n                controllers[i].detach(flags);\n            }\n        }\n    }\n    // #endregion\n    // #region mount/unmount/cache\n    mountCustomElement(flags) {\n        if ((this.state & 64 /* isMounted */) > 0) {\n            return;\n        }\n        this.state |= 64 /* isMounted */;\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.projector.project(this.nodes); // non-null is implied by the hook\n    }\n    mountSynthetic(flags) {\n        const nodes = this.nodes; // non null is implied by the hook\n        const location = this.location; // non null is implied by the hook\n        this.state |= 64 /* isMounted */;\n        switch (this.mountStrategy) {\n            case 2 /* append */:\n                nodes.appendTo(location);\n                break;\n            default:\n                nodes.insertBefore(location);\n        }\n    }\n    unmountCustomElement(flags) {\n        if ((this.state & 64 /* isMounted */) === 0) {\n            return;\n        }\n        this.state = (this.state | 64 /* isMounted */) ^ 64 /* isMounted */;\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.projector.take(this.nodes); // non-null is implied by the hook\n    }\n    unmountSynthetic(flags) {\n        if ((this.state & 64 /* isMounted */) === 0) {\n            return false;\n        }\n        this.state = (this.state | 64 /* isMounted */) ^ 64 /* isMounted */;\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        this.nodes.remove(); // non-null is implied by the hook\n        this.nodes.unlink();\n        if ((this.state & 512 /* canBeCached */) > 0) {\n            this.state = (this.state | 512 /* canBeCached */) ^ 512 /* canBeCached */;\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            if (this.viewFactory.tryReturnToCache(this)) { // non-null is implied by the hook\n                return true;\n            }\n        }\n        return false;\n    }\n    cacheCustomElement(flags) {\n        flags |= 65536 /* fromCache */;\n        if (this.hooks.hasCaching) {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.bindingContext.caching(flags); // non-null is implied by the hook\n        }\n    }\n    cacheCustomAttribute(flags) {\n        flags |= 65536 /* fromCache */;\n        if (this.hooks.hasCaching) {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            this.bindingContext.caching(flags); // non-null is implied by the hook\n        }\n        const { controllers } = this;\n        if (controllers !== void 0) {\n            const { length } = controllers;\n            for (let i = length - 1; i >= 0; --i) {\n                controllers[i].cache(flags);\n            }\n        }\n    }\n    cacheSynthetic(flags) {\n        const { controllers } = this;\n        if (controllers !== void 0) {\n            const { length } = controllers;\n            for (let i = length - 1; i >= 0; --i) {\n                controllers[i].cache(flags);\n            }\n        }\n    }\n}\nfunction getBindingContext(flags, instance) {\n    if (instance.noProxy === true || (flags & 2 /* proxyStrategy */) === 0) {\n        return instance;\n    }\n    return ProxyObserver.getOrCreate(instance).proxy;\n}\nfunction getLookup(instance) {\n    let lookup = instance.$observers;\n    if (lookup === void 0) {\n        Reflect.defineProperty(instance, '$observers', {\n            enumerable: false,\n            value: lookup = {},\n        });\n    }\n    return lookup;\n}\nfunction createObservers(lifecycle, definition, flags, instance) {\n    const bindables = definition.bindables;\n    const observableNames = Object.getOwnPropertyNames(bindables);\n    const length = observableNames.length;\n    if (length > 0) {\n        let name;\n        let bindable;\n        if ((flags & 2 /* proxyStrategy */) > 0) {\n            for (let i = 0; i < length; ++i) {\n                name = observableNames[i];\n                bindable = bindables[name];\n                new BindableObserver(lifecycle, flags, ProxyObserver.getOrCreate(instance).proxy, name, bindable.callback, bindable.set);\n            }\n        }\n        else {\n            const observers = getLookup(instance);\n            for (let i = 0; i < length; ++i) {\n                name = observableNames[i];\n                if (observers[name] === void 0) {\n                    bindable = bindables[name];\n                    observers[name] = new BindableObserver(lifecycle, flags, instance, name, bindable.callback, bindable.set);\n                }\n            }\n        }\n    }\n}\nfunction createChildrenObservers(controller, definition, flags, instance) {\n    const childrenObservers = definition.childrenObservers;\n    const childObserverNames = Object.getOwnPropertyNames(childrenObservers);\n    const length = childObserverNames.length;\n    if (length > 0) {\n        const observers = getLookup(instance);\n        let name;\n        for (let i = 0; i < length; ++i) {\n            name = childObserverNames[i];\n            if (observers[name] == void 0) {\n                const childrenDescription = childrenObservers[name];\n                observers[name] = new ChildrenObserver(controller, instance, flags, name, childrenDescription.callback, childrenDescription.query, childrenDescription.filter, childrenDescription.map, childrenDescription.options);\n            }\n        }\n    }\n}\n//# sourceMappingURL=controller.js.map","import { DI, Registration, Metadata, Protocol } from '@aurelia/kernel';\nimport { Scope } from '../observation/binding-context';\nimport { CustomElement, CustomElementDefinition } from '../resources/custom-element';\nimport { Controller } from './controller';\nimport { mergeParts } from '../definitions';\nimport { getRenderContext } from './render-context';\nexport class ViewFactory {\n    constructor(name, context, lifecycle, parts) {\n        this.name = name;\n        this.context = context;\n        this.lifecycle = lifecycle;\n        this.parts = parts;\n        this.isCaching = false;\n        this.cache = null;\n        this.cacheSize = -1;\n    }\n    setCacheSize(size, doNotOverrideIfAlreadySet) {\n        if (size) {\n            if (size === '*') {\n                size = ViewFactory.maxCacheSize;\n            }\n            else if (typeof size === 'string') {\n                size = parseInt(size, 10);\n            }\n            if (this.cacheSize === -1 || !doNotOverrideIfAlreadySet) {\n                this.cacheSize = size;\n            }\n        }\n        if (this.cacheSize > 0) {\n            this.cache = [];\n        }\n        else {\n            this.cache = null;\n        }\n        this.isCaching = this.cacheSize > 0;\n    }\n    canReturnToCache(controller) {\n        return this.cache != null && this.cache.length < this.cacheSize;\n    }\n    tryReturnToCache(controller) {\n        if (this.canReturnToCache(controller)) {\n            controller.cache(0 /* none */);\n            this.cache.push(controller);\n            return true;\n        }\n        return false;\n    }\n    create(flags) {\n        const cache = this.cache;\n        let controller;\n        if (cache != null && cache.length > 0) {\n            controller = cache.pop();\n            return controller;\n        }\n        controller = Controller.forSyntheticView(this, this.lifecycle, this.context, flags);\n        return controller;\n    }\n    resolve(requestor, parts) {\n        parts = mergeParts(this.parts, parts);\n        if (parts === void 0) {\n            return this;\n        }\n        const part = parts[this.name];\n        if (part === void 0) {\n            return this;\n        }\n        return getRenderContext(part, requestor, parts).getViewFactory(this.name);\n    }\n}\nViewFactory.maxCacheSize = 0xFFFF;\nconst seenViews = new WeakSet();\nfunction notYetSeen($view) {\n    return !seenViews.has($view);\n}\nfunction toCustomElementDefinition($view) {\n    seenViews.add($view);\n    return CustomElementDefinition.create($view);\n}\nexport const Views = {\n    name: Protocol.resource.keyFor('views'),\n    has(value) {\n        return typeof value === 'function' && (Metadata.hasOwn(Views.name, value) || '$views' in value);\n    },\n    get(value) {\n        if (typeof value === 'function' && '$views' in value) {\n            // TODO: a `get` operation with side effects is not a good thing. Should refactor this to a proper resource kind.\n            const $views = value.$views;\n            const definitions = $views.filter(notYetSeen).map(toCustomElementDefinition);\n            for (const def of definitions) {\n                Views.add(value, def);\n            }\n        }\n        let views = Metadata.getOwn(Views.name, value);\n        if (views === void 0) {\n            Metadata.define(Views.name, views = [], value);\n        }\n        return views;\n    },\n    add(Type, partialDefinition) {\n        const definition = CustomElementDefinition.create(partialDefinition);\n        let views = Metadata.getOwn(Views.name, Type);\n        if (views === void 0) {\n            Metadata.define(Views.name, views = [definition], Type);\n        }\n        else {\n            views.push(definition);\n        }\n        return views;\n    },\n};\nexport function view(v) {\n    return function (target) {\n        Views.add(target, v);\n    };\n}\nexport const IViewLocator = DI.createInterface('IViewLocator')\n    .noDefault();\nexport class ViewLocator {\n    constructor() {\n        this.modelInstanceToBoundComponent = new WeakMap();\n        this.modelTypeToUnboundComponent = new Map();\n    }\n    static register(container) {\n        return Registration.singleton(IViewLocator, this).register(container);\n    }\n    getViewComponentForObject(object, viewNameOrSelector) {\n        if (object) {\n            const availableViews = Views.has(object.constructor) ? Views.get(object.constructor) : [];\n            const resolvedViewName = typeof viewNameOrSelector === 'function'\n                ? viewNameOrSelector(object, availableViews)\n                : this.getViewName(availableViews, viewNameOrSelector);\n            return this.getOrCreateBoundComponent(object, availableViews, resolvedViewName);\n        }\n        return null;\n    }\n    getOrCreateBoundComponent(object, availableViews, resolvedViewName) {\n        let lookup = this.modelInstanceToBoundComponent.get(object);\n        let BoundComponent;\n        if (lookup === void 0) {\n            lookup = {};\n            this.modelInstanceToBoundComponent.set(object, lookup);\n        }\n        else {\n            BoundComponent = lookup[resolvedViewName];\n        }\n        if (BoundComponent === void 0) {\n            const UnboundComponent = this.getOrCreateUnboundComponent(object, availableViews, resolvedViewName);\n            BoundComponent = CustomElement.define(CustomElement.getDefinition(UnboundComponent), class extends UnboundComponent {\n                constructor() {\n                    super(object);\n                }\n            });\n            lookup[resolvedViewName] = BoundComponent;\n        }\n        return BoundComponent;\n    }\n    getOrCreateUnboundComponent(object, availableViews, resolvedViewName) {\n        let lookup = this.modelTypeToUnboundComponent.get(object.constructor);\n        let UnboundComponent;\n        if (lookup === void 0) {\n            lookup = {};\n            this.modelTypeToUnboundComponent.set(object.constructor, lookup);\n        }\n        else {\n            UnboundComponent = lookup[resolvedViewName];\n        }\n        if (UnboundComponent === void 0) {\n            UnboundComponent = CustomElement.define(this.getView(availableViews, resolvedViewName), class {\n                constructor(viewModel) {\n                    this.viewModel = viewModel;\n                }\n                create(controller, parentContainer, definition, parts) {\n                    const vm = this.viewModel;\n                    controller.scope = Scope.fromParent(controller.flags, controller.scope, vm);\n                    if (vm.create !== void 0) {\n                        return vm.create(controller, parentContainer, definition, parts);\n                    }\n                }\n            });\n            const proto = UnboundComponent.prototype;\n            if ('beforeCompile' in object) {\n                proto.beforeCompile = function beforeCompile(controller) {\n                    this.viewModel.beforeCompile(controller);\n                };\n            }\n            if ('afterCompile' in object) {\n                proto.afterCompile = function afterCompile(controller) {\n                    this.viewModel.afterCompile(controller);\n                };\n            }\n            if ('afterCompileChildren' in object) {\n                proto.afterCompileChildren = function afterCompileChildren(controller) {\n                    this.viewModel.afterCompileChildren(controller);\n                };\n            }\n            if ('beforeBind' in object) {\n                proto.beforeBind = function beforeBind(flags) {\n                    return this.viewModel.beforeBind(flags);\n                };\n            }\n            if ('afterBind' in object) {\n                proto.afterBind = function afterBind(flags) {\n                    this.viewModel.afterBind(flags);\n                };\n            }\n            if ('beforeUnbind' in object) {\n                proto.beforeUnbind = function beforeUnbind(flags) {\n                    return this.viewModel.beforeUnbind(flags);\n                };\n            }\n            if ('afterUnbind' in object) {\n                proto.afterUnbind = function afterUnbind(flags) {\n                    this.viewModel.afterUnbind(flags);\n                };\n            }\n            if ('beforeAttach' in object) {\n                proto.beforeAttach = function beforeAttach(flags) {\n                    this.viewModel.beforeAttach(flags);\n                };\n            }\n            if ('afterAttach' in object) {\n                proto.afterAttach = function afterAttach(flags) {\n                    this.viewModel.afterAttach(flags);\n                };\n            }\n            if ('beforeDetach' in object) {\n                proto.beforeDetach = function beforeDetach(flags) {\n                    this.viewModel.beforeDetach(flags);\n                };\n            }\n            if ('afterDetach' in object) {\n                proto.afterDetach = function afterDetach(flags) {\n                    this.viewModel.afterDetach(flags);\n                };\n            }\n            if ('caching' in object) {\n                proto.caching = function caching(flags) {\n                    this.viewModel.caching(flags);\n                };\n            }\n            lookup[resolvedViewName] = UnboundComponent;\n        }\n        return UnboundComponent;\n    }\n    getViewName(views, requestedName) {\n        if (requestedName) {\n            return requestedName;\n        }\n        if (views.length === 1) {\n            return views[0].name;\n        }\n        return 'default-view';\n    }\n    getView(views, name) {\n        const v = views.find(x => x.name === name);\n        if (v === void 0) {\n            // TODO: Use Reporter\n            throw new Error(`Could not find view: ${name}`);\n        }\n        return v;\n    }\n}\n//# sourceMappingURL=view.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { IViewLocator } from '../../templating/view';\nimport { valueConverter } from '../value-converter';\nlet ViewValueConverter = class ViewValueConverter {\n    constructor(viewLocator) {\n        this.viewLocator = viewLocator;\n    }\n    toView(object, viewNameOrSelector) {\n        return this.viewLocator.getViewComponentForObject(object, viewNameOrSelector);\n    }\n};\nViewValueConverter = __decorate([\n    valueConverter('view'),\n    __param(0, IViewLocator),\n    __metadata(\"design:paramtypes\", [Object])\n], ViewValueConverter);\nexport { ViewValueConverter };\n//# sourceMappingURL=view.js.map","import { DI, Registration, } from '@aurelia/kernel';\nimport { ILifecycle } from './lifecycle';\nimport { ContinuationTask, IStartTaskManager, } from './lifecycle-task';\nimport { Controller } from './templating/controller';\nexport const IActivator = DI.createInterface('IActivator').withDefault(x => x.singleton(Activator));\n/** @internal */\nexport class Activator {\n    constructor(taskManager) {\n        this.taskManager = taskManager;\n    }\n    static register(container) {\n        return Registration.singleton(IActivator, this).register(container);\n    }\n    activate(host, component, container, flags = 1024 /* fromStartTask */, parentScope) {\n        flags = flags === void 0 ? 0 /* none */ : flags;\n        const mgr = this.taskManager;\n        let task = mgr.runBeforeRender();\n        if (task.done) {\n            this.render(host, component, container, flags);\n        }\n        else {\n            task = new ContinuationTask(task, this.render, this, host, component, container, flags);\n        }\n        if (task.done) {\n            task = mgr.runBeforeBind();\n        }\n        else {\n            task = new ContinuationTask(task, mgr.runBeforeBind, mgr);\n        }\n        if (task.done) {\n            task = this.bind(component, flags, parentScope);\n        }\n        else {\n            task = new ContinuationTask(task, this.bind, this, component, flags, parentScope);\n        }\n        if (task.done) {\n            task = mgr.runBeforeAttach();\n        }\n        else {\n            task = new ContinuationTask(task, mgr.runBeforeAttach, mgr);\n        }\n        if (task.done) {\n            this.attach(component, flags);\n        }\n        else {\n            task = new ContinuationTask(task, this.attach, this, component, flags);\n        }\n        return task;\n    }\n    deactivate(component, flags = 2048 /* fromStopTask */) {\n        const controller = Controller.getCachedOrThrow(component);\n        controller.detach(flags | 32768 /* fromDetach */);\n        return controller.unbind(flags | 8192 /* fromUnbind */);\n    }\n    render(host, component, container, flags) {\n        const lifecycle = container.get(ILifecycle);\n        Controller.forCustomElement(component, lifecycle, host, container, void 0, flags);\n    }\n    bind(component, flags, parentScope) {\n        return Controller.getCachedOrThrow(component).bind(flags | 4096 /* fromBind */, parentScope);\n    }\n    attach(component, flags) {\n        Controller.getCachedOrThrow(component).attach(flags | 16384 /* fromAttach */);\n    }\n}\nActivator.inject = [IStartTaskManager];\n//# sourceMappingURL=activator.js.map","import { DI, PLATFORM, Registration } from '@aurelia/kernel';\nimport { IActivator } from './activator';\nimport { INode } from './dom';\nimport { ILifecycle, } from './lifecycle';\nimport { ContinuationTask, IStartTaskManager, LifecycleTask, } from './lifecycle-task';\nimport { CustomElement } from './resources/custom-element';\nimport { Controller } from './templating/controller';\nexport class CompositionRoot {\n    constructor(config, container) {\n        this.config = config;\n        if (config.host != void 0) {\n            if (container.has(INode, false)) {\n                this.container = container.createChild();\n            }\n            else {\n                this.container = container;\n            }\n            Registration.instance(INode, config.host).register(this.container);\n            this.host = config.host;\n        }\n        else if (container.has(INode, true)) {\n            this.container = container;\n            this.host = container.get(INode);\n        }\n        else {\n            throw new Error(`No host element found.`);\n        }\n        this.strategy = config.strategy != void 0 ? config.strategy : 1 /* getterSetter */;\n        const initializer = this.container.get(IDOMInitializer);\n        this.dom = initializer.initialize(config);\n        this.lifecycle = this.container.get(ILifecycle);\n        this.activator = this.container.get(IActivator);\n        const taskManager = this.container.get(IStartTaskManager);\n        const beforeCreateTask = taskManager.runBeforeCreate();\n        if (beforeCreateTask.done) {\n            this.task = LifecycleTask.done;\n            this.create();\n        }\n        else {\n            this.task = new ContinuationTask(beforeCreateTask, this.create, this);\n        }\n    }\n    activate(antecedent) {\n        const { task, host, viewModel, container, activator, strategy } = this;\n        const flags = strategy | 1024 /* fromStartTask */;\n        if (viewModel === void 0) {\n            if (this.createTask === void 0) {\n                this.createTask = new ContinuationTask(task, this.activate, this, antecedent);\n            }\n            return this.createTask;\n        }\n        if (task.done) {\n            if (antecedent == void 0 || antecedent.done) {\n                this.task = activator.activate(host, viewModel, container, flags, void 0);\n            }\n            else {\n                this.task = new ContinuationTask(antecedent, activator.activate, activator, host, viewModel, container, flags, void 0);\n            }\n        }\n        else {\n            if (antecedent == void 0 || antecedent.done) {\n                this.task = new ContinuationTask(task, activator.activate, activator, host, viewModel, container, flags, void 0);\n            }\n            else {\n                const combinedAntecedent = new ContinuationTask(task, antecedent.wait, antecedent);\n                this.task = new ContinuationTask(combinedAntecedent, activator.activate, activator, host, viewModel, container, flags, void 0);\n            }\n        }\n        return this.task;\n    }\n    deactivate(antecedent) {\n        const { task, viewModel, activator, strategy } = this;\n        const flags = strategy | 2048 /* fromStopTask */;\n        if (viewModel === void 0) {\n            if (this.createTask === void 0) {\n                this.createTask = new ContinuationTask(task, this.deactivate, this, antecedent);\n            }\n            return this.createTask;\n        }\n        if (task.done) {\n            if (antecedent == void 0 || antecedent.done) {\n                this.task = activator.deactivate(viewModel, flags);\n            }\n            else {\n                this.task = new ContinuationTask(antecedent, activator.deactivate, activator, viewModel, flags);\n            }\n        }\n        else {\n            if (antecedent == void 0 || antecedent.done) {\n                this.task = new ContinuationTask(task, activator.deactivate, activator, viewModel, flags);\n            }\n            else {\n                const combinedAntecedent = new ContinuationTask(task, antecedent.wait, antecedent);\n                this.task = new ContinuationTask(combinedAntecedent, activator.deactivate, activator, viewModel, flags);\n            }\n        }\n        return this.task;\n    }\n    create() {\n        const config = this.config;\n        const instance = this.viewModel = CustomElement.isType(config.component)\n            ? this.container.get(config.component)\n            : config.component;\n        const container = this.container;\n        const lifecycle = container.get(ILifecycle);\n        this.controller = Controller.forCustomElement(instance, lifecycle, this.host, container, void 0, this.strategy);\n    }\n}\nexport class Aurelia {\n    constructor(container = DI.createContainer()) {\n        this.container = container;\n        this.task = LifecycleTask.done;\n        this._isRunning = false;\n        this._isStarting = false;\n        this._isStopping = false;\n        this._root = void 0;\n        this.next = (void 0);\n        Registration.instance(Aurelia, this).register(container);\n    }\n    get isRunning() {\n        return this._isRunning;\n    }\n    get isStarting() {\n        return this._isStarting;\n    }\n    get isStopping() {\n        return this._isStopping;\n    }\n    get root() {\n        if (this._root == void 0) {\n            if (this.next == void 0) {\n                throw new Error(`root is not defined`); // TODO: create error code\n            }\n            return this.next;\n        }\n        return this._root;\n    }\n    register(...params) {\n        this.container.register(...params);\n        return this;\n    }\n    app(config) {\n        this.next = new CompositionRoot(config, this.container);\n        if (this.isRunning) {\n            this.start();\n        }\n        return this;\n    }\n    start(root = this.next) {\n        if (root == void 0) {\n            throw new Error(`There is no composition root`); // TODO: create error code\n        }\n        this.stop(root);\n        if (this.task.done) {\n            this.onBeforeStart(root);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.onBeforeStart, this, root);\n        }\n        this.task = this.root.activate(this.task);\n        if (this.task.done) {\n            this.task = this.onAfterStart(root);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.onAfterStart, this, root);\n        }\n        return this.task;\n    }\n    stop(root = this._root) {\n        if (this._isRunning && root != void 0) {\n            if (this.task.done) {\n                this.onBeforeStop(root);\n            }\n            else {\n                this.task = new ContinuationTask(this.task, this.onBeforeStop, this, root);\n            }\n            this.task = root.deactivate(this.task);\n            if (this.task.done) {\n                this.task = this.onAfterStop(root);\n            }\n            else {\n                this.task = new ContinuationTask(this.task, this.onAfterStop, this, root);\n            }\n        }\n        return this.task;\n    }\n    wait() {\n        return this.task.wait();\n    }\n    onBeforeStart(root) {\n        Reflect.set(root.host, '$aurelia', this);\n        this._root = root;\n        this._isStarting = true;\n    }\n    onAfterStart(root) {\n        this._isRunning = true;\n        this._isStarting = false;\n        this.dispatchEvent(root, 'aurelia-composed', root.dom);\n        this.dispatchEvent(root, 'au-started', root.host);\n        return LifecycleTask.done;\n    }\n    onBeforeStop(root) {\n        this._isRunning = false;\n        this._isStopping = true;\n    }\n    onAfterStop(root) {\n        Reflect.deleteProperty(root.host, '$aurelia');\n        this._root = void 0;\n        this._isStopping = false;\n        this.dispatchEvent(root, 'au-stopped', root.host);\n        return LifecycleTask.done;\n    }\n    dispatchEvent(root, name, target) {\n        target = 'dispatchEvent' in target ? target : root.dom;\n        target.dispatchEvent(root.dom.createCustomEvent(name, { detail: this, bubbles: true, cancelable: true }));\n    }\n}\nPLATFORM.global.Aurelia = Aurelia;\nexport const IDOMInitializer = DI.createInterface('IDOMInitializer').noDefault();\n//# sourceMappingURL=aurelia.js.map","import { DI } from '@aurelia/kernel';\nimport { Lifecycle } from './lifecycle';\nimport { StartTaskManager } from './lifecycle-task';\nimport { ObserverLocator } from './observation/observer-locator';\nimport { CallBindingRenderer, CustomAttributeRenderer, CustomElementRenderer, InterpolationBindingRenderer, IteratorBindingRenderer, LetElementRenderer, PropertyBindingRenderer, RefBindingRenderer, Renderer, SetPropertyRenderer, TemplateControllerRenderer } from './renderer';\nimport { FromViewBindingBehavior, OneTimeBindingBehavior, ToViewBindingBehavior, TwoWayBindingBehavior } from './resources/binding-behaviors/binding-mode';\nimport { DebounceBindingBehavior } from './resources/binding-behaviors/debounce';\nimport { SignalBindingBehavior } from './resources/binding-behaviors/signals';\nimport { ThrottleBindingBehavior } from './resources/binding-behaviors/throttle';\nimport { FrequentMutations, InfrequentMutations, ObserveShallow } from './resources/custom-attributes/flags';\nimport { Else, If } from './resources/custom-attributes/if';\nimport { Repeat } from './resources/custom-attributes/repeat';\nimport { Replaceable } from './resources/custom-attributes/replaceable';\nimport { With } from './resources/custom-attributes/with';\nimport { SanitizeValueConverter } from './resources/value-converters/sanitize';\nimport { ViewValueConverter } from './resources/value-converters/view';\nimport { ViewLocator } from './templating/view';\nimport { Now } from '@aurelia/scheduler';\nexport const IObserverLocatorRegistration = ObserverLocator;\nexport const ILifecycleRegistration = Lifecycle;\nexport const IRendererRegistration = Renderer;\nexport const IStartTaskManagerRegistration = StartTaskManager;\nexport const IViewLocatorRegistration = ViewLocator;\n/**\n * Default implementations for the following interfaces:\n * - `IObserverLocator`\n * - `ILifecycle`\n * - `IRenderer`\n * - `IStartTaskManager`\n * - `IViewLocator`\n * - `IClockRegistration`\n * - `ISchedulerRegistration`\n */\nexport const DefaultComponents = [\n    IObserverLocatorRegistration,\n    ILifecycleRegistration,\n    IRendererRegistration,\n    IStartTaskManagerRegistration,\n    IViewLocatorRegistration,\n    Now,\n];\nexport const FrequentMutationsRegistration = FrequentMutations;\nexport const InfrequentMutationsRegistration = InfrequentMutations;\nexport const ObserveShallowRegistration = ObserveShallow;\nexport const IfRegistration = If;\nexport const ElseRegistration = Else;\nexport const RepeatRegistration = Repeat;\nexport const ReplaceableRegistration = Replaceable;\nexport const WithRegistration = With;\nexport const SanitizeValueConverterRegistration = SanitizeValueConverter;\nexport const ViewValueConverterRegistration = ViewValueConverter;\nexport const DebounceBindingBehaviorRegistration = DebounceBindingBehavior;\nexport const OneTimeBindingBehaviorRegistration = OneTimeBindingBehavior;\nexport const ToViewBindingBehaviorRegistration = ToViewBindingBehavior;\nexport const FromViewBindingBehaviorRegistration = FromViewBindingBehavior;\nexport const SignalBindingBehaviorRegistration = SignalBindingBehavior;\nexport const ThrottleBindingBehaviorRegistration = ThrottleBindingBehavior;\nexport const TwoWayBindingBehaviorRegistration = TwoWayBindingBehavior;\n/**\n * Default resources:\n * - Template controllers (`if`/`else`, `repeat`, `replaceable`, `with`)\n * - Value Converters (`sanitize`)\n * - Binding Behaviors (`oneTime`, `toView`, `fromView`, `twoWay`, `signal`, `debounce`, `throttle`)\n */\nexport const DefaultResources = [\n    FrequentMutationsRegistration,\n    InfrequentMutationsRegistration,\n    ObserveShallowRegistration,\n    IfRegistration,\n    ElseRegistration,\n    RepeatRegistration,\n    ReplaceableRegistration,\n    WithRegistration,\n    SanitizeValueConverterRegistration,\n    ViewValueConverterRegistration,\n    DebounceBindingBehaviorRegistration,\n    OneTimeBindingBehaviorRegistration,\n    ToViewBindingBehaviorRegistration,\n    FromViewBindingBehaviorRegistration,\n    SignalBindingBehaviorRegistration,\n    ThrottleBindingBehaviorRegistration,\n    TwoWayBindingBehaviorRegistration\n];\nexport const CallBindingRendererRegistration = CallBindingRenderer;\nexport const CustomAttributeRendererRegistration = CustomAttributeRenderer;\nexport const CustomElementRendererRegistration = CustomElementRenderer;\nexport const InterpolationBindingRendererRegistration = InterpolationBindingRenderer;\nexport const IteratorBindingRendererRegistration = IteratorBindingRenderer;\nexport const LetElementRendererRegistration = LetElementRenderer;\nexport const PropertyBindingRendererRegistration = PropertyBindingRenderer;\nexport const RefBindingRendererRegistration = RefBindingRenderer;\nexport const SetPropertyRendererRegistration = SetPropertyRenderer;\nexport const TemplateControllerRendererRegistration = TemplateControllerRenderer;\n/**\n * Default renderers for:\n * - PropertyBinding: `bind`, `one-time`, `to-view`, `from-view`, `two-way`\n * - IteratorBinding: `for`\n * - CallBinding: `call`\n * - RefBinding: `ref`\n * - InterpolationBinding: `${}`\n * - SetProperty\n * - `customElement` hydration\n * - `customAttribute` hydration\n * - `templateController` hydration\n * - `let` element hydration\n */\nexport const DefaultRenderers = [\n    PropertyBindingRendererRegistration,\n    IteratorBindingRendererRegistration,\n    CallBindingRendererRegistration,\n    RefBindingRendererRegistration,\n    InterpolationBindingRendererRegistration,\n    SetPropertyRendererRegistration,\n    CustomElementRendererRegistration,\n    CustomAttributeRendererRegistration,\n    TemplateControllerRendererRegistration,\n    LetElementRendererRegistration\n];\n/**\n * A DI configuration object containing environment/runtime-agnostic registrations:\n * - `DefaultComponents`\n * - `DefaultResources`\n * - `DefaultRenderers`\n */\nexport const RuntimeConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return container.register(...DefaultComponents, ...DefaultResources, ...DefaultRenderers);\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\n//# sourceMappingURL=configuration.js.map","import { BindingMode } from './flags';\nexport class InterpolationInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rf\" /* interpolation */;\n    }\n}\nexport class OneTimeBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rg\" /* propertyBinding */;\n        this.mode = BindingMode.oneTime;\n        this.oneTime = true;\n    }\n}\nexport class ToViewBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rg\" /* propertyBinding */;\n        this.mode = BindingMode.toView;\n        this.oneTime = false;\n    }\n}\nexport class FromViewBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rg\" /* propertyBinding */;\n        this.mode = BindingMode.fromView;\n        this.oneTime = false;\n    }\n}\nexport class TwoWayBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rg\" /* propertyBinding */;\n        this.mode = BindingMode.twoWay;\n        this.oneTime = false;\n    }\n}\nexport class IteratorBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rk\" /* iteratorBinding */;\n    }\n}\nexport class CallBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rh\" /* callBinding */;\n    }\n}\nexport class RefBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"rj\" /* refBinding */;\n        this.type = \"rj\" /* refBinding */;\n    }\n}\nexport class SetPropertyInstruction {\n    constructor(value, to) {\n        this.value = value;\n        this.to = to;\n        this.type = \"re\" /* setProperty */;\n    }\n}\nexport class HydrateElementInstruction {\n    constructor(res, instructions, parts) {\n        this.res = res;\n        this.instructions = instructions;\n        this.parts = parts;\n        this.type = \"ra\" /* hydrateElement */;\n    }\n}\nexport class HydrateAttributeInstruction {\n    constructor(res, instructions) {\n        this.res = res;\n        this.instructions = instructions;\n        this.type = \"rb\" /* hydrateAttribute */;\n    }\n}\nexport class HydrateTemplateController {\n    constructor(def, res, instructions, link, parts) {\n        this.def = def;\n        this.res = res;\n        this.instructions = instructions;\n        this.link = link;\n        this.parts = parts;\n        this.type = \"rc\" /* hydrateTemplateController */;\n    }\n}\nexport class LetElementInstruction {\n    constructor(instructions, toBindingContext) {\n        this.instructions = instructions;\n        this.toBindingContext = toBindingContext;\n        this.type = \"rd\" /* hydrateLetElement */;\n    }\n}\nexport class LetBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"ri\" /* letBinding */;\n    }\n}\n//# sourceMappingURL=instructions.js.map","export class AttrSyntax {\n    constructor(rawName, rawValue, target, command) {\n        this.rawName = rawName;\n        this.rawValue = rawValue;\n        this.target = target;\n        this.command = command;\n    }\n}\n//# sourceMappingURL=ast.js.map","import { DI, Metadata, PLATFORM, Protocol, Registration, Reporter } from '@aurelia/kernel';\n/** @internal */\nexport class CharSpec {\n    constructor(chars, repeat, isSymbol, isInverted) {\n        this.chars = chars;\n        this.repeat = repeat;\n        this.isSymbol = isSymbol;\n        this.isInverted = isInverted;\n        if (isInverted) {\n            switch (chars.length) {\n                case 0:\n                    this.has = this.hasOfNoneInverse;\n                    break;\n                case 1:\n                    this.has = this.hasOfSingleInverse;\n                    break;\n                default:\n                    this.has = this.hasOfMultipleInverse;\n            }\n        }\n        else {\n            switch (chars.length) {\n                case 0:\n                    this.has = this.hasOfNone;\n                    break;\n                case 1:\n                    this.has = this.hasOfSingle;\n                    break;\n                default:\n                    this.has = this.hasOfMultiple;\n            }\n        }\n    }\n    equals(other) {\n        return this.chars === other.chars\n            && this.repeat === other.repeat\n            && this.isSymbol === other.isSymbol\n            && this.isInverted === other.isInverted;\n    }\n    hasOfMultiple(char) {\n        return this.chars.includes(char);\n    }\n    hasOfSingle(char) {\n        return this.chars === char;\n    }\n    hasOfNone(char) {\n        return false;\n    }\n    hasOfMultipleInverse(char) {\n        return !this.chars.includes(char);\n    }\n    hasOfSingleInverse(char) {\n        return this.chars !== char;\n    }\n    hasOfNoneInverse(char) {\n        return true;\n    }\n}\nexport class Interpretation {\n    constructor() {\n        this.parts = PLATFORM.emptyArray;\n        this._pattern = '';\n        this.currentRecord = {};\n        this.partsRecord = {};\n    }\n    get pattern() {\n        const value = this._pattern;\n        if (value === '') {\n            return null;\n        }\n        else {\n            return value;\n        }\n    }\n    set pattern(value) {\n        if (value == null) {\n            this._pattern = '';\n            this.parts = PLATFORM.emptyArray;\n        }\n        else {\n            this._pattern = value;\n            this.parts = this.partsRecord[value];\n        }\n    }\n    append(pattern, ch) {\n        const { currentRecord } = this;\n        if (currentRecord[pattern] === undefined) {\n            currentRecord[pattern] = ch;\n        }\n        else {\n            currentRecord[pattern] += ch;\n        }\n    }\n    next(pattern) {\n        const { currentRecord } = this;\n        if (currentRecord[pattern] !== undefined) {\n            const { partsRecord } = this;\n            if (partsRecord[pattern] === undefined) {\n                partsRecord[pattern] = [currentRecord[pattern]];\n            }\n            else {\n                partsRecord[pattern].push(currentRecord[pattern]);\n            }\n            currentRecord[pattern] = undefined;\n        }\n    }\n}\n/** @internal */\nexport class State {\n    constructor(charSpec, ...patterns) {\n        this.charSpec = charSpec;\n        this.nextStates = [];\n        this.types = null;\n        this.isEndpoint = false;\n        this.patterns = patterns;\n    }\n    get pattern() {\n        return this.isEndpoint ? this.patterns[0] : null;\n    }\n    findChild(charSpec) {\n        const nextStates = this.nextStates;\n        const len = nextStates.length;\n        let child = null;\n        for (let i = 0; i < len; ++i) {\n            child = nextStates[i];\n            if (charSpec.equals(child.charSpec)) {\n                return child;\n            }\n        }\n        return null;\n    }\n    append(charSpec, pattern) {\n        const { patterns } = this;\n        if (!patterns.includes(pattern)) {\n            patterns.push(pattern);\n        }\n        let state = this.findChild(charSpec);\n        if (state == null) {\n            state = new State(charSpec, pattern);\n            this.nextStates.push(state);\n            if (charSpec.repeat) {\n                state.nextStates.push(state);\n            }\n        }\n        return state;\n    }\n    findMatches(ch, interpretation) {\n        // TODO: reuse preallocated arrays\n        const results = [];\n        const nextStates = this.nextStates;\n        const len = nextStates.length;\n        let childLen = 0;\n        let child = null;\n        let i = 0;\n        let j = 0;\n        for (; i < len; ++i) {\n            child = nextStates[i];\n            if (child.charSpec.has(ch)) {\n                results.push(child);\n                childLen = child.patterns.length;\n                j = 0;\n                if (child.charSpec.isSymbol) {\n                    for (; j < childLen; ++j) {\n                        interpretation.next(child.patterns[j]);\n                    }\n                }\n                else {\n                    for (; j < childLen; ++j) {\n                        interpretation.append(child.patterns[j], ch);\n                    }\n                }\n            }\n        }\n        return results;\n    }\n}\n/** @internal */\nexport class StaticSegment {\n    constructor(text) {\n        this.text = text;\n        this.text = text;\n        const len = this.len = text.length;\n        const specs = this.specs = [];\n        for (let i = 0; i < len; ++i) {\n            specs.push(new CharSpec(text[i], false, false, false));\n        }\n    }\n    eachChar(callback) {\n        const { len, specs } = this;\n        for (let i = 0; i < len; ++i) {\n            callback(specs[i]);\n        }\n    }\n}\n/** @internal */\nexport class DynamicSegment {\n    constructor(symbols) {\n        this.text = 'PART';\n        this.spec = new CharSpec(symbols, true, false, true);\n    }\n    eachChar(callback) {\n        callback(this.spec);\n    }\n}\n/** @internal */\nexport class SymbolSegment {\n    constructor(text) {\n        this.text = text;\n        this.spec = new CharSpec(text, false, true, false);\n    }\n    eachChar(callback) {\n        callback(this.spec);\n    }\n}\n/** @internal */\nexport class SegmentTypes {\n    constructor() {\n        this.statics = 0;\n        this.dynamics = 0;\n        this.symbols = 0;\n    }\n}\nexport const ISyntaxInterpreter = DI.createInterface('ISyntaxInterpreter').withDefault(x => x.singleton(SyntaxInterpreter));\n/** @internal */\nexport class SyntaxInterpreter {\n    constructor() {\n        this.rootState = new State(null);\n        this.initialStates = [this.rootState];\n    }\n    add(defOrDefs) {\n        let i = 0;\n        if (Array.isArray(defOrDefs)) {\n            const ii = defOrDefs.length;\n            for (; i < ii; ++i) {\n                this.add(defOrDefs[i]);\n            }\n            return;\n        }\n        let currentState = this.rootState;\n        const def = defOrDefs;\n        const pattern = def.pattern;\n        const types = new SegmentTypes();\n        const segments = this.parse(def, types);\n        const len = segments.length;\n        const callback = (ch) => {\n            currentState = currentState.append(ch, pattern);\n        };\n        for (i = 0; i < len; ++i) {\n            segments[i].eachChar(callback);\n        }\n        currentState.types = types;\n        currentState.isEndpoint = true;\n    }\n    interpret(name) {\n        const interpretation = new Interpretation();\n        let states = this.initialStates;\n        const len = name.length;\n        for (let i = 0; i < len; ++i) {\n            states = this.getNextStates(states, name.charAt(i), interpretation);\n            if (states.length === 0) {\n                break;\n            }\n        }\n        states.sort((a, b) => {\n            if (a.isEndpoint) {\n                if (!b.isEndpoint) {\n                    return -1;\n                }\n            }\n            else if (b.isEndpoint) {\n                return 1;\n            }\n            else {\n                return 0;\n            }\n            const aTypes = a.types;\n            const bTypes = b.types;\n            if (aTypes.statics !== bTypes.statics) {\n                return bTypes.statics - aTypes.statics;\n            }\n            if (aTypes.dynamics !== bTypes.dynamics) {\n                return bTypes.dynamics - aTypes.dynamics;\n            }\n            if (aTypes.symbols !== bTypes.symbols) {\n                return bTypes.symbols - aTypes.symbols;\n            }\n            return 0;\n        });\n        if (states.length > 0) {\n            const state = states[0];\n            if (!state.charSpec.isSymbol) {\n                interpretation.next(state.pattern);\n            }\n            interpretation.pattern = state.pattern;\n        }\n        return interpretation;\n    }\n    getNextStates(states, ch, interpretation) {\n        // TODO: reuse preallocated arrays\n        const nextStates = [];\n        let state = null;\n        const len = states.length;\n        for (let i = 0; i < len; ++i) {\n            state = states[i];\n            nextStates.push(...state.findMatches(ch, interpretation));\n        }\n        return nextStates;\n    }\n    parse(def, types) {\n        const result = [];\n        const pattern = def.pattern;\n        const len = pattern.length;\n        let i = 0;\n        let start = 0;\n        let c = '';\n        while (i < len) {\n            c = pattern.charAt(i);\n            if (!def.symbols.includes(c)) {\n                if (i === start) {\n                    if (c === 'P' && pattern.slice(i, i + 4) === 'PART') {\n                        start = i = (i + 4);\n                        result.push(new DynamicSegment(def.symbols));\n                        ++types.dynamics;\n                    }\n                    else {\n                        ++i;\n                    }\n                }\n                else {\n                    ++i;\n                }\n            }\n            else if (i !== start) {\n                result.push(new StaticSegment(pattern.slice(start, i)));\n                ++types.statics;\n                start = i;\n            }\n            else {\n                result.push(new SymbolSegment(pattern.slice(start, i + 1)));\n                ++types.symbols;\n                start = ++i;\n            }\n        }\n        if (start !== i) {\n            result.push(new StaticSegment(pattern.slice(start, i)));\n            ++types.statics;\n        }\n        return result;\n    }\n}\nfunction validatePrototype(handler, patternDefs) {\n    for (const def of patternDefs) {\n        // note: we're intentionally not throwing here\n        if (!(def.pattern in handler)) {\n            Reporter.write(401, def.pattern); // TODO: organize error codes\n        }\n        else if (typeof handler[def.pattern] !== 'function') {\n            Reporter.write(402, def.pattern); // TODO: organize error codes\n        }\n    }\n}\nexport const IAttributePattern = DI.createInterface('IAttributePattern').noDefault();\nexport function attributePattern(...patternDefs) {\n    return function decorator(target) {\n        return AttributePattern.define(patternDefs, target);\n    };\n}\nexport class AttributePatternResourceDefinition {\n    constructor(Type) {\n        this.Type = Type;\n        this.name = (void 0);\n    }\n    register(container) {\n        Registration.singleton(IAttributePattern, this.Type).register(container);\n    }\n}\nexport const AttributePattern = Object.freeze({\n    name: Protocol.resource.keyFor('attribute-pattern'),\n    definitionAnnotationKey: 'attribute-pattern-definitions',\n    define(patternDefs, Type) {\n        validatePrototype(Type.prototype, patternDefs);\n        const definition = new AttributePatternResourceDefinition(Type);\n        const { name, definitionAnnotationKey } = AttributePattern;\n        Metadata.define(name, definition, Type);\n        Protocol.resource.appendTo(Type, name);\n        Protocol.annotation.set(Type, definitionAnnotationKey, patternDefs);\n        Protocol.annotation.appendTo(Type, definitionAnnotationKey);\n        return Type;\n    },\n    getPatternDefinitions(Type) {\n        return Protocol.annotation.get(Type, AttributePattern.definitionAnnotationKey);\n    }\n});\n//# sourceMappingURL=attribute-pattern.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { all, DI } from '@aurelia/kernel';\nimport { AttrSyntax } from './ast';\nimport { AttributePattern, IAttributePattern, ISyntaxInterpreter } from './attribute-pattern';\nexport const IAttributeParser = DI.createInterface('IAttributeParser').withDefault(x => x.singleton(AttributeParser));\n/** @internal */\nlet AttributeParser = class AttributeParser {\n    constructor(interpreter, attrPatterns) {\n        this.interpreter = interpreter;\n        this.cache = {};\n        this.interpreter = interpreter;\n        const patterns = this.patterns = {};\n        attrPatterns.forEach(attrPattern => {\n            const defs = AttributePattern.getPatternDefinitions(attrPattern.constructor);\n            interpreter.add(defs);\n            defs.forEach(def => {\n                patterns[def.pattern] = attrPattern;\n            });\n        });\n    }\n    parse(name, value) {\n        let interpretation = this.cache[name];\n        if (interpretation == null) {\n            interpretation = this.cache[name] = this.interpreter.interpret(name);\n        }\n        const pattern = interpretation.pattern;\n        if (pattern == null) {\n            return new AttrSyntax(name, value, name, null);\n        }\n        else {\n            return this.patterns[pattern][pattern](name, value, interpretation.parts);\n        }\n    }\n};\nAttributeParser = __decorate([\n    __param(0, ISyntaxInterpreter),\n    __param(1, all(IAttributePattern)),\n    __metadata(\"design:paramtypes\", [Object, Array])\n], AttributeParser);\nexport { AttributeParser };\n//# sourceMappingURL=attribute-parser.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { AttrSyntax } from './ast';\nimport { attributePattern } from './attribute-pattern';\nlet DotSeparatedAttributePattern = class DotSeparatedAttributePattern {\n    ['PART.PART'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, parts[0], parts[1]);\n    }\n    ['PART.PART.PART'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, parts[0], parts[2]);\n    }\n};\nDotSeparatedAttributePattern = __decorate([\n    attributePattern({ pattern: 'PART.PART', symbols: '.' }, { pattern: 'PART.PART.PART', symbols: '.' })\n], DotSeparatedAttributePattern);\nexport { DotSeparatedAttributePattern };\nlet RefAttributePattern = class RefAttributePattern {\n    ['ref'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, 'element', 'ref');\n    }\n    ['PART.ref'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, parts[0], 'ref');\n    }\n};\nRefAttributePattern = __decorate([\n    attributePattern({ pattern: 'ref', symbols: '' }, { pattern: 'PART.ref', symbols: '.' })\n], RefAttributePattern);\nexport { RefAttributePattern };\nlet ColonPrefixedBindAttributePattern = class ColonPrefixedBindAttributePattern {\n    [':PART'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, parts[0], 'bind');\n    }\n};\nColonPrefixedBindAttributePattern = __decorate([\n    attributePattern({ pattern: ':PART', symbols: ':' })\n], ColonPrefixedBindAttributePattern);\nexport { ColonPrefixedBindAttributePattern };\nlet AtPrefixedTriggerAttributePattern = class AtPrefixedTriggerAttributePattern {\n    ['@PART'](rawName, rawValue, parts) {\n        return new AttrSyntax(rawName, rawValue, parts[0], 'trigger');\n    }\n};\nAtPrefixedTriggerAttributePattern = __decorate([\n    attributePattern({ pattern: '@PART', symbols: '@' })\n], AtPrefixedTriggerAttributePattern);\nexport { AtPrefixedTriggerAttributePattern };\n//# sourceMappingURL=attribute-patterns.js.map","import { camelCase, Registration, mergeArrays, Protocol, firstDefined, Metadata } from '@aurelia/kernel';\nimport { registerAliases } from '@aurelia/runtime';\nexport function bindingCommand(nameOrDefinition) {\n    return function (target) {\n        return BindingCommand.define(nameOrDefinition, target);\n    };\n}\nexport class BindingCommandDefinition {\n    constructor(Type, name, aliases, key, type) {\n        this.Type = Type;\n        this.name = name;\n        this.aliases = aliases;\n        this.key = key;\n        this.type = type;\n    }\n    static create(nameOrDef, Type) {\n        let name;\n        let def;\n        if (typeof nameOrDef === 'string') {\n            name = nameOrDef;\n            def = { name };\n        }\n        else {\n            name = nameOrDef.name;\n            def = nameOrDef;\n        }\n        return new BindingCommandDefinition(Type, firstDefined(BindingCommand.getAnnotation(Type, 'name'), name), mergeArrays(BindingCommand.getAnnotation(Type, 'aliases'), def.aliases, Type.aliases), BindingCommand.keyFrom(name), firstDefined(BindingCommand.getAnnotation(Type, 'type'), def.type, Type.type, null));\n    }\n    register(container) {\n        const { Type, key, aliases } = this;\n        Registration.singleton(key, Type).register(container);\n        Registration.aliasTo(key, Type).register(container);\n        registerAliases(aliases, BindingCommand, key, container);\n    }\n}\nexport const BindingCommand = {\n    name: Protocol.resource.keyFor('binding-command'),\n    keyFrom(name) {\n        return `${BindingCommand.name}:${name}`;\n    },\n    isType(value) {\n        return typeof value === 'function' && Metadata.hasOwn(BindingCommand.name, value);\n    },\n    define(nameOrDef, Type) {\n        const definition = BindingCommandDefinition.create(nameOrDef, Type);\n        Metadata.define(BindingCommand.name, definition, definition.Type);\n        Metadata.define(BindingCommand.name, definition, definition);\n        Protocol.resource.appendTo(Type, BindingCommand.name);\n        return definition.Type;\n    },\n    getDefinition(Type) {\n        const def = Metadata.getOwn(BindingCommand.name, Type);\n        if (def === void 0) {\n            throw new Error(`No definition found for type ${Type.name}`);\n        }\n        return def;\n    },\n    annotate(Type, prop, value) {\n        Metadata.define(Protocol.annotation.keyFor(prop), value, Type);\n    },\n    getAnnotation(Type, prop) {\n        return Metadata.getOwn(Protocol.annotation.keyFor(prop), Type);\n    },\n};\nexport function getTarget(binding, makeCamelCase) {\n    if (binding.flags & 256 /* isBinding */) {\n        return binding.bindable.propName;\n    }\n    else if (makeCamelCase) {\n        return camelCase(binding.syntax.target);\n    }\n    else {\n        return binding.syntax.target;\n    }\n}\n//# sourceMappingURL=binding-command.js.map","export var SymbolFlags;\n(function (SymbolFlags) {\n    SymbolFlags[SymbolFlags[\"type\"] = 511] = \"type\";\n    SymbolFlags[SymbolFlags[\"isTemplateController\"] = 1] = \"isTemplateController\";\n    SymbolFlags[SymbolFlags[\"isReplacePart\"] = 2] = \"isReplacePart\";\n    SymbolFlags[SymbolFlags[\"isCustomAttribute\"] = 4] = \"isCustomAttribute\";\n    SymbolFlags[SymbolFlags[\"isPlainAttribute\"] = 8] = \"isPlainAttribute\";\n    SymbolFlags[SymbolFlags[\"isCustomElement\"] = 16] = \"isCustomElement\";\n    SymbolFlags[SymbolFlags[\"isLetElement\"] = 32] = \"isLetElement\";\n    SymbolFlags[SymbolFlags[\"isPlainElement\"] = 64] = \"isPlainElement\";\n    SymbolFlags[SymbolFlags[\"isText\"] = 128] = \"isText\";\n    SymbolFlags[SymbolFlags[\"isBinding\"] = 256] = \"isBinding\";\n    SymbolFlags[SymbolFlags[\"hasMarker\"] = 512] = \"hasMarker\";\n    SymbolFlags[SymbolFlags[\"hasTemplate\"] = 1024] = \"hasTemplate\";\n    SymbolFlags[SymbolFlags[\"hasAttributes\"] = 2048] = \"hasAttributes\";\n    SymbolFlags[SymbolFlags[\"hasBindings\"] = 4096] = \"hasBindings\";\n    SymbolFlags[SymbolFlags[\"hasChildNodes\"] = 8192] = \"hasChildNodes\";\n    SymbolFlags[SymbolFlags[\"hasParts\"] = 16384] = \"hasParts\";\n})(SymbolFlags || (SymbolFlags = {}));\nfunction createMarker(dom) {\n    const marker = dom.createElement('au-m');\n    dom.makeTarget(marker);\n    return marker;\n}\n/**\n * A html attribute that is associated with a registered resource, specifically a template controller.\n */\nexport class TemplateControllerSymbol {\n    constructor(dom, syntax, info, partName, res = info.name) {\n        this.syntax = syntax;\n        this.info = info;\n        this.res = res;\n        this.flags = 1 /* isTemplateController */ | 512 /* hasMarker */;\n        this.physicalNode = null;\n        this.template = null;\n        this.templateController = null;\n        this._bindings = null;\n        this._parts = null;\n        this.partName = info.name === 'replaceable' ? partName : null;\n        this.marker = createMarker(dom);\n    }\n    get bindings() {\n        if (this._bindings === null) {\n            this._bindings = [];\n            this.flags |= 4096 /* hasBindings */;\n        }\n        return this._bindings;\n    }\n    get parts() {\n        if (this._parts === null) {\n            this._parts = [];\n            this.flags |= 16384 /* hasParts */;\n        }\n        return this._parts;\n    }\n}\n/**\n * Wrapper for an element (with all of its attributes, regardless of the order in which they are declared)\n * that has a replace attribute on it.\n *\n * This element will be lifted from the DOM just like a template controller.\n */\nexport class ReplacePartSymbol {\n    constructor(name, physicalNode = null, parent = null, template = null) {\n        this.name = name;\n        this.physicalNode = physicalNode;\n        this.parent = parent;\n        this.template = template;\n        this.flags = 2 /* isReplacePart */;\n    }\n}\n/**\n * A html attribute that is associated with a registered resource, but not a template controller.\n */\nexport class CustomAttributeSymbol {\n    constructor(syntax, info, res = info.name) {\n        this.syntax = syntax;\n        this.info = info;\n        this.res = res;\n        this.flags = 4 /* isCustomAttribute */;\n        this._bindings = null;\n    }\n    get bindings() {\n        if (this._bindings === null) {\n            this._bindings = [];\n            this.flags |= 4096 /* hasBindings */;\n        }\n        return this._bindings;\n    }\n}\n/**\n * An attribute, with either a binding command or an interpolation, whose target is the html\n * attribute of the element.\n *\n * This will never target a bindable property of a custom attribute or element;\n */\nexport class PlainAttributeSymbol {\n    constructor(syntax, command, expression) {\n        this.syntax = syntax;\n        this.command = command;\n        this.expression = expression;\n        this.flags = 8 /* isPlainAttribute */;\n    }\n}\n/**\n * Either an attribute on an custom element that maps to a declared bindable property of that element,\n * a single-value bound custom attribute, or one of several bindables that were extracted from the attribute\n * value of a custom attribute with multiple bindings usage.\n *\n * This will always target a bindable property of a custom attribute or element;\n */\nexport class BindingSymbol {\n    constructor(command, bindable, expression, rawValue, target) {\n        this.command = command;\n        this.bindable = bindable;\n        this.expression = expression;\n        this.rawValue = rawValue;\n        this.target = target;\n        this.flags = 256 /* isBinding */;\n    }\n}\n/**\n * A html element that is associated with a registered resource either via its (lowerCase) `nodeName`\n * or the value of its `as-element` attribute.\n */\nexport class CustomElementSymbol {\n    constructor(dom, physicalNode, info, res = info.name, bindables = info.bindables) {\n        this.physicalNode = physicalNode;\n        this.info = info;\n        this.res = res;\n        this.bindables = bindables;\n        this.flags = 16 /* isCustomElement */;\n        this.isTarget = true;\n        this.templateController = null;\n        this._customAttributes = null;\n        this._plainAttributes = null;\n        this._bindings = null;\n        this._childNodes = null;\n        this._parts = null;\n        if (info.containerless) {\n            this.isContainerless = true;\n            this.marker = createMarker(dom);\n            this.flags |= 512 /* hasMarker */;\n        }\n        else {\n            this.isContainerless = false;\n            this.marker = null;\n        }\n    }\n    get customAttributes() {\n        if (this._customAttributes === null) {\n            this._customAttributes = [];\n            this.flags |= 2048 /* hasAttributes */;\n        }\n        return this._customAttributes;\n    }\n    get plainAttributes() {\n        if (this._plainAttributes === null) {\n            this._plainAttributes = [];\n            this.flags |= 2048 /* hasAttributes */;\n        }\n        return this._plainAttributes;\n    }\n    get bindings() {\n        if (this._bindings === null) {\n            this._bindings = [];\n            this.flags |= 4096 /* hasBindings */;\n        }\n        return this._bindings;\n    }\n    get childNodes() {\n        if (this._childNodes === null) {\n            this._childNodes = [];\n            this.flags |= 8192 /* hasChildNodes */;\n        }\n        return this._childNodes;\n    }\n    get parts() {\n        if (this._parts === null) {\n            this._parts = [];\n            this.flags |= 16384 /* hasParts */;\n        }\n        return this._parts;\n    }\n}\nexport class LetElementSymbol {\n    constructor(dom, physicalNode, marker = createMarker(dom)) {\n        this.physicalNode = physicalNode;\n        this.marker = marker;\n        this.flags = 32 /* isLetElement */ | 512 /* hasMarker */;\n        this.toBindingContext = false;\n        this._bindings = null;\n    }\n    get bindings() {\n        if (this._bindings === null) {\n            this._bindings = [];\n            this.flags |= 4096 /* hasBindings */;\n        }\n        return this._bindings;\n    }\n}\n/**\n * A normal html element that may or may not have attribute behaviors and/or child node behaviors.\n *\n * It is possible for a PlainElementSymbol to not yield any instructions during compilation.\n */\nexport class PlainElementSymbol {\n    constructor(dom, physicalNode) {\n        this.physicalNode = physicalNode;\n        this.flags = 64 /* isPlainElement */;\n        this.isTarget = false;\n        this.templateController = null;\n        this.hasSlots = false;\n        this._customAttributes = null;\n        this._plainAttributes = null;\n        this._childNodes = null;\n    }\n    get customAttributes() {\n        if (this._customAttributes === null) {\n            this._customAttributes = [];\n            this.flags |= 2048 /* hasAttributes */;\n        }\n        return this._customAttributes;\n    }\n    get plainAttributes() {\n        if (this._plainAttributes === null) {\n            this._plainAttributes = [];\n            this.flags |= 2048 /* hasAttributes */;\n        }\n        return this._plainAttributes;\n    }\n    get childNodes() {\n        if (this._childNodes === null) {\n            this._childNodes = [];\n            this.flags |= 8192 /* hasChildNodes */;\n        }\n        return this._childNodes;\n    }\n}\n/**\n * A standalone text node that has an interpolation.\n */\nexport class TextSymbol {\n    constructor(dom, physicalNode, interpolation, marker = createMarker(dom)) {\n        this.physicalNode = physicalNode;\n        this.interpolation = interpolation;\n        this.marker = marker;\n        this.flags = 128 /* isText */ | 512 /* hasMarker */;\n    }\n}\n//# sourceMappingURL=semantic-model.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { BindingMode, CallBindingInstruction, FromViewBindingInstruction, IteratorBindingInstruction, OneTimeBindingInstruction, ToViewBindingInstruction, TwoWayBindingInstruction, } from '@aurelia/runtime';\nimport { bindingCommand, getTarget, } from './binding-command';\nimport { BindingSymbol, } from './semantic-model';\nlet OneTimeBindingCommand = class OneTimeBindingCommand {\n    constructor() {\n        this.bindingType = 49 /* OneTimeCommand */;\n    }\n    compile(binding) {\n        return new OneTimeBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nOneTimeBindingCommand = __decorate([\n    bindingCommand('one-time')\n], OneTimeBindingCommand);\nexport { OneTimeBindingCommand };\nlet ToViewBindingCommand = class ToViewBindingCommand {\n    constructor() {\n        this.bindingType = 50 /* ToViewCommand */;\n    }\n    compile(binding) {\n        return new ToViewBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nToViewBindingCommand = __decorate([\n    bindingCommand('to-view')\n], ToViewBindingCommand);\nexport { ToViewBindingCommand };\nlet FromViewBindingCommand = class FromViewBindingCommand {\n    constructor() {\n        this.bindingType = 51 /* FromViewCommand */;\n    }\n    compile(binding) {\n        return new FromViewBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nFromViewBindingCommand = __decorate([\n    bindingCommand('from-view')\n], FromViewBindingCommand);\nexport { FromViewBindingCommand };\nlet TwoWayBindingCommand = class TwoWayBindingCommand {\n    constructor() {\n        this.bindingType = 52 /* TwoWayCommand */;\n    }\n    compile(binding) {\n        return new TwoWayBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nTwoWayBindingCommand = __decorate([\n    bindingCommand('two-way')\n], TwoWayBindingCommand);\nexport { TwoWayBindingCommand };\nlet DefaultBindingCommand = class DefaultBindingCommand {\n    constructor() {\n        this.bindingType = 53 /* BindCommand */;\n    }\n    compile(binding) {\n        let mode = BindingMode.default;\n        if (binding instanceof BindingSymbol) {\n            mode = binding.bindable.mode;\n        }\n        else {\n            const command = binding.syntax.command;\n            switch (command) {\n                case 'bind':\n                case 'to-view':\n                    mode = BindingMode.toView;\n                    break;\n                case 'one-time':\n                    mode = BindingMode.oneTime;\n                    break;\n                case 'from-view':\n                    mode = BindingMode.fromView;\n                    break;\n                case 'two-way':\n                    mode = BindingMode.twoWay;\n                    break;\n            }\n        }\n        switch (mode) {\n            case BindingMode.default:\n            case BindingMode.toView:\n                return ToViewBindingCommand.prototype.compile(binding);\n            case BindingMode.oneTime:\n                return OneTimeBindingCommand.prototype.compile(binding);\n            case BindingMode.fromView:\n                return FromViewBindingCommand.prototype.compile(binding);\n            case BindingMode.twoWay:\n                return TwoWayBindingCommand.prototype.compile(binding);\n        }\n    }\n};\nDefaultBindingCommand = __decorate([\n    bindingCommand('bind')\n], DefaultBindingCommand);\nexport { DefaultBindingCommand };\nlet CallBindingCommand = class CallBindingCommand {\n    constructor() {\n        this.bindingType = 153 /* CallCommand */;\n    }\n    compile(binding) {\n        return new CallBindingInstruction(binding.expression, getTarget(binding, true));\n    }\n};\nCallBindingCommand = __decorate([\n    bindingCommand('call')\n], CallBindingCommand);\nexport { CallBindingCommand };\nlet ForBindingCommand = class ForBindingCommand {\n    constructor() {\n        this.bindingType = 539 /* ForCommand */;\n    }\n    compile(binding) {\n        return new IteratorBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nForBindingCommand = __decorate([\n    bindingCommand('for')\n], ForBindingCommand);\nexport { ForBindingCommand };\n//# sourceMappingURL=binding-commands.js.map","export function unescapeCode(code) {\n    switch (code) {\n        case 98 /* LowerB */: return 8 /* Backspace */;\n        case 116 /* LowerT */: return 9 /* Tab */;\n        case 110 /* LowerN */: return 10 /* LineFeed */;\n        case 118 /* LowerV */: return 11 /* VerticalTab */;\n        case 102 /* LowerF */: return 12 /* FormFeed */;\n        case 114 /* LowerR */: return 13 /* CarriageReturn */;\n        case 34 /* DoubleQuote */: return 34 /* DoubleQuote */;\n        case 39 /* SingleQuote */: return 39 /* SingleQuote */;\n        case 92 /* Backslash */: return 92 /* Backslash */;\n        default: return code;\n    }\n}\nexport var Access;\n(function (Access) {\n    Access[Access[\"Reset\"] = 0] = \"Reset\";\n    Access[Access[\"Ancestor\"] = 511] = \"Ancestor\";\n    Access[Access[\"This\"] = 512] = \"This\";\n    Access[Access[\"Scope\"] = 1024] = \"Scope\";\n    Access[Access[\"Member\"] = 2048] = \"Member\";\n    Access[Access[\"Keyed\"] = 4096] = \"Keyed\";\n})(Access || (Access = {}));\nexport var Precedence;\n(function (Precedence) {\n    Precedence[Precedence[\"Variadic\"] = 61] = \"Variadic\";\n    Precedence[Precedence[\"Assign\"] = 62] = \"Assign\";\n    Precedence[Precedence[\"Conditional\"] = 63] = \"Conditional\";\n    Precedence[Precedence[\"LogicalOR\"] = 64] = \"LogicalOR\";\n    Precedence[Precedence[\"LogicalAND\"] = 128] = \"LogicalAND\";\n    Precedence[Precedence[\"Equality\"] = 192] = \"Equality\";\n    Precedence[Precedence[\"Relational\"] = 256] = \"Relational\";\n    Precedence[Precedence[\"Additive\"] = 320] = \"Additive\";\n    Precedence[Precedence[\"Multiplicative\"] = 384] = \"Multiplicative\";\n    Precedence[Precedence[\"Binary\"] = 448] = \"Binary\";\n    Precedence[Precedence[\"LeftHandSide\"] = 449] = \"LeftHandSide\";\n    Precedence[Precedence[\"Primary\"] = 450] = \"Primary\";\n    Precedence[Precedence[\"Unary\"] = 451] = \"Unary\";\n})(Precedence || (Precedence = {}));\n/** @internal */\nexport var Token;\n(function (Token) {\n    Token[Token[\"EOF\"] = 1572864] = \"EOF\";\n    Token[Token[\"ExpressionTerminal\"] = 1048576] = \"ExpressionTerminal\";\n    Token[Token[\"AccessScopeTerminal\"] = 524288] = \"AccessScopeTerminal\";\n    Token[Token[\"ClosingToken\"] = 262144] = \"ClosingToken\";\n    Token[Token[\"OpeningToken\"] = 131072] = \"OpeningToken\";\n    Token[Token[\"BinaryOp\"] = 65536] = \"BinaryOp\";\n    Token[Token[\"UnaryOp\"] = 32768] = \"UnaryOp\";\n    Token[Token[\"LeftHandSide\"] = 16384] = \"LeftHandSide\";\n    Token[Token[\"StringOrNumericLiteral\"] = 12288] = \"StringOrNumericLiteral\";\n    Token[Token[\"NumericLiteral\"] = 8192] = \"NumericLiteral\";\n    Token[Token[\"StringLiteral\"] = 4096] = \"StringLiteral\";\n    Token[Token[\"IdentifierName\"] = 3072] = \"IdentifierName\";\n    Token[Token[\"Keyword\"] = 2048] = \"Keyword\";\n    Token[Token[\"Identifier\"] = 1024] = \"Identifier\";\n    Token[Token[\"Contextual\"] = 512] = \"Contextual\";\n    Token[Token[\"Precedence\"] = 448] = \"Precedence\";\n    Token[Token[\"Type\"] = 63] = \"Type\";\n    Token[Token[\"FalseKeyword\"] = 2048] = \"FalseKeyword\";\n    Token[Token[\"TrueKeyword\"] = 2049] = \"TrueKeyword\";\n    Token[Token[\"NullKeyword\"] = 2050] = \"NullKeyword\";\n    Token[Token[\"UndefinedKeyword\"] = 2051] = \"UndefinedKeyword\";\n    Token[Token[\"ThisScope\"] = 3076] = \"ThisScope\";\n    Token[Token[\"ParentScope\"] = 3077] = \"ParentScope\";\n    Token[Token[\"OpenParen\"] = 671750] = \"OpenParen\";\n    Token[Token[\"OpenBrace\"] = 131079] = \"OpenBrace\";\n    Token[Token[\"Dot\"] = 16392] = \"Dot\";\n    Token[Token[\"CloseBrace\"] = 1835017] = \"CloseBrace\";\n    Token[Token[\"CloseParen\"] = 1835018] = \"CloseParen\";\n    Token[Token[\"Comma\"] = 1572875] = \"Comma\";\n    Token[Token[\"OpenBracket\"] = 671756] = \"OpenBracket\";\n    Token[Token[\"CloseBracket\"] = 1835021] = \"CloseBracket\";\n    Token[Token[\"Colon\"] = 1572878] = \"Colon\";\n    Token[Token[\"Question\"] = 1572879] = \"Question\";\n    Token[Token[\"Ampersand\"] = 1572880] = \"Ampersand\";\n    Token[Token[\"Bar\"] = 1572883] = \"Bar\";\n    Token[Token[\"BarBar\"] = 1638548] = \"BarBar\";\n    Token[Token[\"AmpersandAmpersand\"] = 1638613] = \"AmpersandAmpersand\";\n    Token[Token[\"EqualsEquals\"] = 1638678] = \"EqualsEquals\";\n    Token[Token[\"ExclamationEquals\"] = 1638679] = \"ExclamationEquals\";\n    Token[Token[\"EqualsEqualsEquals\"] = 1638680] = \"EqualsEqualsEquals\";\n    Token[Token[\"ExclamationEqualsEquals\"] = 1638681] = \"ExclamationEqualsEquals\";\n    Token[Token[\"LessThan\"] = 1638746] = \"LessThan\";\n    Token[Token[\"GreaterThan\"] = 1638747] = \"GreaterThan\";\n    Token[Token[\"LessThanEquals\"] = 1638748] = \"LessThanEquals\";\n    Token[Token[\"GreaterThanEquals\"] = 1638749] = \"GreaterThanEquals\";\n    Token[Token[\"InKeyword\"] = 1640798] = \"InKeyword\";\n    Token[Token[\"InstanceOfKeyword\"] = 1640799] = \"InstanceOfKeyword\";\n    Token[Token[\"Plus\"] = 623008] = \"Plus\";\n    Token[Token[\"Minus\"] = 623009] = \"Minus\";\n    Token[Token[\"TypeofKeyword\"] = 34850] = \"TypeofKeyword\";\n    Token[Token[\"VoidKeyword\"] = 34851] = \"VoidKeyword\";\n    Token[Token[\"Asterisk\"] = 1638884] = \"Asterisk\";\n    Token[Token[\"Percent\"] = 1638885] = \"Percent\";\n    Token[Token[\"Slash\"] = 1638886] = \"Slash\";\n    Token[Token[\"Equals\"] = 1048615] = \"Equals\";\n    Token[Token[\"Exclamation\"] = 32808] = \"Exclamation\";\n    Token[Token[\"TemplateTail\"] = 540713] = \"TemplateTail\";\n    Token[Token[\"TemplateContinuation\"] = 540714] = \"TemplateContinuation\";\n    Token[Token[\"OfKeyword\"] = 1051179] = \"OfKeyword\";\n})(Token || (Token = {}));\nexport var Char;\n(function (Char) {\n    Char[Char[\"Null\"] = 0] = \"Null\";\n    Char[Char[\"Backspace\"] = 8] = \"Backspace\";\n    Char[Char[\"Tab\"] = 9] = \"Tab\";\n    Char[Char[\"LineFeed\"] = 10] = \"LineFeed\";\n    Char[Char[\"VerticalTab\"] = 11] = \"VerticalTab\";\n    Char[Char[\"FormFeed\"] = 12] = \"FormFeed\";\n    Char[Char[\"CarriageReturn\"] = 13] = \"CarriageReturn\";\n    Char[Char[\"Space\"] = 32] = \"Space\";\n    Char[Char[\"Exclamation\"] = 33] = \"Exclamation\";\n    Char[Char[\"DoubleQuote\"] = 34] = \"DoubleQuote\";\n    Char[Char[\"Dollar\"] = 36] = \"Dollar\";\n    Char[Char[\"Percent\"] = 37] = \"Percent\";\n    Char[Char[\"Ampersand\"] = 38] = \"Ampersand\";\n    Char[Char[\"SingleQuote\"] = 39] = \"SingleQuote\";\n    Char[Char[\"OpenParen\"] = 40] = \"OpenParen\";\n    Char[Char[\"CloseParen\"] = 41] = \"CloseParen\";\n    Char[Char[\"Asterisk\"] = 42] = \"Asterisk\";\n    Char[Char[\"Plus\"] = 43] = \"Plus\";\n    Char[Char[\"Comma\"] = 44] = \"Comma\";\n    Char[Char[\"Minus\"] = 45] = \"Minus\";\n    Char[Char[\"Dot\"] = 46] = \"Dot\";\n    Char[Char[\"Slash\"] = 47] = \"Slash\";\n    Char[Char[\"Semicolon\"] = 59] = \"Semicolon\";\n    Char[Char[\"Backtick\"] = 96] = \"Backtick\";\n    Char[Char[\"OpenBracket\"] = 91] = \"OpenBracket\";\n    Char[Char[\"Backslash\"] = 92] = \"Backslash\";\n    Char[Char[\"CloseBracket\"] = 93] = \"CloseBracket\";\n    Char[Char[\"Caret\"] = 94] = \"Caret\";\n    Char[Char[\"Underscore\"] = 95] = \"Underscore\";\n    Char[Char[\"OpenBrace\"] = 123] = \"OpenBrace\";\n    Char[Char[\"Bar\"] = 124] = \"Bar\";\n    Char[Char[\"CloseBrace\"] = 125] = \"CloseBrace\";\n    Char[Char[\"Colon\"] = 58] = \"Colon\";\n    Char[Char[\"LessThan\"] = 60] = \"LessThan\";\n    Char[Char[\"Equals\"] = 61] = \"Equals\";\n    Char[Char[\"GreaterThan\"] = 62] = \"GreaterThan\";\n    Char[Char[\"Question\"] = 63] = \"Question\";\n    Char[Char[\"Zero\"] = 48] = \"Zero\";\n    Char[Char[\"One\"] = 49] = \"One\";\n    Char[Char[\"Two\"] = 50] = \"Two\";\n    Char[Char[\"Three\"] = 51] = \"Three\";\n    Char[Char[\"Four\"] = 52] = \"Four\";\n    Char[Char[\"Five\"] = 53] = \"Five\";\n    Char[Char[\"Six\"] = 54] = \"Six\";\n    Char[Char[\"Seven\"] = 55] = \"Seven\";\n    Char[Char[\"Eight\"] = 56] = \"Eight\";\n    Char[Char[\"Nine\"] = 57] = \"Nine\";\n    Char[Char[\"UpperA\"] = 65] = \"UpperA\";\n    Char[Char[\"UpperB\"] = 66] = \"UpperB\";\n    Char[Char[\"UpperC\"] = 67] = \"UpperC\";\n    Char[Char[\"UpperD\"] = 68] = \"UpperD\";\n    Char[Char[\"UpperE\"] = 69] = \"UpperE\";\n    Char[Char[\"UpperF\"] = 70] = \"UpperF\";\n    Char[Char[\"UpperG\"] = 71] = \"UpperG\";\n    Char[Char[\"UpperH\"] = 72] = \"UpperH\";\n    Char[Char[\"UpperI\"] = 73] = \"UpperI\";\n    Char[Char[\"UpperJ\"] = 74] = \"UpperJ\";\n    Char[Char[\"UpperK\"] = 75] = \"UpperK\";\n    Char[Char[\"UpperL\"] = 76] = \"UpperL\";\n    Char[Char[\"UpperM\"] = 77] = \"UpperM\";\n    Char[Char[\"UpperN\"] = 78] = \"UpperN\";\n    Char[Char[\"UpperO\"] = 79] = \"UpperO\";\n    Char[Char[\"UpperP\"] = 80] = \"UpperP\";\n    Char[Char[\"UpperQ\"] = 81] = \"UpperQ\";\n    Char[Char[\"UpperR\"] = 82] = \"UpperR\";\n    Char[Char[\"UpperS\"] = 83] = \"UpperS\";\n    Char[Char[\"UpperT\"] = 84] = \"UpperT\";\n    Char[Char[\"UpperU\"] = 85] = \"UpperU\";\n    Char[Char[\"UpperV\"] = 86] = \"UpperV\";\n    Char[Char[\"UpperW\"] = 87] = \"UpperW\";\n    Char[Char[\"UpperX\"] = 88] = \"UpperX\";\n    Char[Char[\"UpperY\"] = 89] = \"UpperY\";\n    Char[Char[\"UpperZ\"] = 90] = \"UpperZ\";\n    Char[Char[\"LowerA\"] = 97] = \"LowerA\";\n    Char[Char[\"LowerB\"] = 98] = \"LowerB\";\n    Char[Char[\"LowerC\"] = 99] = \"LowerC\";\n    Char[Char[\"LowerD\"] = 100] = \"LowerD\";\n    Char[Char[\"LowerE\"] = 101] = \"LowerE\";\n    Char[Char[\"LowerF\"] = 102] = \"LowerF\";\n    Char[Char[\"LowerG\"] = 103] = \"LowerG\";\n    Char[Char[\"LowerH\"] = 104] = \"LowerH\";\n    Char[Char[\"LowerI\"] = 105] = \"LowerI\";\n    Char[Char[\"LowerJ\"] = 106] = \"LowerJ\";\n    Char[Char[\"LowerK\"] = 107] = \"LowerK\";\n    Char[Char[\"LowerL\"] = 108] = \"LowerL\";\n    Char[Char[\"LowerM\"] = 109] = \"LowerM\";\n    Char[Char[\"LowerN\"] = 110] = \"LowerN\";\n    Char[Char[\"LowerO\"] = 111] = \"LowerO\";\n    Char[Char[\"LowerP\"] = 112] = \"LowerP\";\n    Char[Char[\"LowerQ\"] = 113] = \"LowerQ\";\n    Char[Char[\"LowerR\"] = 114] = \"LowerR\";\n    Char[Char[\"LowerS\"] = 115] = \"LowerS\";\n    Char[Char[\"LowerT\"] = 116] = \"LowerT\";\n    Char[Char[\"LowerU\"] = 117] = \"LowerU\";\n    Char[Char[\"LowerV\"] = 118] = \"LowerV\";\n    Char[Char[\"LowerW\"] = 119] = \"LowerW\";\n    Char[Char[\"LowerX\"] = 120] = \"LowerX\";\n    Char[Char[\"LowerY\"] = 121] = \"LowerY\";\n    Char[Char[\"LowerZ\"] = 122] = \"LowerZ\";\n})(Char || (Char = {}));\n//# sourceMappingURL=common.js.map","import { Reporter } from '@aurelia/kernel';\nimport { AccessKeyedExpression, AccessMemberExpression, AccessScopeExpression, AccessThisExpression, ArrayBindingPattern, ArrayLiteralExpression, AssignExpression, BinaryExpression, BindingBehaviorExpression, BindingIdentifier, CallFunctionExpression, CallMemberExpression, CallScopeExpression, ConditionalExpression, CustomExpression, ForOfStatement, Interpolation, ObjectBindingPattern, ObjectLiteralExpression, PrimitiveLiteralExpression, TaggedTemplateExpression, TemplateExpression, UnaryExpression, ValueConverterExpression } from '@aurelia/runtime';\nimport { unescapeCode } from './common';\nconst $false = PrimitiveLiteralExpression.$false;\nconst $true = PrimitiveLiteralExpression.$true;\nconst $null = PrimitiveLiteralExpression.$null;\nconst $undefined = PrimitiveLiteralExpression.$undefined;\nconst $this = AccessThisExpression.$this;\nconst $parent = AccessThisExpression.$parent;\n/** @internal */\nexport class ParserState {\n    constructor(input) {\n        this.input = input;\n        this.index = 0;\n        this.startIndex = 0;\n        this.lastIndex = 0;\n        this.currentToken = 1572864 /* EOF */;\n        this.tokenValue = '';\n        this.assignable = true;\n        this.length = input.length;\n        this.currentChar = input.charCodeAt(0);\n    }\n    get tokenRaw() {\n        return this.input.slice(this.startIndex, this.index);\n    }\n}\nconst $state = new ParserState('');\nvar SyntaxError;\n(function (SyntaxError) {\n    SyntaxError[SyntaxError[\"InvalidExpressionStart\"] = 100] = \"InvalidExpressionStart\";\n    SyntaxError[SyntaxError[\"UnconsumedToken\"] = 101] = \"UnconsumedToken\";\n    SyntaxError[SyntaxError[\"DoubleDot\"] = 102] = \"DoubleDot\";\n    SyntaxError[SyntaxError[\"InvalidMemberExpression\"] = 103] = \"InvalidMemberExpression\";\n    SyntaxError[SyntaxError[\"UnexpectedEndOfExpression\"] = 104] = \"UnexpectedEndOfExpression\";\n    SyntaxError[SyntaxError[\"ExpectedIdentifier\"] = 105] = \"ExpectedIdentifier\";\n    SyntaxError[SyntaxError[\"InvalidForDeclaration\"] = 106] = \"InvalidForDeclaration\";\n    SyntaxError[SyntaxError[\"InvalidObjectLiteralPropertyDefinition\"] = 107] = \"InvalidObjectLiteralPropertyDefinition\";\n    SyntaxError[SyntaxError[\"UnterminatedQuote\"] = 108] = \"UnterminatedQuote\";\n    SyntaxError[SyntaxError[\"UnterminatedTemplate\"] = 109] = \"UnterminatedTemplate\";\n    SyntaxError[SyntaxError[\"MissingExpectedToken\"] = 110] = \"MissingExpectedToken\";\n    SyntaxError[SyntaxError[\"UnexpectedCharacter\"] = 111] = \"UnexpectedCharacter\";\n    SyntaxError[SyntaxError[\"MissingValueConverter\"] = 112] = \"MissingValueConverter\";\n    SyntaxError[SyntaxError[\"MissingBindingBehavior\"] = 113] = \"MissingBindingBehavior\";\n})(SyntaxError || (SyntaxError = {}));\nvar SemanticError;\n(function (SemanticError) {\n    SemanticError[SemanticError[\"NotAssignable\"] = 150] = \"NotAssignable\";\n    SemanticError[SemanticError[\"UnexpectedForOf\"] = 151] = \"UnexpectedForOf\";\n})(SemanticError || (SemanticError = {}));\nexport function parseExpression(input, bindingType) {\n    $state.input = input;\n    $state.length = input.length;\n    $state.index = 0;\n    $state.currentChar = input.charCodeAt(0);\n    return parse($state, 0 /* Reset */, 61 /* Variadic */, bindingType === void 0 ? 53 /* BindCommand */ : bindingType);\n}\n/** @internal */\n// JUSTIFICATION: This is performance-critical code which follows a subset of the well-known ES spec.\n// Knowing the spec, or parsers in general, will help with understanding this code and it is therefore not the\n// single source of information for being able to figure it out.\n// It generally does not need to change unless the spec changes or spec violations are found, or optimization\n// opportunities are found (which would likely not fix these warnings in any case).\n// It's therefore not considered to have any tangible impact on the maintainability of the code base.\n// For reference, most of the parsing logic is based on: https://tc39.github.io/ecma262/#sec-ecmascript-language-expressions\n// eslint-disable-next-line max-lines-per-function\nexport function parse(state, access, minPrecedence, bindingType) {\n    if (bindingType === 284 /* CustomCommand */) {\n        return new CustomExpression(state.input);\n    }\n    if (state.index === 0) {\n        if (bindingType & 2048 /* Interpolation */) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return parseInterpolation(state);\n        }\n        nextToken(state);\n        if (state.currentToken & 1048576 /* ExpressionTerminal */) {\n            throw Reporter.error(100 /* InvalidExpressionStart */, { state });\n        }\n    }\n    state.assignable = 448 /* Binary */ > minPrecedence;\n    let result = void 0;\n    if (state.currentToken & 32768 /* UnaryOp */) {\n        /** parseUnaryExpression\n         * https://tc39.github.io/ecma262/#sec-unary-operators\n         *\n         * UnaryExpression :\n         * 1. LeftHandSideExpression\n         * 2. void UnaryExpression\n         * 3. typeof UnaryExpression\n         * 4. + UnaryExpression\n         * 5. - UnaryExpression\n         * 6. ! UnaryExpression\n         *\n         * IsValidAssignmentTarget\n         * 2,3,4,5,6 = false\n         * 1 = see parseLeftHandSideExpression\n         *\n         * Note: technically we should throw on ++ / -- / +++ / ---, but there's nothing to gain from that\n         */\n        const op = TokenValues[state.currentToken & 63 /* Type */];\n        nextToken(state);\n        result = new UnaryExpression(op, parse(state, access, 449 /* LeftHandSide */, bindingType));\n        state.assignable = false;\n    }\n    else {\n        /** parsePrimaryExpression\n         * https://tc39.github.io/ecma262/#sec-primary-expression\n         *\n         * PrimaryExpression :\n         * 1. this\n         * 2. IdentifierName\n         * 3. Literal\n         * 4. ArrayLiteralExpression\n         * 5. ObjectLiteralExpression\n         * 6. TemplateLiteral\n         * 7. ParenthesizedExpression\n         *\n         * Literal :\n         * NullLiteral\n         * BooleanLiteral\n         * NumericLiteral\n         * StringLiteral\n         *\n         * ParenthesizedExpression :\n         * ( AssignmentExpression )\n         *\n         * IsValidAssignmentTarget\n         * 1,3,4,5,6,7 = false\n         * 2 = true\n         */\n        primary: switch (state.currentToken) {\n            case 3077 /* ParentScope */: // $parent\n                state.assignable = false;\n                do {\n                    nextToken(state);\n                    access++; // ancestor\n                    if (consumeOpt(state, 16392 /* Dot */)) {\n                        if (state.currentToken === 16392 /* Dot */) {\n                            throw Reporter.error(102 /* DoubleDot */, { state });\n                        }\n                        else if (state.currentToken === 1572864 /* EOF */) {\n                            throw Reporter.error(105 /* ExpectedIdentifier */, { state });\n                        }\n                    }\n                    else if (state.currentToken & 524288 /* AccessScopeTerminal */) {\n                        const ancestor = access & 511 /* Ancestor */;\n                        result = ancestor === 0 ? $this : ancestor === 1 ? $parent : new AccessThisExpression(ancestor);\n                        access = 512 /* This */;\n                        break primary;\n                    }\n                    else {\n                        throw Reporter.error(103 /* InvalidMemberExpression */, { state });\n                    }\n                } while (state.currentToken === 3077 /* ParentScope */);\n            // falls through\n            case 1024 /* Identifier */: // identifier\n                if (bindingType & 512 /* IsIterator */) {\n                    result = new BindingIdentifier(state.tokenValue);\n                }\n                else {\n                    result = new AccessScopeExpression(state.tokenValue, access & 511 /* Ancestor */);\n                    access = 1024 /* Scope */;\n                }\n                state.assignable = true;\n                nextToken(state);\n                break;\n            case 3076 /* ThisScope */: // $this\n                state.assignable = false;\n                nextToken(state);\n                result = $this;\n                access = 512 /* This */;\n                break;\n            case 671750 /* OpenParen */: // parenthesized expression\n                nextToken(state);\n                result = parse(state, 0 /* Reset */, 62 /* Assign */, bindingType);\n                consume(state, 1835018 /* CloseParen */);\n                access = 0 /* Reset */;\n                break;\n            case 671756 /* OpenBracket */:\n                result = parseArrayLiteralExpression(state, access, bindingType);\n                access = 0 /* Reset */;\n                break;\n            case 131079 /* OpenBrace */:\n                result = parseObjectLiteralExpression(state, bindingType);\n                access = 0 /* Reset */;\n                break;\n            case 540713 /* TemplateTail */:\n                result = new TemplateExpression([state.tokenValue]);\n                state.assignable = false;\n                nextToken(state);\n                access = 0 /* Reset */;\n                break;\n            case 540714 /* TemplateContinuation */:\n                result = parseTemplate(state, access, bindingType, result, false);\n                access = 0 /* Reset */;\n                break;\n            case 4096 /* StringLiteral */:\n            case 8192 /* NumericLiteral */:\n                result = new PrimitiveLiteralExpression(state.tokenValue);\n                state.assignable = false;\n                nextToken(state);\n                access = 0 /* Reset */;\n                break;\n            case 2050 /* NullKeyword */:\n            case 2051 /* UndefinedKeyword */:\n            case 2049 /* TrueKeyword */:\n            case 2048 /* FalseKeyword */:\n                result = TokenValues[state.currentToken & 63 /* Type */];\n                state.assignable = false;\n                nextToken(state);\n                access = 0 /* Reset */;\n                break;\n            default:\n                if (state.index >= state.length) {\n                    throw Reporter.error(104 /* UnexpectedEndOfExpression */, { state });\n                }\n                else {\n                    throw Reporter.error(101 /* UnconsumedToken */, { state });\n                }\n        }\n        if (bindingType & 512 /* IsIterator */) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return parseForOfStatement(state, result);\n        }\n        if (449 /* LeftHandSide */ < minPrecedence) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return result;\n        }\n        /** parseMemberExpression (Token.Dot, Token.OpenBracket, Token.TemplateContinuation)\n         * MemberExpression :\n         * 1. PrimaryExpression\n         * 2. MemberExpression [ AssignmentExpression ]\n         * 3. MemberExpression . IdentifierName\n         * 4. MemberExpression TemplateLiteral\n         *\n         * IsValidAssignmentTarget\n         * 1,4 = false\n         * 2,3 = true\n         *\n         *\n         * parseCallExpression (Token.OpenParen)\n         * CallExpression :\n         * 1. MemberExpression Arguments\n         * 2. CallExpression Arguments\n         * 3. CallExpression [ AssignmentExpression ]\n         * 4. CallExpression . IdentifierName\n         * 5. CallExpression TemplateLiteral\n         *\n         * IsValidAssignmentTarget\n         * 1,2,5 = false\n         * 3,4 = true\n         */\n        let name = state.tokenValue;\n        while ((state.currentToken & 16384 /* LeftHandSide */) > 0) {\n            const args = [];\n            let strings;\n            switch (state.currentToken) {\n                case 16392 /* Dot */:\n                    state.assignable = true;\n                    nextToken(state);\n                    if ((state.currentToken & 3072 /* IdentifierName */) === 0) {\n                        throw Reporter.error(105 /* ExpectedIdentifier */, { state });\n                    }\n                    name = state.tokenValue;\n                    nextToken(state);\n                    // Change $This to $Scope, change $Scope to $Member, keep $Member as-is, change $Keyed to $Member, disregard other flags\n                    access = ((access & (512 /* This */ | 1024 /* Scope */)) << 1) | (access & 2048 /* Member */) | ((access & 4096 /* Keyed */) >> 1);\n                    if (state.currentToken === 671750 /* OpenParen */) {\n                        if (access === 0 /* Reset */) { // if the left hand side is a literal, make sure we parse a CallMemberExpression\n                            access = 2048 /* Member */;\n                        }\n                        continue;\n                    }\n                    if (access & 1024 /* Scope */) {\n                        result = new AccessScopeExpression(name, result.ancestor);\n                    }\n                    else { // if it's not $Scope, it's $Member\n                        result = new AccessMemberExpression(result, name);\n                    }\n                    continue;\n                case 671756 /* OpenBracket */:\n                    state.assignable = true;\n                    nextToken(state);\n                    access = 4096 /* Keyed */;\n                    result = new AccessKeyedExpression(result, parse(state, 0 /* Reset */, 62 /* Assign */, bindingType));\n                    consume(state, 1835021 /* CloseBracket */);\n                    break;\n                case 671750 /* OpenParen */:\n                    state.assignable = false;\n                    nextToken(state);\n                    while (state.currentToken !== 1835018 /* CloseParen */) {\n                        args.push(parse(state, 0 /* Reset */, 62 /* Assign */, bindingType));\n                        if (!consumeOpt(state, 1572875 /* Comma */)) {\n                            break;\n                        }\n                    }\n                    consume(state, 1835018 /* CloseParen */);\n                    if (access & 1024 /* Scope */) {\n                        result = new CallScopeExpression(name, args, result.ancestor);\n                    }\n                    else if (access & 2048 /* Member */) {\n                        result = new CallMemberExpression(result, name, args);\n                    }\n                    else {\n                        result = new CallFunctionExpression(result, args);\n                    }\n                    access = 0;\n                    break;\n                case 540713 /* TemplateTail */:\n                    state.assignable = false;\n                    strings = [state.tokenValue];\n                    result = new TaggedTemplateExpression(strings, strings, result);\n                    nextToken(state);\n                    break;\n                case 540714 /* TemplateContinuation */:\n                    result = parseTemplate(state, access, bindingType, result, true);\n                default:\n            }\n        }\n    }\n    if (448 /* Binary */ < minPrecedence) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        return result;\n    }\n    /** parseBinaryExpression\n     * https://tc39.github.io/ecma262/#sec-multiplicative-operators\n     *\n     * MultiplicativeExpression : (local precedence 6)\n     * UnaryExpression\n     * MultiplicativeExpression * / % UnaryExpression\n     *\n     * AdditiveExpression : (local precedence 5)\n     * MultiplicativeExpression\n     * AdditiveExpression + - MultiplicativeExpression\n     *\n     * RelationalExpression : (local precedence 4)\n     * AdditiveExpression\n     * RelationalExpression < > <= >= instanceof in AdditiveExpression\n     *\n     * EqualityExpression : (local precedence 3)\n     * RelationalExpression\n     * EqualityExpression == != === !== RelationalExpression\n     *\n     * LogicalANDExpression : (local precedence 2)\n     * EqualityExpression\n     * LogicalANDExpression && EqualityExpression\n     *\n     * LogicalORExpression : (local precedence 1)\n     * LogicalANDExpression\n     * LogicalORExpression || LogicalANDExpression\n     */\n    while ((state.currentToken & 65536 /* BinaryOp */) > 0) {\n        const opToken = state.currentToken;\n        if ((opToken & 448 /* Precedence */) <= minPrecedence) {\n            break;\n        }\n        nextToken(state);\n        result = new BinaryExpression(TokenValues[opToken & 63 /* Type */], result, parse(state, access, opToken & 448 /* Precedence */, bindingType));\n        state.assignable = false;\n    }\n    if (63 /* Conditional */ < minPrecedence) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        return result;\n    }\n    /**\n     * parseConditionalExpression\n     * https://tc39.github.io/ecma262/#prod-ConditionalExpression\n     *\n     * ConditionalExpression :\n     * 1. BinaryExpression\n     * 2. BinaryExpression ? AssignmentExpression : AssignmentExpression\n     *\n     * IsValidAssignmentTarget\n     * 1,2 = false\n     */\n    if (consumeOpt(state, 1572879 /* Question */)) {\n        const yes = parse(state, access, 62 /* Assign */, bindingType);\n        consume(state, 1572878 /* Colon */);\n        result = new ConditionalExpression(result, yes, parse(state, access, 62 /* Assign */, bindingType));\n        state.assignable = false;\n    }\n    if (62 /* Assign */ < minPrecedence) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        return result;\n    }\n    /** parseAssignmentExpression\n     * https://tc39.github.io/ecma262/#prod-AssignmentExpression\n     * Note: AssignmentExpression here is equivalent to ES Expression because we don't parse the comma operator\n     *\n     * AssignmentExpression :\n     * 1. ConditionalExpression\n     * 2. LeftHandSideExpression = AssignmentExpression\n     *\n     * IsValidAssignmentTarget\n     * 1,2 = false\n     */\n    if (consumeOpt(state, 1048615 /* Equals */)) {\n        if (!state.assignable) {\n            throw Reporter.error(150 /* NotAssignable */, { state });\n        }\n        result = new AssignExpression(result, parse(state, access, 62 /* Assign */, bindingType));\n    }\n    if (61 /* Variadic */ < minPrecedence) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        return result;\n    }\n    /** parseValueConverter\n     */\n    while (consumeOpt(state, 1572883 /* Bar */)) {\n        if (state.currentToken === 1572864 /* EOF */) {\n            throw Reporter.error(112);\n        }\n        const name = state.tokenValue;\n        nextToken(state);\n        const args = new Array();\n        while (consumeOpt(state, 1572878 /* Colon */)) {\n            args.push(parse(state, access, 62 /* Assign */, bindingType));\n        }\n        result = new ValueConverterExpression(result, name, args);\n    }\n    /** parseBindingBehavior\n     */\n    while (consumeOpt(state, 1572880 /* Ampersand */)) {\n        if (state.currentToken === 1572864 /* EOF */) {\n            throw Reporter.error(113);\n        }\n        const name = state.tokenValue;\n        nextToken(state);\n        const args = new Array();\n        while (consumeOpt(state, 1572878 /* Colon */)) {\n            args.push(parse(state, access, 62 /* Assign */, bindingType));\n        }\n        result = new BindingBehaviorExpression(result, name, args);\n    }\n    if (state.currentToken !== 1572864 /* EOF */) {\n        if (bindingType & 2048 /* Interpolation */) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return result;\n        }\n        if (state.tokenRaw === 'of') {\n            throw Reporter.error(151 /* UnexpectedForOf */, { state });\n        }\n        throw Reporter.error(101 /* UnconsumedToken */, { state });\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return result;\n}\n/**\n * parseArrayLiteralExpression\n * https://tc39.github.io/ecma262/#prod-ArrayLiteralExpression\n *\n * ArrayLiteralExpression :\n * [ Elision(opt) ]\n * [ ElementList ]\n * [ ElementList, Elision(opt) ]\n *\n * ElementList :\n * Elision(opt) AssignmentExpression\n * ElementList, Elision(opt) AssignmentExpression\n *\n * Elision :\n * ,\n * Elision ,\n */\nfunction parseArrayLiteralExpression(state, access, bindingType) {\n    nextToken(state);\n    const elements = new Array();\n    while (state.currentToken !== 1835021 /* CloseBracket */) {\n        if (consumeOpt(state, 1572875 /* Comma */)) {\n            elements.push($undefined);\n            if (state.currentToken === 1835021 /* CloseBracket */) {\n                break;\n            }\n        }\n        else {\n            elements.push(parse(state, access, 62 /* Assign */, bindingType & ~512 /* IsIterator */));\n            if (consumeOpt(state, 1572875 /* Comma */)) {\n                if (state.currentToken === 1835021 /* CloseBracket */) {\n                    break;\n                }\n            }\n            else {\n                break;\n            }\n        }\n    }\n    consume(state, 1835021 /* CloseBracket */);\n    if (bindingType & 512 /* IsIterator */) {\n        return new ArrayBindingPattern(elements);\n    }\n    else {\n        state.assignable = false;\n        return new ArrayLiteralExpression(elements);\n    }\n}\nfunction parseForOfStatement(state, result) {\n    if ((result.$kind & 65536 /* IsForDeclaration */) === 0) {\n        throw Reporter.error(106 /* InvalidForDeclaration */, { state });\n    }\n    if (state.currentToken !== 1051179 /* OfKeyword */) {\n        throw Reporter.error(106 /* InvalidForDeclaration */, { state });\n    }\n    nextToken(state);\n    const declaration = result;\n    const statement = parse(state, 0 /* Reset */, 61 /* Variadic */, 0 /* None */);\n    return new ForOfStatement(declaration, statement);\n}\n/**\n * parseObjectLiteralExpression\n * https://tc39.github.io/ecma262/#prod-Literal\n *\n * ObjectLiteralExpression :\n * { }\n * { PropertyDefinitionList }\n *\n * PropertyDefinitionList :\n * PropertyDefinition\n * PropertyDefinitionList, PropertyDefinition\n *\n * PropertyDefinition :\n * IdentifierName\n * PropertyName : AssignmentExpression\n *\n * PropertyName :\n * IdentifierName\n * StringLiteral\n * NumericLiteral\n */\nfunction parseObjectLiteralExpression(state, bindingType) {\n    const keys = new Array();\n    const values = new Array();\n    nextToken(state);\n    while (state.currentToken !== 1835017 /* CloseBrace */) {\n        keys.push(state.tokenValue);\n        // Literal = mandatory colon\n        if (state.currentToken & 12288 /* StringOrNumericLiteral */) {\n            nextToken(state);\n            consume(state, 1572878 /* Colon */);\n            values.push(parse(state, 0 /* Reset */, 62 /* Assign */, bindingType & ~512 /* IsIterator */));\n        }\n        else if (state.currentToken & 3072 /* IdentifierName */) {\n            // IdentifierName = optional colon\n            const { currentChar, currentToken, index } = state;\n            nextToken(state);\n            if (consumeOpt(state, 1572878 /* Colon */)) {\n                values.push(parse(state, 0 /* Reset */, 62 /* Assign */, bindingType & ~512 /* IsIterator */));\n            }\n            else {\n                // Shorthand\n                state.currentChar = currentChar;\n                state.currentToken = currentToken;\n                state.index = index;\n                values.push(parse(state, 0 /* Reset */, 450 /* Primary */, bindingType & ~512 /* IsIterator */));\n            }\n        }\n        else {\n            throw Reporter.error(107 /* InvalidObjectLiteralPropertyDefinition */, { state });\n        }\n        if (state.currentToken !== 1835017 /* CloseBrace */) {\n            consume(state, 1572875 /* Comma */);\n        }\n    }\n    consume(state, 1835017 /* CloseBrace */);\n    if (bindingType & 512 /* IsIterator */) {\n        return new ObjectBindingPattern(keys, values);\n    }\n    else {\n        state.assignable = false;\n        return new ObjectLiteralExpression(keys, values);\n    }\n}\nfunction parseInterpolation(state) {\n    const parts = [];\n    const expressions = [];\n    const length = state.length;\n    let result = '';\n    while (state.index < length) {\n        switch (state.currentChar) {\n            case 36 /* Dollar */:\n                if (state.input.charCodeAt(state.index + 1) === 123 /* OpenBrace */) {\n                    parts.push(result);\n                    result = '';\n                    state.index += 2;\n                    state.currentChar = state.input.charCodeAt(state.index);\n                    nextToken(state);\n                    const expression = parse(state, 0 /* Reset */, 61 /* Variadic */, 2048 /* Interpolation */);\n                    expressions.push(expression);\n                    continue;\n                }\n                else {\n                    result += '$';\n                }\n                break;\n            case 92 /* Backslash */:\n                result += String.fromCharCode(unescapeCode(nextChar(state)));\n                break;\n            default:\n                result += String.fromCharCode(state.currentChar);\n        }\n        nextChar(state);\n    }\n    if (expressions.length) {\n        parts.push(result);\n        return new Interpolation(parts, expressions);\n    }\n    return null;\n}\n/**\n * parseTemplateLiteralExpression\n * https://tc39.github.io/ecma262/#prod-Literal\n *\n * TemplateExpression :\n * NoSubstitutionTemplate\n * TemplateHead\n *\n * NoSubstitutionTemplate :\n * ` TemplateCharacters(opt) `\n *\n * TemplateHead :\n * ` TemplateCharacters(opt) ${\n *\n * TemplateSubstitutionTail :\n * TemplateMiddle\n * TemplateTail\n *\n * TemplateMiddle :\n * } TemplateCharacters(opt) ${\n *\n * TemplateTail :\n * } TemplateCharacters(opt) `\n *\n * TemplateCharacters :\n * TemplateCharacter TemplateCharacters(opt)\n *\n * TemplateCharacter :\n * $ [lookahead ≠ {]\n * \\ EscapeSequence\n * SourceCharacter (but not one of ` or \\ or $)\n */\nfunction parseTemplate(state, access, bindingType, result, tagged) {\n    const cooked = [state.tokenValue];\n    // TODO: properly implement raw parts / decide whether we want this\n    consume(state, 540714 /* TemplateContinuation */);\n    const expressions = [parse(state, access, 62 /* Assign */, bindingType)];\n    while ((state.currentToken = scanTemplateTail(state)) !== 540713 /* TemplateTail */) {\n        cooked.push(state.tokenValue);\n        consume(state, 540714 /* TemplateContinuation */);\n        expressions.push(parse(state, access, 62 /* Assign */, bindingType));\n    }\n    cooked.push(state.tokenValue);\n    state.assignable = false;\n    if (tagged) {\n        nextToken(state);\n        return new TaggedTemplateExpression(cooked, cooked, result, expressions);\n    }\n    else {\n        nextToken(state);\n        return new TemplateExpression(cooked, expressions);\n    }\n}\nfunction nextToken(state) {\n    while (state.index < state.length) {\n        state.startIndex = state.index;\n        if ((state.currentToken = (CharScanners[state.currentChar](state))) != null) { // a null token means the character must be skipped\n            return;\n        }\n    }\n    state.currentToken = 1572864 /* EOF */;\n}\nfunction nextChar(state) {\n    return state.currentChar = state.input.charCodeAt(++state.index);\n}\nfunction scanIdentifier(state) {\n    // run to the next non-idPart\n    while (IdParts[nextChar(state)])\n        ;\n    const token = KeywordLookup[state.tokenValue = state.tokenRaw];\n    return token === undefined ? 1024 /* Identifier */ : token;\n}\nfunction scanNumber(state, isFloat) {\n    let char = state.currentChar;\n    if (isFloat === false) {\n        do {\n            char = nextChar(state);\n        } while (char <= 57 /* Nine */ && char >= 48 /* Zero */);\n        if (char !== 46 /* Dot */) {\n            state.tokenValue = parseInt(state.tokenRaw, 10);\n            return 8192 /* NumericLiteral */;\n        }\n        // past this point it's always a float\n        char = nextChar(state);\n        if (state.index >= state.length) {\n            // unless the number ends with a dot - that behaves a little different in native ES expressions\n            // but in our AST that behavior has no effect because numbers are always stored in variables\n            state.tokenValue = parseInt(state.tokenRaw.slice(0, -1), 10);\n            return 8192 /* NumericLiteral */;\n        }\n    }\n    if (char <= 57 /* Nine */ && char >= 48 /* Zero */) {\n        do {\n            char = nextChar(state);\n        } while (char <= 57 /* Nine */ && char >= 48 /* Zero */);\n    }\n    else {\n        state.currentChar = state.input.charCodeAt(--state.index);\n    }\n    state.tokenValue = parseFloat(state.tokenRaw);\n    return 8192 /* NumericLiteral */;\n}\nfunction scanString(state) {\n    const quote = state.currentChar;\n    nextChar(state); // Skip initial quote.\n    let unescaped = 0;\n    const buffer = new Array();\n    let marker = state.index;\n    while (state.currentChar !== quote) {\n        if (state.currentChar === 92 /* Backslash */) {\n            buffer.push(state.input.slice(marker, state.index));\n            nextChar(state);\n            unescaped = unescapeCode(state.currentChar);\n            nextChar(state);\n            buffer.push(String.fromCharCode(unescaped));\n            marker = state.index;\n        }\n        else if (state.index >= state.length) {\n            throw Reporter.error(108 /* UnterminatedQuote */, { state });\n        }\n        else {\n            nextChar(state);\n        }\n    }\n    const last = state.input.slice(marker, state.index);\n    nextChar(state); // Skip terminating quote.\n    // Compute the unescaped string value.\n    buffer.push(last);\n    const unescapedStr = buffer.join('');\n    state.tokenValue = unescapedStr;\n    return 4096 /* StringLiteral */;\n}\nfunction scanTemplate(state) {\n    let tail = true;\n    let result = '';\n    while (nextChar(state) !== 96 /* Backtick */) {\n        if (state.currentChar === 36 /* Dollar */) {\n            if ((state.index + 1) < state.length && state.input.charCodeAt(state.index + 1) === 123 /* OpenBrace */) {\n                state.index++;\n                tail = false;\n                break;\n            }\n            else {\n                result += '$';\n            }\n        }\n        else if (state.currentChar === 92 /* Backslash */) {\n            result += String.fromCharCode(unescapeCode(nextChar(state)));\n        }\n        else {\n            if (state.index >= state.length) {\n                throw Reporter.error(109 /* UnterminatedTemplate */, { state });\n            }\n            result += String.fromCharCode(state.currentChar);\n        }\n    }\n    nextChar(state);\n    state.tokenValue = result;\n    if (tail) {\n        return 540713 /* TemplateTail */;\n    }\n    return 540714 /* TemplateContinuation */;\n}\nfunction scanTemplateTail(state) {\n    if (state.index >= state.length) {\n        throw Reporter.error(109 /* UnterminatedTemplate */, { state });\n    }\n    state.index--;\n    return scanTemplate(state);\n}\nfunction consumeOpt(state, token) {\n    if (state.currentToken === token) {\n        nextToken(state);\n        return true;\n    }\n    return false;\n}\nfunction consume(state, token) {\n    if (state.currentToken === token) {\n        nextToken(state);\n    }\n    else {\n        throw Reporter.error(110 /* MissingExpectedToken */, { state, expected: token });\n    }\n}\n/**\n * Array for mapping tokens to token values. The indices of the values\n * correspond to the token bits 0-38.\n * For this to work properly, the values in the array must be kept in\n * the same order as the token bits.\n * Usage: TokenValues[token & Token.Type]\n */\nconst TokenValues = [\n    $false, $true, $null, $undefined, '$this', '$parent',\n    '(', '{', '.', '}', ')', ',', '[', ']', ':', '?', '\\'', '\"',\n    '&', '|', '||', '&&', '==', '!=', '===', '!==', '<', '>',\n    '<=', '>=', 'in', 'instanceof', '+', '-', 'typeof', 'void', '*', '%', '/', '=', '!',\n    540713 /* TemplateTail */, 540714 /* TemplateContinuation */,\n    'of'\n];\nconst KeywordLookup = Object.create(null);\nKeywordLookup.true = 2049 /* TrueKeyword */;\nKeywordLookup.null = 2050 /* NullKeyword */;\nKeywordLookup.false = 2048 /* FalseKeyword */;\nKeywordLookup.undefined = 2051 /* UndefinedKeyword */;\nKeywordLookup.$this = 3076 /* ThisScope */;\nKeywordLookup.$parent = 3077 /* ParentScope */;\nKeywordLookup.in = 1640798 /* InKeyword */;\nKeywordLookup.instanceof = 1640799 /* InstanceOfKeyword */;\nKeywordLookup.typeof = 34850 /* TypeofKeyword */;\nKeywordLookup.void = 34851 /* VoidKeyword */;\nKeywordLookup.of = 1051179 /* OfKeyword */;\n/**\n * Ranges of code points in pairs of 2 (eg 0x41-0x5B, 0x61-0x7B, ...) where the second value is not inclusive (5-7 means 5 and 6)\n * Single values are denoted by the second value being a 0\n *\n * Copied from output generated with \"node build/generate-unicode.js\"\n *\n * See also: https://en.wikibooks.org/wiki/Unicode/Character_reference/0000-0FFF\n */\nconst codes = {\n    /* [$0-9A-Za_a-z] */\n    AsciiIdPart: [0x24, 0, 0x30, 0x3A, 0x41, 0x5B, 0x5F, 0, 0x61, 0x7B],\n    IdStart: /* IdentifierStart */ [0x24, 0, 0x41, 0x5B, 0x5F, 0, 0x61, 0x7B, 0xAA, 0, 0xBA, 0, 0xC0, 0xD7, 0xD8, 0xF7, 0xF8, 0x2B9, 0x2E0, 0x2E5, 0x1D00, 0x1D26, 0x1D2C, 0x1D5D, 0x1D62, 0x1D66, 0x1D6B, 0x1D78, 0x1D79, 0x1DBF, 0x1E00, 0x1F00, 0x2071, 0, 0x207F, 0, 0x2090, 0x209D, 0x212A, 0x212C, 0x2132, 0, 0x214E, 0, 0x2160, 0x2189, 0x2C60, 0x2C80, 0xA722, 0xA788, 0xA78B, 0xA7AF, 0xA7B0, 0xA7B8, 0xA7F7, 0xA800, 0xAB30, 0xAB5B, 0xAB5C, 0xAB65, 0xFB00, 0xFB07, 0xFF21, 0xFF3B, 0xFF41, 0xFF5B],\n    Digit: /* DecimalNumber */ [0x30, 0x3A],\n    Skip: /* Skippable */ [0, 0x21, 0x7F, 0xA1]\n};\n/**\n * Decompress the ranges into an array of numbers so that the char code\n * can be used as an index to the lookup\n */\nfunction decompress(lookup, $set, compressed, value) {\n    const rangeCount = compressed.length;\n    for (let i = 0; i < rangeCount; i += 2) {\n        const start = compressed[i];\n        let end = compressed[i + 1];\n        end = end > 0 ? end : start + 1;\n        if (lookup) {\n            lookup.fill(value, start, end);\n        }\n        if ($set) {\n            for (let ch = start; ch < end; ch++) {\n                $set.add(ch);\n            }\n        }\n    }\n}\n// CharFuncLookup functions\nfunction returnToken(token) {\n    return s => {\n        nextChar(s);\n        return token;\n    };\n}\nconst unexpectedCharacter = s => {\n    throw Reporter.error(111 /* UnexpectedCharacter */, { state: s });\n};\nunexpectedCharacter.notMapped = true;\n// ASCII IdentifierPart lookup\nconst AsciiIdParts = new Set();\ndecompress(null, AsciiIdParts, codes.AsciiIdPart, true);\n// IdentifierPart lookup\nconst IdParts = new Uint8Array(0xFFFF);\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ndecompress(IdParts, null, codes.IdStart, 1);\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ndecompress(IdParts, null, codes.Digit, 1);\n// Character scanning function lookup\nconst CharScanners = new Array(0xFFFF);\nCharScanners.fill(unexpectedCharacter, 0, 0xFFFF);\ndecompress(CharScanners, null, codes.Skip, s => {\n    nextChar(s);\n    return null;\n});\ndecompress(CharScanners, null, codes.IdStart, scanIdentifier);\ndecompress(CharScanners, null, codes.Digit, s => scanNumber(s, false));\nCharScanners[34 /* DoubleQuote */] =\n    CharScanners[39 /* SingleQuote */] = s => {\n        return scanString(s);\n    };\nCharScanners[96 /* Backtick */] = s => {\n    return scanTemplate(s);\n};\n// !, !=, !==\nCharScanners[33 /* Exclamation */] = s => {\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 32808 /* Exclamation */;\n    }\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 1638679 /* ExclamationEquals */;\n    }\n    nextChar(s);\n    return 1638681 /* ExclamationEqualsEquals */;\n};\n// =, ==, ===\nCharScanners[61 /* Equals */] = s => {\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 1048615 /* Equals */;\n    }\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 1638678 /* EqualsEquals */;\n    }\n    nextChar(s);\n    return 1638680 /* EqualsEqualsEquals */;\n};\n// &, &&\nCharScanners[38 /* Ampersand */] = s => {\n    if (nextChar(s) !== 38 /* Ampersand */) {\n        return 1572880 /* Ampersand */;\n    }\n    nextChar(s);\n    return 1638613 /* AmpersandAmpersand */;\n};\n// |, ||\nCharScanners[124 /* Bar */] = s => {\n    if (nextChar(s) !== 124 /* Bar */) {\n        return 1572883 /* Bar */;\n    }\n    nextChar(s);\n    return 1638548 /* BarBar */;\n};\n// .\nCharScanners[46 /* Dot */] = s => {\n    if (nextChar(s) <= 57 /* Nine */ && s.currentChar >= 48 /* Zero */) {\n        return scanNumber(s, true);\n    }\n    return 16392 /* Dot */;\n};\n// <, <=\nCharScanners[60 /* LessThan */] = s => {\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 1638746 /* LessThan */;\n    }\n    nextChar(s);\n    return 1638748 /* LessThanEquals */;\n};\n// >, >=\nCharScanners[62 /* GreaterThan */] = s => {\n    if (nextChar(s) !== 61 /* Equals */) {\n        return 1638747 /* GreaterThan */;\n    }\n    nextChar(s);\n    return 1638749 /* GreaterThanEquals */;\n};\nCharScanners[37 /* Percent */] = returnToken(1638885 /* Percent */);\nCharScanners[40 /* OpenParen */] = returnToken(671750 /* OpenParen */);\nCharScanners[41 /* CloseParen */] = returnToken(1835018 /* CloseParen */);\nCharScanners[42 /* Asterisk */] = returnToken(1638884 /* Asterisk */);\nCharScanners[43 /* Plus */] = returnToken(623008 /* Plus */);\nCharScanners[44 /* Comma */] = returnToken(1572875 /* Comma */);\nCharScanners[45 /* Minus */] = returnToken(623009 /* Minus */);\nCharScanners[47 /* Slash */] = returnToken(1638886 /* Slash */);\nCharScanners[58 /* Colon */] = returnToken(1572878 /* Colon */);\nCharScanners[63 /* Question */] = returnToken(1572879 /* Question */);\nCharScanners[91 /* OpenBracket */] = returnToken(671756 /* OpenBracket */);\nCharScanners[93 /* CloseBracket */] = returnToken(1835021 /* CloseBracket */);\nCharScanners[123 /* OpenBrace */] = returnToken(131079 /* OpenBrace */);\nCharScanners[125 /* CloseBrace */] = returnToken(1835017 /* CloseBrace */);\n//# sourceMappingURL=expression-parser.js.map","import { DI } from '@aurelia/kernel';\nimport { IExpressionParser, RuntimeConfiguration } from '@aurelia/runtime';\nimport { AtPrefixedTriggerAttributePattern, ColonPrefixedBindAttributePattern, DotSeparatedAttributePattern, RefAttributePattern } from './attribute-patterns';\nimport { CallBindingCommand, DefaultBindingCommand, ForBindingCommand, FromViewBindingCommand, OneTimeBindingCommand, ToViewBindingCommand, TwoWayBindingCommand } from './binding-commands';\nimport { parseExpression } from './expression-parser';\nexport const IExpressionParserRegistration = {\n    register(container) {\n        container.registerTransformer(IExpressionParser, parser => {\n            Reflect.set(parser, 'parseCore', parseExpression);\n            return parser;\n        });\n    }\n};\n/**\n * Default runtime/environment-agnostic implementations for the following interfaces:\n * - `IExpressionParser`\n */\nexport const DefaultComponents = [\n    IExpressionParserRegistration\n];\nexport const AtPrefixedTriggerAttributePatternRegistration = AtPrefixedTriggerAttributePattern;\nexport const ColonPrefixedBindAttributePatternRegistration = ColonPrefixedBindAttributePattern;\nexport const RefAttributePatternRegistration = RefAttributePattern;\nexport const DotSeparatedAttributePatternRegistration = DotSeparatedAttributePattern;\n/**\n * Default binding syntax for the following attribute name patterns:\n * - `ref`\n * - `target.command` (dot-separated)\n */\nexport const DefaultBindingSyntax = [\n    RefAttributePatternRegistration,\n    DotSeparatedAttributePatternRegistration\n];\n/**\n * Binding syntax for short-hand attribute name patterns:\n * - `@target` (short-hand for `target.trigger`)\n * - `:target` (short-hand for `target.bind`)\n */\nexport const ShortHandBindingSyntax = [\n    AtPrefixedTriggerAttributePatternRegistration,\n    ColonPrefixedBindAttributePatternRegistration\n];\nexport const CallBindingCommandRegistration = CallBindingCommand;\nexport const DefaultBindingCommandRegistration = DefaultBindingCommand;\nexport const ForBindingCommandRegistration = ForBindingCommand;\nexport const FromViewBindingCommandRegistration = FromViewBindingCommand;\nexport const OneTimeBindingCommandRegistration = OneTimeBindingCommand;\nexport const ToViewBindingCommandRegistration = ToViewBindingCommand;\nexport const TwoWayBindingCommandRegistration = TwoWayBindingCommand;\n/**\n * Default runtime/environment-agnostic binding commands:\n * - Property observation: `.bind`, `.one-time`, `.from-view`, `.to-view`, `.two-way`\n * - Function call: `.call`\n * - Collection observation: `.for`\n */\nexport const DefaultBindingLanguage = [\n    DefaultBindingCommandRegistration,\n    OneTimeBindingCommandRegistration,\n    FromViewBindingCommandRegistration,\n    ToViewBindingCommandRegistration,\n    TwoWayBindingCommandRegistration,\n    CallBindingCommandRegistration,\n    ForBindingCommandRegistration\n];\n/**\n * A DI configuration object containing runtime/environment-agnostic registrations:\n * - `RuntimeConfiguration` from `@aurelia/runtime`\n * - `DefaultComponents`\n * - `DefaultBindingSyntax`\n * - `DefaultBindingLanguage`\n */\nexport const JitConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return RuntimeConfiguration\n            .register(container)\n            .register(...DefaultComponents, ...DefaultBindingSyntax, ...DefaultBindingLanguage);\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\n//# sourceMappingURL=configuration.js.map","import { kebabCase, Metadata, } from '@aurelia/kernel';\nimport { BindingMode, CustomAttribute, CustomElement, } from '@aurelia/runtime';\nimport { BindingCommand } from './binding-command';\n/**\n * A pre-processed piece of information about a defined bindable property on a custom\n * element or attribute, optimized for consumption by the template compiler.\n */\nexport class BindableInfo {\n    constructor(\n    /**\n     * The pre-processed *property* (not attribute) name of the bindable, which is\n     * (in order of priority):\n     *\n     * 1. The `property` from the description (if defined)\n     * 2. The name of the property of the bindable itself\n     */\n    propName, \n    /**\n     * The pre-processed (default) bindingMode of the bindable, which is (in order of priority):\n     *\n     * 1. The `mode` from the bindable (if defined and not bindingMode.default)\n     * 2. The `defaultBindingMode` (if it's an attribute, defined, and not bindingMode.default)\n     * 3. `bindingMode.toView`\n     */\n    mode) {\n        this.propName = propName;\n        this.mode = mode;\n    }\n}\n/**\n * Pre-processed information about a custom element resource, optimized\n * for consumption by the template compiler.\n */\nexport class ElementInfo {\n    constructor(name, containerless) {\n        this.name = name;\n        this.containerless = containerless;\n        /**\n         * A lookup of the bindables of this element, indexed by the (pre-processed)\n         * attribute names as they would be found in parsed markup.\n         */\n        this.bindables = Object.create(null);\n    }\n    static from(def) {\n        const info = new ElementInfo(def.name, def.containerless);\n        const bindables = def.bindables;\n        const defaultBindingMode = BindingMode.toView;\n        let bindable;\n        let prop;\n        let attr;\n        let mode;\n        for (prop in bindables) {\n            bindable = bindables[prop];\n            // explicitly provided property name has priority over the implicit property name\n            if (bindable.property !== void 0) {\n                prop = bindable.property;\n            }\n            // explicitly provided attribute name has priority over the derived implicit attribute name\n            if (bindable.attribute !== void 0) {\n                attr = bindable.attribute;\n            }\n            else {\n                // derive the attribute name from the resolved property name\n                attr = kebabCase(prop);\n            }\n            if (bindable.mode !== void 0 && bindable.mode !== BindingMode.default) {\n                mode = bindable.mode;\n            }\n            else {\n                mode = defaultBindingMode;\n            }\n            info.bindables[attr] = new BindableInfo(prop, mode);\n        }\n        return info;\n    }\n}\n/**\n * Pre-processed information about a custom attribute resource, optimized\n * for consumption by the template compiler.\n */\nexport class AttrInfo {\n    constructor(name, isTemplateController, noMultiBindings) {\n        this.name = name;\n        this.isTemplateController = isTemplateController;\n        this.noMultiBindings = noMultiBindings;\n        /**\n         * A lookup of the bindables of this attribute, indexed by the (pre-processed)\n         * bindable names as they would be found in the attribute value.\n         *\n         * Only applicable to multi attribute bindings (semicolon-separated).\n         */\n        this.bindables = Object.create(null);\n        /**\n         * The single or first bindable of this attribute, or a default 'value'\n         * bindable if no bindables were defined on the attribute.\n         *\n         * Only applicable to single attribute bindings (where the attribute value\n         * contains no semicolons)\n         */\n        this.bindable = null;\n    }\n    static from(def) {\n        const info = new AttrInfo(def.name, def.isTemplateController, def.noMultiBindings);\n        const bindables = def.bindables;\n        const defaultBindingMode = def.defaultBindingMode !== void 0 && def.defaultBindingMode !== BindingMode.default\n            ? def.defaultBindingMode\n            : BindingMode.toView;\n        let bindable;\n        let prop;\n        let mode;\n        let hasPrimary = false;\n        let isPrimary = false;\n        let bindableInfo;\n        for (prop in bindables) {\n            bindable = bindables[prop];\n            // explicitly provided property name has priority over the implicit property name\n            if (bindable.property !== void 0) {\n                prop = bindable.property;\n            }\n            if (bindable.mode !== void 0 && bindable.mode !== BindingMode.default) {\n                mode = bindable.mode;\n            }\n            else {\n                mode = defaultBindingMode;\n            }\n            isPrimary = bindable.primary === true;\n            bindableInfo = info.bindables[prop] = new BindableInfo(prop, mode);\n            if (isPrimary) {\n                if (hasPrimary) {\n                    throw new Error('primary already exists');\n                }\n                hasPrimary = true;\n                info.bindable = bindableInfo;\n            }\n            // set to first bindable by convention\n            if (info.bindable === null) {\n                info.bindable = bindableInfo;\n            }\n        }\n        // if no bindables are present, default to \"value\"\n        if (info.bindable === null) {\n            info.bindable = new BindableInfo('value', defaultBindingMode);\n        }\n        return info;\n    }\n}\nconst contextLookup = new WeakMap();\n/**\n * A pre-processed piece of information about declared custom elements, attributes and\n * binding commands, optimized for consumption by the template compiler.\n */\nexport class ResourceModel {\n    constructor(container) {\n        this.elementLookup = Object.create(null);\n        this.attributeLookup = Object.create(null);\n        this.commandLookup = Object.create(null);\n        // Note: don't do this sort of thing elsewhere, this is purely for perf reasons\n        this.container = container;\n        const rootContainer = container.root;\n        this.resourceResolvers = container.resourceResolvers;\n        this.rootResourceResolvers = rootContainer.resourceResolvers;\n    }\n    static getOrCreate(context) {\n        let model = contextLookup.get(context);\n        if (model === void 0) {\n            contextLookup.set(context, model = new ResourceModel(context));\n        }\n        return model;\n    }\n    /**\n     * Retrieve information about a custom element resource.\n     *\n     * @param element - The original DOM element.\n     *\n     * @returns The resource information if the element exists, or `null` if it does not exist.\n     */\n    getElementInfo(name) {\n        let result = this.elementLookup[name];\n        if (result === void 0) {\n            const def = this.find(CustomElement, name);\n            this.elementLookup[name] = result = def === null ? null : ElementInfo.from(def);\n        }\n        return result;\n    }\n    /**\n     * Retrieve information about a custom attribute resource.\n     *\n     * @param syntax - The parsed `AttrSyntax`\n     *\n     * @returns The resource information if the attribute exists, or `null` if it does not exist.\n     */\n    getAttributeInfo(syntax) {\n        let result = this.attributeLookup[syntax.target];\n        if (result === void 0) {\n            const def = this.find(CustomAttribute, syntax.target);\n            this.attributeLookup[syntax.target] = result = def === null ? null : AttrInfo.from(def);\n        }\n        return result;\n    }\n    /**\n     * Retrieve a binding command resource.\n     *\n     * @param name - The parsed `AttrSyntax`\n     *\n     * @returns An instance of the command if it exists, or `null` if it does not exist.\n     */\n    getBindingCommand(syntax, optional) {\n        const name = syntax.command;\n        if (name === null) {\n            return null;\n        }\n        let result = this.commandLookup[name];\n        if (result === void 0) {\n            result = this.create(BindingCommand, name);\n            if (result === null) {\n                if (optional) {\n                    return null;\n                }\n                throw new Error(`Unknown binding command: ${name}`);\n            }\n            this.commandLookup[name] = result;\n        }\n        return result;\n    }\n    find(kind, name) {\n        const key = kind.keyFrom(name);\n        let resolver = this.resourceResolvers[key];\n        if (resolver === void 0) {\n            resolver = this.rootResourceResolvers[key];\n            if (resolver === void 0) {\n                return null;\n            }\n        }\n        if (resolver === null) {\n            return null;\n        }\n        if (typeof resolver.getFactory === 'function') {\n            const factory = resolver.getFactory(this.container);\n            if (factory === null || factory === void 0) {\n                return null;\n            }\n            const definition = Metadata.getOwn(kind.name, factory.Type);\n            if (definition === void 0) {\n                // TODO: we may want to log a warning here, or even throw. This would happen if a dependency is registered with a resource-like key\n                // but does not actually have a definition associated via the type's metadata. That *should* generally not happen.\n                return null;\n            }\n            return definition;\n        }\n        return null;\n    }\n    create(kind, name) {\n        const key = kind.keyFrom(name);\n        let resolver = this.resourceResolvers[key];\n        if (resolver === void 0) {\n            resolver = this.rootResourceResolvers[key];\n            if (resolver === void 0) {\n                return null;\n            }\n        }\n        if (resolver === null) {\n            return null;\n        }\n        const instance = resolver.resolve(this.container, this.container);\n        if (instance === void 0) {\n            return null;\n        }\n        return instance;\n    }\n}\n//# sourceMappingURL=resource-model.js.map","import { hasBind, hasUnbind } from '@aurelia/runtime';\n/**\n * Listener binding. Handle event binding between view and view model\n */\nexport class Listener {\n    constructor(dom, targetEvent, delegationStrategy, sourceExpression, target, preventDefault, eventManager, locator) {\n        this.dom = dom;\n        this.targetEvent = targetEvent;\n        this.delegationStrategy = delegationStrategy;\n        this.sourceExpression = sourceExpression;\n        this.target = target;\n        this.preventDefault = preventDefault;\n        this.eventManager = eventManager;\n        this.locator = locator;\n        this.interceptor = this;\n        this.$state = 0 /* none */;\n    }\n    callSource(event) {\n        const overrideContext = this.$scope.overrideContext;\n        overrideContext.$event = event;\n        const result = this.sourceExpression.evaluate(2097152 /* mustEvaluate */, this.$scope, this.locator, this.part);\n        Reflect.deleteProperty(overrideContext, '$event');\n        if (result !== true && this.preventDefault) {\n            event.preventDefault();\n        }\n        return result;\n    }\n    handleEvent(event) {\n        this.interceptor.callSource(event);\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags | 4096 /* fromBind */);\n        }\n        // add isBinding flag\n        this.$state |= 1 /* isBinding */;\n        this.$scope = scope;\n        this.part = part;\n        const sourceExpression = this.sourceExpression;\n        if (hasBind(sourceExpression)) {\n            sourceExpression.bind(flags, scope, this.interceptor);\n        }\n        this.handler = this.eventManager.addEventListener(this.dom, this.target, this.targetEvent, this, this.delegationStrategy);\n        // add isBound flag and remove isBinding flag\n        this.$state |= 4 /* isBound */;\n        this.$state &= ~1 /* isBinding */;\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        // add isUnbinding flag\n        this.$state |= 2 /* isUnbinding */;\n        const sourceExpression = this.sourceExpression;\n        if (hasUnbind(sourceExpression)) {\n            sourceExpression.unbind(flags, this.$scope, this.interceptor);\n        }\n        this.$scope = null;\n        this.handler.dispose();\n        this.handler = null;\n        // remove isBound and isUnbinding flags\n        this.$state &= ~(4 /* isBound */ | 2 /* isUnbinding */);\n    }\n    observeProperty(flags, obj, propertyName) {\n        return;\n    }\n    handleChange(newValue, previousValue, flags) {\n        return;\n    }\n}\n//# sourceMappingURL=listener.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { DOM, IObserverLocator, subscriberCollection, IScheduler, } from '@aurelia/runtime';\n/**\n * Observer for handling two-way binding with attributes\n * Has different strategy for class/style and normal attributes\n * TODO: handle SVG/attributes with namespace\n */\nlet AttributeObserver = class AttributeObserver {\n    constructor(scheduler, flags, observerLocator, obj, propertyKey, targetAttribute) {\n        this.scheduler = scheduler;\n        this.observerLocator = observerLocator;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.targetAttribute = targetAttribute;\n        this.currentValue = null;\n        this.oldValue = null;\n        this.hasChanges = false;\n        this.task = null;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue } = this;\n            this.oldValue = currentValue;\n            switch (this.targetAttribute) {\n                case 'class': {\n                    // Why is class attribute observer setValue look different with class attribute accessor?\n                    // ==============\n                    // For class list\n                    // newValue is simply checked if truthy or falsy\n                    // and toggle the class accordingly\n                    // -- the rule of this is quite different to normal attribute\n                    //\n                    // for class attribute, observer is different in a way that it only observe a particular class at a time\n                    // this also comes from syntax, where it would typically be my-class.class=\"someProperty\"\n                    //\n                    // so there is no need for separating class by space and add all of them like class accessor\n                    if (!!currentValue) {\n                        this.obj.classList.add(this.propertyKey);\n                    }\n                    else {\n                        this.obj.classList.remove(this.propertyKey);\n                    }\n                    break;\n                }\n                case 'style': {\n                    let priority = '';\n                    let newValue = currentValue;\n                    if (typeof newValue === 'string' && newValue.includes('!important')) {\n                        priority = 'important';\n                        newValue = newValue.replace('!important', '');\n                    }\n                    this.obj.style.setProperty(this.propertyKey, newValue, priority);\n                }\n            }\n        }\n    }\n    handleMutation(mutationRecords) {\n        let shouldProcess = false;\n        for (let i = 0, ii = mutationRecords.length; ii > i; ++i) {\n            const record = mutationRecords[i];\n            if (record.type === 'attributes' && record.attributeName === this.propertyKey) {\n                shouldProcess = true;\n                break;\n            }\n        }\n        if (shouldProcess) {\n            let newValue;\n            switch (this.targetAttribute) {\n                case 'class':\n                    newValue = this.obj.classList.contains(this.propertyKey);\n                    break;\n                case 'style':\n                    newValue = this.obj.style.getPropertyValue(this.propertyKey);\n                    break;\n                default:\n                    throw new Error(`Unsupported targetAttribute: ${this.targetAttribute}`);\n            }\n            if (newValue !== this.currentValue) {\n                const { currentValue } = this;\n                this.currentValue = this.oldValue = newValue;\n                this.hasChanges = false;\n                this.callSubscribers(newValue, currentValue, 131072 /* fromDOMEvent */);\n            }\n        }\n    }\n    subscribe(subscriber) {\n        if (!this.hasSubscribers()) {\n            this.currentValue = this.oldValue = this.obj.getAttribute(this.propertyKey);\n            startObservation(this.obj, this);\n        }\n        this.addSubscriber(subscriber);\n    }\n    unsubscribe(subscriber) {\n        this.removeSubscriber(subscriber);\n        if (!this.hasSubscribers()) {\n            stopObservation(this.obj, this);\n        }\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n};\nAttributeObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Number, Object, Object, String, String])\n], AttributeObserver);\nexport { AttributeObserver };\nconst startObservation = (element, subscription) => {\n    if (element.$eMObservers === undefined) {\n        element.$eMObservers = new Set();\n    }\n    if (element.$mObserver === undefined) {\n        element.$mObserver = DOM.createNodeObserver(element, handleMutation, { attributes: true });\n    }\n    element.$eMObservers.add(subscription);\n};\nconst stopObservation = (element, subscription) => {\n    const $eMObservers = element.$eMObservers;\n    if ($eMObservers && $eMObservers.delete(subscription)) {\n        if ($eMObservers.size === 0) {\n            element.$mObserver.disconnect();\n            element.$mObserver = undefined;\n        }\n        return true;\n    }\n    return false;\n};\nconst handleMutation = (mutationRecords) => {\n    mutationRecords[0].target.$eMObservers.forEach(invokeHandleMutation, mutationRecords);\n};\nfunction invokeHandleMutation(s) {\n    s.handleMutation(this);\n}\n//# sourceMappingURL=element-attribute-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { IServiceLocator, Reporter, } from '@aurelia/kernel';\nimport { BindingMode, connectable, hasBind, hasUnbind, IObserverLocator, IScheduler, INode, } from '@aurelia/runtime';\nimport { AttributeObserver, } from '../observation/element-attribute-observer';\n// BindingMode is not a const enum (and therefore not inlined), so assigning them to a variable to save a member accessor is a minor perf tweak\nconst { oneTime, toView, fromView } = BindingMode;\n// pre-combining flags for bitwise checks is a minor perf tweak\nconst toViewOrOneTime = toView | oneTime;\n/**\n * Attribute binding. Handle attribute binding betwen view/view model. Understand Html special attributes\n */\nlet AttributeBinding = class AttributeBinding {\n    constructor(sourceExpression, target, \n    // some attributes may have inner structure\n    // such as class -> collection of class names\n    // such as style -> collection of style rules\n    //\n    // for normal attributes, targetAttribute and targetProperty are the same and can be ignore\n    targetAttribute, targetProperty, mode, observerLocator, locator) {\n        this.sourceExpression = sourceExpression;\n        this.targetAttribute = targetAttribute;\n        this.targetProperty = targetProperty;\n        this.mode = mode;\n        this.observerLocator = observerLocator;\n        this.locator = locator;\n        this.interceptor = this;\n        this.$state = 0 /* none */;\n        this.$scope = null;\n        this.persistentFlags = 0 /* none */;\n        this.target = target;\n        connectable.assignIdTo(this);\n        this.$scheduler = locator.get(IScheduler);\n    }\n    updateTarget(value, flags) {\n        flags |= this.persistentFlags;\n        this.targetObserver.setValue(value, flags | 16 /* updateTargetInstance */);\n    }\n    updateSource(value, flags) {\n        flags |= this.persistentFlags;\n        this.sourceExpression.assign(flags | 32 /* updateSourceExpression */, this.$scope, this.locator, value);\n    }\n    handleChange(newValue, _previousValue, flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        flags |= this.persistentFlags;\n        if (this.mode === BindingMode.fromView) {\n            flags &= ~16 /* updateTargetInstance */;\n            flags |= 32 /* updateSourceExpression */;\n        }\n        if (flags & 16 /* updateTargetInstance */) {\n            const previousValue = this.targetObserver.getValue();\n            // if the only observable is an AccessScope then we can assume the passed-in newValue is the correct and latest value\n            if (this.sourceExpression.$kind !== 10082 /* AccessScope */ || this.observerSlots > 1) {\n                newValue = this.sourceExpression.evaluate(flags, this.$scope, this.locator, this.part);\n            }\n            if (newValue !== previousValue) {\n                this.interceptor.updateTarget(newValue, flags);\n            }\n            if ((this.mode & oneTime) === 0) {\n                this.version++;\n                this.sourceExpression.connect(flags, this.$scope, this.interceptor, this.part);\n                this.interceptor.unobserve(false);\n            }\n            return;\n        }\n        if (flags & 32 /* updateSourceExpression */) {\n            if (newValue !== this.sourceExpression.evaluate(flags, this.$scope, this.locator, this.part)) {\n                this.interceptor.updateSource(newValue, flags);\n            }\n            return;\n        }\n        throw Reporter.error(15, flags);\n    }\n    $bind(flags, scope, part) {\n        if (this.$state & 4 /* isBound */) {\n            if (this.$scope === scope) {\n                return;\n            }\n            this.interceptor.$unbind(flags | 4096 /* fromBind */);\n        }\n        // add isBinding flag\n        this.$state |= 1 /* isBinding */;\n        // Store flags which we can only receive during $bind and need to pass on\n        // to the AST during evaluate/connect/assign\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        this.$scope = scope;\n        this.part = part;\n        let sourceExpression = this.sourceExpression;\n        if (hasBind(sourceExpression)) {\n            sourceExpression.bind(flags, scope, this.interceptor);\n        }\n        let targetObserver = this.targetObserver;\n        if (!targetObserver) {\n            targetObserver = this.targetObserver = new AttributeObserver(this.$scheduler, flags, this.observerLocator, this.target, this.targetProperty, this.targetAttribute);\n        }\n        if (targetObserver.bind) {\n            targetObserver.bind(flags);\n        }\n        // during bind, binding behavior might have changed sourceExpression\n        sourceExpression = this.sourceExpression;\n        if (this.mode & toViewOrOneTime) {\n            this.interceptor.updateTarget(sourceExpression.evaluate(flags, scope, this.locator, part), flags);\n        }\n        if (this.mode & toView) {\n            sourceExpression.connect(flags, scope, this, part);\n        }\n        if (this.mode & fromView) {\n            targetObserver[this.id] |= 32 /* updateSourceExpression */;\n            targetObserver.subscribe(this.interceptor);\n        }\n        // add isBound flag and remove isBinding flag\n        this.$state |= 4 /* isBound */;\n        this.$state &= ~1 /* isBinding */;\n    }\n    $unbind(flags) {\n        if (!(this.$state & 4 /* isBound */)) {\n            return;\n        }\n        // add isUnbinding flag\n        this.$state |= 2 /* isUnbinding */;\n        // clear persistent flags\n        this.persistentFlags = 0 /* none */;\n        if (hasUnbind(this.sourceExpression)) {\n            this.sourceExpression.unbind(flags, this.$scope, this.interceptor);\n        }\n        this.$scope = null;\n        if (this.targetObserver.unbind) {\n            this.targetObserver.unbind(flags);\n        }\n        if (this.targetObserver.unsubscribe) {\n            this.targetObserver.unsubscribe(this.interceptor);\n            this.targetObserver[this.id] &= ~32 /* updateSourceExpression */;\n        }\n        this.interceptor.unobserve(true);\n        // remove isBound and isUnbinding flags\n        this.$state &= ~(4 /* isBound */ | 2 /* isUnbinding */);\n    }\n    connect(flags) {\n        if (this.$state & 4 /* isBound */) {\n            flags |= this.persistentFlags;\n            this.sourceExpression.connect(flags | 2097152 /* mustEvaluate */, this.$scope, this.interceptor, this.part); // why do we have a connect method here in the first place? will this be called after bind?\n        }\n    }\n};\nAttributeBinding = __decorate([\n    connectable(),\n    __metadata(\"design:paramtypes\", [Object, Object, String, String, Number, Object, Object])\n], AttributeBinding);\nexport { AttributeBinding };\n//# sourceMappingURL=attribute.js.map","/**\n * Attribute accessor in a XML document/element that can be accessed via a namespace.\n * Wraps [`getAttributeNS`](https://developer.mozilla.org/en-US/docs/Web/API/Element/getAttributeNS).\n */\nexport class AttributeNSAccessor {\n    constructor(scheduler, flags, obj, propertyKey, namespace) {\n        this.scheduler = scheduler;\n        this.propertyKey = propertyKey;\n        this.namespace = namespace;\n        this.currentValue = null;\n        this.oldValue = null;\n        this.hasChanges = false;\n        this.task = null;\n        this.obj = obj;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue } = this;\n            this.oldValue = currentValue;\n            if (currentValue == void 0) {\n                this.obj.removeAttributeNS(this.namespace, this.propertyKey);\n            }\n            else {\n                this.obj.setAttributeNS(this.namespace, this.propertyKey, currentValue);\n            }\n        }\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n        this.currentValue = this.oldValue = this.obj.getAttributeNS(this.namespace, this.propertyKey);\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n}\n//# sourceMappingURL=attribute-ns-accessor.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { subscriberCollection, IScheduler, getCollectionObserver, ILifecycle, } from '@aurelia/runtime';\nconst toStringTag = Object.prototype.toString;\nfunction defaultMatcher(a, b) {\n    return a === b;\n}\nlet CheckedObserver = class CheckedObserver {\n    constructor(scheduler, flags, lifecycle, handler, obj) {\n        this.scheduler = scheduler;\n        this.lifecycle = lifecycle;\n        this.handler = handler;\n        this.obj = obj;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.hasChanges = false;\n        this.task = null;\n        this.collectionObserver = void 0;\n        this.valueObserver = void 0;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) === 4096 /* fromBind */ || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const currentValue = this.oldValue = this.currentValue;\n            if (this.valueObserver === void 0) {\n                if (this.obj.$observers !== void 0) {\n                    if (this.obj.$observers.model !== void 0) {\n                        this.valueObserver = this.obj.$observers.model;\n                    }\n                    else if (this.obj.$observers.value !== void 0) {\n                        this.valueObserver = this.obj.$observers.value;\n                    }\n                }\n                if (this.valueObserver !== void 0) {\n                    this.valueObserver.subscribe(this);\n                }\n            }\n            if (this.collectionObserver !== void 0) {\n                this.collectionObserver.unsubscribeFromCollection(this);\n                this.collectionObserver = void 0;\n            }\n            if (this.obj.type === 'checkbox') {\n                this.collectionObserver = getCollectionObserver(flags, this.lifecycle, currentValue);\n                if (this.collectionObserver !== void 0) {\n                    this.collectionObserver.subscribeToCollection(this);\n                }\n            }\n            this.synchronizeElement();\n        }\n    }\n    handleCollectionChange(indexMap, flags) {\n        const { currentValue, oldValue } = this;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.oldValue = currentValue;\n            this.synchronizeElement();\n        }\n        else {\n            this.hasChanges = true;\n        }\n        if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n        this.callSubscribers(currentValue, oldValue, flags);\n    }\n    handleChange(newValue, previousValue, flags) {\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.synchronizeElement();\n        }\n        else {\n            this.hasChanges = true;\n        }\n        if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags));\n        }\n        this.callSubscribers(newValue, previousValue, flags);\n    }\n    synchronizeElement() {\n        const currentValue = this.currentValue;\n        const obj = this.obj;\n        const elementValue = Object.prototype.hasOwnProperty.call(obj, 'model') ? obj.model : obj.value;\n        const isRadio = obj.type === 'radio';\n        const matcher = obj.matcher !== void 0 ? obj.matcher : defaultMatcher;\n        if (isRadio) {\n            obj.checked = !!matcher(currentValue, elementValue);\n        }\n        else if (currentValue === true) {\n            obj.checked = true;\n        }\n        else {\n            let hasMatch = false;\n            switch (toStringTag.call(currentValue)) {\n                case '[object Array]':\n                    hasMatch = currentValue.findIndex(item => !!matcher(item, elementValue)) !== -1;\n                    break;\n                case '[object Set]':\n                    for (const v of currentValue) {\n                        if (matcher(v, elementValue)) {\n                            hasMatch = true;\n                            break;\n                        }\n                    }\n                    break;\n                case '[object Map]':\n                    for (const pair of currentValue) {\n                        const existingItem = pair[0];\n                        const $isChecked = pair[1];\n                        // a potential complain, when only `true` is supported\n                        // but it's consistent with array\n                        if (matcher(existingItem, elementValue) && $isChecked === true) {\n                            hasMatch = true;\n                            break;\n                        }\n                    }\n            }\n            obj.checked = hasMatch;\n        }\n    }\n    handleEvent() {\n        let currentValue = this.oldValue = this.currentValue;\n        const obj = this.obj;\n        const elementValue = Object.prototype.hasOwnProperty.call(obj, 'model') ? obj.model : obj.value;\n        const isChecked = obj.checked;\n        const matcher = obj.matcher !== void 0 ? obj.matcher : defaultMatcher;\n        if (obj.type === 'checkbox') {\n            const toStringRet = toStringTag.call(currentValue);\n            if (toStringRet === '[object Array]') {\n                // Array binding steps on a change event:\n                // 1. find corresponding item INDEX in the Set based on current model/value and matcher\n                // 2. is the checkbox checked?\n                //    2.1. Yes: is the corresponding item in the Array (index === -1)?\n                //        2.1.1 No: push the current model/value to the Array\n                //    2.2. No: is the corresponding item in the Array (index !== -1)?\n                //        2.2.1: Yes: remove the corresponding item\n                // =================================================\n                const index = currentValue.findIndex(item => !!matcher(item, elementValue));\n                // if the checkbox is checkde, and there's no matching value in the existing array\n                // add the checkbox model/value to the array\n                if (isChecked && index === -1) {\n                    currentValue.push(elementValue);\n                }\n                else if (!isChecked && index !== -1) {\n                    // if the checkbox is not checked, and found a matching item in the array\n                    // based on the checkbox model/value\n                    // remove the existing item\n                    currentValue.splice(index, 1);\n                }\n                // when existing currentValue is an array,\n                // do not invoke callback as only the array obj has changed\n                return;\n            }\n            else if (toStringRet === '[object Set]') {\n                // Set binding steps on a change event:\n                // 1. find corresponding item in the Set based on current model/value and matcher\n                // 2. is the checkbox checked?\n                //    2.1. Yes: is the corresponding item in the Set?\n                //        2.1.1 No: add the current model/value to the Set\n                //    2.2. No: is the corresponding item in the Set?\n                //        2.2.1: Yes: remove the corresponding item\n                // =================================================\n                // 1. find corresponding item\n                const unset = {};\n                let existingItem = unset;\n                for (const value of currentValue) {\n                    if (matcher(value, elementValue) === true) {\n                        existingItem = value;\n                        break;\n                    }\n                }\n                // 2.1. Checkbox is checked, is the corresponding item in the Set?\n                //\n                // if checkbox is checked and there's no value in the existing Set\n                // add the checkbox model/value to the Set\n                if (isChecked && existingItem === unset) {\n                    // 2.1.1. add the current model/value to the Set\n                    currentValue.add(elementValue);\n                }\n                else if (!isChecked && existingItem !== unset) {\n                    // 2.2.1 Checkbox is unchecked, corresponding is in the Set\n                    //\n                    // if checkbox is not checked, and found a matching item in the Set\n                    // based on the checkbox model/value\n                    // remove the existing item\n                    currentValue.delete(existingItem);\n                }\n                // when existing value is a Set,\n                // do not invoke callback as only the Set has been mutated\n                return;\n            }\n            else if (toStringRet === '[object Map]') {\n                // Map binding steps on a change event\n                // 1. find corresponding item in the Map based on current model/value and matcher\n                // 2. Set the value of the corresponding item in the Map based on checked state of the checkbox\n                // =================================================\n                // 1. find the corresponding item\n                let existingItem;\n                for (const pair of currentValue) {\n                    const currItem = pair[0];\n                    if (matcher(currItem, elementValue) === true) {\n                        existingItem = currItem;\n                        break;\n                    }\n                }\n                // 2. set the value of the corresponding item in the map\n                // if checkbox is checked and there's no value in the existing Map\n                // add the checkbox model/value to the Map as key,\n                // and value will be checked state of the checkbox\n                currentValue.set(existingItem, isChecked);\n                // when existing value is a Map,\n                // do not invoke callback as only the Map has been mutated\n                return;\n            }\n            currentValue = isChecked;\n        }\n        else if (isChecked) {\n            currentValue = elementValue;\n        }\n        else {\n            // if it's a radio and it has been unchecked\n            // do nothing, as the radio that was checked will fire change event and it will be handle there\n            // a radio cannot be unchecked by user\n            return;\n        }\n        this.currentValue = currentValue;\n        this.callSubscribers(this.currentValue, this.oldValue, 131072 /* fromDOMEvent */ | 524288 /* allowPublishRoundtrip */);\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n        this.currentValue = this.obj.checked;\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    unbind(flags) {\n        if (this.collectionObserver !== void 0) {\n            this.collectionObserver.unsubscribeFromCollection(this);\n            this.collectionObserver = void 0;\n        }\n        if (this.valueObserver !== void 0) {\n            this.valueObserver.unsubscribe(this);\n        }\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n    subscribe(subscriber) {\n        if (!this.hasSubscribers()) {\n            this.handler.subscribe(this.obj, this);\n        }\n        this.addSubscriber(subscriber);\n    }\n    unsubscribe(subscriber) {\n        this.removeSubscriber(subscriber);\n        if (!this.hasSubscribers()) {\n            this.handler.dispose();\n        }\n    }\n};\nCheckedObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Number, Object, Object, Object])\n], CheckedObserver);\nexport { CheckedObserver };\n//# sourceMappingURL=checked-observer.js.map","import { PLATFORM } from '@aurelia/kernel';\nexport class ClassAttributeAccessor {\n    constructor(scheduler, flags, obj) {\n        this.scheduler = scheduler;\n        this.currentValue = '';\n        this.oldValue = '';\n        this.doNotCache = true;\n        this.nameIndex = {};\n        this.version = 0;\n        this.hasChanges = false;\n        this.isActive = false;\n        this.task = null;\n        this.obj = obj;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue, nameIndex } = this;\n            let { version } = this;\n            this.oldValue = currentValue;\n            const classesToAdd = getClassesToAdd(currentValue);\n            // Get strings split on a space not including empties\n            if (classesToAdd.length > 0) {\n                this.addClassesAndUpdateIndex(classesToAdd);\n            }\n            this.version += 1;\n            // First call to setValue?  We're done.\n            if (version === 0) {\n                return;\n            }\n            // Remove classes from previous version.\n            version -= 1;\n            for (const name in nameIndex) {\n                if (!Object.prototype.hasOwnProperty.call(nameIndex, name) || nameIndex[name] !== version) {\n                    continue;\n                }\n                // TODO: this has the side-effect that classes already present which are added again,\n                // will be removed if they're not present in the next update.\n                // Better would be do have some configurability for this behavior, allowing the user to\n                // decide whether initial classes always need to be kept, always removed, or something in between\n                this.obj.classList.remove(name);\n            }\n        }\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n    addClassesAndUpdateIndex(classes) {\n        const node = this.obj;\n        for (let i = 0, ii = classes.length; i < ii; i++) {\n            const className = classes[i];\n            if (className.length === 0) {\n                continue;\n            }\n            this.nameIndex[className] = this.version;\n            node.classList.add(className);\n        }\n    }\n}\nexport function getClassesToAdd(object) {\n    function splitClassString(classString) {\n        const matches = classString.match(/\\S+/g);\n        if (matches === null) {\n            return PLATFORM.emptyArray;\n        }\n        return matches;\n    }\n    if (typeof object === 'string') {\n        return splitClassString(object);\n    }\n    if (object instanceof Array) {\n        const len = object.length;\n        if (len > 0) {\n            const classes = [];\n            for (let i = 0; i < len; ++i) {\n                classes.push(...getClassesToAdd(object[i]));\n            }\n            return classes;\n        }\n        else {\n            return PLATFORM.emptyArray;\n        }\n    }\n    else if (object instanceof Object) {\n        const classes = [];\n        for (const property in object) {\n            // Let non typical values also evaluate true so disable bool check\n            // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions, no-extra-boolean-cast\n            if (Boolean(object[property])) {\n                // We must do this in case object property has a space in the name which results in two classes\n                if (property.includes(' ')) {\n                    classes.push(...splitClassString(property));\n                }\n                else {\n                    classes.push(property);\n                }\n            }\n        }\n        return classes;\n    }\n    return PLATFORM.emptyArray;\n}\n//# sourceMappingURL=class-attribute-accessor.js.map","/**\n * Attribute accessor for HTML elements.\n * Note that Aurelia works with properties, so in all case it will try to assign to property instead of attributes.\n * Unless the property falls into a special set, then it will use attribute for it.\n *\n * @see ElementPropertyAccessor\n */\nexport class DataAttributeAccessor {\n    constructor(scheduler, flags, obj, propertyKey) {\n        this.scheduler = scheduler;\n        this.propertyKey = propertyKey;\n        this.currentValue = null;\n        this.oldValue = null;\n        this.hasChanges = false;\n        this.task = null;\n        this.obj = obj;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue } = this;\n            this.oldValue = currentValue;\n            if (currentValue == void 0) {\n                this.obj.removeAttribute(this.propertyKey);\n            }\n            else {\n                this.obj.setAttribute(this.propertyKey, currentValue);\n            }\n        }\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n        this.currentValue = this.oldValue = this.obj.getAttribute(this.propertyKey);\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n}\n//# sourceMappingURL=data-attribute-accessor.js.map","/**\n * Property accessor for HTML Elements.\n * Note that Aurelia works with properties, so in all case it will try to assign to property instead of attributes.\n * Unless the property falls into a special set, then it will use attribute for it.\n *\n * @see DataAttributeAccessor\n */\nexport class ElementPropertyAccessor {\n    constructor(scheduler, flags, obj, propertyKey) {\n        this.scheduler = scheduler;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.hasChanges = false;\n        this.task = null;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue } = this;\n            this.oldValue = currentValue;\n            this.obj[this.propertyKey] = currentValue;\n        }\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n        this.currentValue = this.oldValue = this.obj[this.propertyKey];\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n}\n//# sourceMappingURL=element-property-accessor.js.map","import { DI } from '@aurelia/kernel';\nimport { DelegationStrategy } from '@aurelia/runtime';\n// Note: path and deepPath are designed to handle v0 and v1 shadow dom specs respectively\n/** @internal */\nexport function findOriginalEventTarget(event) {\n    return (event.composedPath && event.composedPath()[0]) || (event.deepPath && event.deepPath()[0]) || (event.path && event.path[0]) || event.target;\n}\nfunction stopPropagation() {\n    this.standardStopPropagation();\n    this.propagationStopped = true;\n}\nfunction handleCapturedEvent(event) {\n    event.propagationStopped = false;\n    let target = findOriginalEventTarget(event);\n    const orderedCallbacks = [];\n    /**\n     * During capturing phase, event 'bubbles' down from parent. Needs to reorder callback from root down to target\n     */\n    while (target) {\n        if (target.capturedCallbacks) {\n            const callback = target.capturedCallbacks[event.type];\n            if (callback) {\n                if (event.stopPropagation !== stopPropagation) {\n                    event.standardStopPropagation = event.stopPropagation;\n                    event.stopPropagation = stopPropagation;\n                }\n                orderedCallbacks.push(callback);\n            }\n        }\n        target = target.parentNode;\n    }\n    for (let i = orderedCallbacks.length - 1; i >= 0 && !event.propagationStopped; i--) {\n        const orderedCallback = orderedCallbacks[i];\n        if ('handleEvent' in orderedCallback) {\n            orderedCallback.handleEvent(event);\n        }\n        else {\n            orderedCallback(event);\n        }\n    }\n}\nfunction handleDelegatedEvent(event) {\n    event.propagationStopped = false;\n    let target = findOriginalEventTarget(event);\n    while (target && !event.propagationStopped) {\n        if (target.delegatedCallbacks) {\n            const callback = target.delegatedCallbacks[event.type];\n            if (callback) {\n                if (event.stopPropagation !== stopPropagation) {\n                    event.standardStopPropagation = event.stopPropagation;\n                    event.stopPropagation = stopPropagation;\n                }\n                if ('handleEvent' in callback) {\n                    callback.handleEvent(event);\n                }\n                else {\n                    callback(event);\n                }\n            }\n        }\n        target = target.parentNode;\n    }\n}\nexport class ListenerTracker {\n    constructor(dom, eventName, listener, capture) {\n        this.dom = dom;\n        this.eventName = eventName;\n        this.listener = listener;\n        this.capture = capture;\n        this.count = 0;\n    }\n    increment() {\n        this.count++;\n        if (this.count === 1) {\n            this.dom.addEventListener(this.eventName, this.listener, null, this.capture);\n        }\n    }\n    decrement() {\n        this.count--;\n        if (this.count === 0) {\n            this.dom.removeEventListener(this.eventName, this.listener, null, this.capture);\n        }\n    }\n    /* @internal */\n    dispose() {\n        if (this.count > 0) {\n            this.count = 0;\n            this.dom.removeEventListener(this.eventName, this.listener, null, this.capture);\n        }\n    }\n}\n/**\n * Enable dispose() pattern for `delegate` & `capture` commands\n */\nexport class DelegateOrCaptureSubscription {\n    constructor(entry, lookup, targetEvent, callback) {\n        this.entry = entry;\n        this.lookup = lookup;\n        this.targetEvent = targetEvent;\n        lookup[targetEvent] = callback;\n    }\n    dispose() {\n        this.entry.decrement();\n        this.lookup[this.targetEvent] = null;\n    }\n}\n/**\n * Enable dispose() pattern for addEventListener for `trigger`\n */\nexport class TriggerSubscription {\n    constructor(dom, target, targetEvent, callback) {\n        this.dom = dom;\n        this.target = target;\n        this.targetEvent = targetEvent;\n        this.callback = callback;\n        dom.addEventListener(targetEvent, callback, target);\n    }\n    dispose() {\n        this.dom.removeEventListener(this.targetEvent, this.callback, this.target);\n    }\n}\nexport class EventSubscriber {\n    constructor(dom, events) {\n        this.dom = dom;\n        this.events = events;\n        this.target = null;\n        this.handler = null;\n    }\n    subscribe(node, callbackOrListener) {\n        this.target = node;\n        this.handler = callbackOrListener;\n        const add = this.dom.addEventListener;\n        const events = this.events;\n        for (let i = 0, ii = events.length; ii > i; ++i) {\n            add(events[i], callbackOrListener, node);\n        }\n    }\n    dispose() {\n        const node = this.target;\n        const callbackOrListener = this.handler;\n        const events = this.events;\n        const dom = this.dom;\n        for (let i = 0, ii = events.length; ii > i; ++i) {\n            dom.removeEventListener(events[i], callbackOrListener, node);\n        }\n        this.target = this.handler = null;\n    }\n}\nexport const IEventManager = DI.createInterface('IEventManager').withDefault(x => x.singleton(EventManager));\n/** @internal */\nexport class EventManager {\n    constructor() {\n        this.delegatedHandlers = {};\n        this.capturedHandlers = {};\n    }\n    addEventListener(dom, target, targetEvent, callbackOrListener, strategy) {\n        let delegatedHandlers;\n        let capturedHandlers;\n        let handlerEntry;\n        if (strategy === DelegationStrategy.bubbling) {\n            delegatedHandlers = this.delegatedHandlers;\n            handlerEntry = delegatedHandlers[targetEvent] || (delegatedHandlers[targetEvent] = new ListenerTracker(dom, targetEvent, handleDelegatedEvent, false));\n            handlerEntry.increment();\n            const delegatedCallbacks = target.delegatedCallbacks || (target.delegatedCallbacks = {});\n            return new DelegateOrCaptureSubscription(handlerEntry, delegatedCallbacks, targetEvent, callbackOrListener);\n        }\n        if (strategy === DelegationStrategy.capturing) {\n            capturedHandlers = this.capturedHandlers;\n            handlerEntry = capturedHandlers[targetEvent] || (capturedHandlers[targetEvent] = new ListenerTracker(dom, targetEvent, handleCapturedEvent, true));\n            handlerEntry.increment();\n            const capturedCallbacks = target.capturedCallbacks || (target.capturedCallbacks = {});\n            return new DelegateOrCaptureSubscription(handlerEntry, capturedCallbacks, targetEvent, callbackOrListener);\n        }\n        return new TriggerSubscription(dom, target, targetEvent, callbackOrListener);\n    }\n    dispose() {\n        let key;\n        const { delegatedHandlers, capturedHandlers } = this;\n        for (key in delegatedHandlers) {\n            delegatedHandlers[key].dispose();\n        }\n        for (key in capturedHandlers) {\n            capturedHandlers[key].dispose();\n        }\n    }\n}\n//# sourceMappingURL=event-manager.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { IDOM, IObserverLocator, subscriberCollection, IScheduler, } from '@aurelia/runtime';\nimport { bound } from '@aurelia/kernel';\nconst childObserverOptions = {\n    childList: true,\n    subtree: true,\n    characterData: true\n};\nfunction defaultMatcher(a, b) {\n    return a === b;\n}\nlet SelectValueObserver = class SelectValueObserver {\n    constructor(scheduler, flags, observerLocator, dom, handler, obj) {\n        this.scheduler = scheduler;\n        this.observerLocator = observerLocator;\n        this.dom = dom;\n        this.handler = handler;\n        this.obj = obj;\n        this.currentValue = void 0;\n        this.oldValue = void 0;\n        this.hasChanges = false;\n        this.task = null;\n        this.arrayObserver = void 0;\n        this.nodeObserver = void 0;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue } = this;\n            this.oldValue = currentValue;\n            const isArray = Array.isArray(currentValue);\n            if (!isArray && currentValue != void 0 && this.obj.multiple) {\n                throw new Error('Only null or Array instances can be bound to a multi-select.');\n            }\n            if (this.arrayObserver) {\n                this.arrayObserver.unsubscribeFromCollection(this);\n                this.arrayObserver = void 0;\n            }\n            if (isArray) {\n                this.arrayObserver = this.observerLocator.getArrayObserver(flags, currentValue);\n                this.arrayObserver.subscribeToCollection(this);\n            }\n            this.synchronizeOptions();\n            this.notify(flags);\n        }\n    }\n    handleCollectionChange(indexMap, flags) {\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.synchronizeOptions();\n        }\n        else {\n            this.hasChanges = true;\n        }\n        if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n        this.callSubscribers(this.currentValue, this.oldValue, flags);\n    }\n    handleChange(newValue, previousValue, flags) {\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.synchronizeOptions();\n        }\n        else {\n            this.hasChanges = true;\n        }\n        if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n        this.callSubscribers(newValue, previousValue, flags);\n    }\n    notify(flags) {\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            return;\n        }\n        const oldValue = this.oldValue;\n        const newValue = this.currentValue;\n        if (newValue === oldValue) {\n            return;\n        }\n        this.callSubscribers(newValue, oldValue, flags);\n    }\n    handleEvent() {\n        // \"from-view\" changes are always synchronous now, so immediately sync the value and notify subscribers\n        const shouldNotify = this.synchronizeValue();\n        if (shouldNotify) {\n            this.callSubscribers(this.currentValue, this.oldValue, 131072 /* fromDOMEvent */ | 524288 /* allowPublishRoundtrip */);\n        }\n    }\n    synchronizeOptions(indexMap) {\n        const { currentValue, obj } = this;\n        const isArray = Array.isArray(currentValue);\n        const matcher = obj.matcher !== void 0 ? obj.matcher : defaultMatcher;\n        const options = obj.options;\n        let i = options.length;\n        while (i-- > 0) {\n            const option = options[i];\n            const optionValue = Object.prototype.hasOwnProperty.call(option, 'model') ? option.model : option.value;\n            if (isArray) {\n                option.selected = currentValue.findIndex(item => !!matcher(optionValue, item)) !== -1;\n                continue;\n            }\n            option.selected = !!matcher(optionValue, currentValue);\n        }\n    }\n    synchronizeValue() {\n        // Spec for synchronizing value from `SelectObserver` to `<select/>`\n        // When synchronizing value to observed <select/> element, do the following steps:\n        // A. If `<select/>` is multiple\n        //    1. Check if current value, called `currentValue` is an array\n        //      a. If not an array, return true to signal value has changed\n        //      b. If is an array:\n        //        i. gather all current selected <option/>, in to array called `values`\n        //        ii. loop through the `currentValue` array and remove items that are nolonger selected based on matcher\n        //        iii. loop through the `values` array and add items that are selected based on matcher\n        //        iv. Return false to signal value hasn't changed\n        // B. If the select is single\n        //    1. Let `value` equal the first selected option, if no option selected, then `value` is `null`\n        //    2. assign `this.currentValue` to `this.oldValue`\n        //    3. assign `value` to `this.currentValue`\n        //    4. return `true` to signal value has changed\n        const obj = this.obj;\n        const options = obj.options;\n        const len = options.length;\n        const currentValue = this.currentValue;\n        let i = 0;\n        if (obj.multiple) {\n            // A.\n            if (!Array.isArray(currentValue)) {\n                // A.1.a\n                return true;\n            }\n            // A.1.b\n            // multi select\n            let option;\n            const matcher = obj.matcher || defaultMatcher;\n            // A.1.b.i\n            const values = [];\n            while (i < len) {\n                option = options[i];\n                if (option.selected) {\n                    values.push(Object.prototype.hasOwnProperty.call(option, 'model')\n                        ? option.model\n                        : option.value);\n                }\n                ++i;\n            }\n            // A.1.b.ii\n            i = 0;\n            while (i < currentValue.length) {\n                const a = currentValue[i];\n                // Todo: remove arrow fn\n                if (values.findIndex(b => !!matcher(a, b)) === -1) {\n                    currentValue.splice(i, 1);\n                }\n                else {\n                    ++i;\n                }\n            }\n            // A.1.b.iii\n            i = 0;\n            while (i < values.length) {\n                const a = values[i];\n                // Todo: remove arrow fn\n                if (currentValue.findIndex(b => !!matcher(a, b)) === -1) {\n                    currentValue.push(a);\n                }\n                ++i;\n            }\n            // A.1.b.iv\n            return false;\n        }\n        // B. single select\n        // B.1\n        let value = null;\n        while (i < len) {\n            const option = options[i];\n            if (option.selected) {\n                value = Object.prototype.hasOwnProperty.call(option, 'model')\n                    ? option.model\n                    : option.value;\n                break;\n            }\n            ++i;\n        }\n        // B.2\n        this.oldValue = this.currentValue;\n        // B.3\n        this.currentValue = value;\n        // B.4\n        return true;\n    }\n    bind(flags) {\n        this.nodeObserver = this.dom.createNodeObserver(this.obj, this.handleNodeChange, childObserverOptions);\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n    }\n    unbind(flags) {\n        this.nodeObserver.disconnect();\n        this.nodeObserver = null;\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n        if (this.arrayObserver) {\n            this.arrayObserver.unsubscribeFromCollection(this);\n            this.arrayObserver = null;\n        }\n    }\n    handleNodeChange() {\n        this.synchronizeOptions();\n        const shouldNotify = this.synchronizeValue();\n        if (shouldNotify) {\n            this.notify(131072 /* fromDOMEvent */);\n        }\n    }\n    subscribe(subscriber) {\n        if (!this.hasSubscribers()) {\n            this.handler.subscribe(this.obj, this);\n        }\n        this.addSubscriber(subscriber);\n    }\n    unsubscribe(subscriber) {\n        this.removeSubscriber(subscriber);\n        if (!this.hasSubscribers()) {\n            this.handler.dispose();\n        }\n    }\n};\n__decorate([\n    bound,\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", []),\n    __metadata(\"design:returntype\", void 0)\n], SelectValueObserver.prototype, \"handleNodeChange\", null);\nSelectValueObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Number, Object, Object, Object, Object])\n], SelectValueObserver);\nexport { SelectValueObserver };\n//# sourceMappingURL=select-value-observer.js.map","import { PLATFORM, kebabCase } from '@aurelia/kernel';\nexport class StyleAttributeAccessor {\n    constructor(scheduler, flags, obj) {\n        this.scheduler = scheduler;\n        this.currentValue = '';\n        this.oldValue = '';\n        this.styles = {};\n        this.version = 0;\n        this.hasChanges = false;\n        this.task = null;\n        this.obj = obj;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.obj.style.cssText;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    getStyleTuplesFromString(currentValue) {\n        const styleTuples = [];\n        const rx = /\\s*([\\w-]+)\\s*:\\s*((?:(?:[\\w-]+\\(\\s*(?:\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'|[\\w-]+\\(\\s*(?:[^\"](?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'|[^)]*)\\),?|[^)]*)\\),?|\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'|[^;]*),?\\s*)+);?/g;\n        let pair;\n        let name;\n        while ((pair = rx.exec(currentValue)) !== null) {\n            name = pair[1];\n            if (name.length === 0) {\n                continue;\n            }\n            styleTuples.push([name, pair[2]]);\n        }\n        return styleTuples;\n    }\n    getStyleTuplesFromObject(currentValue) {\n        let value;\n        const styles = [];\n        for (const property in currentValue) {\n            value = currentValue[property];\n            if (value == null) {\n                continue;\n            }\n            if (typeof value === 'string') {\n                styles.push([kebabCase(property), value]);\n                continue;\n            }\n            styles.push(...this.getStyleTuples(value));\n        }\n        return styles;\n    }\n    getStyleTuplesFromArray(currentValue) {\n        const len = currentValue.length;\n        if (len > 0) {\n            const styles = [];\n            for (let i = 0; i < len; ++i) {\n                styles.push(...this.getStyleTuples(currentValue[i]));\n            }\n            return styles;\n        }\n        return PLATFORM.emptyArray;\n    }\n    getStyleTuples(currentValue) {\n        if (typeof currentValue === 'string') {\n            return this.getStyleTuplesFromString(currentValue);\n        }\n        if (currentValue instanceof Array) {\n            return this.getStyleTuplesFromArray(currentValue);\n        }\n        if (currentValue instanceof Object) {\n            return this.getStyleTuplesFromObject(currentValue);\n        }\n        return PLATFORM.emptyArray;\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue } = this;\n            this.oldValue = currentValue;\n            const styles = this.styles;\n            let style;\n            let version = this.version;\n            const styleTuples = this.getStyleTuples(currentValue);\n            let tuple;\n            let name;\n            let value;\n            const len = styleTuples.length;\n            for (let i = 0; i < len; ++i) {\n                tuple = styleTuples[i];\n                name = tuple[0];\n                value = tuple[1];\n                this.setProperty(name, value);\n                styles[name] = version;\n            }\n            this.styles = styles;\n            this.version += 1;\n            if (version === 0) {\n                return;\n            }\n            version -= 1;\n            for (style in styles) {\n                if (!Object.prototype.hasOwnProperty.call(styles, style) || styles[style] !== version) {\n                    continue;\n                }\n                this.obj.style.removeProperty(style);\n            }\n        }\n    }\n    setProperty(style, value) {\n        let priority = '';\n        if (value != null && typeof value.indexOf === 'function' && value.includes('!important')) {\n            priority = 'important';\n            value = value.replace('!important', '');\n        }\n        this.obj.style.setProperty(style, value, priority);\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n        this.oldValue = this.currentValue = this.obj.style.cssText;\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n}\n//# sourceMappingURL=style-attribute-accessor.js.map","import { DI } from '@aurelia/kernel';\nexport const ISVGAnalyzer = DI.createInterface('ISVGAnalyzer').withDefault(x => x.singleton(class {\n    isStandardSvgAttribute(node, attributeName) {\n        return false;\n    }\n}));\n//# sourceMappingURL=svg-analyzer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { subscriberCollection, IScheduler, } from '@aurelia/runtime';\n// TODO: handle file attribute properly again, etc\n/**\n * Observer for non-radio, non-checkbox input.\n */\nlet ValueAttributeObserver = class ValueAttributeObserver {\n    constructor(scheduler, flags, handler, obj, propertyKey) {\n        this.scheduler = scheduler;\n        this.handler = handler;\n        this.obj = obj;\n        this.propertyKey = propertyKey;\n        this.currentValue = '';\n        this.oldValue = '';\n        this.hasChanges = false;\n        this.task = null;\n        this.persistentFlags = flags & 805306383 /* targetObserverFlags */;\n    }\n    getValue() {\n        return this.currentValue;\n    }\n    setValue(newValue, flags) {\n        this.currentValue = newValue;\n        this.hasChanges = newValue !== this.oldValue;\n        if ((flags & 4096 /* fromBind */) > 0 || this.persistentFlags === 268435456 /* noTargetObserverQueue */) {\n            this.flushChanges(flags);\n        }\n        else if (this.persistentFlags !== 536870912 /* persistentTargetObserverQueue */ && this.task === null) {\n            this.task = this.scheduler.queueRenderTask(() => {\n                this.flushChanges(flags);\n                this.task = null;\n            });\n        }\n    }\n    flushChanges(flags) {\n        if (this.hasChanges) {\n            this.hasChanges = false;\n            const { currentValue, oldValue } = this;\n            this.oldValue = currentValue;\n            if (currentValue == void 0) {\n                this.obj[this.propertyKey] = '';\n            }\n            else {\n                this.obj[this.propertyKey] = currentValue;\n            }\n            if ((flags & 4096 /* fromBind */) === 0) {\n                this.callSubscribers(currentValue, oldValue, flags);\n            }\n        }\n    }\n    handleEvent() {\n        const oldValue = this.oldValue = this.currentValue;\n        const currentValue = this.currentValue = this.obj[this.propertyKey];\n        if (oldValue !== currentValue) {\n            this.oldValue = currentValue;\n            this.callSubscribers(currentValue, oldValue, 131072 /* fromDOMEvent */ | 524288 /* allowPublishRoundtrip */);\n        }\n    }\n    subscribe(subscriber) {\n        if (!this.hasSubscribers()) {\n            this.handler.subscribe(this.obj, this);\n            this.currentValue = this.oldValue = this.obj[this.propertyKey];\n        }\n        this.addSubscriber(subscriber);\n    }\n    unsubscribe(subscriber) {\n        this.removeSubscriber(subscriber);\n        if (!this.hasSubscribers()) {\n            this.handler.dispose();\n        }\n    }\n    bind(flags) {\n        if (this.persistentFlags === 536870912 /* persistentTargetObserverQueue */) {\n            if (this.task !== null) {\n                this.task.cancel();\n            }\n            this.task = this.scheduler.queueRenderTask(() => this.flushChanges(flags), { persistent: true });\n        }\n    }\n    unbind(flags) {\n        if (this.task !== null) {\n            this.task.cancel();\n            this.task = null;\n        }\n    }\n};\nValueAttributeObserver = __decorate([\n    subscriberCollection(),\n    __metadata(\"design:paramtypes\", [Object, Number, Object, Object, String])\n], ValueAttributeObserver);\nexport { ValueAttributeObserver };\n//# sourceMappingURL=value-attribute-observer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Registration } from '@aurelia/kernel';\nimport { IDOM, ITargetAccessorLocator, ITargetObserverLocator, SetterObserver } from '@aurelia/runtime';\nimport { AttributeNSAccessor } from './attribute-ns-accessor';\nimport { CheckedObserver } from './checked-observer';\nimport { ClassAttributeAccessor } from './class-attribute-accessor';\nimport { DataAttributeAccessor } from './data-attribute-accessor';\nimport { ElementPropertyAccessor } from './element-property-accessor';\nimport { EventSubscriber } from './event-manager';\nimport { SelectValueObserver } from './select-value-observer';\nimport { StyleAttributeAccessor } from './style-attribute-accessor';\nimport { ISVGAnalyzer } from './svg-analyzer';\nimport { ValueAttributeObserver } from './value-attribute-observer';\n// https://infra.spec.whatwg.org/#namespaces\nconst htmlNS = 'http://www.w3.org/1999/xhtml';\nconst mathmlNS = 'http://www.w3.org/1998/Math/MathML';\nconst svgNS = 'http://www.w3.org/2000/svg';\nconst xlinkNS = 'http://www.w3.org/1999/xlink';\nconst xmlNS = 'http://www.w3.org/XML/1998/namespace';\nconst xmlnsNS = 'http://www.w3.org/2000/xmlns/';\n// https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\nconst nsAttributes = Object.assign(Object.create(null), {\n    'xlink:actuate': ['actuate', xlinkNS],\n    'xlink:arcrole': ['arcrole', xlinkNS],\n    'xlink:href': ['href', xlinkNS],\n    'xlink:role': ['role', xlinkNS],\n    'xlink:show': ['show', xlinkNS],\n    'xlink:title': ['title', xlinkNS],\n    'xlink:type': ['type', xlinkNS],\n    'xml:lang': ['lang', xmlNS],\n    'xml:space': ['space', xmlNS],\n    'xmlns': ['xmlns', xmlnsNS],\n    'xmlns:xlink': ['xlink', xmlnsNS],\n});\nconst inputEvents = ['change', 'input'];\nconst selectEvents = ['change'];\nconst contentEvents = ['change', 'input', 'blur', 'keyup', 'paste'];\nconst scrollEvents = ['scroll'];\nconst overrideProps = Object.assign(Object.create(null), {\n    'class': true,\n    'style': true,\n    'css': true,\n    'checked': true,\n    'value': true,\n    'model': true,\n    'xlink:actuate': true,\n    'xlink:arcrole': true,\n    'xlink:href': true,\n    'xlink:role': true,\n    'xlink:show': true,\n    'xlink:title': true,\n    'xlink:type': true,\n    'xml:lang': true,\n    'xml:space': true,\n    'xmlns': true,\n    'xmlns:xlink': true,\n});\nlet TargetObserverLocator = class TargetObserverLocator {\n    constructor(dom, svgAnalyzer) {\n        this.dom = dom;\n        this.svgAnalyzer = svgAnalyzer;\n    }\n    static register(container) {\n        return Registration.singleton(ITargetObserverLocator, this).register(container);\n    }\n    getObserver(flags, scheduler, lifecycle, observerLocator, obj, propertyName) {\n        switch (propertyName) {\n            case 'checked':\n                return new CheckedObserver(scheduler, flags, lifecycle, new EventSubscriber(this.dom, inputEvents), obj);\n            case 'value':\n                if (obj.tagName === 'SELECT') {\n                    return new SelectValueObserver(scheduler, flags, observerLocator, this.dom, new EventSubscriber(this.dom, selectEvents), obj);\n                }\n                return new ValueAttributeObserver(scheduler, flags, new EventSubscriber(this.dom, inputEvents), obj, propertyName);\n            case 'files':\n                return new ValueAttributeObserver(scheduler, flags, new EventSubscriber(this.dom, inputEvents), obj, propertyName);\n            case 'textContent':\n            case 'innerHTML':\n                return new ValueAttributeObserver(scheduler, flags, new EventSubscriber(this.dom, contentEvents), obj, propertyName);\n            case 'scrollTop':\n            case 'scrollLeft':\n                return new ValueAttributeObserver(scheduler, flags, new EventSubscriber(this.dom, scrollEvents), obj, propertyName);\n            case 'class':\n                return new ClassAttributeAccessor(scheduler, flags, obj);\n            case 'style':\n            case 'css':\n                return new StyleAttributeAccessor(scheduler, flags, obj);\n            case 'model':\n                return new SetterObserver(lifecycle, flags, obj, propertyName);\n            case 'role':\n                return new DataAttributeAccessor(scheduler, flags, obj, propertyName);\n            default:\n                if (nsAttributes[propertyName] !== undefined) {\n                    const nsProps = nsAttributes[propertyName];\n                    return new AttributeNSAccessor(scheduler, flags, obj, nsProps[0], nsProps[1]);\n                }\n                if (isDataAttribute(obj, propertyName, this.svgAnalyzer)) {\n                    return new DataAttributeAccessor(scheduler, flags, obj, propertyName);\n                }\n        }\n        return null;\n    }\n    overridesAccessor(flags, obj, propertyName) {\n        return overrideProps[propertyName] === true;\n    }\n    // consider a scenario where user would want to provide a Date object observation via patching a few mutation method on it\n    // then this extension point of this default implementaion cannot be used,\n    // and a new implementation of ITargetObserverLocator should be used instead\n    // This default implementation only accounts for the most common target scenarios\n    handles(flags, obj) {\n        return this.dom.isNodeInstance(obj);\n    }\n};\nTargetObserverLocator = __decorate([\n    __param(0, IDOM),\n    __param(1, ISVGAnalyzer),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], TargetObserverLocator);\nexport { TargetObserverLocator };\nlet TargetAccessorLocator = class TargetAccessorLocator {\n    constructor(dom, svgAnalyzer) {\n        this.dom = dom;\n        this.svgAnalyzer = svgAnalyzer;\n    }\n    static register(container) {\n        return Registration.singleton(ITargetAccessorLocator, this).register(container);\n    }\n    getAccessor(flags, scheduler, lifecycle, obj, propertyName) {\n        switch (propertyName) {\n            case 'textContent':\n                // note: this case is just an optimization (textContent is the most often used property)\n                return new ElementPropertyAccessor(scheduler, flags, obj, propertyName);\n            case 'class':\n                return new ClassAttributeAccessor(scheduler, flags, obj);\n            case 'style':\n            case 'css':\n                return new StyleAttributeAccessor(scheduler, flags, obj);\n            // TODO: there are (many) more situation where we want to default to DataAttributeAccessor,\n            // but for now stick to what vCurrent does\n            case 'src':\n            case 'href':\n            // https://html.spec.whatwg.org/multipage/dom.html#wai-aria\n            case 'role':\n                return new DataAttributeAccessor(scheduler, flags, obj, propertyName);\n            default:\n                if (nsAttributes[propertyName] !== undefined) {\n                    const nsProps = nsAttributes[propertyName];\n                    return new AttributeNSAccessor(scheduler, flags, obj, nsProps[0], nsProps[1]);\n                }\n                if (isDataAttribute(obj, propertyName, this.svgAnalyzer)) {\n                    return new DataAttributeAccessor(scheduler, flags, obj, propertyName);\n                }\n                return new ElementPropertyAccessor(scheduler, flags, obj, propertyName);\n        }\n    }\n    handles(flags, obj) {\n        return this.dom.isNodeInstance(obj);\n    }\n};\nTargetAccessorLocator = __decorate([\n    __param(0, IDOM),\n    __param(1, ISVGAnalyzer),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], TargetAccessorLocator);\nexport { TargetAccessorLocator };\nconst IsDataAttribute = {};\nfunction isDataAttribute(obj, propertyName, svgAnalyzer) {\n    if (IsDataAttribute[propertyName] === true) {\n        return true;\n    }\n    const prefix = propertyName.slice(0, 5);\n    // https://html.spec.whatwg.org/multipage/dom.html#wai-aria\n    // https://html.spec.whatwg.org/multipage/dom.html#custom-data-attribute\n    return IsDataAttribute[propertyName] =\n        prefix === 'aria-' ||\n            prefix === 'data-' ||\n            svgAnalyzer.isStandardSvgAttribute(obj, propertyName);\n}\n//# sourceMappingURL=observer-locator.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { bindingBehavior, IScheduler } from '@aurelia/runtime';\nimport { DataAttributeAccessor } from '../../observation/data-attribute-accessor';\nlet AttrBindingBehavior = class AttrBindingBehavior {\n    bind(flags, scope, binding) {\n        binding.targetObserver = new DataAttributeAccessor(binding.locator.get(IScheduler), flags, binding.target, binding.targetProperty);\n    }\n    unbind(flags, scope, binding) {\n        return;\n    }\n};\nAttrBindingBehavior = __decorate([\n    bindingBehavior('attr')\n], AttrBindingBehavior);\nexport { AttrBindingBehavior };\n//# sourceMappingURL=attr.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Reporter } from '@aurelia/kernel';\nimport { bindingBehavior } from '@aurelia/runtime';\nimport { findOriginalEventTarget } from '../../observation/event-manager';\n/** @internal */\nexport function handleSelfEvent(event) {\n    const target = findOriginalEventTarget(event);\n    if (this.target !== target) {\n        return;\n    }\n    return this.selfEventCallSource(event);\n}\nlet SelfBindingBehavior = class SelfBindingBehavior {\n    bind(flags, scope, binding) {\n        if (!binding.callSource || !binding.targetEvent) {\n            throw Reporter.error(8);\n        }\n        binding.selfEventCallSource = binding.callSource;\n        binding.callSource = handleSelfEvent;\n    }\n    unbind(flags, scope, binding) {\n        binding.callSource = binding.selfEventCallSource;\n        binding.selfEventCallSource = null;\n    }\n};\nSelfBindingBehavior = __decorate([\n    bindingBehavior('self')\n], SelfBindingBehavior);\nexport { SelfBindingBehavior };\n//# sourceMappingURL=self.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Reporter } from '@aurelia/kernel';\nimport { BindingMode, IDOM, IObserverLocator, bindingBehavior } from '@aurelia/runtime';\nimport { EventSubscriber } from '../../observation/event-manager';\nlet UpdateTriggerBindingBehavior = class UpdateTriggerBindingBehavior {\n    constructor(observerLocator) {\n        this.observerLocator = observerLocator;\n    }\n    bind(flags, scope, binding, ...events) {\n        if (events.length === 0) {\n            throw Reporter.error(9);\n        }\n        if (binding.mode !== BindingMode.twoWay && binding.mode !== BindingMode.fromView) {\n            throw Reporter.error(10);\n        }\n        this.persistentFlags = flags & 2080374799 /* persistentBindingFlags */;\n        // ensure the binding's target observer has been set.\n        const targetObserver = this.observerLocator.getObserver(this.persistentFlags | flags, binding.target, binding.targetProperty);\n        if (!targetObserver.handler) {\n            throw Reporter.error(10);\n        }\n        binding.targetObserver = targetObserver;\n        // stash the original element subscribe function.\n        targetObserver.originalHandler = binding.targetObserver.handler;\n        // replace the element subscribe function with one that uses the correct events.\n        targetObserver.handler = new EventSubscriber(binding.locator.get(IDOM), events);\n    }\n    unbind(flags, scope, binding) {\n        // restore the state of the binding.\n        binding.targetObserver.handler.dispose();\n        binding.targetObserver.handler = binding.targetObserver.originalHandler;\n        binding.targetObserver.originalHandler = null;\n    }\n};\nUpdateTriggerBindingBehavior = __decorate([\n    bindingBehavior('updateTrigger'),\n    __param(0, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object])\n], UpdateTriggerBindingBehavior);\nexport { UpdateTriggerBindingBehavior };\n//# sourceMappingURL=update-trigger.js.map","import { DI, PLATFORM } from '@aurelia/kernel';\nexport const noopShadowDOMStyles = Object.freeze({\n    applyTo: PLATFORM.noop\n});\nexport const IShadowDOMStyles = DI.createInterface('IShadowDOMStyles').noDefault();\nexport const IShadowDOMGlobalStyles = DI.createInterface('IShadowDOMGlobalStyles')\n    .withDefault(x => x.instance(noopShadowDOMStyles));\nexport class AdoptedStyleSheetsStyles {\n    constructor(dom, localStyles, styleSheetCache, sharedStyles = null) {\n        this.sharedStyles = sharedStyles;\n        this.styleSheets = localStyles.map(x => {\n            let sheet;\n            if (x instanceof dom.CSSStyleSheet) {\n                sheet = x;\n            }\n            else {\n                sheet = styleSheetCache.get(x);\n                if (!sheet) {\n                    sheet = new dom.CSSStyleSheet();\n                    sheet.replaceSync(x);\n                    styleSheetCache.set(x, sheet);\n                }\n            }\n            return sheet;\n        });\n    }\n    static supported(dom) {\n        return 'adoptedStyleSheets' in dom.ShadowRoot.prototype;\n    }\n    applyTo(shadowRoot) {\n        if (this.sharedStyles !== null) {\n            this.sharedStyles.applyTo(shadowRoot);\n        }\n        // https://wicg.github.io/construct-stylesheets/\n        // https://developers.google.com/web/updates/2019/02/constructable-stylesheets\n        shadowRoot.adoptedStyleSheets = [\n            ...shadowRoot.adoptedStyleSheets,\n            ...this.styleSheets\n        ];\n    }\n}\nexport class StyleElementStyles {\n    constructor(dom, localStyles, sharedStyles = null) {\n        this.dom = dom;\n        this.localStyles = localStyles;\n        this.sharedStyles = sharedStyles;\n    }\n    applyTo(shadowRoot) {\n        const styles = this.localStyles;\n        const dom = this.dom;\n        for (let i = styles.length - 1; i > -1; --i) {\n            const element = dom.createElement('style');\n            element.innerHTML = styles[i];\n            shadowRoot.prepend(element);\n        }\n        if (this.sharedStyles !== null) {\n            this.sharedStyles.applyTo(shadowRoot);\n        }\n    }\n}\n//# sourceMappingURL=shadow-dom-styles.js.map","import { PLATFORM, Registration, Reporter, toArray, Metadata } from '@aurelia/kernel';\nimport { IProjectorLocator, CustomElement, } from '@aurelia/runtime';\nimport { IShadowDOMStyles, IShadowDOMGlobalStyles } from './styles/shadow-dom-styles';\nconst defaultShadowOptions = {\n    mode: 'open'\n};\nexport class HTMLProjectorLocator {\n    static register(container) {\n        return Registration.singleton(IProjectorLocator, this).register(container);\n    }\n    getElementProjector(dom, $component, host, def) {\n        if (def.shadowOptions || def.hasSlots) {\n            if (def.containerless) {\n                throw Reporter.error(21);\n            }\n            return new ShadowDOMProjector(dom, $component, host, def);\n        }\n        if (def.containerless) {\n            return new ContainerlessProjector(dom, $component, host);\n        }\n        return new HostProjector($component, host);\n    }\n}\nconst childObserverOptions = { childList: true };\n/** @internal */\nexport class ShadowDOMProjector {\n    constructor(dom, \n    // eslint-disable-next-line @typescript-eslint/prefer-readonly\n    $controller, host, definition) {\n        this.dom = dom;\n        this.$controller = $controller;\n        this.host = host;\n        let shadowOptions;\n        if (definition.shadowOptions instanceof Object &&\n            'mode' in definition.shadowOptions) {\n            shadowOptions = definition.shadowOptions;\n        }\n        else {\n            shadowOptions = defaultShadowOptions;\n        }\n        this.shadowRoot = host.attachShadow(shadowOptions);\n        Metadata.define(CustomElement.name, $controller, this.host);\n        Metadata.define(CustomElement.name, $controller, this.shadowRoot);\n    }\n    get children() {\n        return this.host.childNodes;\n    }\n    subscribeToChildrenChange(callback, options = childObserverOptions) {\n        // TODO: add a way to dispose/disconnect\n        this.dom.createNodeObserver(this.host, callback, options);\n    }\n    provideEncapsulationSource() {\n        return this.shadowRoot;\n    }\n    project(nodes) {\n        const context = this.$controller.context;\n        const styles = context.has(IShadowDOMStyles, false)\n            ? context.get(IShadowDOMStyles)\n            : context.get(IShadowDOMGlobalStyles);\n        styles.applyTo(this.shadowRoot);\n        nodes.appendTo(this.shadowRoot);\n    }\n    take(nodes) {\n        nodes.remove();\n        nodes.unlink();\n    }\n}\n/** @internal */\nexport class ContainerlessProjector {\n    constructor(dom, $controller, host) {\n        if (host.childNodes.length) {\n            this.childNodes = toArray(host.childNodes);\n        }\n        else {\n            this.childNodes = PLATFORM.emptyArray;\n        }\n        this.host = dom.convertToRenderLocation(host);\n        Metadata.define(CustomElement.name, $controller, this.host);\n    }\n    get children() {\n        return this.childNodes;\n    }\n    subscribeToChildrenChange(callback) {\n        // TODO: turn this into an error\n        // Containerless does not have a container node to observe children on.\n    }\n    provideEncapsulationSource() {\n        return this.host.getRootNode();\n    }\n    project(nodes) {\n        nodes.insertBefore(this.host);\n    }\n    take(nodes) {\n        nodes.remove();\n        nodes.unlink();\n    }\n}\n/** @internal */\nexport class HostProjector {\n    constructor($controller, host) {\n        this.host = host;\n        Metadata.define(CustomElement.name, $controller, host);\n    }\n    get children() {\n        return this.host.childNodes;\n    }\n    subscribeToChildrenChange(callback) {\n        // Do nothing since this scenario will never have children.\n    }\n    provideEncapsulationSource() {\n        return this.host.getRootNode();\n    }\n    project(nodes) {\n        nodes.appendTo(this.host);\n    }\n    take(nodes) {\n        nodes.remove();\n        nodes.unlink();\n    }\n}\n//# sourceMappingURL=projectors.js.map","import { PLATFORM, Registration, Reporter } from '@aurelia/kernel';\nimport { DOM, IDOM, INode, CustomElement } from '@aurelia/runtime';\nimport { ShadowDOMProjector } from './projectors';\nexport var NodeType;\n(function (NodeType) {\n    NodeType[NodeType[\"Element\"] = 1] = \"Element\";\n    NodeType[NodeType[\"Attr\"] = 2] = \"Attr\";\n    NodeType[NodeType[\"Text\"] = 3] = \"Text\";\n    NodeType[NodeType[\"CDATASection\"] = 4] = \"CDATASection\";\n    NodeType[NodeType[\"EntityReference\"] = 5] = \"EntityReference\";\n    NodeType[NodeType[\"Entity\"] = 6] = \"Entity\";\n    NodeType[NodeType[\"ProcessingInstruction\"] = 7] = \"ProcessingInstruction\";\n    NodeType[NodeType[\"Comment\"] = 8] = \"Comment\";\n    NodeType[NodeType[\"Document\"] = 9] = \"Document\";\n    NodeType[NodeType[\"DocumentType\"] = 10] = \"DocumentType\";\n    NodeType[NodeType[\"DocumentFragment\"] = 11] = \"DocumentFragment\";\n    NodeType[NodeType[\"Notation\"] = 12] = \"Notation\";\n})(NodeType || (NodeType = {}));\nconst effectiveParentNodeOverrides = new WeakMap();\n/**\n * IDOM implementation for Html.\n */\nexport class HTMLDOM {\n    constructor(window, document, TNode, TElement, THTMLElement, TCustomEvent, TCSSStyleSheet, TShadowRoot) {\n        this.window = window;\n        this.document = document;\n        this.Node = TNode;\n        this.Element = TElement;\n        this.HTMLElement = THTMLElement;\n        this.CustomEvent = TCustomEvent;\n        this.CSSStyleSheet = TCSSStyleSheet;\n        this.ShadowRoot = TShadowRoot;\n        if (DOM.isInitialized) {\n            Reporter.write(1001); // TODO: create reporters code // DOM already initialized (just info)\n            DOM.destroy();\n        }\n        DOM.initialize(this);\n        this.emptyNodes = new FragmentNodeSequence(this, document.createDocumentFragment());\n    }\n    static register(container) {\n        return Registration.aliasTo(IDOM, this).register(container);\n    }\n    addEventListener(eventName, subscriber, publisher, options) {\n        (publisher || this.document).addEventListener(eventName, subscriber, options);\n    }\n    appendChild(parent, child) {\n        parent.appendChild(child);\n    }\n    cloneNode(node, deep) {\n        return node.cloneNode(deep !== false);\n    }\n    convertToRenderLocation(node) {\n        if (this.isRenderLocation(node)) {\n            return node; // it's already a IRenderLocation (converted by FragmentNodeSequence)\n        }\n        if (node.parentNode == null) {\n            throw Reporter.error(52);\n        }\n        const locationEnd = this.document.createComment('au-end');\n        const locationStart = this.document.createComment('au-start');\n        node.parentNode.replaceChild(locationEnd, node);\n        locationEnd.parentNode.insertBefore(locationStart, locationEnd);\n        locationEnd.$start = locationStart;\n        locationStart.$nodes = null;\n        return locationEnd;\n    }\n    createDocumentFragment(markupOrNode) {\n        if (markupOrNode == null) {\n            return this.document.createDocumentFragment();\n        }\n        if (this.isNodeInstance(markupOrNode)) {\n            if (markupOrNode.content !== undefined) {\n                return markupOrNode.content;\n            }\n            const fragment = this.document.createDocumentFragment();\n            fragment.appendChild(markupOrNode);\n            return fragment;\n        }\n        return this.createTemplate(markupOrNode).content;\n    }\n    createNodeSequence(fragment) {\n        if (fragment === null) {\n            return this.emptyNodes;\n        }\n        return new FragmentNodeSequence(this, fragment.cloneNode(true));\n    }\n    createElement(name) {\n        return this.document.createElement(name);\n    }\n    fetch(input, init) {\n        return this.window.fetch(input, init);\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    createCustomEvent(eventType, options) {\n        return new this.CustomEvent(eventType, options);\n    }\n    dispatchEvent(evt) {\n        this.document.dispatchEvent(evt);\n    }\n    createNodeObserver(node, cb, init) {\n        if (typeof MutationObserver === 'undefined') {\n            // TODO: find a proper response for this scenario\n            return {\n                disconnect() { },\n                observe() { },\n                takeRecords() { return PLATFORM.emptyArray; }\n            };\n        }\n        const observer = new MutationObserver(cb);\n        observer.observe(node, init);\n        return observer;\n    }\n    createTemplate(markup) {\n        if (markup == null) {\n            return this.document.createElement('template');\n        }\n        const template = this.document.createElement('template');\n        template.innerHTML = markup.toString();\n        return template;\n    }\n    createTextNode(text) {\n        return this.document.createTextNode(text);\n    }\n    /**\n     * Returns the effective parentNode according to Aurelia's component hierarchy.\n     *\n     * Used by Aurelia to find the closest parent controller relative to a node.\n     *\n     * This method supports 3 additional scenarios that `node.parentNode` does not support:\n     * - Containerless elements. The parentNode in this case is a comment precending the element under specific conditions, rather than a node wrapping the element.\n     * - ShadowDOM. If a `ShadowRoot` is encountered, this method retrieves the associated controller via the metadata api to locate the original host.\n     * - Portals. If the provided node was moved to a different location in the DOM by a `portal` attribute, then the original parent of the node will be returned.\n     *\n     * @param node - The node to get the parent for.\n     * @returns Either the closest parent node, the closest `IRenderLocation` (comment node that is the containerless host), original portal host, or `null` if this is either the absolute document root or a disconnected node.\n     */\n    getEffectiveParentNode(node) {\n        // TODO: this method needs more tests!\n        // First look for any overrides\n        if (effectiveParentNodeOverrides.has(node)) {\n            return effectiveParentNodeOverrides.get(node);\n        }\n        // Then try to get the nearest au-start render location, which would be the containerless parent,\n        // again looking for any overrides along the way.\n        // otherwise return the normal parent node\n        let containerlessOffset = 0;\n        let next = node.nextSibling;\n        while (next !== null) {\n            if (next.nodeType === 8 /* Comment */) {\n                switch (next.textContent) {\n                    case 'au-start':\n                        // If we see an au-start before we see au-end, it will precede the host of a sibling containerless element rather than a parent.\n                        // So we use the offset to ignore the next au-end\n                        ++containerlessOffset;\n                        break;\n                    case 'au-end':\n                        if (containerlessOffset-- === 0) {\n                            return next;\n                        }\n                }\n            }\n            next = next.nextSibling;\n        }\n        if (node.parentNode === null && node.nodeType === 11 /* DocumentFragment */) {\n            // Could be a shadow root; see if there's a controller and if so, get the original host via the projector\n            const controller = CustomElement.for(node);\n            if (controller === void 0) {\n                // Not a shadow root (or at least, not one created by Aurelia)\n                // Nothing more we can try, just return null\n                return null;\n            }\n            const projector = controller.projector;\n            if (projector instanceof ShadowDOMProjector) {\n                // Now we can use the original host to traverse further up\n                return this.getEffectiveParentNode(projector.host);\n            }\n        }\n        return node.parentNode;\n    }\n    setEffectiveParentNode(childNodeOrNodeSequence, parentNode) {\n        if (this.isNodeInstance(childNodeOrNodeSequence)) {\n            effectiveParentNodeOverrides.set(childNodeOrNodeSequence, parentNode);\n        }\n        else {\n            const nodes = childNodeOrNodeSequence.childNodes;\n            for (let i = 0, ii = nodes.length; i < ii; ++i) {\n                effectiveParentNodeOverrides.set(nodes[i], parentNode);\n            }\n        }\n    }\n    insertBefore(nodeToInsert, referenceNode) {\n        referenceNode.parentNode.insertBefore(nodeToInsert, referenceNode);\n    }\n    isMarker(node) {\n        return node.nodeName === 'AU-M';\n    }\n    isNodeInstance(potentialNode) {\n        return potentialNode != null && potentialNode.nodeType > 0;\n    }\n    isRenderLocation(node) {\n        return node.textContent === 'au-end';\n    }\n    makeTarget(node) {\n        node.className = 'au';\n    }\n    registerElementResolver(container, resolver) {\n        container.registerResolver(INode, resolver);\n        container.registerResolver(this.Node, resolver);\n        container.registerResolver(this.Element, resolver);\n        container.registerResolver(this.HTMLElement, resolver);\n    }\n    remove(node) {\n        if (node.remove) {\n            node.remove();\n        }\n        else {\n            node.parentNode.removeChild(node);\n        }\n    }\n    removeEventListener(eventName, subscriber, publisher, options) {\n        (publisher || this.document).removeEventListener(eventName, subscriber, options);\n    }\n    setAttribute(node, name, value) {\n        node.setAttribute(name, value);\n    }\n}\nconst $DOM = DOM;\nexport { $DOM as DOM };\n/* eslint-enable @typescript-eslint/no-explicit-any */\n// This is the most common form of INodeSequence.\n// Every custom element or template controller whose node sequence is based on an HTML template\n// has an instance of this under the hood. Anyone who wants to create a node sequence from\n// a string of markup would also receive an instance of this.\n// CompiledTemplates create instances of FragmentNodeSequence.\n/**\n * This is the most common form of INodeSequence.\n *\n * @internal\n */\nexport class FragmentNodeSequence {\n    constructor(dom, fragment) {\n        this.dom = dom;\n        this.fragment = fragment;\n        this.isMounted = false;\n        this.isLinked = false;\n        this.next = void 0;\n        this.refNode = void 0;\n        const targetNodeList = fragment.querySelectorAll('.au');\n        let i = 0;\n        let ii = targetNodeList.length;\n        const targets = this.targets = Array(ii);\n        while (i < ii) {\n            // eagerly convert all markers to RenderLocations (otherwise the renderer\n            // will do it anyway) and store them in the target list (since the comments\n            // can't be queried)\n            const target = targetNodeList[i];\n            if (target.nodeName === 'AU-M') {\n                // note the renderer will still call this method, but it will just return the\n                // location if it sees it's already a location\n                targets[i] = this.dom.convertToRenderLocation(target);\n            }\n            else {\n                // also store non-markers for consistent ordering\n                targets[i] = target;\n            }\n            ++i;\n        }\n        const childNodeList = fragment.childNodes;\n        i = 0;\n        ii = childNodeList.length;\n        const childNodes = this.childNodes = Array(ii);\n        while (i < ii) {\n            childNodes[i] = childNodeList[i];\n            ++i;\n        }\n        this.firstChild = fragment.firstChild;\n        this.lastChild = fragment.lastChild;\n    }\n    findTargets() {\n        return this.targets;\n    }\n    insertBefore(refNode) {\n        if (this.isLinked && !!this.refNode) {\n            this.addToLinked();\n        }\n        else {\n            const parent = refNode.parentNode;\n            if (this.isMounted) {\n                let current = this.firstChild;\n                const end = this.lastChild;\n                let next;\n                while (current != null) {\n                    next = current.nextSibling;\n                    parent.insertBefore(current, refNode);\n                    if (current === end) {\n                        break;\n                    }\n                    current = next;\n                }\n            }\n            else {\n                this.isMounted = true;\n                refNode.parentNode.insertBefore(this.fragment, refNode);\n            }\n        }\n    }\n    appendTo(parent) {\n        if (this.isMounted) {\n            let current = this.firstChild;\n            const end = this.lastChild;\n            let next;\n            while (current != null) {\n                next = current.nextSibling;\n                parent.appendChild(current);\n                if (current === end) {\n                    break;\n                }\n                current = next;\n            }\n        }\n        else {\n            this.isMounted = true;\n            parent.appendChild(this.fragment);\n        }\n    }\n    remove() {\n        if (this.isMounted) {\n            this.isMounted = false;\n            const fragment = this.fragment;\n            const end = this.lastChild;\n            let next;\n            let current = this.firstChild;\n            while (current !== null) {\n                next = current.nextSibling;\n                fragment.appendChild(current);\n                if (current === end) {\n                    break;\n                }\n                current = next;\n            }\n        }\n    }\n    addToLinked() {\n        const refNode = this.refNode;\n        const parent = refNode.parentNode;\n        if (this.isMounted) {\n            let current = this.firstChild;\n            const end = this.lastChild;\n            let next;\n            while (current != null) {\n                next = current.nextSibling;\n                parent.insertBefore(current, refNode);\n                if (current === end) {\n                    break;\n                }\n                current = next;\n            }\n        }\n        else {\n            this.isMounted = true;\n            parent.insertBefore(this.fragment, refNode);\n        }\n    }\n    unlink() {\n        this.isLinked = false;\n        this.next = void 0;\n        this.refNode = void 0;\n    }\n    link(next) {\n        this.isLinked = true;\n        if (this.dom.isRenderLocation(next)) {\n            this.refNode = next;\n        }\n        else {\n            this.next = next;\n            this.obtainRefNode();\n        }\n    }\n    obtainRefNode() {\n        if (this.next !== void 0) {\n            this.refNode = this.next.firstChild;\n        }\n        else {\n            this.refNode = void 0;\n        }\n    }\n}\n/** @internal */\nexport class AuMarker {\n    constructor(nextSibling) {\n        this.nextSibling = nextSibling;\n        this.textContent = '';\n    }\n    get parentNode() {\n        return this.nextSibling.parentNode;\n    }\n    remove() { }\n}\n(proto => {\n    proto.previousSibling = null;\n    proto.childNodes = PLATFORM.emptyArray;\n    proto.nodeName = 'AU-M';\n    proto.nodeType = 1 /* Element */;\n})(AuMarker.prototype);\n//# sourceMappingURL=dom.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { PLATFORM } from '@aurelia/kernel';\nimport { bindable, customAttribute, IDOM, INode, IScheduler } from '@aurelia/runtime';\nimport { HTMLDOM } from '../../dom';\nconst unset = Symbol();\n// Using passive to help with performance\nconst defaultCaptureEventInit = {\n    passive: true,\n    capture: true\n};\n// Using passive to help with performance\nconst defaultBubbleEventInit = {\n    passive: true\n};\n// weakly connect a document to a blur manager\n// to avoid polluting the document properties\nconst blurDocMap = new WeakMap();\nexport class BlurManager {\n    constructor(dom, scheduler) {\n        this.dom = dom;\n        this.scheduler = scheduler;\n        this.blurs = [];\n        blurDocMap.set(dom.document, this);\n        this.handler = createHandler(this, this.blurs);\n    }\n    static createFor(dom, scheduler) {\n        return blurDocMap.get(dom.document) || new BlurManager(dom, scheduler);\n    }\n    register(blur) {\n        const blurs = this.blurs;\n        if (!blurs.includes(blur) && blurs.push(blur) === 1) {\n            this.addListeners();\n        }\n    }\n    unregister(blur) {\n        const blurs = this.blurs;\n        const index = blurs.indexOf(blur);\n        if (index > -1) {\n            blurs.splice(index, 1);\n        }\n        if (blurs.length === 0) {\n            this.removeListeners();\n        }\n    }\n    addListeners() {\n        const dom = this.dom;\n        const doc = dom.document;\n        const win = dom.window;\n        const handler = this.handler;\n        if (win.navigator.pointerEnabled) {\n            doc.addEventListener('pointerdown', handler, defaultCaptureEventInit);\n        }\n        doc.addEventListener('touchstart', handler, defaultCaptureEventInit);\n        doc.addEventListener('mousedown', handler, defaultCaptureEventInit);\n        doc.addEventListener('focus', handler, defaultCaptureEventInit);\n        win.addEventListener('blur', handler, defaultBubbleEventInit);\n    }\n    removeListeners() {\n        const dom = this.dom;\n        const doc = dom.document;\n        const win = dom.window;\n        const handler = this.handler;\n        if (win.navigator.pointerEnabled) {\n            doc.removeEventListener('pointerdown', handler, defaultCaptureEventInit);\n        }\n        doc.removeEventListener('touchstart', handler, defaultCaptureEventInit);\n        doc.removeEventListener('mousedown', handler, defaultCaptureEventInit);\n        doc.removeEventListener('focus', handler, defaultCaptureEventInit);\n        win.removeEventListener('blur', handler, defaultBubbleEventInit);\n    }\n}\nlet Blur = class Blur {\n    constructor(element, dom, scheduler) {\n        this.dom = dom;\n        this.element = element;\n        /**\n         * By default, the behavior should be least surprise possible, that:\n         *\n         * it searches for anything from root context,\n         * and root context is document body\n         */\n        this.linkedMultiple = true;\n        this.searchSubTree = true;\n        this.linkingContext = null;\n        this.value = unset;\n        this.manager = BlurManager.createFor(dom, scheduler);\n    }\n    afterAttach() {\n        this.manager.register(this);\n    }\n    beforeDetach() {\n        this.manager.unregister(this);\n    }\n    handleEventTarget(target) {\n        if (this.value === false) {\n            return;\n        }\n        const dom = this.dom;\n        if (target === dom.window || target === dom.document || !this.contains(target)) {\n            this.triggerBlur();\n        }\n    }\n    contains(target) {\n        if (!this.value) {\n            return false;\n        }\n        let els;\n        let i;\n        let j, jj;\n        let link;\n        const element = this.element;\n        if (containsElementOrShadowRoot(element, target)) {\n            return true;\n        }\n        if (!this.linkedWith) {\n            return false;\n        }\n        const doc = this.dom.document;\n        const linkedWith = this.linkedWith;\n        const linkingContext = this.linkingContext;\n        const searchSubTree = this.searchSubTree;\n        const linkedMultiple = this.linkedMultiple;\n        const links = Array.isArray(linkedWith) ? linkedWith : [linkedWith];\n        const contextNode = (typeof linkingContext === 'string'\n            ? doc.querySelector(linkingContext)\n            : linkingContext)\n            || doc.body;\n        const ii = links.length;\n        for (i = 0; ii > i; ++i) {\n            link = links[i];\n            // When user specify to link with something by a string, it acts as a CSS selector\n            // We need to do some querying stuff to determine if target above is contained.\n            if (typeof link === 'string') {\n                // Default behavior, search the whole tree, from context that user specified, which default to document body\n                if (searchSubTree) {\n                    // todo: are there too many knobs?? Consider remove \"linkedMultiple\"??\n                    if (!linkedMultiple) {\n                        const el = contextNode.querySelector(link);\n                        els = el !== null ? [el] : PLATFORM.emptyArray;\n                    }\n                    else {\n                        els = contextNode.querySelectorAll(link);\n                    }\n                    jj = els.length;\n                    for (j = 0; jj > j; ++j) {\n                        if (els[j].contains(target)) {\n                            return true;\n                        }\n                    }\n                }\n                else {\n                    // default to document body, if user didn't define a linking context, and wanted to ignore subtree.\n                    // This is specifically performant and useful for dialogs, plugins\n                    // that usually generate contents to document body\n                    els = contextNode.children;\n                    jj = els.length;\n                    for (j = 0; jj > j; ++j) {\n                        if (els[j].matches(link)) {\n                            return true;\n                        }\n                    }\n                }\n            }\n            else {\n                // When user passed in something that is not a string,\n                // simply check if has method `contains` (allow duck typing)\n                // and call it against target.\n                // This enables flexible usages\n                if (link && link.contains(target)) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n    triggerBlur() {\n        this.value = false;\n        if (typeof this.onBlur === 'function') {\n            this.onBlur.call(null);\n        }\n    }\n};\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Object)\n], Blur.prototype, \"value\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Function)\n], Blur.prototype, \"onBlur\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Object)\n], Blur.prototype, \"linkedWith\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Boolean)\n], Blur.prototype, \"linkedMultiple\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Boolean)\n], Blur.prototype, \"searchSubTree\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Object)\n], Blur.prototype, \"linkingContext\", void 0);\nBlur = __decorate([\n    customAttribute('blur'),\n    __param(0, INode), __param(1, IDOM), __param(2, IScheduler),\n    __metadata(\"design:paramtypes\", [Object, HTMLDOM, Object])\n], Blur);\nexport { Blur };\nconst containsElementOrShadowRoot = (container, target) => {\n    if (container.contains(target)) {\n        return true;\n    }\n    let parentNode = null;\n    while (target != null) {\n        if (target === container) {\n            return true;\n        }\n        parentNode = target.parentNode;\n        if (parentNode === null && target.nodeType === 11 /* DocumentFragment */) {\n            target = target.host;\n            continue;\n        }\n        target = parentNode;\n    }\n    return false;\n};\nconst createHandler = (manager, checkTargets) => {\n    // *******************************\n    // EVENTS ORDER\n    // -----------------------------\n    // pointerdown\n    // touchstart\n    // pointerup\n    // touchend\n    // mousedown\n    // --------------\n    // BLUR\n    // FOCUS\n    // --------------\n    // mouseup\n    // click\n    //\n    // ******************************\n    //\n    // There are cases focus happens without mouse interaction (keyboard)\n    // So it needs to capture both mouse / focus movement\n    //\n    // ******************************\n    let hasChecked = false;\n    const revertCheckage = () => {\n        hasChecked = false;\n    };\n    const markChecked = () => {\n        hasChecked = true;\n        manager.scheduler.queueRenderTask(revertCheckage, { preempt: true });\n    };\n    const handleMousedown = (e) => {\n        if (!hasChecked) {\n            handleEvent(e);\n            markChecked();\n        }\n    };\n    /**\n     * Handle globally captured focus event\n     * This can happen via a few way:\n     * User clicks on a focusable element\n     * User uses keyboard to navigate to a focusable element\n     * User goes back to the window from another browser tab\n     * User clicks on a non-focusable element\n     * User clicks on the window, outside of the document\n     */\n    const handleFocus = (e) => {\n        if (hasChecked) {\n            return;\n        }\n        // there are two way a focus gets captured on window\n        // when the windows itself got focus\n        // and when an element in the document gets focus\n        // when the window itself got focus, reacting to it is quite unnecessary\n        // as it doesn't really affect element inside the document\n        // Do a simple check and bail immediately\n        const isWindow = e.target === manager.dom.window;\n        if (isWindow) {\n            for (let i = 0, ii = checkTargets.length; ii > i; ++i) {\n                checkTargets[i].triggerBlur();\n            }\n        }\n        else {\n            handleEvent(e);\n        }\n        markChecked();\n    };\n    const handleWindowBlur = () => {\n        hasChecked = false;\n        for (let i = 0, ii = checkTargets.length; i < ii; ++i) {\n            checkTargets[i].triggerBlur();\n        }\n    };\n    const handleEvent = (e) => {\n        const target = e.composed ? e.composedPath()[0] : e.target;\n        if (target === null) {\n            return;\n        }\n        for (let i = 0, ii = checkTargets.length; i < ii; ++i) {\n            checkTargets[i].handleEventTarget(target);\n        }\n    };\n    return {\n        onpointerdown: handleMousedown,\n        ontouchstart: handleMousedown,\n        onmousedown: handleMousedown,\n        onfocus: handleFocus,\n        onblur: handleWindowBlur,\n        handleEvent(e) {\n            this[`on${e.type}`](e);\n        }\n    };\n};\n//# sourceMappingURL=blur.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { bindable, BindingMode, customAttribute, IDOM, INode } from '@aurelia/runtime';\nimport { HTMLDOM } from '../../dom';\n/**\n * Focus attribute for element focus binding\n */\nlet Focus = class Focus {\n    constructor(element, dom) {\n        this.dom = dom;\n        /**\n         * Indicates whether `apply` should be called when `afterAttach` callback is invoked\n         */\n        this.needsApply = false;\n        this.element = element;\n    }\n    beforeBind() {\n        this.valueChanged();\n    }\n    /**\n     * Invoked everytime the bound value changes.\n     *\n     * @param newValue - The new value.\n     */\n    valueChanged() {\n        // In theory, we could/should react immediately\n        // but focus state of an element cannot be achieved\n        // while it's disconnected from the document\n        // thus, there neesd to be a check if it's currently connected or not\n        // before applying the value to the element\n        if (this.$controller.state & 32 /* isAttached */) {\n            this.apply();\n        }\n        else {\n            // If the element is not currently connect\n            // toggle the flag to add pending work for later\n            // in afterAttach lifecycle\n            this.needsApply = true;\n        }\n    }\n    /**\n     * Invoked when the attribute is afterAttach to the DOM.\n     */\n    afterAttach() {\n        if (this.needsApply) {\n            this.needsApply = false;\n            this.apply();\n        }\n        const el = this.element;\n        el.addEventListener('focus', this);\n        el.addEventListener('blur', this);\n    }\n    /**\n     * Invoked when the attribute is afterDetach from the DOM.\n     */\n    afterDetach() {\n        const el = this.element;\n        el.removeEventListener('focus', this);\n        el.removeEventListener('blur', this);\n    }\n    /**\n     * EventTarget interface handler for better memory usage\n     */\n    handleEvent(e) {\n        // there are only two event listened to\n        // if the even is focus, it menans the element is focused\n        // only need to switch the value to true\n        if (e.type === 'focus') {\n            this.value = true;\n        }\n        else if (this.dom.document.activeElement !== this.element) {\n            // else, it's blur event\n            // when a blur event happens, there are two situations\n            // 1. the element itself lost the focus\n            // 2. window lost the focus\n            // To handle both (1) and (2), only need to check if\n            // current active element is still the same element of this focus custom attribute\n            // If it's not, it's a blur event happened on Window because the browser tab lost focus\n            this.value = false;\n        }\n    }\n    /**\n     * Focus/blur based on current value\n     */\n    apply() {\n        const el = this.element;\n        if (this.value) {\n            el.focus();\n        }\n        else {\n            el.blur();\n        }\n    }\n};\n__decorate([\n    bindable({ mode: BindingMode.twoWay }),\n    __metadata(\"design:type\", Object)\n], Focus.prototype, \"value\", void 0);\nFocus = __decorate([\n    customAttribute('focus'),\n    __param(0, INode), __param(1, IDOM),\n    __metadata(\"design:paramtypes\", [Object, HTMLDOM])\n], Focus);\nexport { Focus };\n//# sourceMappingURL=focus.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { nextId, } from '@aurelia/kernel';\nimport { bindable, ContinuationTask, IDOM, IRenderLocation, IViewFactory, LifecycleTask, templateController, TerminalTask, } from '@aurelia/runtime';\nimport { HTMLDOM, } from '../../dom';\nfunction toTask(maybePromiseOrTask) {\n    if (maybePromiseOrTask == null) {\n        return LifecycleTask.done;\n    }\n    if (typeof maybePromiseOrTask.then === 'function') {\n        return new TerminalTask(maybePromiseOrTask);\n    }\n    return maybePromiseOrTask;\n}\nlet Portal = class Portal {\n    constructor(factory, originalLoc, dom) {\n        this.factory = factory;\n        this.originalLoc = originalLoc;\n        this.dom = dom;\n        this.id = nextId('au$component');\n        this.strict = false;\n        this.task = LifecycleTask.done;\n        // to make the shape of this object consistent.\n        // todo: is this necessary\n        this.currentTarget = dom.createElement('div');\n        this.view = this.factory.create();\n        dom.setEffectiveParentNode(this.view.nodes, originalLoc);\n        this.view.hold(originalLoc, 1 /* insertBefore */);\n    }\n    beforeBind(flags) {\n        if (this.callbackContext == null) {\n            this.callbackContext = this.$controller.scope.bindingContext;\n        }\n        return this.view.bind(flags, this.$controller.scope);\n    }\n    afterAttach(flags) {\n        this.targetChanged();\n    }\n    beforeDetach(flags) {\n        this.task = this.deactivate(flags);\n    }\n    beforeUnbind(flags) {\n        this.callbackContext = null;\n        return this.view.unbind(flags);\n    }\n    targetChanged() {\n        const $controller = this.$controller;\n        if (($controller.state & 4 /* isBound */) === 0) {\n            return;\n        }\n        this.project($controller.flags);\n    }\n    project(flags) {\n        const oldTarget = this.currentTarget;\n        const newTarget = this.currentTarget = this.resolveTarget();\n        if (oldTarget === newTarget) {\n            return;\n        }\n        this.task = this.deactivate(flags);\n        this.task = this.activate(newTarget, flags);\n    }\n    activate(target, flags) {\n        const { activating, activated, callbackContext, view } = this;\n        let task = this.task;\n        view.hold(target, 2 /* append */);\n        if ((this.$controller.state & 40 /* isAttachedOrAttaching */) === 0) {\n            return task;\n        }\n        if (typeof activating === 'function') {\n            if (task.done) {\n                task = toTask(activating.call(callbackContext, target, view));\n            }\n            else {\n                task = new ContinuationTask(task, activating, callbackContext, target, view);\n            }\n        }\n        if (task.done) {\n            view.attach(flags);\n        }\n        else {\n            task = new ContinuationTask(task, view.attach, view, flags);\n        }\n        if (typeof activated === 'function') {\n            if (task.done) {\n                // TODO: chain this up with RAF queue mount callback so activated is called only when\n                // node is actually mounted (is this needed as per the spec of this resource?)\n                task = toTask(activated.call(callbackContext, target, view));\n            }\n            else {\n                task = new ContinuationTask(task, activated, callbackContext, target, view);\n            }\n        }\n        return task;\n    }\n    deactivate(flags) {\n        const { deactivating, deactivated, callbackContext, view, target: target } = this;\n        let task = this.task;\n        if (typeof deactivating === 'function') {\n            if (task.done) {\n                task = toTask(deactivating.call(callbackContext, target, view));\n            }\n            else {\n                task = new ContinuationTask(task, deactivating, callbackContext, target, view);\n            }\n        }\n        if (task.done) {\n            view.detach(flags);\n        }\n        else {\n            task = new ContinuationTask(task, view.detach, view, flags);\n        }\n        if (typeof deactivated === 'function') {\n            if (task.done) {\n                task = toTask(deactivated.call(callbackContext, target, view));\n            }\n            else {\n                task = new ContinuationTask(task, deactivated, callbackContext, target, view);\n            }\n        }\n        return task;\n    }\n    resolveTarget() {\n        const dom = this.dom;\n        // with a $ in front to make it less confusing/error prone\n        const $document = dom.document;\n        let target = this.target;\n        let context = this.renderContext;\n        if (typeof target === 'string') {\n            let queryContext = $document;\n            if (typeof context === 'string') {\n                context = $document.querySelector(context);\n            }\n            if (dom.isNodeInstance(context)) {\n                queryContext = context;\n            }\n            target = queryContext.querySelector(target);\n        }\n        if (dom.isNodeInstance(target)) {\n            return target;\n        }\n        if (target == null) {\n            if (this.strict) {\n                throw new Error('Render target not found');\n            }\n            else {\n                target = $document.body;\n            }\n        }\n        return target;\n    }\n};\n__decorate([\n    bindable({ primary: true }),\n    __metadata(\"design:type\", Object)\n], Portal.prototype, \"target\", void 0);\n__decorate([\n    bindable({ callback: 'targetChanged' }),\n    __metadata(\"design:type\", Object)\n], Portal.prototype, \"renderContext\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Boolean)\n], Portal.prototype, \"strict\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Function)\n], Portal.prototype, \"deactivating\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Function)\n], Portal.prototype, \"activating\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Function)\n], Portal.prototype, \"deactivated\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Function)\n], Portal.prototype, \"activated\", void 0);\n__decorate([\n    bindable(),\n    __metadata(\"design:type\", Object)\n], Portal.prototype, \"callbackContext\", void 0);\nPortal = __decorate([\n    templateController('portal'),\n    __param(0, IViewFactory),\n    __param(1, IRenderLocation),\n    __param(2, IDOM),\n    __metadata(\"design:paramtypes\", [Object, Object, HTMLDOM])\n], Portal);\nexport { Portal };\n//# sourceMappingURL=portal.js.map","export var HTMLTargetedInstructionType;\n(function (HTMLTargetedInstructionType) {\n    HTMLTargetedInstructionType[\"textBinding\"] = \"ha\";\n    HTMLTargetedInstructionType[\"listenerBinding\"] = \"hb\";\n    HTMLTargetedInstructionType[\"attributeBinding\"] = \"hc\";\n    HTMLTargetedInstructionType[\"stylePropertyBinding\"] = \"hd\";\n    HTMLTargetedInstructionType[\"setAttribute\"] = \"he\";\n    HTMLTargetedInstructionType[\"setClassAttribute\"] = \"hf\";\n    HTMLTargetedInstructionType[\"setStyleAttribute\"] = \"hg\";\n})(HTMLTargetedInstructionType || (HTMLTargetedInstructionType = {}));\nexport function isHTMLTargetedInstruction(value) {\n    const type = value.type;\n    return typeof type === 'string' && type.length === 2;\n}\n//# sourceMappingURL=definitions.js.map","import { DelegationStrategy } from '@aurelia/runtime';\nexport class TextBindingInstruction {\n    constructor(from) {\n        this.from = from;\n        this.type = \"ha\" /* textBinding */;\n    }\n}\nexport class TriggerBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"hb\" /* listenerBinding */;\n        this.preventDefault = true;\n        this.strategy = DelegationStrategy.none;\n    }\n}\nexport class DelegateBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"hb\" /* listenerBinding */;\n        this.preventDefault = false;\n        this.strategy = DelegationStrategy.bubbling;\n    }\n}\nexport class CaptureBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"hb\" /* listenerBinding */;\n        this.preventDefault = false;\n        this.strategy = DelegationStrategy.capturing;\n    }\n}\nexport class StylePropertyBindingInstruction {\n    constructor(from, to) {\n        this.from = from;\n        this.to = to;\n        this.type = \"hd\" /* stylePropertyBinding */;\n    }\n}\nexport class SetAttributeInstruction {\n    constructor(value, to) {\n        this.value = value;\n        this.to = to;\n        this.type = \"he\" /* setAttribute */;\n    }\n}\nexport class SetClassAttributeInstruction {\n    constructor(value) {\n        this.value = value;\n        this.type = \"hf\" /* setClassAttribute */;\n    }\n}\nexport class SetStyleAttributeInstruction {\n    constructor(value) {\n        this.value = value;\n        this.type = \"hg\" /* setStyleAttribute */;\n    }\n}\nexport class AttributeBindingInstruction {\n    constructor(\n    /**\n     * `attr` and `to` have the same value on a normal attribute\n     * Will be different on `class` and `style`\n     * on `class`: attr = `class` (from binding command), to = attribute name\n     * on `style`: attr = `style` (from binding command), to = attribute name\n     */\n    attr, from, to) {\n        this.attr = attr;\n        this.from = from;\n        this.to = to;\n        this.type = \"hc\" /* attributeBinding */;\n    }\n}\n//# sourceMappingURL=instructions.js.map","import { CustomElement, HydrateElementInstruction, CustomElementDefinition, getRenderContext, } from '@aurelia/runtime';\nimport { isHTMLTargetedInstruction } from './definitions';\nimport { SetAttributeInstruction } from './instructions';\nexport function createElement(dom, tagOrType, props, children) {\n    if (typeof tagOrType === 'string') {\n        return createElementForTag(dom, tagOrType, props, children);\n    }\n    else if (CustomElement.isType(tagOrType)) {\n        return createElementForType(dom, tagOrType, props, children);\n    }\n    else {\n        throw new Error(`Invalid tagOrType.`);\n    }\n}\n/**\n * RenderPlan. Todo: describe goal of this class\n */\nexport class RenderPlan {\n    constructor(dom, node, instructions, dependencies) {\n        this.dom = dom;\n        this.node = node;\n        this.instructions = instructions;\n        this.dependencies = dependencies;\n        this.lazyDefinition = void 0;\n    }\n    get definition() {\n        if (this.lazyDefinition === void 0) {\n            this.lazyDefinition = CustomElementDefinition.create({\n                name: CustomElement.generateName(),\n                template: this.node,\n                needsCompile: typeof this.node === 'string',\n                instructions: this.instructions,\n                dependencies: this.dependencies,\n            });\n        }\n        return this.lazyDefinition;\n    }\n    getContext(parentContainer) {\n        return getRenderContext(this.definition, parentContainer, void 0);\n    }\n    createView(parentContainer) {\n        return this.getViewFactory(parentContainer).create();\n    }\n    getViewFactory(parentContainer) {\n        return this.getContext(parentContainer).getViewFactory();\n    }\n    /** @internal */\n    mergeInto(parent, instructions, dependencies) {\n        this.dom.appendChild(parent, this.node);\n        instructions.push(...this.instructions);\n        dependencies.push(...this.dependencies);\n    }\n}\nfunction createElementForTag(dom, tagName, props, children) {\n    const instructions = [];\n    const allInstructions = [];\n    const dependencies = [];\n    const element = dom.createElement(tagName);\n    let hasInstructions = false;\n    if (props) {\n        Object.keys(props)\n            .forEach(to => {\n            const value = props[to];\n            if (isHTMLTargetedInstruction(value)) {\n                hasInstructions = true;\n                instructions.push(value);\n            }\n            else {\n                dom.setAttribute(element, to, value);\n            }\n        });\n    }\n    if (hasInstructions) {\n        dom.makeTarget(element);\n        allInstructions.push(instructions);\n    }\n    if (children) {\n        addChildren(dom, element, children, allInstructions, dependencies);\n    }\n    return new RenderPlan(dom, element, allInstructions, dependencies);\n}\nfunction createElementForType(dom, Type, props, children) {\n    const definition = CustomElement.getDefinition(Type);\n    const tagName = definition.name;\n    const instructions = [];\n    const allInstructions = [instructions];\n    const dependencies = [];\n    const childInstructions = [];\n    const bindables = definition.bindables;\n    const element = dom.createElement(tagName);\n    dom.makeTarget(element);\n    if (!dependencies.includes(Type)) {\n        dependencies.push(Type);\n    }\n    instructions.push(new HydrateElementInstruction(tagName, childInstructions));\n    if (props) {\n        Object.keys(props)\n            .forEach(to => {\n            const value = props[to];\n            if (isHTMLTargetedInstruction(value)) {\n                childInstructions.push(value);\n            }\n            else {\n                const bindable = bindables[to];\n                if (bindable !== void 0) {\n                    childInstructions.push({\n                        type: \"re\" /* setProperty */,\n                        to,\n                        value\n                    });\n                }\n                else {\n                    childInstructions.push(new SetAttributeInstruction(value, to));\n                }\n            }\n        });\n    }\n    if (children) {\n        addChildren(dom, element, children, allInstructions, dependencies);\n    }\n    return new RenderPlan(dom, element, allInstructions, dependencies);\n}\nfunction addChildren(dom, parent, children, allInstructions, dependencies) {\n    for (let i = 0, ii = children.length; i < ii; ++i) {\n        const current = children[i];\n        switch (typeof current) {\n            case 'string':\n                dom.appendChild(parent, dom.createTextNode(current));\n                break;\n            case 'object':\n                if (dom.isNodeInstance(current)) {\n                    dom.appendChild(parent, current);\n                }\n                else if ('mergeInto' in current) {\n                    current.mergeInto(parent, allInstructions, dependencies);\n                }\n        }\n    }\n}\n//# sourceMappingURL=create-element.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { nextId, PLATFORM, } from '@aurelia/kernel';\nimport { BindingMode, ContinuationTask, IDOM, ITargetedInstruction, LifecycleTask, PromiseTask, CustomElementDefinition, bindable, customElement, getRenderContext, } from '@aurelia/runtime';\nimport { createElement, } from '../../create-element';\nconst bindables = ['subject', 'composing'];\nlet Compose = class Compose {\n    constructor(dom, instruction) {\n        this.dom = dom;\n        this.id = nextId('au$component');\n        this.subject = void 0;\n        this.composing = false;\n        this.view = void 0;\n        this.task = LifecycleTask.done;\n        this.lastSubject = void 0;\n        this.properties = instruction.instructions\n            .filter((x) => !bindables.includes(x.to))\n            .reduce((acc, item) => {\n            if (item.to) {\n                acc[item.to] = item;\n            }\n            return acc;\n        }, {});\n    }\n    beforeBind(flags) {\n        if (this.task.done) {\n            this.task = this.compose(this.subject, flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.compose, this, this.subject, flags);\n        }\n        if (this.task.done) {\n            this.task = this.bindView(flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.bindView, this, flags);\n        }\n        return this.task;\n    }\n    beforeAttach(flags) {\n        if (this.task.done) {\n            this.attachView(flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.attachView, this, flags);\n        }\n    }\n    beforeDetach(flags) {\n        if (this.view != void 0) {\n            if (this.task.done) {\n                this.view.detach(flags);\n            }\n            else {\n                this.task = new ContinuationTask(this.task, this.view.detach, this.view, flags);\n            }\n        }\n    }\n    beforeUnbind(flags) {\n        this.lastSubject = void 0;\n        if (this.view != void 0) {\n            if (this.task.done) {\n                this.task = this.view.unbind(flags);\n            }\n            else {\n                this.task = new ContinuationTask(this.task, this.view.unbind, this.view, flags);\n            }\n        }\n        return this.task;\n    }\n    caching(flags) {\n        this.view = void 0;\n    }\n    subjectChanged(newValue, previousValue, flags) {\n        flags |= this.$controller.flags;\n        if (this.task.done) {\n            this.task = this.compose(newValue, flags);\n        }\n        else {\n            this.task = new ContinuationTask(this.task, this.compose, this, newValue, flags);\n        }\n    }\n    compose(subject, flags) {\n        if (this.lastSubject === subject) {\n            return LifecycleTask.done;\n        }\n        this.lastSubject = subject;\n        this.composing = true;\n        let task = this.deactivate(flags);\n        if (subject instanceof Promise) {\n            let viewPromise;\n            if (task.done) {\n                viewPromise = subject.then(s => this.resolveView(s, flags));\n            }\n            else {\n                viewPromise = task.wait().then(() => subject.then(s => this.resolveView(s, flags)));\n            }\n            task = new PromiseTask(viewPromise, this.activate, this, flags);\n        }\n        else {\n            const view = this.resolveView(subject, flags);\n            if (task.done) {\n                task = this.activate(view, flags);\n            }\n            else {\n                task = new ContinuationTask(task, this.activate, this, view, flags);\n            }\n        }\n        if (task.done) {\n            this.onComposed();\n        }\n        else {\n            task = new ContinuationTask(task, this.onComposed, this);\n        }\n        return task;\n    }\n    deactivate(flags) {\n        const view = this.view;\n        if (view == void 0) {\n            return LifecycleTask.done;\n        }\n        view.detach(flags);\n        return view.unbind(flags);\n    }\n    activate(view, flags) {\n        this.view = view;\n        if (view == void 0) {\n            return LifecycleTask.done;\n        }\n        let task = this.bindView(flags);\n        if (task.done) {\n            this.attachView(flags);\n        }\n        else {\n            task = new ContinuationTask(task, this.attachView, this, flags);\n        }\n        return task;\n    }\n    bindView(flags) {\n        if (this.view != void 0 && (this.$controller.state & (5 /* isBoundOrBinding */)) > 0) {\n            return this.view.bind(flags, this.$controller.scope, this.$controller.part);\n        }\n        return LifecycleTask.done;\n    }\n    attachView(flags) {\n        if (this.view != void 0 && (this.$controller.state & (40 /* isAttachedOrAttaching */)) > 0) {\n            this.view.attach(flags);\n        }\n    }\n    onComposed() {\n        this.composing = false;\n    }\n    resolveView(subject, flags) {\n        const view = this.provideViewFor(subject, flags);\n        if (view) {\n            view.hold(this.$controller.projector.host, 1 /* insertBefore */);\n            view.lockScope(this.$controller.scope);\n            return view;\n        }\n        return void 0;\n    }\n    provideViewFor(subject, flags) {\n        if (!subject) {\n            return void 0;\n        }\n        if (isController(subject)) { // IController\n            return subject;\n        }\n        if ('createView' in subject) { // RenderPlan\n            return subject.createView(this.$controller.context);\n        }\n        if ('create' in subject) { // IViewFactory\n            return subject.create(flags);\n        }\n        if ('template' in subject) { // Raw Template Definition\n            const definition = CustomElementDefinition.getOrCreate(subject);\n            return getRenderContext(definition, this.$controller.context, void 0).getViewFactory().create(flags);\n        }\n        // Constructable (Custom Element Constructor)\n        return createElement(this.dom, subject, this.properties, this.$controller.projector === void 0\n            ? PLATFORM.emptyArray\n            : this.$controller.projector.children).createView(this.$controller.context);\n    }\n};\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Object)\n], Compose.prototype, \"subject\", void 0);\n__decorate([\n    bindable({ mode: BindingMode.fromView }),\n    __metadata(\"design:type\", Boolean)\n], Compose.prototype, \"composing\", void 0);\nCompose = __decorate([\n    customElement({ name: 'au-compose', template: null, containerless: true }),\n    __param(0, IDOM),\n    __param(1, ITargetedInstruction),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], Compose);\nexport { Compose };\nfunction isController(subject) {\n    return 'lockScope' in subject;\n}\n//# sourceMappingURL=compose.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { BindingMode, ensureExpression, IExpressionParser, instructionRenderer, InterpolationBinding, IObserverLocator, MultiInterpolationBinding, PropertyBinding, applyBindingBehavior, } from '@aurelia/runtime';\nimport { AttributeBinding } from './binding/attribute';\nimport { Listener } from './binding/listener';\nimport { IEventManager } from './observation/event-manager';\nlet TextBindingRenderer = \n/** @internal */\nclass TextBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, context, controller, target, instruction) {\n        const next = target.nextSibling;\n        if (context.dom.isMarker(target)) {\n            context.dom.remove(target);\n        }\n        let binding;\n        const expr = ensureExpression(this.parser, instruction.from, 2048 /* Interpolation */);\n        if (expr.isMulti) {\n            binding = applyBindingBehavior(new MultiInterpolationBinding(this.observerLocator, expr, next, 'textContent', BindingMode.toView, context), expr, context);\n        }\n        else {\n            binding = applyBindingBehavior(new InterpolationBinding(expr.firstExpression, expr, next, 'textContent', BindingMode.toView, this.observerLocator, context, true), expr, context);\n        }\n        controller.addBinding(binding);\n    }\n};\nTextBindingRenderer = __decorate([\n    instructionRenderer(\"ha\" /* textBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], TextBindingRenderer);\nexport { TextBindingRenderer };\nlet ListenerBindingRenderer = \n/** @internal */\nclass ListenerBindingRenderer {\n    constructor(parser, eventManager) {\n        this.parser = parser;\n        this.eventManager = eventManager;\n    }\n    render(flags, context, controller, target, instruction) {\n        // eslint-disable-next-line @typescript-eslint/restrict-plus-operands\n        const expr = ensureExpression(this.parser, instruction.from, 80 /* IsEventCommand */ | (instruction.strategy + 6 /* DelegationStrategyDelta */));\n        const binding = applyBindingBehavior(new Listener(context.dom, instruction.to, instruction.strategy, expr, target, instruction.preventDefault, this.eventManager, context), expr, context);\n        controller.addBinding(binding);\n    }\n};\nListenerBindingRenderer = __decorate([\n    instructionRenderer(\"hb\" /* listenerBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IEventManager),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], ListenerBindingRenderer);\nexport { ListenerBindingRenderer };\nlet SetAttributeRenderer = \n/** @internal */\nclass SetAttributeRenderer {\n    render(flags, context, controller, target, instruction) {\n        target.setAttribute(instruction.to, instruction.value);\n    }\n};\nSetAttributeRenderer = __decorate([\n    instructionRenderer(\"he\" /* setAttribute */)\n    /** @internal */\n], SetAttributeRenderer);\nexport { SetAttributeRenderer };\nlet SetClassAttributeRenderer = class SetClassAttributeRenderer {\n    render(flags, context, controller, target, instruction) {\n        addClasses(target.classList, instruction.value);\n    }\n};\nSetClassAttributeRenderer = __decorate([\n    instructionRenderer(\"hf\" /* setClassAttribute */)\n], SetClassAttributeRenderer);\nexport { SetClassAttributeRenderer };\nlet SetStyleAttributeRenderer = class SetStyleAttributeRenderer {\n    render(flags, context, controller, target, instruction) {\n        target.style.cssText += instruction.value;\n    }\n};\nSetStyleAttributeRenderer = __decorate([\n    instructionRenderer(\"hg\" /* setStyleAttribute */)\n], SetStyleAttributeRenderer);\nexport { SetStyleAttributeRenderer };\nlet StylePropertyBindingRenderer = \n/** @internal */\nclass StylePropertyBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, context, controller, target, instruction) {\n        const expr = ensureExpression(this.parser, instruction.from, 48 /* IsPropertyCommand */ | BindingMode.toView);\n        const binding = applyBindingBehavior(new PropertyBinding(expr, target.style, instruction.to, BindingMode.toView, this.observerLocator, context), expr, context);\n        controller.addBinding(binding);\n    }\n};\nStylePropertyBindingRenderer = __decorate([\n    instructionRenderer(\"hd\" /* stylePropertyBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], StylePropertyBindingRenderer);\nexport { StylePropertyBindingRenderer };\nlet AttributeBindingRenderer = \n/** @internal */\nclass AttributeBindingRenderer {\n    constructor(parser, observerLocator) {\n        this.parser = parser;\n        this.observerLocator = observerLocator;\n    }\n    render(flags, context, controller, target, instruction) {\n        const expr = ensureExpression(this.parser, instruction.from, 48 /* IsPropertyCommand */ | BindingMode.toView);\n        const binding = applyBindingBehavior(new AttributeBinding(expr, target, instruction.attr /* targetAttribute */, instruction.to /* targetKey */, BindingMode.toView, this.observerLocator, context), expr, context);\n        controller.addBinding(binding);\n    }\n};\nAttributeBindingRenderer = __decorate([\n    instructionRenderer(\"hc\" /* attributeBinding */)\n    /** @internal */\n    ,\n    __param(0, IExpressionParser),\n    __param(1, IObserverLocator),\n    __metadata(\"design:paramtypes\", [Object, Object])\n], AttributeBindingRenderer);\nexport { AttributeBindingRenderer };\n// http://jsben.ch/7n5Kt\nfunction addClasses(classList, className) {\n    const len = className.length;\n    let start = 0;\n    for (let i = 0; i < len; ++i) {\n        if (className.charCodeAt(i) === 0x20) {\n            if (i !== start) {\n                classList.add(className.slice(start, i));\n            }\n            start = i + 1;\n        }\n        else if (i + 1 === len) {\n            classList.add(className.slice(start));\n        }\n    }\n}\n//# sourceMappingURL=html-renderer.js.map","import { DI } from '@aurelia/kernel';\nimport { RuntimeConfiguration } from '@aurelia/runtime';\nimport { AttributeBindingRenderer, ListenerBindingRenderer, SetAttributeRenderer, StylePropertyBindingRenderer, TextBindingRenderer, SetClassAttributeRenderer, SetStyleAttributeRenderer } from './html-renderer';\nimport { TargetAccessorLocator, TargetObserverLocator } from './observation/observer-locator';\nimport { HTMLProjectorLocator } from './projectors';\nimport { AttrBindingBehavior } from './resources/binding-behaviors/attr';\nimport { SelfBindingBehavior } from './resources/binding-behaviors/self';\nimport { UpdateTriggerBindingBehavior } from './resources/binding-behaviors/update-trigger';\nimport { Blur } from './resources/custom-attributes/blur';\nimport { Focus } from './resources/custom-attributes/focus';\nimport { Portal } from './resources/custom-attributes/portal';\nimport { Compose } from './resources/custom-elements/compose';\nexport const IProjectorLocatorRegistration = HTMLProjectorLocator;\nexport const ITargetAccessorLocatorRegistration = TargetAccessorLocator;\nexport const ITargetObserverLocatorRegistration = TargetObserverLocator;\n/**\n * Default HTML-specific (but environment-agnostic) implementations for the following interfaces:\n * - `IProjectorLocator`\n * - `ITargetAccessorLocator`\n * - `ITargetObserverLocator`\n * - `ITemplateFactory`\n */\nexport const DefaultComponents = [\n    IProjectorLocatorRegistration,\n    ITargetAccessorLocatorRegistration,\n    ITargetObserverLocatorRegistration,\n];\nexport const AttrBindingBehaviorRegistration = AttrBindingBehavior;\nexport const SelfBindingBehaviorRegistration = SelfBindingBehavior;\nexport const UpdateTriggerBindingBehaviorRegistration = UpdateTriggerBindingBehavior;\nexport const ComposeRegistration = Compose;\nexport const PortalRegistration = Portal;\nexport const FocusRegistration = Focus;\nexport const BlurRegistration = Blur;\n/**\n * Default HTML-specific (but environment-agnostic) resources:\n * - Binding Behaviors: `attr`, `self`, `updateTrigger`\n * - Custom Elements: `au-compose`\n * - Custom Attributes: `blur`, `focus`, `portal`\n */\nexport const DefaultResources = [\n    AttrBindingBehaviorRegistration,\n    SelfBindingBehaviorRegistration,\n    UpdateTriggerBindingBehaviorRegistration,\n    ComposeRegistration,\n    PortalRegistration,\n    FocusRegistration,\n    BlurRegistration\n];\nexport const ListenerBindingRendererRegistration = ListenerBindingRenderer;\nexport const AttributeBindingRendererRegistration = AttributeBindingRenderer;\nexport const SetAttributeRendererRegistration = SetAttributeRenderer;\nexport const SetClassAttributeRendererRegistration = SetClassAttributeRenderer;\nexport const SetStyleAttributeRendererRegistration = SetStyleAttributeRenderer;\nexport const StylePropertyBindingRendererRegistration = StylePropertyBindingRenderer;\nexport const TextBindingRendererRegistration = TextBindingRenderer;\n/**\n * Default HTML-specfic (but environment-agnostic) renderers for:\n * - Listener Bindings: `trigger`, `capture`, `delegate`\n * - SetAttribute\n * - StyleProperty: `style`, `css`\n * - TextBinding: `${}`\n */\nexport const DefaultRenderers = [\n    ListenerBindingRendererRegistration,\n    AttributeBindingRendererRegistration,\n    SetAttributeRendererRegistration,\n    SetClassAttributeRendererRegistration,\n    SetStyleAttributeRendererRegistration,\n    StylePropertyBindingRendererRegistration,\n    TextBindingRendererRegistration\n];\n/**\n * A DI configuration object containing html-specific (but environment-agnostic) registrations:\n * - `RuntimeConfiguration` from `@aurelia/runtime`\n * - `DefaultComponents`\n * - `DefaultResources`\n * - `DefaultRenderers`\n */\nexport const RuntimeHtmlConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return RuntimeConfiguration\n            .register(container)\n            .register(...DefaultComponents, ...DefaultResources, ...DefaultRenderers);\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\n//# sourceMappingURL=configuration.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Registration, DI } from '@aurelia/kernel';\nimport { IShadowDOMStyles, IShadowDOMGlobalStyles, AdoptedStyleSheetsStyles, StyleElementStyles } from './shadow-dom-styles';\nimport { HTMLDOM } from '../dom';\nimport { IDOM } from '@aurelia/runtime';\nexport function shadowCSS(...css) {\n    return new ShadowDOMRegistry(css);\n}\nconst factoryCache = new WeakMap();\nexport const IShadowDOMStyleFactory = DI.createInterface('IShadowDOMStyleFactory')\n    .withDefault(x => x.callback((handler, requestor, resolver) => {\n    let factory = factoryCache.get(resolver);\n    if (factory === void 0) {\n        factoryCache.set(resolver, factory = ShadowDOMRegistry.createStyleFactory(handler));\n    }\n    return factory;\n}));\nexport class ShadowDOMRegistry {\n    constructor(css) {\n        this.css = css;\n    }\n    register(container) {\n        const sharedStyles = container.get(IShadowDOMGlobalStyles);\n        const factory = container.get(IShadowDOMStyleFactory);\n        container.register(Registration.instance(IShadowDOMStyles, factory.createStyles(this.css, sharedStyles)));\n    }\n    static createStyleFactory(container) {\n        if (AdoptedStyleSheetsStyles.supported(container.get(HTMLDOM))) {\n            return container.get(AdoptedStyleSheetsStylesFactory);\n        }\n        return container.get(StyleElementStylesFactory);\n    }\n}\nlet AdoptedStyleSheetsStylesFactory = class AdoptedStyleSheetsStylesFactory {\n    constructor(dom) {\n        this.dom = dom;\n        this.cache = new Map();\n    }\n    createStyles(localStyles, sharedStyles) {\n        return new AdoptedStyleSheetsStyles(this.dom, localStyles, this.cache, sharedStyles);\n    }\n};\nAdoptedStyleSheetsStylesFactory = __decorate([\n    __param(0, IDOM),\n    __metadata(\"design:paramtypes\", [HTMLDOM])\n], AdoptedStyleSheetsStylesFactory);\nlet StyleElementStylesFactory = class StyleElementStylesFactory {\n    constructor(dom) {\n        this.dom = dom;\n    }\n    createStyles(localStyles, sharedStyles) {\n        if (localStyles.some(x => typeof x !== 'string')) {\n            // TODO: use reporter\n            throw new Error('Shadow DOM CSS must be a string.');\n        }\n        return new StyleElementStyles(this.dom, localStyles, sharedStyles);\n    }\n};\nStyleElementStylesFactory = __decorate([\n    __param(0, IDOM),\n    __metadata(\"design:paramtypes\", [HTMLDOM])\n], StyleElementStylesFactory);\n//# sourceMappingURL=shadow-dom-registry.js.map","import { DI, PLATFORM } from '@aurelia/kernel';\nconst defaultNow = PLATFORM.now.bind(PLATFORM);\nexport const Now = DI.createInterface('Now').withDefault(x => x.instance(defaultNow));\n//# sourceMappingURL=now.js.map","export var TaskQueuePriority;\n(function (TaskQueuePriority) {\n    TaskQueuePriority[TaskQueuePriority[\"microTask\"] = 0] = \"microTask\";\n    TaskQueuePriority[TaskQueuePriority[\"render\"] = 1] = \"render\";\n    TaskQueuePriority[TaskQueuePriority[\"macroTask\"] = 2] = \"macroTask\";\n    TaskQueuePriority[TaskQueuePriority[\"postRender\"] = 3] = \"postRender\";\n    TaskQueuePriority[TaskQueuePriority[\"idle\"] = 4] = \"idle\";\n})(TaskQueuePriority || (TaskQueuePriority = {}));\nexport const defaultQueueTaskOptions = {\n    delay: 0,\n    preempt: false,\n    priority: 1 /* render */,\n    persistent: false,\n    reusable: true,\n};\nlet $resolve;\nlet $reject;\nfunction executor(resolve, reject) {\n    $resolve = resolve;\n    $reject = reject;\n}\nexport function createExposedPromise() {\n    const p = new Promise(executor);\n    p.resolve = $resolve;\n    p.reject = $reject;\n    return p;\n}\n//# sourceMappingURL=types.js.map","import { createExposedPromise, } from './types';\nexport class TaskAbortError extends Error {\n    constructor(task) {\n        super('Task was canceled.');\n        this.task = task;\n    }\n}\nlet id = 0;\nexport class Task {\n    constructor(taskQueue, createdTime, queueTime, preempt, persistent, reusable, callback) {\n        this.taskQueue = taskQueue;\n        this.createdTime = createdTime;\n        this.queueTime = queueTime;\n        this.preempt = preempt;\n        this.persistent = persistent;\n        this.reusable = reusable;\n        this.callback = callback;\n        this.id = ++id;\n        this.next = void 0;\n        this.prev = void 0;\n        this.resolve = void 0;\n        this.reject = void 0;\n        this._result = void 0;\n        this._status = 'pending';\n        this.priority = taskQueue.priority;\n    }\n    get result() {\n        const result = this._result;\n        if (result === void 0) {\n            switch (this._status) {\n                case 'pending': {\n                    const promise = this._result = createExposedPromise();\n                    this.resolve = promise.resolve;\n                    this.reject = promise.reject;\n                    return promise;\n                }\n                case 'running':\n                    throw new Error('Trying to await task from within task will cause a deadlock.');\n                case 'completed':\n                    return this._result = Promise.resolve();\n                case 'canceled':\n                    return this._result = Promise.reject(new TaskAbortError(this));\n            }\n        }\n        return result;\n    }\n    get status() {\n        return this._status;\n    }\n    run() {\n        if (this._status !== 'pending') {\n            throw new Error(`Cannot run task in ${this._status} state`);\n        }\n        // this.persistent could be changed while the task is running (this can only be done by the task itself if canceled, and is a valid way of stopping a loop)\n        // so we deliberately reference this.persistent instead of the local variable, but we keep it around to know whether the task *was* persistent before running it,\n        // so we can set the correct cancelation state.\n        const persistent = this.persistent;\n        const reusable = this.reusable;\n        const taskQueue = this.taskQueue;\n        const callback = this.callback;\n        const resolve = this.resolve;\n        const reject = this.reject;\n        const createdTime = this.createdTime;\n        taskQueue.remove(this);\n        this._status = 'running';\n        try {\n            const ret = callback(taskQueue.now() - createdTime);\n            if (this.persistent) {\n                taskQueue.resetPersistentTask(this);\n            }\n            else if (persistent) {\n                // Persistent tasks never reach completed status. They're either pending, running, or canceled.\n                this._status = 'canceled';\n            }\n            else {\n                this._status = 'completed';\n            }\n            if (resolve !== void 0) {\n                resolve(ret);\n            }\n        }\n        catch (err) {\n            if (reject !== void 0) {\n                reject(err);\n            }\n            else {\n                throw err;\n            }\n        }\n        finally {\n            if (!this.persistent) {\n                this.dispose();\n                if (reusable) {\n                    taskQueue.returnToPool(this);\n                }\n            }\n        }\n    }\n    cancel() {\n        if (this._status === 'pending') {\n            const taskQueue = this.taskQueue;\n            const reusable = this.reusable;\n            const reject = this.reject;\n            taskQueue.remove(this);\n            if (taskQueue.isEmpty) {\n                taskQueue.cancel();\n            }\n            this._status = 'canceled';\n            if (reject !== void 0) {\n                reject(new TaskAbortError(this));\n            }\n            this.dispose();\n            if (reusable) {\n                taskQueue.returnToPool(this);\n            }\n            return true;\n        }\n        else if (this._status === 'running' && this.persistent) {\n            this.persistent = false;\n            return true;\n        }\n        return false;\n    }\n    reset(time) {\n        const delay = this.queueTime - this.createdTime;\n        this.createdTime = time;\n        this.queueTime = time + delay;\n        this._status = 'pending';\n        this.resolve = void 0;\n        this.reject = void 0;\n        this._result = void 0;\n    }\n    reuse(time, delay, preempt, persistent, callback) {\n        this.createdTime = time;\n        this.queueTime = time + delay;\n        this.preempt = preempt;\n        this.persistent = persistent;\n        this.callback = callback;\n        this._status = 'pending';\n    }\n    dispose() {\n        this.prev = void 0;\n        this.next = void 0;\n        this.callback = (void 0);\n        this.resolve = void 0;\n        this.reject = void 0;\n        this._result = void 0;\n    }\n}\n//# sourceMappingURL=task.js.map","import { createExposedPromise, defaultQueueTaskOptions, } from './types';\nimport { Task, } from './task';\nexport class TaskQueue {\n    constructor(now, priority, scheduler, flushRequestorFactory) {\n        this.now = now;\n        this.priority = priority;\n        this.scheduler = scheduler;\n        this.processingSize = 0;\n        this.processingHead = void 0;\n        this.processingTail = void 0;\n        this.pendingSize = 0;\n        this.pendingHead = void 0;\n        this.pendingTail = void 0;\n        this.delayedSize = 0;\n        this.delayedHead = void 0;\n        this.delayedTail = void 0;\n        this.flushRequested = false;\n        this.yieldPromise = void 0;\n        this.taskPool = [];\n        this.taskPoolSize = 0;\n        this.lastRequest = 0;\n        this.microTaskRequestFlushTask = null;\n        this.flushRequestor = flushRequestorFactory.create(this);\n        this.requestFlush = this.requestFlush.bind(this);\n    }\n    get isEmpty() {\n        return this.processingSize === 0 && this.pendingSize === 0 && this.delayedSize === 0;\n    }\n    flush() {\n        if (this.microTaskRequestFlushTask !== null) {\n            this.microTaskRequestFlushTask.cancel();\n            this.microTaskRequestFlushTask = null;\n        }\n        this.flushRequested = false;\n        if (this.pendingSize > 0) {\n            this.movePendingToProcessing();\n        }\n        if (this.delayedSize > 0) {\n            this.moveDelayedToProcessing();\n        }\n        while (this.processingSize > 0) {\n            this.processingHead.run();\n        }\n        if (this.pendingSize > 0) {\n            this.movePendingToProcessing();\n        }\n        if (this.delayedSize > 0) {\n            this.moveDelayedToProcessing();\n        }\n        if (this.processingSize > 0) {\n            this.requestFlush();\n        }\n        else if (this.delayedSize > 0) {\n            if (this.priority <= 0 /* microTask */) {\n                // MicroTasks are not clamped so we have to clamp them with setTimeout or they'll block forever\n                this.microTaskRequestFlushTask = this.scheduler.getTaskQueue(2 /* macroTask */).queueTask(this.requestFlush);\n            }\n            else {\n                // Otherwise just let this queue handle itself\n                this.requestFlush();\n            }\n        }\n        if (this.yieldPromise !== void 0) {\n            let noMoreFiniteWork = true;\n            let cur = this.processingHead;\n            while (cur !== void 0) {\n                if (!cur.persistent) {\n                    noMoreFiniteWork = false;\n                    break;\n                }\n                cur = cur.next;\n            }\n            if (noMoreFiniteWork) {\n                cur = this.pendingHead;\n                while (cur !== void 0) {\n                    if (!cur.persistent) {\n                        noMoreFiniteWork = false;\n                        break;\n                    }\n                    cur = cur.next;\n                }\n            }\n            if (noMoreFiniteWork) {\n                cur = this.delayedHead;\n                while (cur !== void 0) {\n                    if (!cur.persistent) {\n                        noMoreFiniteWork = false;\n                        break;\n                    }\n                    cur = cur.next;\n                }\n            }\n            if (noMoreFiniteWork) {\n                const p = this.yieldPromise;\n                this.yieldPromise = void 0;\n                p.resolve();\n            }\n        }\n    }\n    cancel() {\n        if (this.microTaskRequestFlushTask !== null) {\n            this.microTaskRequestFlushTask.cancel();\n            this.microTaskRequestFlushTask = null;\n        }\n        this.flushRequestor.cancel();\n        this.flushRequested = false;\n    }\n    async yield() {\n        if (this.processingSize > 0 || this.pendingSize > 0 || this.delayedSize > 0) {\n            if (this.yieldPromise === void 0) {\n                this.yieldPromise = createExposedPromise();\n            }\n            await this.yieldPromise;\n        }\n    }\n    queueTask(callback, opts) {\n        const { delay, preempt, persistent, reusable } = { ...defaultQueueTaskOptions, ...opts };\n        if (preempt) {\n            if (delay > 0) {\n                throw new Error(`Invalid arguments: preempt cannot be combined with a greater-than-zero delay`);\n            }\n            if (persistent) {\n                throw new Error(`Invalid arguments: preempt cannot be combined with persistent`);\n            }\n        }\n        if (persistent && this.priority === 0 /* microTask */) {\n            throw new Error(`Invalid arguments: cannot queue persistent tasks on the micro task queue`);\n        }\n        if (this.processingSize === 0) {\n            this.requestFlush();\n        }\n        const time = this.now();\n        let task;\n        if (reusable) {\n            const taskPool = this.taskPool;\n            const index = this.taskPoolSize - 1;\n            if (index >= 0) {\n                task = taskPool[index];\n                taskPool[index] = (void 0);\n                this.taskPoolSize = index;\n                task.reuse(time, delay, preempt, persistent, callback);\n            }\n            else {\n                task = new Task(this, time, time + delay, preempt, persistent, reusable, callback);\n            }\n        }\n        else {\n            task = new Task(this, time, time + delay, preempt, persistent, reusable, callback);\n        }\n        if (preempt) {\n            if (this.processingSize++ === 0) {\n                this.processingHead = this.processingTail = task;\n            }\n            else {\n                this.processingTail = (task.prev = this.processingTail).next = task;\n            }\n        }\n        else if (delay === 0) {\n            if (this.pendingSize++ === 0) {\n                this.pendingHead = this.pendingTail = task;\n            }\n            else {\n                this.pendingTail = (task.prev = this.pendingTail).next = task;\n            }\n        }\n        else {\n            if (this.delayedSize++ === 0) {\n                this.delayedHead = this.delayedTail = task;\n            }\n            else {\n                this.delayedTail = (task.prev = this.delayedTail).next = task;\n            }\n        }\n        return task;\n    }\n    take(task) {\n        if (task.status !== 'pending') {\n            throw new Error('Can only take pending tasks.');\n        }\n        if (this.processingSize === 0) {\n            this.requestFlush();\n        }\n        task.taskQueue.remove(task);\n        if (task.preempt) {\n            this.addToProcessing(task);\n        }\n        else if (task.queueTime <= this.now()) {\n            this.addToPending(task);\n        }\n        else {\n            this.addToDelayed(task);\n        }\n    }\n    remove(task) {\n        if (task.preempt) {\n            // Fast path - preempt task can only ever end up in the processing queue\n            this.removeFromProcessing(task);\n            return;\n        }\n        if (task.queueTime > this.now()) {\n            // Fast path - task with queueTime in the future can only ever be in the delayed queue\n            this.removeFromDelayed(task);\n            return;\n        }\n        // Scan everything (we can make this faster by using the queueTime property, but this is good enough for now)\n        let cur = this.processingHead;\n        while (cur !== void 0) {\n            if (cur === task) {\n                this.removeFromProcessing(task);\n                return;\n            }\n            cur = cur.next;\n        }\n        cur = this.pendingHead;\n        while (cur !== void 0) {\n            if (cur === task) {\n                this.removeFromPending(task);\n                return;\n            }\n            cur = cur.next;\n        }\n        cur = this.delayedHead;\n        while (cur !== void 0) {\n            if (cur === task) {\n                this.removeFromDelayed(task);\n                return;\n            }\n            cur = cur.next;\n        }\n        throw new Error(`Task #${task.id} could not be found`);\n    }\n    returnToPool(task) {\n        this.taskPool[this.taskPoolSize++] = task;\n    }\n    resetPersistentTask(task) {\n        task.reset(this.now());\n        if (task.createdTime === task.queueTime) {\n            if (this.pendingSize++ === 0) {\n                this.pendingHead = this.pendingTail = task;\n                task.prev = task.next = void 0;\n            }\n            else {\n                this.pendingTail = (task.prev = this.pendingTail).next = task;\n                task.next = void 0;\n            }\n        }\n        else {\n            if (this.delayedSize++ === 0) {\n                this.delayedHead = this.delayedTail = task;\n                task.prev = task.next = void 0;\n            }\n            else {\n                this.delayedTail = (task.prev = this.delayedTail).next = task;\n                task.next = void 0;\n            }\n        }\n    }\n    finish(task) {\n        if (task.next !== void 0) {\n            task.next.prev = task.prev;\n        }\n        if (task.prev !== void 0) {\n            task.prev.next = task.next;\n        }\n    }\n    removeFromProcessing(task) {\n        if (this.processingHead === task) {\n            this.processingHead = task.next;\n        }\n        if (this.processingTail === task) {\n            this.processingTail = task.prev;\n        }\n        --this.processingSize;\n        this.finish(task);\n    }\n    removeFromPending(task) {\n        if (this.pendingHead === task) {\n            this.pendingHead = task.next;\n        }\n        if (this.pendingTail === task) {\n            this.pendingTail = task.prev;\n        }\n        --this.pendingSize;\n        this.finish(task);\n    }\n    removeFromDelayed(task) {\n        if (this.delayedHead === task) {\n            this.delayedHead = task.next;\n        }\n        if (this.delayedTail === task) {\n            this.delayedTail = task.prev;\n        }\n        --this.delayedSize;\n        this.finish(task);\n    }\n    addToProcessing(task) {\n        if (this.processingSize++ === 0) {\n            this.processingHead = this.processingTail = task;\n        }\n        else {\n            this.processingTail = (task.prev = this.processingTail).next = task;\n        }\n    }\n    addToPending(task) {\n        if (this.pendingSize++ === 0) {\n            this.pendingHead = this.pendingTail = task;\n        }\n        else {\n            this.pendingTail = (task.prev = this.pendingTail).next = task;\n        }\n    }\n    addToDelayed(task) {\n        if (this.delayedSize++ === 0) {\n            this.delayedHead = this.delayedTail = task;\n        }\n        else {\n            this.delayedTail = (task.prev = this.delayedTail).next = task;\n        }\n    }\n    movePendingToProcessing() {\n        // Add the previously pending tasks to the currently processing tasks\n        if (this.processingSize === 0) {\n            this.processingHead = this.pendingHead;\n            this.processingTail = this.pendingTail;\n            this.processingSize = this.pendingSize;\n        }\n        else {\n            this.processingTail.next = this.pendingHead;\n            this.processingTail = this.pendingTail;\n            this.processingSize += this.pendingSize;\n        }\n        this.pendingHead = void 0;\n        this.pendingTail = void 0;\n        this.pendingSize = 0;\n    }\n    moveDelayedToProcessing() {\n        const time = this.now();\n        // Add any delayed tasks whose delay have expired to the currently processing tasks\n        const delayedHead = this.delayedHead;\n        if (delayedHead.queueTime <= time) {\n            let delayedTail = delayedHead;\n            let next = delayedTail.next;\n            let count = 1;\n            while (next !== void 0 && next.queueTime <= time) {\n                delayedTail = next;\n                next = delayedTail.next;\n                ++count;\n            }\n            if (this.processingSize === 0) {\n                this.processingHead = delayedHead;\n                this.processingTail = delayedTail;\n                this.processingSize = count;\n            }\n            else {\n                this.processingTail.next = delayedHead;\n                this.processingTail = delayedTail;\n                this.processingSize += count;\n            }\n            this.delayedHead = next;\n            this.delayedSize -= count;\n            if (this.delayedSize === 0) {\n                this.delayedTail = void 0;\n            }\n        }\n    }\n    requestFlush() {\n        if (this.microTaskRequestFlushTask !== null) {\n            this.microTaskRequestFlushTask.cancel();\n            this.microTaskRequestFlushTask = null;\n        }\n        if (!this.flushRequested) {\n            this.flushRequested = true;\n            this.lastRequest = this.now();\n            this.flushRequestor.request();\n        }\n    }\n}\n//# sourceMappingURL=task-queue.js.map","import { DI } from '@aurelia/kernel';\nimport { defaultQueueTaskOptions, } from './types';\nimport { TaskQueue, } from './task-queue';\nconst store = new WeakMap();\nexport const IScheduler = DI.createInterface('IScheduler').noDefault();\nexport class Scheduler {\n    constructor(now, microtaskFactory, renderFactory, macroTaskFactory, postRenderFactory, idleFactory) {\n        this.taskQueues = [\n            this.microtask = (new TaskQueue(now, 0 /* microTask */, this, microtaskFactory)),\n            this.render = (new TaskQueue(now, 1 /* render */, this, renderFactory)),\n            this.macroTask = (new TaskQueue(now, 2 /* macroTask */, this, macroTaskFactory)),\n            this.postRender = (new TaskQueue(now, 3 /* postRender */, this, postRenderFactory)),\n            this.idle = (new TaskQueue(now, 4 /* idle */, this, idleFactory)),\n        ];\n        this.yieldMicroTask = this.yieldMicroTask.bind(this);\n        this.yieldRenderTask = this.yieldRenderTask.bind(this);\n        this.yieldMacroTask = this.yieldMacroTask.bind(this);\n        this.yieldPostRenderTask = this.yieldPostRenderTask.bind(this);\n        this.yieldIdleTask = this.yieldIdleTask.bind(this);\n        this.yieldAll = this.yieldAll.bind(this);\n    }\n    static get(key) {\n        return store.get(key);\n    }\n    static set(key, instance) {\n        store.set(key, instance);\n    }\n    getTaskQueue(priority) {\n        return this.taskQueues[priority];\n    }\n    yield(priority) {\n        return this.taskQueues[priority].yield();\n    }\n    queueTask(callback, opts) {\n        const { delay, preempt, priority, persistent, reusable } = { ...defaultQueueTaskOptions, ...opts };\n        return this.taskQueues[priority].queueTask(callback, { delay, preempt, persistent, reusable });\n    }\n    getMicroTaskQueue() {\n        return this.microtask;\n    }\n    getRenderTaskQueue() {\n        return this.render;\n    }\n    getMacroTaskQueue() {\n        return this.macroTask;\n    }\n    getPostRenderTaskQueue() {\n        return this.postRender;\n    }\n    getIdleTaskQueue() {\n        return this.idle;\n    }\n    yieldMicroTask() {\n        return this.microtask.yield();\n    }\n    yieldRenderTask() {\n        return this.render.yield();\n    }\n    yieldMacroTask() {\n        return this.macroTask.yield();\n    }\n    yieldPostRenderTask() {\n        return this.postRender.yield();\n    }\n    yieldIdleTask() {\n        return this.idle.yield();\n    }\n    async yieldAll(repeat = 1) {\n        while (repeat-- > 0) {\n            await this.yieldIdleTask();\n            await this.yieldPostRenderTask();\n            await this.yieldMacroTask();\n            await this.yieldRenderTask();\n            await this.yieldMicroTask();\n        }\n    }\n    queueMicroTask(callback, opts) {\n        return this.microtask.queueTask(callback, opts);\n    }\n    queueRenderTask(callback, opts) {\n        return this.render.queueTask(callback, opts);\n    }\n    queueMacroTask(callback, opts) {\n        return this.macroTask.queueTask(callback, opts);\n    }\n    queuePostRenderTask(callback, opts) {\n        return this.postRender.queueTask(callback, opts);\n    }\n    queueIdleTask(callback, opts) {\n        return this.idle.queueTask(callback, opts);\n    }\n}\n//# sourceMappingURL=scheduler.js.map","function $noop() { return; }\nconst $global = (function () {\n    if (typeof global !== 'undefined') {\n        return global;\n    }\n    if (typeof self !== 'undefined') {\n        return self;\n    }\n    if (typeof window !== 'undefined') {\n        return window;\n    }\n    try {\n        // Not all environments allow eval and Function. Use only as a last resort:\n        // eslint-disable-next-line no-new-func\n        return new Function('return this')();\n    }\n    catch (_a) {\n        // If all fails, give up and create an object.\n        // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n        return {};\n    }\n})();\nconst isBrowserLike = (typeof window !== 'undefined'\n    && typeof window.document !== 'undefined');\nconst isWebWorkerLike = (typeof self === 'object'\n    && self.constructor != null\n    && self.constructor.name === 'DedicatedWorkerGlobalScope');\nconst isNodeLike = (typeof process !== 'undefined'\n    && process.versions != null\n    && process.versions.node != null);\n// performance.now polyfill for non-browser envs based on https://github.com/myrne/performance-now\nconst $now = (function () {\n    var _a, _b;\n    let getNanoSeconds;\n    let hrtime;\n    let moduleLoadTime;\n    let nodeLoadTime;\n    let upTime;\n    if (((_a = $global.performance) === null || _a === void 0 ? void 0 : _a.now) != null) {\n        const $performance = $global.performance;\n        return function () {\n            return $performance.now();\n        };\n    }\n    else if (((_b = $global.process) === null || _b === void 0 ? void 0 : _b.hrtime) != null) {\n        const now = function () {\n            return (getNanoSeconds() - nodeLoadTime) / 1e6;\n        };\n        hrtime = $global.process.hrtime;\n        getNanoSeconds = function () {\n            const hr = hrtime();\n            return hr[0] * 1e9 + hr[1];\n        };\n        moduleLoadTime = getNanoSeconds();\n        upTime = $global.process.uptime() * 1e9;\n        nodeLoadTime = moduleLoadTime - upTime;\n        return now;\n    }\n    else {\n        const now = function () {\n            return Date.now() - nodeLoadTime;\n        };\n        nodeLoadTime = Date.now();\n        return now;\n    }\n})();\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\nconst emptyArray = Object.freeze([]);\nconst emptyObject = Object.freeze({});\nconst $PLATFORM = {\n    /**\n     * `true` if there is a `window` variable in the global scope with a `document` property.\n     *\n     * NOTE: this does not guarantee that the code is actually running in a browser, as some libraries tamper with globals.\n     * The only conclusion that can be drawn is that the `window` global is available and likely behaves similar to how it would in a browser.\n     */\n    isBrowserLike,\n    /**\n     * `true` if there is a `self` variable (of type `object`) in the global scope with constructor name `'DedicatedWorkerGlobalScope'`.\n     *\n     * NOTE: this does not guarantee that the code is actually running in a web worker, as some libraries tamper with globals.\n     * The only conclusion that can be drawn is that the `self` global is available and likely behaves similar to how it would in a web worker.\n     */\n    isWebWorkerLike,\n    /**\n     * `true` if there is a `process` variable in the global scope with a `versions` property which has a `node` property.\n     *\n     * NOTE: this is not a guarantee that the code is actually running in nodejs, as some libraries tamper with globals.\n     * The only conclusion that can be drawn is that the `process` global is available and likely behaves similar to how it would in nodejs.\n     */\n    isNodeLike,\n    global: $global,\n    emptyArray,\n    emptyObject,\n    noop: $noop,\n    now: $now,\n    hasOwnProperty,\n    restore() {\n        Object.assign(PLATFORM, $PLATFORM);\n    },\n};\nexport const PLATFORM = { ...$PLATFORM };\n//# sourceMappingURL=platform.js.map","import * as AST from '@aurelia/runtime';\nconst astTypeMap = [\n    { type: AST.AccessKeyedExpression, name: 'AccessKeyedExpression' },\n    { type: AST.AccessMemberExpression, name: 'AccessMemberExpression' },\n    { type: AST.AccessScopeExpression, name: 'AccessScopeExpression' },\n    { type: AST.AccessThisExpression, name: 'AccessThisExpression' },\n    { type: AST.ArrayBindingPattern, name: 'ArrayBindingPattern' },\n    { type: AST.ArrayLiteralExpression, name: 'ArrayLiteralExpression' },\n    { type: AST.AssignExpression, name: 'AssignExpression' },\n    { type: AST.BinaryExpression, name: 'BinaryExpression' },\n    { type: AST.BindingBehaviorExpression, name: 'BindingBehaviorExpression' },\n    { type: AST.BindingIdentifier, name: 'BindingIdentifier' },\n    { type: AST.CallFunctionExpression, name: 'CallFunctionExpression' },\n    { type: AST.CallMemberExpression, name: 'CallMemberExpression' },\n    { type: AST.CallScopeExpression, name: 'CallScopeExpression' },\n    { type: AST.ConditionalExpression, name: 'ConditionalExpression' },\n    { type: AST.ForOfStatement, name: 'ForOfStatement' },\n    { type: AST.HtmlLiteralExpression, name: 'HtmlLiteralExpression' },\n    { type: AST.Interpolation, name: 'Interpolation' },\n    { type: AST.ObjectBindingPattern, name: 'ObjectBindingPattern' },\n    { type: AST.ObjectLiteralExpression, name: 'ObjectLiteralExpression' },\n    { type: AST.PrimitiveLiteralExpression, name: 'PrimitiveLiteralExpression' },\n    { type: AST.TaggedTemplateExpression, name: 'TaggedTemplateExpression' },\n    { type: AST.TemplateExpression, name: 'TemplateExpression' },\n    { type: AST.UnaryExpression, name: 'UnaryExpression' },\n    { type: AST.ValueConverterExpression, name: 'ValueConverterExpression' }\n];\nexport function enableImprovedExpressionDebugging() {\n    astTypeMap.forEach(x => { adoptDebugMethods(x.type, x.name); });\n}\n/** @internal */\nexport function adoptDebugMethods($type, name) {\n    $type.prototype.toString = function () { return Unparser.unparse(this); };\n}\nexport class Unparser {\n    constructor() {\n        this.text = '';\n    }\n    static unparse(expr) {\n        const visitor = new Unparser();\n        expr.accept(visitor);\n        return visitor.text;\n    }\n    visitAccessMember(expr) {\n        expr.object.accept(this);\n        this.text += `.${expr.name}`;\n    }\n    visitAccessKeyed(expr) {\n        expr.object.accept(this);\n        this.text += '[';\n        expr.key.accept(this);\n        this.text += ']';\n    }\n    visitAccessThis(expr) {\n        if (expr.ancestor === 0) {\n            this.text += '$this';\n            return;\n        }\n        this.text += '$parent';\n        let i = expr.ancestor - 1;\n        while (i--) {\n            this.text += '.$parent';\n        }\n    }\n    visitAccessScope(expr) {\n        let i = expr.ancestor;\n        while (i--) {\n            this.text += '$parent.';\n        }\n        this.text += expr.name;\n    }\n    visitArrayLiteral(expr) {\n        const elements = expr.elements;\n        this.text += '[';\n        for (let i = 0, length = elements.length; i < length; ++i) {\n            if (i !== 0) {\n                this.text += ',';\n            }\n            elements[i].accept(this);\n        }\n        this.text += ']';\n    }\n    visitObjectLiteral(expr) {\n        const keys = expr.keys;\n        const values = expr.values;\n        this.text += '{';\n        for (let i = 0, length = keys.length; i < length; ++i) {\n            if (i !== 0) {\n                this.text += ',';\n            }\n            this.text += `'${keys[i]}':`;\n            values[i].accept(this);\n        }\n        this.text += '}';\n    }\n    visitPrimitiveLiteral(expr) {\n        this.text += '(';\n        if (typeof expr.value === 'string') {\n            const escaped = expr.value.replace(/'/g, '\\\\\\'');\n            this.text += `'${escaped}'`;\n        }\n        else {\n            this.text += `${expr.value}`;\n        }\n        this.text += ')';\n    }\n    visitCallFunction(expr) {\n        this.text += '(';\n        expr.func.accept(this);\n        this.writeArgs(expr.args);\n        this.text += ')';\n    }\n    visitCallMember(expr) {\n        this.text += '(';\n        expr.object.accept(this);\n        this.text += `.${expr.name}`;\n        this.writeArgs(expr.args);\n        this.text += ')';\n    }\n    visitCallScope(expr) {\n        this.text += '(';\n        let i = expr.ancestor;\n        while (i--) {\n            this.text += '$parent.';\n        }\n        this.text += expr.name;\n        this.writeArgs(expr.args);\n        this.text += ')';\n    }\n    visitTemplate(expr) {\n        const { cooked, expressions } = expr;\n        const length = expressions.length;\n        this.text += '`';\n        this.text += cooked[0];\n        for (let i = 0; i < length; i++) {\n            expressions[i].accept(this);\n            this.text += cooked[i + 1];\n        }\n        this.text += '`';\n    }\n    visitTaggedTemplate(expr) {\n        const { cooked, expressions } = expr;\n        const length = expressions.length;\n        expr.func.accept(this);\n        this.text += '`';\n        this.text += cooked[0];\n        for (let i = 0; i < length; i++) {\n            expressions[i].accept(this);\n            this.text += cooked[i + 1];\n        }\n        this.text += '`';\n    }\n    visitUnary(expr) {\n        this.text += `(${expr.operation}`;\n        if (expr.operation.charCodeAt(0) >= /* a */ 97) {\n            this.text += ' ';\n        }\n        expr.expression.accept(this);\n        this.text += ')';\n    }\n    visitBinary(expr) {\n        this.text += '(';\n        expr.left.accept(this);\n        if (expr.operation.charCodeAt(0) === /* i */ 105) {\n            this.text += ` ${expr.operation} `;\n        }\n        else {\n            this.text += expr.operation;\n        }\n        expr.right.accept(this);\n        this.text += ')';\n    }\n    visitConditional(expr) {\n        this.text += '(';\n        expr.condition.accept(this);\n        this.text += '?';\n        expr.yes.accept(this);\n        this.text += ':';\n        expr.no.accept(this);\n        this.text += ')';\n    }\n    visitAssign(expr) {\n        this.text += '(';\n        expr.target.accept(this);\n        this.text += '=';\n        expr.value.accept(this);\n        this.text += ')';\n    }\n    visitValueConverter(expr) {\n        const args = expr.args;\n        expr.expression.accept(this);\n        this.text += `|${expr.name}`;\n        for (let i = 0, length = args.length; i < length; ++i) {\n            this.text += ':';\n            args[i].accept(this);\n        }\n    }\n    visitBindingBehavior(expr) {\n        const args = expr.args;\n        expr.expression.accept(this);\n        this.text += `&${expr.name}`;\n        for (let i = 0, length = args.length; i < length; ++i) {\n            this.text += ':';\n            args[i].accept(this);\n        }\n    }\n    visitArrayBindingPattern(expr) {\n        const elements = expr.elements;\n        this.text += '[';\n        for (let i = 0, length = elements.length; i < length; ++i) {\n            if (i !== 0) {\n                this.text += ',';\n            }\n            elements[i].accept(this);\n        }\n        this.text += ']';\n    }\n    visitObjectBindingPattern(expr) {\n        const keys = expr.keys;\n        const values = expr.values;\n        this.text += '{';\n        for (let i = 0, length = keys.length; i < length; ++i) {\n            if (i !== 0) {\n                this.text += ',';\n            }\n            this.text += `'${keys[i]}':`;\n            values[i].accept(this);\n        }\n        this.text += '}';\n    }\n    visitBindingIdentifier(expr) {\n        this.text += expr.name;\n    }\n    visitHtmlLiteral(expr) { throw new Error('visitHtmlLiteral'); }\n    visitForOfStatement(expr) {\n        expr.declaration.accept(this);\n        this.text += ' of ';\n        expr.iterable.accept(this);\n    }\n    visitInterpolation(expr) {\n        const { parts, expressions } = expr;\n        const length = expressions.length;\n        this.text += '${';\n        this.text += parts[0];\n        for (let i = 0; i < length; i++) {\n            expressions[i].accept(this);\n            this.text += parts[i + 1];\n        }\n        this.text += '}';\n    }\n    writeArgs(args) {\n        this.text += '(';\n        for (let i = 0, length = args.length; i < length; ++i) {\n            if (i !== 0) {\n                this.text += ',';\n            }\n            args[i].accept(this);\n        }\n        this.text += ')';\n    }\n}\n//# sourceMappingURL=unparser.js.map","import { Reporter as RuntimeReporter } from '@aurelia/kernel';\nfunction applyFormat(message, ...params) {\n    while (message.includes('%s')) {\n        message = message.replace('%s', String(params.shift()));\n    }\n    return message;\n}\nexport const Reporter = {\n    ...RuntimeReporter,\n    get level() {\n        return RuntimeReporter.level;\n    },\n    write(code, ...params) {\n        const info = getMessageInfoForCode(code);\n        const message = `Code ${code}: ${info.message}`;\n        switch (info.level) {\n            case 1 /* debug */:\n                if (this.level <= 1 /* debug */) {\n                    console.debug(message, ...params);\n                }\n                break;\n            case 2 /* info */:\n                if (this.level <= 2 /* info */) {\n                    console.info(message, ...params);\n                }\n                break;\n            case 3 /* warn */:\n                if (this.level <= 3 /* warn */) {\n                    console.warn(message, ...params);\n                }\n                break;\n            case 4 /* error */: {\n                throw this.error(code, ...params);\n            }\n        }\n    },\n    error(code, ...params) {\n        const info = getMessageInfoForCode(code);\n        const error = new Error(`Code ${code}: ${applyFormat(info.message, ...params)}`);\n        error.data = params;\n        return error;\n    }\n};\nfunction getMessageInfoForCode(code) {\n    const info = codeLookup[code];\n    return info !== undefined ? info : createInvalidCodeMessageInfo(code);\n}\nfunction createInvalidCodeMessageInfo(code) {\n    return {\n        level: 4 /* error */,\n        message: `Attempted to report with unknown code ${code}.`\n    };\n}\nconst codeLookup = {\n    0: {\n        level: 3 /* warn */,\n        message: 'Cannot add observers to object.'\n    },\n    1: {\n        level: 3 /* warn */,\n        message: 'Cannot observe property of object.'\n    },\n    2: {\n        level: 2 /* info */,\n        message: 'Starting application in debug mode.'\n    },\n    3: {\n        level: 4 /* error */,\n        message: 'Runtime expression compilation is only available when including JIT support.'\n    },\n    4: {\n        level: 4 /* error */,\n        message: 'Invalid animation direction.'\n    },\n    5: {\n        level: 4 /* error */,\n        message: 'key/value cannot be null or undefined. Are you trying to inject/register something that doesn\\'t exist with DI?'\n    },\n    6: {\n        level: 4 /* error */,\n        message: 'Invalid resolver strategy specified.'\n    },\n    7: {\n        level: 4 /* error */,\n        message: 'Constructor Parameter with index cannot be null or undefined. Are you trying to inject/register something that doesn\\'t exist with DI?'\n    },\n    8: {\n        level: 4 /* error */,\n        message: 'Self binding behavior only supports events.'\n    },\n    9: {\n        level: 4 /* error */,\n        message: 'The updateTrigger binding behavior requires at least one event name argument: eg <input value.bind=\"firstName & updateTrigger:\\'blur\\'\">'\n    },\n    10: {\n        level: 4 /* error */,\n        message: 'The updateTrigger binding behavior can only be applied to two-way/ from-view bindings on input/select elements.'\n    },\n    11: {\n        level: 4 /* error */,\n        message: 'Only property bindings and string interpolation bindings can be signaled. Trigger, delegate and call bindings cannot be signaled.'\n    },\n    12: {\n        level: 4 /* error */,\n        message: 'Signal name is required.'\n    },\n    14: {\n        level: 4 /* error */,\n        message: 'Property cannot be assigned.'\n    },\n    15: {\n        level: 4 /* error */,\n        message: 'Unexpected call context.'\n    },\n    16: {\n        level: 4 /* error */,\n        message: 'A dependency registration is missing for the interface %s.'\n    },\n    17: {\n        level: 4 /* error */,\n        message: 'You can only define one default implementation for an interface.'\n    },\n    18: {\n        level: 4 /* error */,\n        message: 'You cannot observe a setter only property.'\n    },\n    19: {\n        level: 4 /* error */,\n        message: 'Value for expression is non-repeatable.'\n    },\n    20: {\n        level: 4 /* error */,\n        message: 'No template compiler found with the specified name. JIT support or a custom compiler is required.'\n    },\n    21: {\n        level: 4 /* error */,\n        message: 'You cannot combine the containerless custom element option with Shadow DOM.'\n    },\n    22: {\n        level: 4 /* error */,\n        message: 'A containerless custom element cannot be the root component of an application.'\n    },\n    30: {\n        level: 4 /* error */,\n        message: 'There are more targets than there are target instructions.'\n    },\n    31: {\n        level: 4 /* error */,\n        message: 'There are more target instructions than there are targets.'\n    },\n    100: {\n        level: 4 /* error */,\n        message: 'Invalid start of expression.'\n    },\n    101: {\n        level: 4 /* error */,\n        message: 'Unconsumed token.'\n    },\n    102: {\n        level: 4 /* error */,\n        message: 'Double dot and spread operators are not supported.'\n    },\n    103: {\n        level: 4 /* error */,\n        message: 'Invalid member expression.'\n    },\n    104: {\n        level: 4 /* error */,\n        message: 'Unexpected end of expression.'\n    },\n    105: {\n        level: 4 /* error */,\n        message: 'Expected identifier.'\n    },\n    106: {\n        level: 4 /* error */,\n        message: 'Invalid BindingIdentifier at left hand side of \"of\".'\n    },\n    107: {\n        level: 4 /* error */,\n        message: 'Invalid or unsupported property definition in object literal.'\n    },\n    108: {\n        level: 4 /* error */,\n        message: 'Unterminated quote in string literal.'\n    },\n    109: {\n        level: 4 /* error */,\n        message: 'Unterminated template string.'\n    },\n    110: {\n        level: 4 /* error */,\n        message: 'Missing expected token.'\n    },\n    111: {\n        level: 4 /* error */,\n        message: 'Unexpected character.'\n    },\n    150: {\n        level: 4 /* error */,\n        message: 'Left hand side of expression is not assignable.'\n    },\n    151: {\n        level: 4 /* error */,\n        message: 'Unexpected keyword \"of\"'\n    },\n    401: {\n        level: 3 /* warn */,\n        message: `AttributePattern is missing a handler for '%s'.`\n    },\n    402: {\n        level: 3 /* warn */,\n        message: `AttributePattern handler for '%s' is not a function.`\n    },\n    800: {\n        level: 4 /* error */,\n        message: `Property '%s' is being dirty-checked.`\n    },\n    801: {\n        level: 3 /* warn */,\n        message: `Property '%s' is being dirty-checked.`\n    },\n    2000: {\n        level: 4 /* error */,\n        message: 'Router has not been activated.'\n    },\n    2001: {\n        level: 4 /* error */,\n        message: 'Router has already been activated.'\n    },\n    2002: {\n        level: 4 /* error */,\n        message: 'Failed to resolve all viewports.'\n    },\n    2003: {\n        level: 4 /* error */,\n        message: 'Browser navigation has already been activated.'\n    },\n    2004: {\n        level: 4 /* error */,\n        message: 'LinkHandler has already been activated.'\n    },\n    1001: {\n        level: 2 /* info */,\n        message: 'DOM already initialized. Destroying and re-initializing..'\n    },\n    10000: {\n        level: 1 /* debug */,\n        message: '%s'\n    }\n};\n//# sourceMappingURL=reporter.js.map","import { PLATFORM, Reporter, Tracer } from '@aurelia/kernel';\nconst marker = {\n    objName: 'marker',\n    methodName: 'noop',\n    params: PLATFORM.emptyArray,\n    depth: -1,\n    prev: null,\n    next: null\n};\nclass TraceInfo {\n    constructor(objName, methodName, params) {\n        this.objName = objName;\n        this.methodName = methodName;\n        this.params = params;\n        this.objName = objName;\n        this.methodName = methodName;\n        this.depth = TraceInfo.stack.length;\n        this.params = params;\n        this.next = marker;\n        this.prev = TraceInfo.tail;\n        TraceInfo.tail.next = this;\n        TraceInfo.tail = this;\n        TraceInfo.stack.push(this);\n    }\n    static reset() {\n        let current = TraceInfo.head;\n        let next = null;\n        while (current != null) {\n            next = current.next;\n            current.next = null;\n            current.prev = null;\n            current.params = null;\n            current = next;\n        }\n        TraceInfo.head = marker;\n        TraceInfo.tail = marker;\n        TraceInfo.stack = [];\n    }\n    static enter(objName, methodName, params) {\n        return new TraceInfo(objName, methodName, params);\n    }\n    static leave() {\n        return TraceInfo.stack.pop();\n    }\n}\nTraceInfo.head = marker;\nTraceInfo.tail = marker;\nTraceInfo.stack = [];\nexport const DebugTracer = {\n    ...Tracer,\n    /**\n     * A convenience property for the user to conditionally call the tracer.\n     * This saves unnecessary `noop` and `slice` calls in non-AOT scenarios even if debugging is disabled.\n     * In AOT these calls will simply be removed entirely.\n     *\n     * This property **only** turns on tracing if `@aurelia/debug` is included and configured as well.\n     */\n    enabled: false,\n    liveLoggingEnabled: false,\n    liveWriter: null,\n    /**\n     * Call this at the start of a method/function.\n     * Each call to `enter` **must** have an accompanying call to `leave` for the tracer to work properly.\n     *\n     * @param objName - Any human-friendly name to identify the traced object with.\n     * @param methodName - Any human-friendly name to identify the traced method with.\n     * @param args - Pass in `Array.prototype.slice.call(arguments)` to also trace the parameters, or `null` if this is not needed (to save memory/cpu)\n     */\n    enter(objName, methodName, args) {\n        if (this.enabled) {\n            const info = TraceInfo.enter(objName, methodName, args);\n            if (this.liveLoggingEnabled) {\n                this.liveWriter.write(info);\n            }\n        }\n    },\n    /**\n     * Call this at the end of a method/function. Pops one trace item off the stack.\n     */\n    leave() {\n        if (this.enabled) {\n            TraceInfo.leave();\n        }\n    },\n    /**\n     * Writes only the trace info leading up to the current method call.\n     *\n     * @param writer - An object to write the output to.\n     */\n    writeStack(writer) {\n        let i = 0;\n        const stack = TraceInfo.stack;\n        const len = stack.length;\n        while (i < len) {\n            writer.write(stack[i]);\n            ++i;\n        }\n    },\n    /**\n     * Writes all trace info captured since the previous flushAll operation.\n     *\n     * @param writer - An object to write the output to. Can be null to simply reset the tracer state.\n     */\n    flushAll(writer) {\n        if (writer != null) {\n            let current = TraceInfo.head.next; // skip the marker\n            while (current != null && current !== marker) {\n                writer.write(current);\n                current = current.next;\n            }\n        }\n        TraceInfo.reset();\n    },\n    enableLiveLogging,\n    /**\n     * Stops writing out each trace info item as they are traced.\n     */\n    disableLiveLogging() {\n        this.liveLoggingEnabled = false;\n        this.liveWriter = null;\n    }\n};\nconst defaultOptions = {\n    rendering: true,\n    binding: true,\n    observation: true,\n    beforeAttach: true,\n    mounting: true,\n    di: true,\n    lifecycle: true,\n    jit: true\n};\nfunction enableLiveLogging(optionsOrWriter) {\n    this.liveLoggingEnabled = true;\n    if (optionsOrWriter && 'write' in optionsOrWriter) {\n        this.liveWriter = optionsOrWriter;\n    }\n    else {\n        const options = optionsOrWriter !== undefined ? optionsOrWriter : defaultOptions;\n        this.liveWriter = createLiveTraceWriter(options);\n    }\n}\nconst toString = Object.prototype.toString;\nfunction flagsText(info, i = 0) {\n    if (info.params != null && info.params.length > i) {\n        return stringifyLifecycleFlags(info.params[i]);\n    }\n    return 'none';\n}\nfunction _ctorName(obj) {\n    let name;\n    if (obj === undefined) {\n        name = 'undefined';\n    }\n    else if (obj === null) {\n        name = 'null';\n    }\n    else if (obj.constructor !== undefined) {\n        if (obj.constructor.description) {\n            name = `Resource{'${obj.constructor.description.name}'}`;\n        }\n        else {\n            name = obj.constructor.name;\n        }\n    }\n    else if (typeof obj === 'string') {\n        name = `'${obj}'`;\n    }\n    else {\n        name = toString.call(obj);\n    }\n    return name;\n}\nfunction ctorName(info, i = 0) {\n    if (info.params != null && info.params.length > i) {\n        return _ctorName(info.params[i]);\n    }\n    return 'undefined';\n}\nfunction scopeText(info, i = 0) {\n    let $ctorName;\n    if (info.params != null && info.params.length > i) {\n        const $scope = info.params[i];\n        if ($scope != null && $scope.bindingContext != null) {\n            $ctorName = _ctorName($scope.bindingContext);\n        }\n        else {\n            $ctorName = 'undefined';\n        }\n        return `Scope{${$ctorName}}`;\n    }\n    return 'undefined';\n}\nfunction keyText(info, i = 0) {\n    if (info.params != null && info.params.length > i) {\n        const $key = info.params[i];\n        if (typeof $key === 'string') {\n            return `'${$key}'`;\n        }\n        if ($key !== undefined && Reflect.has($key, 'friendlyName')) {\n            return $key['friendlyName'];\n        }\n        return _ctorName($key);\n    }\n    return 'undefined';\n}\nfunction primitive(info, i = 0) {\n    if (info.params != null && info.params.length > i) {\n        const $key = info.params[i];\n        if (typeof $key === 'string') {\n            return `'${$key}'`;\n        }\n        return $key.toString();\n    }\n    return 'undefined';\n}\nconst RenderingArgsProcessor = {\n    $hydrate(info) {\n        return flagsText(info);\n    },\n    render(info) {\n        return `${flagsText(info)},IDOM,IContainer,${ctorName(info, 3)}`;\n    },\n    addBinding(info) {\n        return `${ctorName(info)},${ctorName(info, 1)}`;\n    },\n    addComponent(info) {\n        return `${ctorName(info)},${ctorName(info, 1)}`;\n    }\n};\nconst BindingArgsProcessor = {\n    $bind(info) {\n        return flagsText(info);\n    },\n    $unbind(info) {\n        return flagsText(info);\n    },\n    connect(info) {\n        return flagsText(info);\n    },\n    // currently only observers trace constructor calls but keep an eye on this if others are added, then we'd need additional filtering\n    constructor(info) {\n        switch (info.objName) {\n            case 'ArrayObserver':\n            case 'MapObserver':\n            case 'SetObserver':\n                return flagsText(info);\n            case 'SetterObserver':\n            case 'BindableObserver':\n                return `${flagsText(info)},${ctorName(info, 1)},${primitive(info, 2)}`;\n            case 'ProxyObserver':\n                return ctorName(info);\n            case 'ProxySubscriberCollection':\n            case 'DirtyCheckProperty':\n                return `${ctorName(info, 1)},${primitive(info, 2)}`;\n            case 'PrimitiveObserver':\n            case 'PropertyAccessor':\n                return `${ctorName(info)},${primitive(info, 1)}`;\n            default:\n                return '';\n        }\n    },\n    lockedBind(info) {\n        return flagsText(info);\n    },\n    lockedUnbind(info) {\n        return flagsText(info);\n    },\n    InternalObserversLookup(info) {\n        return `${flagsText(info)},${ctorName(info, 1)},${primitive(info, 2)}`;\n    },\n    BindingContext(info) {\n        switch (info.methodName) {\n            case 'get':\n                return `${scopeText(info)},${primitive(info, 1)},${primitive(info, 2)},${flagsText(info, 3)}`;\n            case 'getObservers':\n                return flagsText(info);\n            default:\n                return 'unknown';\n        }\n    },\n    Scope(info) {\n        switch (info.methodName) {\n            case 'create':\n                return `${flagsText(info)},${ctorName(info, 1)},${ctorName(info, 2)}`;\n            case 'fromOverride':\n                return `${flagsText(info)},${ctorName(info, 1)}`;\n            case 'fromParent':\n                return `${flagsText(info)},${scopeText(info, 1)},${ctorName(info, 2)}`;\n            default:\n                return 'unknown';\n        }\n    },\n    OverrideContext(info) {\n        switch (info.methodName) {\n            case 'create':\n                return `${flagsText(info)},${ctorName(info, 1)},${ctorName(info, 2)}`;\n            case 'getObservers':\n                return '';\n            default:\n                return 'unknown';\n        }\n    }\n};\nconst ObservationArgsProcessor = {\n    callSource(info) {\n        const names = [];\n        switch (info.objName) {\n            case 'Listener':\n                return (info.params[0]).type;\n            case 'CallBinding':\n                if (info.params != null) {\n                    for (let i = 0, ii = info.params.length; i < ii; ++i) {\n                        names.push(ctorName(info, i));\n                    }\n                }\n                return names.join(',');\n            default:\n                return 'unknown';\n        }\n    },\n    setValue(info) {\n        let valueText;\n        const value = info.params[0];\n        switch (typeof value) {\n            case 'undefined':\n                valueText = 'undefined';\n                break;\n            case 'object':\n                if (value === null) {\n                    valueText = 'null';\n                }\n                else {\n                    valueText = _ctorName(value);\n                }\n                break;\n            case 'string':\n                valueText = `'${value}'`;\n                break;\n            case 'number':\n                valueText = value.toString();\n                break;\n            default:\n                valueText = _ctorName(value);\n        }\n        return `${valueText},${flagsText(info, 1)}`;\n    },\n    flush(info) {\n        return flagsText(info);\n    },\n    handleChange(info) {\n        return `${primitive(info)},${primitive(info, 1)},${flagsText(info, 2)}`;\n    },\n    lockScope(info) {\n        return scopeText(info);\n    }\n};\nconst AttachingArgsProcessor = {\n    $attach(info) {\n        return flagsText(info);\n    },\n    $detach(info) {\n        return flagsText(info);\n    },\n    $cache(info) {\n        return flagsText(info);\n    },\n    hold(info) {\n        return `Node{'${(info.params[0]).textContent}'}`;\n    },\n    release(info) {\n        return flagsText(info);\n    }\n};\nconst MountingArgsProcessor = {\n    $mount(info) {\n        return flagsText(info);\n    },\n    $unmount(info) {\n        return flagsText(info);\n    },\n    project(info) {\n        return ctorName(info);\n    },\n    take(info) {\n        return ctorName(info);\n    }\n};\nconst DIArgsProcessor = {\n    construct(info) {\n        return ctorName(info);\n    },\n    Container(info) {\n        const names = [];\n        switch (info.methodName) {\n            case 'get':\n            case 'getAll':\n                return keyText(info);\n            case 'register':\n                if (info.params != null) {\n                    for (let i = 0, ii = info.params.length; i < ii; ++i) {\n                        names.push(keyText(info, i));\n                    }\n                }\n                return names.join(',');\n            case 'createChild':\n                return '';\n            default:\n                return 'unknown';\n        }\n    }\n};\nconst LifecycleArgsProcessor = {\n    Lifecycle(info) {\n        switch (info.methodName.slice(0, 3)) {\n            case 'beg':\n                return '';\n            case 'enq':\n                return ctorName(info);\n            case 'end':\n            case 'pro':\n                return flagsText(info);\n            default:\n                return 'unknown';\n        }\n    },\n    CompositionCoordinator(info) {\n        switch (info.methodName) {\n            case 'enqueue':\n                return 'IController';\n            case 'swap':\n                return `IController,${flagsText(info, 1)}`;\n            case 'processNext':\n                return '';\n            default:\n                return 'unknown';\n        }\n    },\n    AggregateLifecycleTask(info) {\n        switch (info.methodName) {\n            case 'addTask':\n            case 'removeTask':\n                return ctorName(info);\n            case 'complete':\n                return `${primitive(info, 2)}`;\n            default:\n                return 'unknown';\n        }\n    }\n};\nconst JitArgsProcessor = {\n    TemplateBinder(info) {\n        return ''; // TODO\n    }\n};\nfunction createLiveTraceWriter(options) {\n    const Processors = {};\n    if (options.rendering) {\n        Object.assign(Processors, RenderingArgsProcessor);\n    }\n    if (options.binding) {\n        Object.assign(Processors, BindingArgsProcessor);\n    }\n    if (options.observation) {\n        Object.assign(Processors, ObservationArgsProcessor);\n    }\n    if (options.beforeAttach) {\n        Object.assign(Processors, AttachingArgsProcessor);\n    }\n    if (options.mounting) {\n        Object.assign(Processors, MountingArgsProcessor);\n    }\n    if (options.di) {\n        Object.assign(Processors, DIArgsProcessor);\n    }\n    if (options.lifecycle) {\n        Object.assign(Processors, LifecycleArgsProcessor);\n    }\n    if (options.jit) {\n        Object.assign(Processors, JitArgsProcessor);\n    }\n    return {\n        write(info) {\n            let output;\n            if (Processors[info.methodName] !== undefined) {\n                output = Processors[info.methodName](info);\n            }\n            else if (Processors[info.objName] !== undefined) {\n                output = Processors[info.objName](info);\n            }\n            else {\n                return;\n            }\n            Reporter.write(10000, `${'-'.repeat(info.depth)}${info.objName}.${info.methodName}(${output})`);\n        }\n    };\n}\nexport function stringifyLifecycleFlags(flags) {\n    const flagNames = [];\n    if (flags & 2097152 /* mustEvaluate */) {\n        flagNames.push('mustEvaluate');\n    }\n    if (flags & 16777216 /* isCollectionMutation */) {\n        flagNames.push('isCollectionMutation');\n    }\n    if (flags & 16 /* updateTargetInstance */) {\n        flagNames.push('updateTargetInstance');\n    }\n    if (flags & 32 /* updateSourceExpression */) {\n        flagNames.push('updateSourceExpression');\n    }\n    if (flags & 64 /* fromAsyncFlush */) {\n        flagNames.push('fromAsyncFlush');\n    }\n    if (flags & 128 /* fromSyncFlush */) {\n        flagNames.push('fromSyncFlush');\n    }\n    if (flags & 256 /* fromTick */) {\n        flagNames.push('fromTick');\n    }\n    if (flags & 1024 /* fromStartTask */) {\n        flagNames.push('fromStartTask');\n    }\n    if (flags & 2048 /* fromStopTask */) {\n        flagNames.push('fromStopTask');\n    }\n    if (flags & 4096 /* fromBind */) {\n        flagNames.push('fromBind');\n    }\n    if (flags & 8192 /* fromUnbind */) {\n        flagNames.push('fromUnbind');\n    }\n    if (flags & 16384 /* fromAttach */) {\n        flagNames.push('fromAttach');\n    }\n    if (flags & 32768 /* fromDetach */) {\n        flagNames.push('fromDetach');\n    }\n    if (flags & 65536 /* fromCache */) {\n        flagNames.push('fromCache');\n    }\n    if (flags & 131072 /* fromDOMEvent */) {\n        flagNames.push('fromDOMEvent');\n    }\n    if (flags & 262144 /* fromLifecycleTask */) {\n        flagNames.push('fromLifecycleTask');\n    }\n    if (flags & 4194304 /* isTraversingParentScope */) {\n        flagNames.push('isTraversingParentScope');\n    }\n    if (flags & 67108864 /* allowParentScopeTraversal */) {\n        flagNames.push('allowParentScopeTraversal');\n    }\n    if (flags & 1 /* getterSetterStrategy */) {\n        flagNames.push('getterSetterStrategy');\n    }\n    if (flags & 2 /* proxyStrategy */) {\n        flagNames.push('proxyStrategy');\n    }\n    if (flags & 1073741824 /* secondaryExpression */) {\n        flagNames.push('secondaryExpression');\n    }\n    if (flagNames.length === 0) {\n        return 'none';\n    }\n    return flagNames.join('|');\n}\n//# sourceMappingURL=tracer.js.map","import { DI } from '@aurelia/kernel';\nexport const IAttrSyntaxTransformer = DI\n    .createInterface('IAttrSyntaxTransformer')\n    .noDefault();\n//# sourceMappingURL=attribute-syntax-transformer.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { bindingCommand, getTarget, } from '@aurelia/jit';\nimport { RefBindingInstruction } from '@aurelia/runtime';\nimport { AttributeBindingInstruction, CaptureBindingInstruction, DelegateBindingInstruction, TriggerBindingInstruction } from '@aurelia/runtime-html';\n/**\n * Trigger binding command. Compile attr with binding symbol with command `trigger` to `TriggerBindingInstruction`\n */\nlet TriggerBindingCommand = class TriggerBindingCommand {\n    constructor() {\n        this.bindingType = 4182 /* TriggerCommand */;\n    }\n    compile(binding) {\n        return new TriggerBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nTriggerBindingCommand = __decorate([\n    bindingCommand('trigger')\n], TriggerBindingCommand);\nexport { TriggerBindingCommand };\n/**\n * Delegate binding command. Compile attr with binding symbol with command `delegate` to `DelegateBindingInstruction`\n */\nlet DelegateBindingCommand = class DelegateBindingCommand {\n    constructor() {\n        this.bindingType = 4184 /* DelegateCommand */;\n    }\n    compile(binding) {\n        return new DelegateBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nDelegateBindingCommand = __decorate([\n    bindingCommand('delegate')\n], DelegateBindingCommand);\nexport { DelegateBindingCommand };\n/**\n * Capture binding command. Compile attr with binding symbol with command `capture` to `CaptureBindingInstruction`\n */\nlet CaptureBindingCommand = class CaptureBindingCommand {\n    constructor() {\n        this.bindingType = 4183 /* CaptureCommand */;\n    }\n    compile(binding) {\n        return new CaptureBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nCaptureBindingCommand = __decorate([\n    bindingCommand('capture')\n], CaptureBindingCommand);\nexport { CaptureBindingCommand };\n/**\n * Attr binding command. Compile attr with binding symbol with command `attr` to `AttributeBindingInstruction`\n */\nlet AttrBindingCommand = class AttrBindingCommand {\n    constructor() {\n        this.bindingType = 32 /* IsProperty */;\n    }\n    compile(binding) {\n        const target = getTarget(binding, false);\n        return new AttributeBindingInstruction(target, binding.expression, target);\n    }\n};\nAttrBindingCommand = __decorate([\n    bindingCommand('attr')\n], AttrBindingCommand);\nexport { AttrBindingCommand };\n/**\n * Style binding command. Compile attr with binding symbol with command `style` to `AttributeBindingInstruction`\n */\nlet StyleBindingCommand = class StyleBindingCommand {\n    constructor() {\n        this.bindingType = 32 /* IsProperty */;\n    }\n    compile(binding) {\n        return new AttributeBindingInstruction('style', binding.expression, getTarget(binding, false));\n    }\n};\nStyleBindingCommand = __decorate([\n    bindingCommand('style')\n], StyleBindingCommand);\nexport { StyleBindingCommand };\n/**\n * Class binding command. Compile attr with binding symbol with command `class` to `AttributeBindingInstruction`\n */\nlet ClassBindingCommand = class ClassBindingCommand {\n    constructor() {\n        this.bindingType = 32 /* IsProperty */;\n    }\n    compile(binding) {\n        return new AttributeBindingInstruction('class', binding.expression, getTarget(binding, false));\n    }\n};\nClassBindingCommand = __decorate([\n    bindingCommand('class')\n], ClassBindingCommand);\nexport { ClassBindingCommand };\n/**\n * Binding command to refer different targets (element, custom element/attribute view models, controller) afterAttach to an element\n */\nlet RefBindingCommand = class RefBindingCommand {\n    constructor() {\n        this.bindingType = 32 /* IsProperty */ | 4096 /* IgnoreCustomAttr */;\n    }\n    compile(binding) {\n        return new RefBindingInstruction(binding.expression, getTarget(binding, false));\n    }\n};\nRefBindingCommand = __decorate([\n    bindingCommand('ref')\n], RefBindingCommand);\nexport { RefBindingCommand };\n//# sourceMappingURL=binding-commands.js.map","import { BindingSymbol, CustomAttributeSymbol, CustomElementSymbol as $CustomElementSymbol, LetElementSymbol as $LetElementSymbol, PlainAttributeSymbol, PlainElementSymbol as $PlainElementSymbol, ReplacePartSymbol as $ReplacePartSymbol, TemplateControllerSymbol as $TemplateControllerSymbol, TextSymbol as $TextSymbol, } from '@aurelia/jit';\nexport const CustomElementSymbol = $CustomElementSymbol;\nexport const LetElementSymbol = $LetElementSymbol;\nexport const PlainElementSymbol = $PlainElementSymbol;\nexport const ReplacePartSymbol = $ReplacePartSymbol;\nexport const TemplateControllerSymbol = $TemplateControllerSymbol;\nexport const TextSymbol = $TextSymbol;\nexport { BindingSymbol, CustomAttributeSymbol, PlainAttributeSymbol, };\n//# sourceMappingURL=semantic-model.js.map","/* eslint-disable compat/compat */\nimport { BindableInfo, } from '@aurelia/jit';\nimport { camelCase, } from '@aurelia/kernel';\nimport { BindingMode } from '@aurelia/runtime';\nimport { BindingSymbol, CustomAttributeSymbol, CustomElementSymbol, LetElementSymbol, PlainAttributeSymbol, PlainElementSymbol, ReplacePartSymbol, TemplateControllerSymbol, TextSymbol, } from './semantic-model';\nconst invalidSurrogateAttribute = Object.assign(Object.create(null), {\n    'id': true,\n    'replace': true\n});\nconst attributesToIgnore = Object.assign(Object.create(null), {\n    'as-element': true,\n    'replace': true\n});\nfunction hasInlineBindings(rawValue) {\n    const len = rawValue.length;\n    let ch = 0;\n    for (let i = 0; i < len; ++i) {\n        ch = rawValue.charCodeAt(i);\n        if (ch === 92 /* Backslash */) {\n            ++i;\n            // Ignore whatever comes next because it's escaped\n        }\n        else if (ch === 58 /* Colon */) {\n            return true;\n        }\n        else if (ch === 36 /* Dollar */ && rawValue.charCodeAt(i + 1) === 123 /* OpenBrace */) {\n            return false;\n        }\n    }\n    return false;\n}\nfunction processInterpolationText(symbol) {\n    const node = symbol.physicalNode;\n    const parentNode = node.parentNode;\n    while (node.nextSibling !== null && node.nextSibling.nodeType === 3 /* Text */) {\n        parentNode.removeChild(node.nextSibling);\n    }\n    node.textContent = '';\n    parentNode.insertBefore(symbol.marker, node);\n}\nfunction isTemplateControllerOf(proxy, manifest) {\n    return proxy !== manifest;\n}\n/**\n * A (temporary) standalone function that purely does the DOM processing (lifting) related to template controllers.\n * It's a first refactoring step towards separating DOM parsing/binding from mutations.\n */\nfunction processTemplateControllers(dom, manifestProxy, manifest) {\n    const manifestNode = manifest.physicalNode;\n    let current = manifestProxy;\n    let currentTemplate;\n    while (isTemplateControllerOf(current, manifest)) {\n        if (current.template === manifest) {\n            // the DOM linkage is still in its original state here so we can safely assume the parentNode is non-null\n            manifestNode.parentNode.replaceChild(current.marker, manifestNode);\n            // if the manifest is a template element (e.g. <template repeat.for=\"...\">) then we can skip one lift operation\n            // and simply use the template directly, saving a bit of work\n            if (manifestNode.nodeName === 'TEMPLATE') {\n                current.physicalNode = manifestNode;\n                // the template could safely stay without affecting anything visible, but let's keep the DOM tidy\n                manifestNode.remove();\n            }\n            else {\n                // the manifest is not a template element so we need to wrap it in one\n                currentTemplate = current.physicalNode = dom.createTemplate();\n                currentTemplate.content.appendChild(manifestNode);\n            }\n        }\n        else {\n            currentTemplate = current.physicalNode = dom.createTemplate();\n            currentTemplate.content.appendChild(current.marker);\n        }\n        manifestNode.removeAttribute(current.syntax.rawName);\n        current = current.template;\n    }\n}\nfunction processReplacePart(dom, replacePart, manifestProxy) {\n    let proxyNode;\n    let currentTemplate;\n    if ((manifestProxy.flags & 512 /* hasMarker */) > 0) {\n        proxyNode = manifestProxy.marker;\n    }\n    else {\n        proxyNode = manifestProxy.physicalNode;\n    }\n    if (proxyNode.nodeName === 'TEMPLATE') {\n        // if it's a template element, no need to do anything special, just assign it to the replacePart\n        replacePart.physicalNode = proxyNode;\n    }\n    else {\n        // otherwise wrap the replace in a template\n        currentTemplate = replacePart.physicalNode = dom.createTemplate();\n        currentTemplate.content.appendChild(proxyNode);\n    }\n}\n/**\n * TemplateBinder. Todo: describe goal of this class\n */\nexport class TemplateBinder {\n    constructor(dom, resources, attrParser, exprParser, attrSyntaxTransformer) {\n        this.dom = dom;\n        this.resources = resources;\n        this.attrParser = attrParser;\n        this.exprParser = exprParser;\n        this.attrSyntaxTransformer = attrSyntaxTransformer;\n    }\n    bind(node) {\n        const surrogate = new PlainElementSymbol(this.dom, node);\n        const resources = this.resources;\n        const attrSyntaxTransformer = this.attrSyntaxTransformer;\n        const attributes = node.attributes;\n        let i = 0;\n        while (i < attributes.length) {\n            const attr = attributes[i];\n            const attrSyntax = this.attrParser.parse(attr.name, attr.value);\n            if (invalidSurrogateAttribute[attrSyntax.target] === true) {\n                throw new Error(`Invalid surrogate attribute: ${attrSyntax.target}`);\n                // TODO: use reporter\n            }\n            const bindingCommand = resources.getBindingCommand(attrSyntax, true);\n            if (bindingCommand === null || (bindingCommand.bindingType & 4096 /* IgnoreCustomAttr */) === 0) {\n                const attrInfo = resources.getAttributeInfo(attrSyntax);\n                if (attrInfo === null) {\n                    // map special html attributes to their corresponding properties\n                    attrSyntaxTransformer.transform(node, attrSyntax);\n                    // it's not a custom attribute but might be a regular bound attribute or interpolation (it might also be nothing)\n                    this.bindPlainAttribute(\n                    /* attrSyntax */ attrSyntax, \n                    /* attr       */ attr, \n                    /* surrogate  */ surrogate, \n                    /* manifest   */ surrogate);\n                }\n                else if (attrInfo.isTemplateController) {\n                    throw new Error('Cannot have template controller on surrogate element.');\n                    // TODO: use reporter\n                }\n                else {\n                    this.bindCustomAttribute(\n                    /* attrSyntax */ attrSyntax, \n                    /* attrInfo   */ attrInfo, \n                    /* command    */ bindingCommand, \n                    /* manifest   */ surrogate);\n                }\n            }\n            else {\n                // map special html attributes to their corresponding properties\n                attrSyntaxTransformer.transform(node, attrSyntax);\n                // it's not a custom attribute but might be a regular bound attribute or interpolation (it might also be nothing)\n                this.bindPlainAttribute(\n                /* attrSyntax */ attrSyntax, \n                /* attr       */ attr, \n                /* surrogate  */ surrogate, \n                /* manifest   */ surrogate);\n            }\n            ++i;\n        }\n        this.bindChildNodes(\n        /* node               */ node, \n        /* surrogate          */ surrogate, \n        /* manifest           */ surrogate, \n        /* manifestRoot       */ null, \n        /* parentManifestRoot */ null, \n        /* partName           */ null);\n        return surrogate;\n    }\n    bindManifest(parentManifest, node, surrogate, manifest, manifestRoot, parentManifestRoot, partName) {\n        switch (node.nodeName) {\n            case 'LET':\n                // let cannot have children and has some different processing rules, so return early\n                this.bindLetElement(\n                /* parentManifest */ parentManifest, \n                /* node           */ node);\n                return;\n            case 'SLOT':\n                surrogate.hasSlots = true;\n        }\n        // get the part name to override the name of the compiled definition\n        partName = node.getAttribute('replaceable');\n        if (partName === '') {\n            partName = 'default';\n        }\n        let name = node.getAttribute('as-element');\n        if (name === null) {\n            name = node.nodeName.toLowerCase();\n        }\n        const elementInfo = this.resources.getElementInfo(name);\n        if (elementInfo === null) {\n            // there is no registered custom element with this name\n            manifest = new PlainElementSymbol(this.dom, node);\n        }\n        else {\n            // it's a custom element so we set the manifestRoot as well (for storing replaces)\n            parentManifestRoot = manifestRoot;\n            manifestRoot = manifest = new CustomElementSymbol(this.dom, node, elementInfo);\n        }\n        // lifting operations done by template controllers and replaces effectively unlink the nodes, so start at the bottom\n        this.bindChildNodes(\n        /* node               */ node, \n        /* surrogate          */ surrogate, \n        /* manifest           */ manifest, \n        /* manifestRoot       */ manifestRoot, \n        /* parentManifestRoot */ parentManifestRoot, \n        /* partName           */ partName);\n        // the parentManifest will receive either the direct child nodes, or the template controllers / replaces\n        // wrapping them\n        this.bindAttributes(\n        /* node               */ node, \n        /* parentManifest     */ parentManifest, \n        /* surrogate          */ surrogate, \n        /* manifest           */ manifest, \n        /* manifestRoot       */ manifestRoot, \n        /* parentManifestRoot */ parentManifestRoot, \n        /* partName           */ partName);\n        if (manifestRoot === manifest && manifest.isContainerless) {\n            node.parentNode.replaceChild(manifest.marker, node);\n        }\n        else if (manifest.isTarget) {\n            node.classList.add('au');\n        }\n    }\n    bindLetElement(parentManifest, node) {\n        const symbol = new LetElementSymbol(this.dom, node);\n        parentManifest.childNodes.push(symbol);\n        const attributes = node.attributes;\n        let i = 0;\n        while (i < attributes.length) {\n            const attr = attributes[i];\n            if (attr.name === 'to-binding-context') {\n                node.removeAttribute('to-binding-context');\n                symbol.toBindingContext = true;\n                continue;\n            }\n            const attrSyntax = this.attrParser.parse(attr.name, attr.value);\n            const command = this.resources.getBindingCommand(attrSyntax, false);\n            const bindingType = command === null ? 2048 /* Interpolation */ : command.bindingType;\n            const expr = this.exprParser.parse(attrSyntax.rawValue, bindingType);\n            const to = camelCase(attrSyntax.target);\n            const info = new BindableInfo(to, BindingMode.toView);\n            symbol.bindings.push(new BindingSymbol(command, info, expr, attrSyntax.rawValue, to));\n            ++i;\n        }\n        node.parentNode.replaceChild(symbol.marker, node);\n    }\n    bindAttributes(node, parentManifest, surrogate, manifest, manifestRoot, parentManifestRoot, partName) {\n        // This is the top-level symbol for the current depth.\n        // If there are no template controllers or replaces, it is always the manifest itself.\n        // If there are template controllers, then this will be the outer-most TemplateControllerSymbol.\n        let manifestProxy = manifest;\n        let previousController = (void 0);\n        let currentController = (void 0);\n        const attributes = node.attributes;\n        let i = 0;\n        while (i < attributes.length) {\n            const attr = attributes[i];\n            ++i;\n            if (attributesToIgnore[attr.name] === true) {\n                continue;\n            }\n            const attrSyntax = this.attrParser.parse(attr.name, attr.value);\n            const bindingCommand = this.resources.getBindingCommand(attrSyntax, true);\n            if (bindingCommand === null || (bindingCommand.bindingType & 4096 /* IgnoreCustomAttr */) === 0) {\n                const attrInfo = this.resources.getAttributeInfo(attrSyntax);\n                if (attrInfo === null) {\n                    // map special html attributes to their corresponding properties\n                    this.attrSyntaxTransformer.transform(node, attrSyntax);\n                    // it's not a custom attribute but might be a regular bound attribute or interpolation (it might also be nothing)\n                    this.bindPlainAttribute(\n                    /* attrSyntax */ attrSyntax, \n                    /* attr       */ attr, \n                    /* surrogate  */ surrogate, \n                    /* manifest   */ manifest);\n                }\n                else if (attrInfo.isTemplateController) {\n                    // the manifest is wrapped by the inner-most template controller (if there are multiple on the same element)\n                    // so keep setting manifest.templateController to the latest template controller we find\n                    currentController = manifest.templateController = this.declareTemplateController(\n                    /* attrSyntax */ attrSyntax, \n                    /* attrInfo   */ attrInfo, \n                    /* partName   */ partName);\n                    // the proxy and the manifest are only identical when we're at the first template controller (since the controller\n                    // is assigned to the proxy), so this evaluates to true at most once per node\n                    if (manifestProxy === manifest) {\n                        currentController.template = manifest;\n                        manifestProxy = currentController;\n                    }\n                    else {\n                        currentController.templateController = previousController;\n                        currentController.template = previousController.template;\n                        previousController.template = currentController;\n                    }\n                    previousController = currentController;\n                }\n                else {\n                    // a regular custom attribute\n                    this.bindCustomAttribute(\n                    /* attrSyntax */ attrSyntax, \n                    /* attrInfo   */ attrInfo, \n                    /* command    */ bindingCommand, \n                    /* manifest   */ manifest);\n                }\n            }\n            else {\n                // map special html attributes to their corresponding properties\n                this.attrSyntaxTransformer.transform(node, attrSyntax);\n                // it's not a custom attribute but might be a regular bound attribute or interpolation (it might also be nothing)\n                this.bindPlainAttribute(\n                /* attrSyntax */ attrSyntax, \n                /* attr       */ attr, \n                /* surrogate  */ surrogate, \n                /* manifest   */ manifest);\n            }\n        }\n        if (node.tagName === 'INPUT') {\n            const type = node.type;\n            if (type === 'checkbox' || type === 'radio') {\n                this.ensureAttributeOrder(manifest);\n            }\n        }\n        processTemplateControllers(this.dom, manifestProxy, manifest);\n        let replace = node.getAttribute('replace');\n        if (replace === '' || (replace === null && manifestRoot !== null && manifestRoot.isContainerless && ((parentManifest.flags & 16 /* isCustomElement */) > 0))) {\n            replace = 'default';\n        }\n        const partOwner = manifest === manifestRoot ? parentManifestRoot : manifestRoot;\n        if (replace === null || partOwner === null) {\n            // the proxy is either the manifest itself or the outer-most controller; add it directly to the parent\n            parentManifest.childNodes.push(manifestProxy);\n        }\n        else {\n            // there is a replace attribute on this node, so add it to the parts collection of the manifestRoot\n            // instead of to the childNodes\n            const replacePart = new ReplacePartSymbol(replace);\n            replacePart.parent = parentManifest;\n            replacePart.template = manifestProxy;\n            partOwner.parts.push(replacePart);\n            if (parentManifest.templateController != null) {\n                parentManifest.templateController.parts.push(replacePart);\n            }\n            processReplacePart(this.dom, replacePart, manifestProxy);\n        }\n    }\n    // TODO: refactor to use render priority slots (this logic shouldn't be in the template binder)\n    ensureAttributeOrder(manifest) {\n        // swap the order of checked and model/value attribute, so that the required observers are prepared for checked-observer\n        const attributes = manifest.plainAttributes;\n        let modelOrValueIndex = void 0;\n        let checkedIndex = void 0;\n        let found = 0;\n        for (let i = 0; i < attributes.length && found < 3; i++) {\n            switch (attributes[i].syntax.target) {\n                case 'model':\n                case 'value':\n                case 'matcher':\n                    modelOrValueIndex = i;\n                    found++;\n                    break;\n                case 'checked':\n                    checkedIndex = i;\n                    found++;\n                    break;\n            }\n        }\n        if (checkedIndex !== void 0 && modelOrValueIndex !== void 0 && checkedIndex < modelOrValueIndex) {\n            [attributes[modelOrValueIndex], attributes[checkedIndex]] = [attributes[checkedIndex], attributes[modelOrValueIndex]];\n        }\n    }\n    bindChildNodes(node, surrogate, manifest, manifestRoot, parentManifestRoot, partName) {\n        let childNode;\n        if (node.nodeName === 'TEMPLATE') {\n            childNode = node.content.firstChild;\n        }\n        else {\n            childNode = node.firstChild;\n        }\n        let nextChild;\n        while (childNode !== null) {\n            switch (childNode.nodeType) {\n                case 1 /* Element */:\n                    nextChild = childNode.nextSibling;\n                    this.bindManifest(\n                    /* parentManifest     */ manifest, \n                    /* node               */ childNode, \n                    /* surrogate          */ surrogate, \n                    /* manifest           */ manifest, \n                    /* manifestRoot       */ manifestRoot, \n                    /* parentManifestRoot */ parentManifestRoot, \n                    /* partName           */ partName);\n                    childNode = nextChild;\n                    break;\n                case 3 /* Text */:\n                    childNode = this.bindText(\n                    /* textNode */ childNode, \n                    /* manifest */ manifest).nextSibling;\n                    break;\n                case 4 /* CDATASection */:\n                case 7 /* ProcessingInstruction */:\n                case 8 /* Comment */:\n                case 10 /* DocumentType */:\n                    childNode = childNode.nextSibling;\n                    break;\n                case 9 /* Document */:\n                case 11 /* DocumentFragment */:\n                    childNode = childNode.firstChild;\n            }\n        }\n    }\n    bindText(textNode, manifest) {\n        const interpolation = this.exprParser.parse(textNode.wholeText, 2048 /* Interpolation */);\n        if (interpolation !== null) {\n            const symbol = new TextSymbol(this.dom, textNode, interpolation);\n            manifest.childNodes.push(symbol);\n            processInterpolationText(symbol);\n        }\n        let next = textNode;\n        while (next.nextSibling !== null && next.nextSibling.nodeType === 3 /* Text */) {\n            next = next.nextSibling;\n        }\n        return next;\n    }\n    declareTemplateController(attrSyntax, attrInfo, partName) {\n        let symbol;\n        const attrRawValue = attrSyntax.rawValue;\n        const command = this.resources.getBindingCommand(attrSyntax, false);\n        // multi-bindings logic here is similar to (and explained in) bindCustomAttribute\n        const isMultiBindings = attrInfo.noMultiBindings === false && command === null && hasInlineBindings(attrRawValue);\n        if (isMultiBindings) {\n            symbol = new TemplateControllerSymbol(this.dom, attrSyntax, attrInfo, partName);\n            this.bindMultiAttribute(symbol, attrInfo, attrRawValue);\n        }\n        else {\n            symbol = new TemplateControllerSymbol(this.dom, attrSyntax, attrInfo, partName);\n            const bindingType = command === null ? 2048 /* Interpolation */ : command.bindingType;\n            const expr = this.exprParser.parse(attrRawValue, bindingType);\n            symbol.bindings.push(new BindingSymbol(command, attrInfo.bindable, expr, attrRawValue, attrSyntax.target));\n        }\n        return symbol;\n    }\n    bindCustomAttribute(attrSyntax, attrInfo, command, manifest) {\n        let symbol;\n        const attrRawValue = attrSyntax.rawValue;\n        // Custom attributes are always in multiple binding mode,\n        // except when they can't be\n        // When they cannot be:\n        //        * has explicit configuration noMultiBindings: false\n        //        * has binding command, ie: <div my-attr.bind=\"...\">.\n        //          In this scenario, the value of the custom attributes is required to be a valid expression\n        //        * has no colon: ie: <div my-attr=\"abcd\">\n        //          In this scenario, it's simply invalid syntax. Consider style attribute rule-value pair: <div style=\"rule: ruleValue\">\n        const isMultiBindings = attrInfo.noMultiBindings === false && command === null && hasInlineBindings(attrRawValue);\n        if (isMultiBindings) {\n            // a multiple-bindings attribute usage (semicolon separated binding) is only valid without a binding command;\n            // the binding commands must be declared in each of the property bindings\n            symbol = new CustomAttributeSymbol(attrSyntax, attrInfo);\n            this.bindMultiAttribute(symbol, attrInfo, attrRawValue);\n        }\n        else {\n            symbol = new CustomAttributeSymbol(attrSyntax, attrInfo);\n            const bindingType = command === null ? 2048 /* Interpolation */ : command.bindingType;\n            const expr = this.exprParser.parse(attrRawValue, bindingType);\n            symbol.bindings.push(new BindingSymbol(command, attrInfo.bindable, expr, attrRawValue, attrSyntax.target));\n        }\n        manifest.customAttributes.push(symbol);\n        manifest.isTarget = true;\n    }\n    bindMultiAttribute(symbol, attrInfo, value) {\n        const bindables = attrInfo.bindables;\n        const valueLength = value.length;\n        let attrName = void 0;\n        let attrValue = void 0;\n        let start = 0;\n        let ch = 0;\n        for (let i = 0; i < valueLength; ++i) {\n            ch = value.charCodeAt(i);\n            if (ch === 92 /* Backslash */) {\n                ++i;\n                // Ignore whatever comes next because it's escaped\n            }\n            else if (ch === 58 /* Colon */) {\n                attrName = value.slice(start, i);\n                // Skip whitespace after colon\n                while (value.charCodeAt(++i) <= 32 /* Space */)\n                    ;\n                start = i;\n                for (; i < valueLength; ++i) {\n                    ch = value.charCodeAt(i);\n                    if (ch === 92 /* Backslash */) {\n                        ++i;\n                        // Ignore whatever comes next because it's escaped\n                    }\n                    else if (ch === 59 /* Semicolon */) {\n                        attrValue = value.slice(start, i);\n                        break;\n                    }\n                }\n                if (attrValue === void 0) {\n                    // No semicolon found, so just grab the rest of the value\n                    attrValue = value.slice(start);\n                }\n                const attrSyntax = this.attrParser.parse(attrName, attrValue);\n                const attrTarget = camelCase(attrSyntax.target);\n                const command = this.resources.getBindingCommand(attrSyntax, false);\n                const bindingType = command === null ? 2048 /* Interpolation */ : command.bindingType;\n                const expr = this.exprParser.parse(attrValue, bindingType);\n                let bindable = bindables[attrTarget];\n                if (bindable === undefined) {\n                    // everything in a multi-bindings expression must be used,\n                    // so if it's not a bindable then we create one on the spot\n                    bindable = bindables[attrTarget] = new BindableInfo(attrTarget, BindingMode.toView);\n                }\n                symbol.bindings.push(new BindingSymbol(command, bindable, expr, attrValue, attrTarget));\n                // Skip whitespace after semicolon\n                while (i < valueLength && value.charCodeAt(++i) <= 32 /* Space */)\n                    ;\n                start = i;\n                attrName = void 0;\n                attrValue = void 0;\n            }\n        }\n    }\n    bindPlainAttribute(attrSyntax, attr, surrogate, manifest) {\n        const command = this.resources.getBindingCommand(attrSyntax, false);\n        const bindingType = command === null ? 2048 /* Interpolation */ : command.bindingType;\n        const attrTarget = attrSyntax.target;\n        const attrRawValue = attrSyntax.rawValue;\n        let expr;\n        if (attrRawValue.length === 0\n            && (bindingType & 53 /* BindCommand */ | 49 /* OneTimeCommand */ | 50 /* ToViewCommand */ | 52 /* TwoWayCommand */) > 0) {\n            if ((bindingType & 53 /* BindCommand */ | 49 /* OneTimeCommand */ | 50 /* ToViewCommand */ | 52 /* TwoWayCommand */) > 0) {\n                // Default to the name of the attr for empty binding commands\n                expr = this.exprParser.parse(camelCase(attrTarget), bindingType);\n            }\n            else {\n                return;\n            }\n        }\n        else {\n            expr = this.exprParser.parse(attrRawValue, bindingType);\n        }\n        if ((manifest.flags & 16 /* isCustomElement */) > 0) {\n            const bindable = manifest.bindables[attrTarget];\n            if (bindable != null) {\n                // if the attribute name matches a bindable property name, add it regardless of whether it's a command, interpolation, or just a plain string;\n                // the template compiler will translate it to the correct instruction\n                manifest.bindings.push(new BindingSymbol(command, bindable, expr, attrRawValue, attrTarget));\n                manifest.isTarget = true;\n            }\n            else if (expr != null) {\n                // if it does not map to a bindable, only add it if we were able to parse an expression (either a command or interpolation)\n                manifest.plainAttributes.push(new PlainAttributeSymbol(attrSyntax, command, expr));\n                manifest.isTarget = true;\n            }\n        }\n        else if (expr != null) {\n            // either a binding command, an interpolation, or a ref\n            manifest.plainAttributes.push(new PlainAttributeSymbol(attrSyntax, command, expr));\n            manifest.isTarget = true;\n        }\n        else if (manifest === surrogate) {\n            // any attributes, even if they are plain (no command/interpolation etc), should be added if they\n            // are on the surrogate element\n            manifest.plainAttributes.push(new PlainAttributeSymbol(attrSyntax, command, expr));\n        }\n        if (command == null && expr != null) {\n            // if it's an interpolation, clear the attribute value\n            attr.value = '';\n        }\n    }\n}\n//# sourceMappingURL=template-binder.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DI, Registration } from '@aurelia/kernel';\nimport { IDOM } from '@aurelia/runtime';\n// For some reason rollup complains about `DI.createInterface<ITemplateElementFactory>().noDefault()` with this message:\n// \"semantic error TS2742 The inferred type of 'ITemplateElementFactory' cannot be named without a reference to '@aurelia/jit/node_modules/@aurelia/kernel'. This is likely not portable. A type annotation is necessary\"\n// So.. investigate why that happens (or rather, why it *only* happens here and not for the other 50)\nexport const ITemplateElementFactory = DI.createInterface('ITemplateElementFactory').noDefault();\nconst markupCache = {};\n/**\n * Default implementation for `ITemplateFactory` for use in an HTML based runtime.\n *\n * @internal\n */\nlet HTMLTemplateElementFactory = class HTMLTemplateElementFactory {\n    constructor(dom) {\n        this.dom = dom;\n        this.template = dom.createTemplate();\n    }\n    static register(container) {\n        return Registration.singleton(ITemplateElementFactory, this).register(container);\n    }\n    createTemplate(input) {\n        if (typeof input === 'string') {\n            let result = markupCache[input];\n            if (result === void 0) {\n                const template = this.template;\n                template.innerHTML = input;\n                const node = template.content.firstElementChild;\n                // if the input is either not wrapped in a template or there is more than one node,\n                // return the whole template that wraps it/them (and create a new one for the next input)\n                if (node == null || node.nodeName !== 'TEMPLATE' || node.nextElementSibling != null) {\n                    this.template = this.dom.createTemplate();\n                    result = template;\n                }\n                else {\n                    // the node to return is both a template and the only node, so return just the node\n                    // and clean up the template for the next input\n                    template.content.removeChild(node);\n                    result = node;\n                }\n                markupCache[input] = result;\n            }\n            return result.cloneNode(true);\n        }\n        if (input.nodeName !== 'TEMPLATE') {\n            // if we get one node that is not a template, wrap it in one\n            const template = this.dom.createTemplate();\n            template.content.appendChild(input);\n            return template;\n        }\n        // we got a template element, remove it from the DOM if it's present there and don't\n        // do any other processing\n        if (input.parentNode != null) {\n            input.parentNode.removeChild(input);\n        }\n        return input;\n    }\n};\nHTMLTemplateElementFactory = __decorate([\n    __param(0, IDOM),\n    __metadata(\"design:paramtypes\", [Object])\n], HTMLTemplateElementFactory);\nexport { HTMLTemplateElementFactory };\n//# sourceMappingURL=template-element-factory.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { IAttributeParser, ResourceModel, } from '@aurelia/jit';\nimport { mergeDistinct, PLATFORM, Registration, mergeArrays, } from '@aurelia/kernel';\nimport { HydrateAttributeInstruction, HydrateElementInstruction, HydrateTemplateController, IExpressionParser, InterpolationInstruction, ITemplateCompiler, LetBindingInstruction, LetElementInstruction, SetPropertyInstruction, CustomElementDefinition, IDOM } from '@aurelia/runtime';\nimport { SetAttributeInstruction, TextBindingInstruction, SetClassAttributeInstruction, SetStyleAttributeInstruction, } from '@aurelia/runtime-html';\nimport { IAttrSyntaxTransformer } from './attribute-syntax-transformer';\nimport { TemplateBinder } from './template-binder';\nimport { ITemplateElementFactory } from './template-element-factory';\nclass CustomElementCompilationUnit {\n    constructor(partialDefinition, surrogate, template) {\n        this.partialDefinition = partialDefinition;\n        this.surrogate = surrogate;\n        this.template = template;\n        this.instructions = [];\n        this.surrogates = [];\n        this.scopeParts = [];\n        this.parts = {};\n    }\n    toDefinition() {\n        const def = this.partialDefinition;\n        return CustomElementDefinition.create({\n            ...def,\n            instructions: mergeArrays(def.instructions, this.instructions),\n            surrogates: mergeArrays(def.surrogates, this.surrogates),\n            scopeParts: mergeArrays(def.scopeParts, this.scopeParts),\n            template: this.template,\n            needsCompile: false,\n            hasSlots: this.surrogate.hasSlots,\n        });\n    }\n}\n/**\n * Default (runtime-agnostic) implementation for `ITemplateCompiler`.\n *\n * @internal\n */\nlet TemplateCompiler = class TemplateCompiler {\n    constructor(factory, attrParser, exprParser, attrSyntaxModifier) {\n        this.factory = factory;\n        this.attrParser = attrParser;\n        this.exprParser = exprParser;\n        this.attrSyntaxModifier = attrSyntaxModifier;\n    }\n    get name() {\n        return 'default';\n    }\n    static register(container) {\n        return Registration.singleton(ITemplateCompiler, this).register(container);\n    }\n    compile(partialDefinition, context) {\n        const definition = CustomElementDefinition.getOrCreate(partialDefinition);\n        if (definition.template === null || definition.template === void 0) {\n            return definition;\n        }\n        const resources = ResourceModel.getOrCreate(context);\n        const { attrParser, exprParser, attrSyntaxModifier, factory } = this;\n        const binder = new TemplateBinder(context.get(IDOM), resources, attrParser, exprParser, attrSyntaxModifier);\n        const template = factory.createTemplate(definition.template);\n        const surrogate = binder.bind(template);\n        const compilation = this.compilation = new CustomElementCompilationUnit(definition, surrogate, template);\n        const customAttributes = surrogate.customAttributes;\n        const plainAttributes = surrogate.plainAttributes;\n        const customAttributeLength = customAttributes.length;\n        const plainAttributeLength = plainAttributes.length;\n        if (customAttributeLength + plainAttributeLength > 0) {\n            let offset = 0;\n            for (let i = 0; customAttributeLength > i; ++i) {\n                compilation.surrogates[offset] = this.compileCustomAttribute(customAttributes[i]);\n                offset++;\n            }\n            for (let i = 0; i < plainAttributeLength; ++i) {\n                compilation.surrogates[offset] = this.compilePlainAttribute(plainAttributes[i], true);\n                offset++;\n            }\n        }\n        this.compileChildNodes(surrogate, compilation.instructions, compilation.scopeParts);\n        const compiledDefinition = compilation.toDefinition();\n        this.compilation = null;\n        return compiledDefinition;\n    }\n    compileChildNodes(parent, instructionRows, scopeParts) {\n        if ((parent.flags & 8192 /* hasChildNodes */) > 0) {\n            const childNodes = parent.childNodes;\n            const ii = childNodes.length;\n            let childNode;\n            for (let i = 0; i < ii; ++i) {\n                childNode = childNodes[i];\n                if ((childNode.flags & 128 /* isText */) > 0) {\n                    instructionRows.push([new TextBindingInstruction(childNode.interpolation)]);\n                }\n                else if ((childNode.flags & 32 /* isLetElement */) > 0) {\n                    const bindings = childNode.bindings;\n                    const instructions = [];\n                    let binding;\n                    const jj = bindings.length;\n                    for (let j = 0; j < jj; ++j) {\n                        binding = bindings[j];\n                        instructions[j] = new LetBindingInstruction(binding.expression, binding.target);\n                    }\n                    instructionRows.push([new LetElementInstruction(instructions, childNode.toBindingContext)]);\n                }\n                else {\n                    this.compileParentNode(childNode, instructionRows, scopeParts);\n                }\n            }\n        }\n    }\n    compileCustomElement(symbol, instructionRows, scopeParts) {\n        // offset 1 to leave a spot for the hydrate instruction so we don't need to create 2 arrays with a spread etc\n        const instructionRow = this.compileAttributes(symbol, 1);\n        instructionRow[0] = new HydrateElementInstruction(symbol.res, this.compileBindings(symbol), this.compileParts(symbol, scopeParts));\n        instructionRows.push(instructionRow);\n        this.compileChildNodes(symbol, instructionRows, scopeParts);\n    }\n    compilePlainElement(symbol, instructionRows, scopeParts) {\n        const attributes = this.compileAttributes(symbol, 0);\n        if (attributes.length > 0) {\n            instructionRows.push(attributes);\n        }\n        this.compileChildNodes(symbol, instructionRows, scopeParts);\n    }\n    compileParentNode(symbol, instructionRows, scopeParts) {\n        switch (symbol.flags & 511 /* type */) {\n            case 16 /* isCustomElement */:\n                this.compileCustomElement(symbol, instructionRows, scopeParts);\n                break;\n            case 64 /* isPlainElement */:\n                this.compilePlainElement(symbol, instructionRows, scopeParts);\n                break;\n            case 1 /* isTemplateController */:\n                this.compileTemplateController(symbol, instructionRows, scopeParts);\n        }\n    }\n    compileTemplateController(symbol, instructionRows, scopeParts) {\n        const bindings = this.compileBindings(symbol);\n        const controllerInstructionRows = [];\n        const controllerScopeParts = [];\n        this.compileParentNode(symbol.template, controllerInstructionRows, controllerScopeParts);\n        mergeDistinct(scopeParts, controllerScopeParts, false);\n        const def = CustomElementDefinition.create({\n            name: symbol.partName === null ? symbol.res : symbol.partName,\n            scopeParts: controllerScopeParts,\n            template: symbol.physicalNode,\n            instructions: controllerInstructionRows,\n            needsCompile: false,\n        });\n        let parts = void 0;\n        if ((symbol.flags & 16384 /* hasParts */) > 0) {\n            parts = {};\n            for (const part of symbol.parts) {\n                parts[part.name] = this.compilation.parts[part.name];\n            }\n        }\n        instructionRows.push([new HydrateTemplateController(def, symbol.res, bindings, symbol.res === 'else', parts)]);\n    }\n    compileBindings(symbol) {\n        let bindingInstructions;\n        if ((symbol.flags & 4096 /* hasBindings */) > 0) {\n            // either a custom element with bindings, a custom attribute / template controller with dynamic options,\n            // or a single value custom attribute binding\n            const { bindings } = symbol;\n            const len = bindings.length;\n            bindingInstructions = Array(len);\n            let i = 0;\n            for (; i < len; ++i) {\n                bindingInstructions[i] = this.compileBinding(bindings[i]);\n            }\n        }\n        else {\n            bindingInstructions = PLATFORM.emptyArray;\n        }\n        return bindingInstructions;\n    }\n    compileBinding(symbol) {\n        if (symbol.command === null) {\n            // either an interpolation or a normal string value assigned to an element or attribute binding\n            if (symbol.expression === null) {\n                // the template binder already filtered out non-bindables, so we know we need a setProperty here\n                return new SetPropertyInstruction(symbol.rawValue, symbol.bindable.propName);\n            }\n            else {\n                // either an element binding interpolation or a dynamic options attribute binding interpolation\n                return new InterpolationInstruction(symbol.expression, symbol.bindable.propName);\n            }\n        }\n        else {\n            // either an element binding command, dynamic options attribute binding command,\n            // or custom attribute / template controller (single value) binding command\n            return symbol.command.compile(symbol);\n        }\n    }\n    compileAttributes(symbol, offset) {\n        let attributeInstructions;\n        if ((symbol.flags & 2048 /* hasAttributes */) > 0) {\n            // any attributes on a custom element (which are not bindables) or a plain element\n            const customAttributes = symbol.customAttributes;\n            const plainAttributes = symbol.plainAttributes;\n            const customAttributeLength = customAttributes.length;\n            const plainAttributesLength = plainAttributes.length;\n            attributeInstructions = Array(offset + customAttributeLength + plainAttributesLength);\n            for (let i = 0; customAttributeLength > i; ++i) {\n                attributeInstructions[offset] = this.compileCustomAttribute(customAttributes[i]);\n                offset++;\n            }\n            for (let i = 0; plainAttributesLength > i; ++i) {\n                attributeInstructions[offset] = this.compilePlainAttribute(plainAttributes[i], false);\n                offset++;\n            }\n        }\n        else if (offset > 0) {\n            attributeInstructions = Array(offset);\n        }\n        else {\n            attributeInstructions = PLATFORM.emptyArray;\n        }\n        return attributeInstructions;\n    }\n    compileCustomAttribute(symbol) {\n        // a normal custom attribute (not template controller)\n        const bindings = this.compileBindings(symbol);\n        return new HydrateAttributeInstruction(symbol.res, bindings);\n    }\n    compilePlainAttribute(symbol, isOnSurrogate) {\n        if (symbol.command === null) {\n            const syntax = symbol.syntax;\n            if (symbol.expression === null) {\n                const attrRawValue = syntax.rawValue;\n                if (isOnSurrogate) {\n                    switch (syntax.target) {\n                        case 'class':\n                            return new SetClassAttributeInstruction(attrRawValue);\n                        case 'style':\n                            return new SetStyleAttributeInstruction(attrRawValue);\n                        // todo:  define how to merge other attribute peacefully\n                        //        this is an existing feature request\n                    }\n                }\n                // a plain attribute on a surrogate\n                return new SetAttributeInstruction(attrRawValue, syntax.target);\n            }\n            else {\n                // a plain attribute with an interpolation\n                return new InterpolationInstruction(symbol.expression, syntax.target);\n            }\n        }\n        else {\n            // a plain attribute with a binding command\n            return symbol.command.compile(symbol);\n        }\n    }\n    // private compileAttribute(symbol: IAttributeSymbol): HTMLAttributeInstruction {\n    //   // any attribute on a custom element (which is not a bindable) or a plain element\n    //   if (symbol.flags & SymbolFlags.isCustomAttribute) {\n    //     return this.compileCustomAttribute(symbol as CustomAttributeSymbol);\n    //   } else {\n    //     return this.compilePlainAttribute(symbol as PlainAttributeSymbol);\n    //   }\n    // }\n    compileParts(symbol, scopeParts) {\n        const parts = {};\n        if ((symbol.flags & 16384 /* hasParts */) > 0) {\n            const replaceParts = symbol.parts;\n            const len = replaceParts.length;\n            let s = scopeParts.length;\n            for (let i = 0; i < len; ++i) {\n                const replacePart = replaceParts[i];\n                if (!scopeParts.includes(replacePart.name)) {\n                    scopeParts[s++] = replacePart.name;\n                }\n                const partScopeParts = [];\n                const partInstructionRows = [];\n                this.compileParentNode(replacePart.template, partInstructionRows, partScopeParts);\n                // TODO: the assignment to `this.compilation.parts[replacePart.name]` might be the cause of replaceable bug reported by rluba\n                // need to verify this\n                this.compilation.parts[replacePart.name] = parts[replacePart.name] = CustomElementDefinition.create({\n                    name: replacePart.name,\n                    scopeParts: partScopeParts,\n                    template: replacePart.physicalNode,\n                    instructions: partInstructionRows,\n                    needsCompile: false,\n                });\n            }\n        }\n        return parts;\n    }\n};\nTemplateCompiler = __decorate([\n    __param(0, ITemplateElementFactory),\n    __param(1, IAttributeParser),\n    __param(2, IExpressionParser),\n    __param(3, IAttrSyntaxTransformer),\n    __metadata(\"design:paramtypes\", [Object, Object, Object, Object])\n], TemplateCompiler);\nexport { TemplateCompiler };\n//# sourceMappingURL=template-compiler.js.map","import { DefaultBindingLanguage as JitDefaultBindingLanguage, DefaultBindingSyntax as JitDefaultBindingSyntax, DefaultComponents as JitDefaultComponents } from '@aurelia/jit';\nimport { DI } from '@aurelia/kernel';\nimport { RuntimeHtmlConfiguration } from '@aurelia/runtime-html';\nimport { AttrBindingCommand, CaptureBindingCommand, ClassBindingCommand, DelegateBindingCommand, RefBindingCommand, StyleBindingCommand, TriggerBindingCommand } from './binding-commands';\nimport { HtmlAttrSyntaxTransformer } from './html-attribute-syntax-transformer';\nimport { TemplateCompiler } from './template-compiler';\nimport { HTMLTemplateElementFactory } from './template-element-factory';\nexport const ITemplateCompilerRegistration = TemplateCompiler;\nexport const ITemplateElementFactoryRegistration = HTMLTemplateElementFactory;\nexport const IAttrSyntaxTransformerRegistation = HtmlAttrSyntaxTransformer;\n/**\n * Default HTML-specific (but environment-agnostic) implementations for the following interfaces:\n * - `ITemplateCompiler`\n * - `ITemplateElementFactory`\n */\nexport const DefaultComponents = [\n    ITemplateCompilerRegistration,\n    ITemplateElementFactoryRegistration,\n    IAttrSyntaxTransformerRegistation\n];\nexport const RefBindingCommandRegistration = RefBindingCommand;\nexport const TriggerBindingCommandRegistration = TriggerBindingCommand;\nexport const DelegateBindingCommandRegistration = DelegateBindingCommand;\nexport const CaptureBindingCommandRegistration = CaptureBindingCommand;\nexport const AttrBindingCommandRegistration = AttrBindingCommand;\nexport const ClassBindingCommandRegistration = ClassBindingCommand;\nexport const StyleBindingCommandRegistration = StyleBindingCommand;\n/**\n * Default HTML-specific (but environment-agnostic) binding commands:\n * - Event listeners: `.trigger`, `.delegate`, `.capture`\n */\nexport const DefaultBindingLanguage = [\n    RefBindingCommandRegistration,\n    TriggerBindingCommandRegistration,\n    DelegateBindingCommandRegistration,\n    CaptureBindingCommandRegistration,\n    ClassBindingCommandRegistration,\n    StyleBindingCommandRegistration,\n    AttrBindingCommandRegistration\n];\n/**\n * A DI configuration object containing html-specific (but environment-agnostic) registrations:\n * - `RuntimeHtmlConfiguration` from `@aurelia/runtime-html`\n * - `DefaultComponents` from `@aurelia/jit`\n * - `DefaultBindingSyntax` from `@aurelia/jit`\n * - `DefaultBindingLanguage` from `@aurelia/jit`\n * - `DefaultComponents`\n * - `DefaultBindingLanguage`\n */\nexport const JitHtmlConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return RuntimeHtmlConfiguration\n            .register(container)\n            .register(...JitDefaultComponents, ...JitDefaultBindingSyntax, ...JitDefaultBindingLanguage, ...DefaultComponents, ...DefaultBindingLanguage);\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\n//# sourceMappingURL=configuration.js.map","import { Registration } from '@aurelia/kernel';\nimport { IAttrSyntaxTransformer } from './attribute-syntax-transformer';\nexport class HtmlAttrSyntaxTransformer {\n    static register(container) {\n        return Registration.singleton(IAttrSyntaxTransformer, this).register(container);\n    }\n    transform(node, attrSyntax) {\n        if (attrSyntax.command === 'bind' && shouldDefaultToTwoWay(node, attrSyntax)) {\n            attrSyntax.command = 'two-way';\n        }\n        attrSyntax.target = this.map(node.tagName, attrSyntax.target);\n    }\n    map(tagName, attr) {\n        switch (tagName) {\n            case 'LABEL':\n                switch (attr) {\n                    case 'for':\n                        return 'htmlFor';\n                    default:\n                        return attr;\n                }\n            case 'IMG':\n                switch (attr) {\n                    case 'usemap':\n                        return 'useMap';\n                    default:\n                        return attr;\n                }\n            case 'INPUT':\n                switch (attr) {\n                    case 'maxlength':\n                        return 'maxLength';\n                    case 'minlength':\n                        return 'minLength';\n                    case 'formaction':\n                        return 'formAction';\n                    case 'formenctype':\n                        return 'formEncType';\n                    case 'formmethod':\n                        return 'formMethod';\n                    case 'formnovalidate':\n                        return 'formNoValidate';\n                    case 'formtarget':\n                        return 'formTarget';\n                    case 'inputmode':\n                        return 'inputMode';\n                    default:\n                        return attr;\n                }\n            case 'TEXTAREA':\n                switch (attr) {\n                    case 'maxlength':\n                        return 'maxLength';\n                    default:\n                        return attr;\n                }\n            case 'TD':\n            case 'TH':\n                switch (attr) {\n                    case 'rowspan':\n                        return 'rowSpan';\n                    case 'colspan':\n                        return 'colSpan';\n                    default:\n                        return attr;\n                }\n            default:\n                switch (attr) {\n                    case 'accesskey':\n                        return 'accessKey';\n                    case 'contenteditable':\n                        return 'contentEditable';\n                    case 'tabindex':\n                        return 'tabIndex';\n                    case 'textcontent':\n                        return 'textContent';\n                    case 'innerhtml':\n                        return 'innerHTML';\n                    case 'scrolltop':\n                        return 'scrollTop';\n                    case 'scrollleft':\n                        return 'scrollLeft';\n                    case 'readonly':\n                        return 'readOnly';\n                    default:\n                        return attr;\n                }\n        }\n    }\n}\nfunction shouldDefaultToTwoWay(element, attr) {\n    switch (element.tagName) {\n        case 'INPUT':\n            switch (element.type) {\n                case 'checkbox':\n                case 'radio':\n                    return attr.target === 'checked';\n                default:\n                    return attr.target === 'value' || attr.target === 'files';\n            }\n        case 'TEXTAREA':\n        case 'SELECT':\n            return attr.target === 'value';\n        default:\n            switch (attr.target) {\n                case 'textcontent':\n                case 'innerhtml':\n                    return element.hasAttribute('contenteditable');\n                case 'scrolltop':\n                case 'scrollleft':\n                    return true;\n                default:\n                    return false;\n            }\n    }\n}\n//# sourceMappingURL=html-attribute-syntax-transformer.js.map","import { Scheduler, Now, } from '@aurelia/scheduler';\nimport { isNativeFunction, PLATFORM, } from '@aurelia/kernel';\nfunction createMicroTaskFlushRequestorFactory() {\n    return {\n        create(taskQueue) {\n            let requested = false;\n            let canceled = false;\n            const p = Promise.resolve();\n            function flush() {\n                if (canceled) {\n                    canceled = false;\n                }\n                else {\n                    requested = false;\n                    taskQueue.flush();\n                }\n            }\n            return {\n                request() {\n                    if (!requested) {\n                        canceled = false;\n                        requested = true;\n                        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n                        p.then(flush);\n                    }\n                },\n                cancel() {\n                    canceled = true;\n                    requested = false;\n                },\n            };\n        },\n    };\n}\nfunction createSetTimeoutFlushRequestorFactory(w) {\n    return {\n        create(taskQueue) {\n            let handle = -1;\n            function flush() {\n                if (handle > -1) {\n                    handle = -1;\n                    taskQueue.flush();\n                }\n            }\n            return {\n                cancel() {\n                    if (handle > -1) {\n                        w.clearTimeout(handle);\n                        handle = -1;\n                    }\n                },\n                request() {\n                    if (handle === -1) {\n                        handle = w.setTimeout(flush, 0);\n                    }\n                },\n            };\n        },\n    };\n}\nfunction createRequestAnimationFrameFlushRequestor(w) {\n    return {\n        create(taskQueue) {\n            let handle = -1;\n            function flush() {\n                if (handle > -1) {\n                    handle = -1;\n                    taskQueue.flush();\n                }\n            }\n            return {\n                cancel() {\n                    if (handle > -1) {\n                        w.cancelAnimationFrame(handle);\n                        handle = -1;\n                    }\n                },\n                request() {\n                    if (handle === -1) {\n                        handle = w.requestAnimationFrame(flush);\n                    }\n                },\n            };\n        },\n    };\n}\nfunction createPostRequestAnimationFrameFlushRequestor(w) {\n    return {\n        create(taskQueue) {\n            let rafHandle = -1;\n            let timeoutHandle = -1;\n            function flush() {\n                if (timeoutHandle > -1) {\n                    timeoutHandle = -1;\n                    taskQueue.flush();\n                }\n            }\n            function queueFlush() {\n                if (rafHandle > -1) {\n                    rafHandle = -1;\n                    if (timeoutHandle === -1) {\n                        timeoutHandle = w.setTimeout(flush, 0);\n                    }\n                }\n            }\n            return {\n                cancel() {\n                    if (rafHandle > -1) {\n                        w.cancelAnimationFrame(rafHandle);\n                        rafHandle = -1;\n                    }\n                    if (timeoutHandle > -1) {\n                        w.clearTimeout(timeoutHandle);\n                        timeoutHandle = -1;\n                    }\n                },\n                request() {\n                    if (rafHandle === -1) {\n                        rafHandle = w.requestAnimationFrame(queueFlush);\n                    }\n                },\n            };\n        },\n    };\n}\nfunction createRequestIdleCallbackFlushRequestor(w) {\n    return {\n        create(taskQueue) {\n            let handle = -1;\n            function flush() {\n                if (handle > -1) {\n                    handle = -1;\n                    taskQueue.flush();\n                }\n            }\n            if (typeof w.requestIdleCallback === 'function' &&\n                isNativeFunction(w.requestIdleCallback)) {\n                return {\n                    cancel() {\n                        if (handle > -1) {\n                            // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n                            w.cancelIdleCallback(handle);\n                            handle = -1;\n                        }\n                    },\n                    request() {\n                        if (handle === -1) {\n                            // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n                            handle = w.requestIdleCallback(flush);\n                        }\n                    },\n                };\n            }\n            else {\n                return {\n                    cancel() {\n                        if (handle > -1) {\n                            w.clearTimeout(handle);\n                            handle = -1;\n                        }\n                    },\n                    request() {\n                        if (handle === -1) {\n                            // Instead of trying anything fancy with event handler debouncers (we could do that if there was a request for it),\n                            // we just wait 45ms which is approximately the interval in a native idleCallback loop in chrome, to at least make it look\n                            // the same from a timing perspective\n                            handle = w.setTimeout(flush, 45);\n                        }\n                    },\n                };\n            }\n        },\n    };\n}\nexport function createDOMScheduler(container, w) {\n    let scheduler = Scheduler.get(PLATFORM.global);\n    if (scheduler === void 0) {\n        Scheduler.set(PLATFORM.global, scheduler = new Scheduler(container.get(Now), createMicroTaskFlushRequestorFactory(), createRequestAnimationFrameFlushRequestor(w), createSetTimeoutFlushRequestorFactory(w), createPostRequestAnimationFrameFlushRequestor(w), createRequestIdleCallbackFlushRequestor(w)));\n    }\n    return scheduler;\n}\n//# sourceMappingURL=index.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DI, IContainer, Registration } from '@aurelia/kernel';\nimport { IDOM, IDOMInitializer, IScheduler } from '@aurelia/runtime';\nimport { RuntimeHtmlConfiguration, HTMLDOM } from '@aurelia/runtime-html';\nimport { createDOMScheduler } from '@aurelia/scheduler-dom';\nlet BrowserDOMInitializer = class BrowserDOMInitializer {\n    constructor(container) {\n        this.container = container;\n    }\n    static register(container) {\n        return Registration.singleton(IDOMInitializer, this).register(container);\n    }\n    initialize(config) {\n        if (this.container.has(IDOM, false)) {\n            return this.container.get(IDOM);\n        }\n        let dom;\n        if (config !== undefined) {\n            if (config.dom !== undefined) {\n                dom = config.dom;\n            }\n            else if (config.host.ownerDocument !== null) {\n                dom = new HTMLDOM(window, config.host.ownerDocument, Node, Element, HTMLElement, CustomEvent, CSSStyleSheet, ShadowRoot);\n            }\n            else {\n                dom = new HTMLDOM(window, document, Node, Element, HTMLElement, CustomEvent, CSSStyleSheet, ShadowRoot);\n            }\n        }\n        else {\n            dom = new HTMLDOM(window, document, Node, Element, HTMLElement, CustomEvent, CSSStyleSheet, ShadowRoot);\n        }\n        Registration.instance(IDOM, dom).register(this.container);\n        Registration.instance(IScheduler, createDOMScheduler(this.container, window)).register(this.container);\n        return dom;\n    }\n};\nBrowserDOMInitializer = __decorate([\n    __param(0, IContainer),\n    __metadata(\"design:paramtypes\", [Object])\n], BrowserDOMInitializer);\nexport const IDOMInitializerRegistration = BrowserDOMInitializer;\n/**\n * Default HTML-specific, browser-specific implementations for the following interfaces:\n * - `IDOMInitializer`\n */\nexport const DefaultComponents = [\n    IDOMInitializerRegistration,\n];\n/**\n * A DI configuration object containing html-specific, browser-specific registrations:\n * - `RuntimeHtmlConfiguration` from `@aurelia/runtime-html`\n * - `DefaultComponents`\n */\nexport const RuntimeHtmlBrowserConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return RuntimeHtmlConfiguration\n            .register(container)\n            .register(...DefaultComponents);\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\nexport { BrowserDOMInitializer, };\n//# sourceMappingURL=index.js.map","import { DefaultBindingLanguage as JitDefaultBindingLanguage, DefaultBindingSyntax as JitDefaultBindingSyntax, DefaultComponents as JitDefaultComponents } from '@aurelia/jit';\nimport { DefaultBindingLanguage as JitHtmlDefaultBindingLanguage, DefaultComponents as JitHtmlDefaultComponents } from '@aurelia/jit-html';\nimport { DI, Profiler } from '@aurelia/kernel';\nimport { RuntimeHtmlBrowserConfiguration } from '@aurelia/runtime-html-browser';\nconst { enter, leave } = Profiler.createTimer('JitHtmlBrowserConfiguration');\n/**\n * A DI configuration object containing html-specific, browser-specific registrations:\n * - `RuntimeHtmlBrowserConfiguration` from `@aurelia/runtime-html-browser`\n * - `DefaultComponents` from `@aurelia/jit`\n * - `DefaultBindingSyntax` from `@aurelia/jit`\n * - `DefaultBindingLanguage` from `@aurelia/jit`\n * - `DefaultComponents` from `@aurelia/jit-html`\n * - `DefaultBindingLanguage` from `@aurelia/jit-html`\n */\nexport const JitHtmlBrowserConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        RuntimeHtmlBrowserConfiguration\n            .register(container)\n            .register(...JitDefaultBindingLanguage, ...JitDefaultBindingSyntax, ...JitDefaultComponents, ...JitHtmlDefaultBindingLanguage, ...JitHtmlDefaultComponents);\n        return container;\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\n//# sourceMappingURL=index.js.map","import { DebugConfiguration } from '@aurelia/debug';\nimport { JitHtmlBrowserConfiguration } from '@aurelia/jit-html-browser';\nimport { DI } from '@aurelia/kernel';\nimport { Aurelia as $Aurelia, CustomElement } from '@aurelia/runtime';\n// TODO: SSR?? abstract HTMLElement and document.\nfunction createAurelia() {\n    const au = new Aurelia();\n    au.register(JitHtmlBrowserConfiguration);\n    // eslint-disable-next-line sonarjs/no-collapsible-if\n    if (typeof process !== 'undefined' && typeof process.env === 'object') {\n        // Just use NODE_ENV to control build process.\n        // Bundlers (at least webpack/dumber/parcel) have feature to remove this branch in production.\n        // Then tree-shaking/minifier will remove unused DebugConfiguration import.\n        if (process.env.NODE_ENV !== 'production') {\n            au.register(DebugConfiguration);\n        }\n    }\n    return au;\n}\nexport class Aurelia extends $Aurelia {\n    constructor(container = DI.createContainer()) {\n        super(container);\n    }\n    static start(root) {\n        return createAurelia().start(root);\n    }\n    static app(config) {\n        return createAurelia().app(config);\n    }\n    static register(...params) {\n        return createAurelia().register(...params);\n    }\n    app(config) {\n        if (CustomElement.isType(config)) {\n            // Default to custom element element name\n            const definition = CustomElement.getDefinition(config);\n            let host = document.querySelector(definition.name);\n            if (host === null) {\n                // When no target is found, default to body.\n                // For example, when user forgot to write <my-app></my-app> in html.\n                host = document.body;\n            }\n            return super.app({\n                host: host,\n                component: config\n            });\n        }\n        return super.app(config);\n    }\n}\n//# sourceMappingURL=quick-start.js.map","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","var api = require(\"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../node_modules/css-loader/dist/cjs.js!../node_modules/postcss-loader/src/index.js??ref--8-2!./my-app.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","\"use strict\";\n\nvar isOldIE = function isOldIE() {\n  var memo;\n  return function memorize() {\n    if (typeof memo === 'undefined') {\n      // Test for IE <= 9 as proposed by Browserhacks\n      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n      // Tests for existence of standard globals is to allow style-loader\n      // to operate correctly into non-standard environments\n      // @see https://github.com/webpack-contrib/style-loader/issues/177\n      memo = Boolean(window && document && document.all && !window.atob);\n    }\n\n    return memo;\n  };\n}();\n\nvar getTarget = function getTarget() {\n  var memo = {};\n  return function memorize(target) {\n    if (typeof memo[target] === 'undefined') {\n      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n        try {\n          // This will throw an exception if access to iframe is blocked\n          // due to cross-origin restrictions\n          styleTarget = styleTarget.contentDocument.head;\n        } catch (e) {\n          // istanbul ignore next\n          styleTarget = null;\n        }\n      }\n\n      memo[target] = styleTarget;\n    }\n\n    return memo[target];\n  };\n}();\n\nvar stylesInDom = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDom.length; i++) {\n    if (stylesInDom[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var index = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3]\n    };\n\n    if (index !== -1) {\n      stylesInDom[index].references++;\n      stylesInDom[index].updater(obj);\n    } else {\n      stylesInDom.push({\n        identifier: identifier,\n        updater: addStyle(obj, options),\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction insertStyleElement(options) {\n  var style = document.createElement('style');\n  var attributes = options.attributes || {};\n\n  if (typeof attributes.nonce === 'undefined') {\n    var nonce = typeof __webpack_nonce__ !== 'undefined' ? __webpack_nonce__ : null;\n\n    if (nonce) {\n      attributes.nonce = nonce;\n    }\n  }\n\n  Object.keys(attributes).forEach(function (key) {\n    style.setAttribute(key, attributes[key]);\n  });\n\n  if (typeof options.insert === 'function') {\n    options.insert(style);\n  } else {\n    var target = getTarget(options.insert || 'head');\n\n    if (!target) {\n      throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n    }\n\n    target.appendChild(style);\n  }\n\n  return style;\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nvar replaceText = function replaceText() {\n  var textStore = [];\n  return function replace(index, replacement) {\n    textStore[index] = replacement;\n    return textStore.filter(Boolean).join('\\n');\n  };\n}();\n\nfunction applyToSingletonTag(style, index, remove, obj) {\n  var css = remove ? '' : obj.media ? \"@media \".concat(obj.media, \" {\").concat(obj.css, \"}\") : obj.css; // For old IE\n\n  /* istanbul ignore if  */\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = replaceText(index, css);\n  } else {\n    var cssNode = document.createTextNode(css);\n    var childNodes = style.childNodes;\n\n    if (childNodes[index]) {\n      style.removeChild(childNodes[index]);\n    }\n\n    if (childNodes.length) {\n      style.insertBefore(cssNode, childNodes[index]);\n    } else {\n      style.appendChild(cssNode);\n    }\n  }\n}\n\nfunction applyToTag(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute('media', media);\n  } else {\n    style.removeAttribute('media');\n  }\n\n  if (sourceMap && btoa) {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar singleton = null;\nvar singletonCounter = 0;\n\nfunction addStyle(obj, options) {\n  var style;\n  var update;\n  var remove;\n\n  if (options.singleton) {\n    var styleIndex = singletonCounter++;\n    style = singleton || (singleton = insertStyleElement(options));\n    update = applyToSingletonTag.bind(null, style, styleIndex, false);\n    remove = applyToSingletonTag.bind(null, style, styleIndex, true);\n  } else {\n    style = insertStyleElement(options);\n    update = applyToTag.bind(null, style, options);\n\n    remove = function remove() {\n      removeStyleElement(style);\n    };\n  }\n\n  update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      update(obj = newObj);\n    } else {\n      remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n  // tags it will allow on a page\n\n  if (!options.singleton && typeof options.singleton !== 'boolean') {\n    options.singleton = isOldIE();\n  }\n\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    if (Object.prototype.toString.call(newList) !== '[object Array]') {\n      return;\n    }\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDom[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDom[_index].references === 0) {\n        stylesInDom[_index].updater();\n\n        stylesInDom.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"nav {\\n  background: #eee;\\n  display: flex;\\n}\\n\\na {\\n  padding: 10px;\\n  text-decoration: none;\\n  color: black;\\n}\\n\\na:hover {\\n  background-color: darkgray;\\n}\\n\\n.goto-active {\\n  background-color: lightgray;\\n}\\n\", \"\"]);\n// Exports\nmodule.exports = exports;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (useSourceMap) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item, useSourceMap);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join('');\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === 'string') {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, '']];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n  var content = item[1] || ''; // eslint-disable-next-line prefer-destructuring\n\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (useSourceMap && typeof btoa === 'function') {\n    var sourceMapping = toComment(cssMapping);\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || '').concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n  }\n\n  return [content].join('\\n');\n} // Adapted from convert-source-map (MIT)\n\n\nfunction toComment(sourceMap) {\n  // eslint-disable-next-line no-undef\n  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n  var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n  return \"/*# \".concat(data, \" */\");\n}","import { DOM } from '@aurelia/runtime-html';\nexport const retryStrategy = {\n    fixed: 0,\n    incremental: 1,\n    exponential: 2,\n    random: 3\n};\nconst defaultRetryConfig = {\n    maxRetries: 3,\n    interval: 1000,\n    strategy: retryStrategy.fixed\n};\n/**\n * Interceptor that retries requests on error, based on a given RetryConfiguration.\n */\nexport class RetryInterceptor {\n    /**\n     * Creates an instance of RetryInterceptor.\n     */\n    constructor(retryConfig) {\n        this.retryConfig = { ...defaultRetryConfig, ...(retryConfig !== undefined ? retryConfig : {}) };\n        if (this.retryConfig.strategy === retryStrategy.exponential &&\n            this.retryConfig.interval <= 1000) {\n            throw new Error('An interval less than or equal to 1 second is not allowed when using the exponential retry strategy');\n        }\n    }\n    /**\n     * Called with the request before it is sent. It remembers the request so it can be retried on error.\n     *\n     * @param request - The request to be sent.\n     * @returns The existing request, a new request or a response; or a Promise for any of these.\n     */\n    request(request) {\n        if (!request.retryConfig) {\n            request.retryConfig = { ...this.retryConfig };\n            request.retryConfig.counter = 0;\n        }\n        // do this on every request\n        request.retryConfig.requestClone = request.clone();\n        return request;\n    }\n    /**\n     * Called with the response after it is received. Clears the remembered request, as it was succesfull.\n     *\n     * @param response - The response.\n     * @returns The response; or a Promise for one.\n     */\n    response(response, request) {\n        // retry was successful, so clean up after ourselves\n        Reflect.deleteProperty(request, 'retryConfig');\n        return response;\n    }\n    /**\n     * Handles fetch errors and errors generated by previous interceptors. This\n     * function acts as a Promise rejection handler. It wil retry the remembered request based on the\n     * configured RetryConfiguration.\n     *\n     * @param error - The rejection value from the fetch request or from a\n     * previous interceptor.\n     * @returns The response of the retry; or a Promise for one.\n     */\n    responseError(error, request, httpClient) {\n        const { retryConfig } = request;\n        const { requestClone } = retryConfig;\n        return Promise.resolve().then(() => {\n            if (retryConfig.counter < retryConfig.maxRetries) {\n                const result = retryConfig.doRetry !== undefined ? retryConfig.doRetry(error, request) : true;\n                return Promise.resolve(result).then(doRetry => {\n                    if (doRetry) {\n                        retryConfig.counter++;\n                        const delay = calculateDelay(retryConfig);\n                        return new Promise((resolve) => DOM.window.setTimeout(resolve, !isNaN(delay) ? delay : 0))\n                            .then(() => {\n                            const newRequest = requestClone.clone();\n                            if (typeof (retryConfig.beforeRetry) === 'function') {\n                                return retryConfig.beforeRetry(newRequest, httpClient);\n                            }\n                            return newRequest;\n                        })\n                            .then(newRequest => {\n                            const retryableRequest = { ...newRequest, retryConfig };\n                            return httpClient.fetch(retryableRequest);\n                        });\n                    }\n                    // no more retries, so clean up\n                    Reflect.deleteProperty(request, 'retryConfig');\n                    throw error;\n                });\n            }\n            // no more retries, so clean up\n            Reflect.deleteProperty(request, 'retryConfig');\n            throw error;\n        });\n    }\n}\nfunction calculateDelay(retryConfig) {\n    const { interval, strategy, minRandomInterval, maxRandomInterval, counter } = retryConfig;\n    if (typeof (strategy) === 'function') {\n        return retryConfig.strategy(counter);\n    }\n    switch (strategy) {\n        case (retryStrategy.fixed):\n            return retryStrategies[retryStrategy.fixed](interval);\n        case (retryStrategy.incremental):\n            return retryStrategies[retryStrategy.incremental](counter, interval);\n        case (retryStrategy.exponential):\n            return retryStrategies[retryStrategy.exponential](counter, interval);\n        case (retryStrategy.random):\n            return retryStrategies[retryStrategy.random](counter, interval, minRandomInterval, maxRandomInterval);\n        default:\n            throw new Error('Unrecognized retry strategy');\n    }\n}\nconst retryStrategies = [\n    // fixed\n    interval => interval,\n    // incremental\n    (retryCount, interval) => interval * retryCount,\n    // exponential\n    (retryCount, interval) => retryCount === 1 ? interval : interval ** retryCount / 1000,\n    // random\n    (retryCount, interval, minRandomInterval = 0, maxRandomInterval = 60000) => {\n        return Math.random() * (maxRandomInterval - minRandomInterval) + minRandomInterval;\n    }\n];\n//# sourceMappingURL=retry-interceptor.js.map","import { RetryInterceptor } from './retry-interceptor';\n/**\n * A class for configuring HttpClients.\n */\nexport class HttpClientConfiguration {\n    constructor() {\n        /**\n         * The base URL to be prepended to each Request's url before sending.\n         */\n        this.baseUrl = '';\n        /**\n         * Default values to apply to init objects when creating Requests. Note that\n         * defaults cannot be applied when Request objects are manually created because\n         * Request provides its own defaults and discards the original init object.\n         * See also https://developer.mozilla.org/en-US/docs/Web/API/Request/Request\n         */\n        this.defaults = {};\n        /**\n         * Interceptors to be added to the HttpClient.\n         */\n        this.interceptors = [];\n    }\n    /**\n     * Sets the baseUrl.\n     *\n     * @param baseUrl - The base URL.\n     * @returns The chainable instance of this configuration object.\n     * @chainable\n     */\n    withBaseUrl(baseUrl) {\n        this.baseUrl = baseUrl;\n        return this;\n    }\n    /**\n     * Sets the defaults.\n     *\n     * @param defaults - The defaults.\n     * @returns The chainable instance of this configuration object.\n     * @chainable\n     */\n    withDefaults(defaults) {\n        this.defaults = defaults;\n        return this;\n    }\n    /**\n     * Adds an interceptor to be run on all requests or responses.\n     *\n     * @param interceptor - An object with request, requestError,\n     * response, or responseError methods. request and requestError act as\n     * resolve and reject handlers for the Request before it is sent.\n     * response and responseError act as resolve and reject handlers for\n     * the Response after it has been received.\n     * @returns The chainable instance of this configuration object.\n     * @chainable\n     */\n    withInterceptor(interceptor) {\n        this.interceptors.push(interceptor);\n        return this;\n    }\n    /**\n     * Applies a configuration that addresses common application needs, including\n     * configuring same-origin credentials, and using rejectErrorResponses.\n     *\n     * @returns The chainable instance of this configuration object.\n     * @chainable\n     */\n    useStandardConfiguration() {\n        const standardConfig = { credentials: 'same-origin' };\n        Object.assign(this.defaults, standardConfig, this.defaults);\n        return this.rejectErrorResponses();\n    }\n    /**\n     * Causes Responses whose status codes fall outside the range 200-299 to reject.\n     * The fetch API only rejects on network errors or other conditions that prevent\n     * the request from completing, meaning consumers must inspect Response.ok in the\n     * Promise continuation to determine if the server responded with a success code.\n     * This method adds a response interceptor that causes Responses with error codes\n     * to be rejected, which is common behavior in HTTP client libraries.\n     *\n     * @returns The chainable instance of this configuration object.\n     * @chainable\n     */\n    rejectErrorResponses() {\n        return this.withInterceptor({ response: rejectOnError });\n    }\n    withRetry(config) {\n        const interceptor = new RetryInterceptor(config);\n        return this.withInterceptor(interceptor);\n    }\n}\nfunction rejectOnError(response) {\n    if (!response.ok) {\n        throw response;\n    }\n    return response;\n}\n//# sourceMappingURL=http-client-configuration.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { IDOM } from '@aurelia/runtime';\nimport { DOM, HTMLDOM } from '@aurelia/runtime-html';\nimport { HttpClientConfiguration } from './http-client-configuration';\nimport { RetryInterceptor } from './retry-interceptor';\nconst absoluteUrlRegexp = /^([a-z][a-z0-9+\\-.]*:)?\\/\\//i;\n/**\n * An HTTP client based on the Fetch API.\n */\nlet HttpClient = class HttpClient {\n    /**\n     * Creates an instance of HttpClient.\n     */\n    constructor(dom) {\n        this.dom = dom;\n        if (dom.window.fetch === undefined) {\n            throw new Error('HttpClient requires a Fetch API implementation, but the current environment doesn\\'t support it. You may need to load a polyfill such as https://github.com/github/fetch');\n        }\n        this.dom = dom;\n        this.activeRequestCount = 0;\n        this.isRequesting = false;\n        this.isConfigured = false;\n        this.baseUrl = '';\n        this.defaults = null;\n        this.interceptors = [];\n    }\n    /**\n     * Configure this client with default settings to be used by all requests.\n     *\n     * @param config - A configuration object, or a function that takes a config\n     * object and configures it.\n     * @returns The chainable instance of this HttpClient.\n     * @chainable\n     */\n    configure(config) {\n        let normalizedConfig;\n        if (typeof config === 'object') {\n            const requestInitConfiguration = { defaults: config };\n            normalizedConfig = requestInitConfiguration;\n        }\n        else if (typeof config === 'function') {\n            normalizedConfig = new HttpClientConfiguration();\n            normalizedConfig.baseUrl = this.baseUrl;\n            normalizedConfig.defaults = { ...this.defaults };\n            normalizedConfig.interceptors = this.interceptors;\n            const c = config(normalizedConfig);\n            if (Object.prototype.isPrototypeOf.call(HttpClientConfiguration.prototype, c)) {\n                normalizedConfig = c;\n            }\n        }\n        else {\n            throw new Error('invalid config');\n        }\n        const defaults = normalizedConfig.defaults;\n        if (defaults !== undefined && Object.prototype.isPrototypeOf.call(Headers.prototype, defaults.headers)) {\n            // Headers instances are not iterable in all browsers. Require a plain\n            // object here to allow default headers to be merged into request headers.\n            throw new Error('Default headers must be a plain object.');\n        }\n        const interceptors = normalizedConfig.interceptors;\n        if (interceptors !== undefined && interceptors.length) {\n            // find if there is a RetryInterceptor\n            if (interceptors.filter(x => Object.prototype.isPrototypeOf.call(RetryInterceptor.prototype, x)).length > 1) {\n                throw new Error('Only one RetryInterceptor is allowed.');\n            }\n            const retryInterceptorIndex = interceptors.findIndex(x => Object.prototype.isPrototypeOf.call(RetryInterceptor.prototype, x));\n            if (retryInterceptorIndex >= 0 && retryInterceptorIndex !== interceptors.length - 1) {\n                throw new Error('The retry interceptor must be the last interceptor defined.');\n            }\n        }\n        this.baseUrl = normalizedConfig.baseUrl;\n        this.defaults = defaults;\n        this.interceptors = normalizedConfig.interceptors !== undefined ? normalizedConfig.interceptors : [];\n        this.isConfigured = true;\n        return this;\n    }\n    /**\n     * Starts the process of fetching a resource. Default configuration parameters\n     * will be applied to the Request. The constructed Request will be passed to\n     * registered request interceptors before being sent. The Response will be passed\n     * to registered Response interceptors before it is returned.\n     *\n     * See also https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API\n     *\n     * @param input - The resource that you wish to fetch. Either a\n     * Request object, or a string containing the URL of the resource.\n     * @param init - An options object containing settings to be applied to\n     * the Request.\n     * @returns A Promise for the Response from the fetch request.\n     */\n    fetch(input, init) {\n        this.trackRequestStart();\n        let request = this.buildRequest(input, init);\n        return this.processRequest(request, this.interceptors).then(result => {\n            let response;\n            if (Object.prototype.isPrototypeOf.call(Response.prototype, result)) {\n                response = Promise.resolve(result);\n            }\n            else if (Object.prototype.isPrototypeOf.call(Request.prototype, result)) {\n                request = result;\n                response = fetch(request);\n            }\n            else {\n                throw new Error(`An invalid result was returned by the interceptor chain. Expected a Request or Response instance, but got [${result}]`);\n            }\n            return this.processResponse(response, this.interceptors, request);\n        })\n            .then(result => {\n            if (Object.prototype.isPrototypeOf.call(Request.prototype, result)) {\n                return this.fetch(result);\n            }\n            return result;\n        })\n            .then(result => {\n            this.trackRequestEnd();\n            return result;\n        }, error => {\n            this.trackRequestEnd();\n            throw error;\n        });\n    }\n    buildRequest(input, init) {\n        const defaults = this.defaults !== null ? this.defaults : {};\n        let request;\n        let body;\n        let requestContentType;\n        const parsedDefaultHeaders = parseHeaderValues(defaults.headers);\n        if (Object.prototype.isPrototypeOf.call(Request.prototype, input)) {\n            request = input;\n            requestContentType = new Headers(request.headers).get('Content-Type');\n        }\n        else {\n            if (!init) {\n                init = {};\n            }\n            body = init.body;\n            const bodyObj = body !== undefined ? { body: body } : null;\n            const requestInit = { ...defaults, headers: {}, ...init, ...bodyObj };\n            requestContentType = new Headers(requestInit.headers).get('Content-Type');\n            request = new Request(getRequestUrl(this.baseUrl, input), requestInit);\n        }\n        if (!requestContentType) {\n            if (new Headers(parsedDefaultHeaders).has('content-type')) {\n                request.headers.set('Content-Type', new Headers(parsedDefaultHeaders).get('content-type'));\n            }\n            else if (body !== undefined && isJSON(body)) {\n                request.headers.set('Content-Type', 'application/json');\n            }\n        }\n        setDefaultHeaders(request.headers, parsedDefaultHeaders);\n        if (body !== undefined && Object.prototype.isPrototypeOf.call(Blob.prototype, body) && body.type) {\n            // work around bug in IE & Edge where the Blob type is ignored in the request\n            // https://connect.microsoft.com/IE/feedback/details/2136163\n            request.headers.set('Content-Type', body.type);\n        }\n        return request;\n    }\n    /**\n     * Calls fetch as a GET request.\n     *\n     * @param input - The resource that you wish to fetch. Either a\n     * Request object, or a string containing the URL of the resource.\n     * @param init - An options object containing settings to be applied to\n     * the Request.\n     * @returns A Promise for the Response from the fetch request.\n     */\n    get(input, init) {\n        return this.fetch(input, init);\n    }\n    /**\n     * Calls fetch with request method set to POST.\n     *\n     * @param input - The resource that you wish to fetch. Either a\n     * Request object, or a string containing the URL of the resource.\n     * @param body - The body of the request.\n     * @param init - An options object containing settings to be applied to\n     * the Request.\n     * @returns A Promise for the Response from the fetch request.\n     */\n    post(input, body, init) {\n        return this.callFetch(input, body, init, 'POST');\n    }\n    /**\n     * Calls fetch with request method set to PUT.\n     *\n     * @param input - The resource that you wish to fetch. Either a\n     * Request object, or a string containing the URL of the resource.\n     * @param body - The body of the request.\n     * @param init - An options object containing settings to be applied to\n     * the Request.\n     * @returns A Promise for the Response from the fetch request.\n     */\n    put(input, body, init) {\n        return this.callFetch(input, body, init, 'PUT');\n    }\n    /**\n     * Calls fetch with request method set to PATCH.\n     *\n     * @param input - The resource that you wish to fetch. Either a\n     * Request object, or a string containing the URL of the resource.\n     * @param body - The body of the request.\n     * @param init - An options object containing settings to be applied to\n     * the Request.\n     * @returns A Promise for the Response from the fetch request.\n     */\n    patch(input, body, init) {\n        return this.callFetch(input, body, init, 'PATCH');\n    }\n    /**\n     * Calls fetch with request method set to DELETE.\n     *\n     * @param input - The resource that you wish to fetch. Either a\n     * Request object, or a string containing the URL of the resource.\n     * @param body - The body of the request.\n     * @param init - An options object containing settings to be applied to\n     * the Request.\n     * @returns A Promise for the Response from the fetch request.\n     */\n    delete(input, body, init) {\n        return this.callFetch(input, body, init, 'DELETE');\n    }\n    trackRequestStart() {\n        this.isRequesting = !!(++this.activeRequestCount);\n        if (this.isRequesting) {\n            const evt = DOM.createCustomEvent('aurelia-fetch-client-request-started', { bubbles: true, cancelable: true });\n            DOM.window.setTimeout(() => { DOM.dispatchEvent(evt); }, 1);\n        }\n    }\n    trackRequestEnd() {\n        this.isRequesting = !!(--this.activeRequestCount);\n        if (!this.isRequesting) {\n            const evt = DOM.createCustomEvent('aurelia-fetch-client-requests-drained', { bubbles: true, cancelable: true });\n            DOM.window.setTimeout(() => { DOM.dispatchEvent(evt); }, 1);\n        }\n    }\n    processRequest(request, interceptors) {\n        return this.applyInterceptors(request, interceptors, 'request', 'requestError', this);\n    }\n    processResponse(response, interceptors, request) {\n        return this.applyInterceptors(response, interceptors, 'response', 'responseError', request, this);\n    }\n    applyInterceptors(input, interceptors, successName, errorName, ...interceptorArgs) {\n        return (interceptors !== undefined ? interceptors : [])\n            .reduce((chain, interceptor) => {\n            const successHandler = interceptor[successName];\n            const errorHandler = interceptor[errorName];\n            // TODO: Fix this, as it violates `strictBindCallApply`.\n            return chain.then(successHandler ? (value => successHandler.call(interceptor, value, ...interceptorArgs)) : identity, errorHandler ? (reason => errorHandler.call(interceptor, reason, ...interceptorArgs)) : thrower);\n        }, Promise.resolve(input));\n    }\n    callFetch(input, body, init, method) {\n        if (!init) {\n            init = {};\n        }\n        init.method = method;\n        if (body) {\n            init.body = body;\n        }\n        return this.fetch(input, init);\n    }\n};\nHttpClient = __decorate([\n    __param(0, IDOM),\n    __metadata(\"design:paramtypes\", [HTMLDOM])\n], HttpClient);\nexport { HttpClient };\nfunction parseHeaderValues(headers) {\n    const parsedHeaders = {};\n    const $headers = headers !== undefined ? headers : {};\n    for (const name in $headers) {\n        if (Object.prototype.hasOwnProperty.call($headers, name)) {\n            parsedHeaders[name] = (typeof $headers[name] === 'function')\n                ? $headers[name]()\n                : $headers[name];\n        }\n    }\n    return parsedHeaders;\n}\nfunction getRequestUrl(baseUrl, url) {\n    if (absoluteUrlRegexp.test(url)) {\n        return url;\n    }\n    return (baseUrl !== undefined ? baseUrl : '') + url;\n}\nfunction setDefaultHeaders(headers, defaultHeaders) {\n    const $defaultHeaders = defaultHeaders !== undefined ? defaultHeaders : {};\n    for (const name in $defaultHeaders) {\n        if (Object.prototype.hasOwnProperty.call($defaultHeaders, name) && !headers.has(name)) {\n            headers.set(name, $defaultHeaders[name]);\n        }\n    }\n}\nfunction isJSON(str) {\n    try {\n        JSON.parse(str);\n    }\n    catch (err) {\n        return false;\n    }\n    return true;\n}\nfunction identity(x) {\n    return x;\n}\nfunction thrower(x) {\n    throw x;\n}\n//# sourceMappingURL=http-client.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { bound } from '@aurelia/kernel';\n/**\n * A first-in-first-out queue that only processes the next queued item\n * when the current one has been resolved or rejected. Sends queued items\n * one at a time to a specified callback function. The callback function\n * should resolve or reject the queued item when processing is done.\n * Enqueued items can be awaited. Enqueued items can specify an (arbitrary)\n * execution cost and the queue can be set up (activated) to only process\n * a specific amount of execution cost per RAF/tick.\n *\n * @internal - Shouldn't be used directly.\n */\nexport class Queue {\n    constructor(callback) {\n        this.callback = callback;\n        this.pending = [];\n        this.processing = null;\n        this.allowedExecutionCostWithinTick = null;\n        this.currentExecutionCostInCurrentTick = 0;\n        this.scheduler = null;\n        this.task = null;\n    }\n    get isActive() {\n        return this.task !== null;\n    }\n    get length() {\n        return this.pending.length;\n    }\n    activate(options) {\n        if (this.isActive) {\n            throw new Error('Queue has already been activated');\n        }\n        this.scheduler = options.scheduler;\n        this.allowedExecutionCostWithinTick = options.allowedExecutionCostWithinTick;\n        this.task = this.scheduler.queueRenderTask(this.dequeue, { persistent: true });\n    }\n    deactivate() {\n        if (!this.isActive) {\n            throw new Error('Queue has not been activated');\n        }\n        this.task.cancel();\n        this.task = null;\n        this.allowedExecutionCostWithinTick = null;\n        this.clear();\n    }\n    enqueue(itemOrItems, costOrCosts) {\n        const list = Array.isArray(itemOrItems);\n        const items = list ? itemOrItems : [itemOrItems];\n        const costs = items\n            .map((value, index) => !Array.isArray(costOrCosts) ? costOrCosts : costOrCosts[index])\n            .map(value => value !== undefined ? value : 1);\n        const promises = [];\n        for (const item of items) {\n            const qItem = { ...item };\n            qItem.cost = costs.shift();\n            promises.push(new Promise((resolve, reject) => {\n                qItem.resolve = () => {\n                    resolve();\n                    this.processing = null;\n                    this.dequeue();\n                };\n                qItem.reject = (reason) => {\n                    reject(reason);\n                    this.processing = null;\n                    this.dequeue();\n                };\n            }));\n            this.pending.push(qItem);\n        }\n        this.dequeue();\n        return list ? promises : promises[0];\n    }\n    dequeue(delta) {\n        if (this.processing !== null) {\n            return;\n        }\n        if (delta !== undefined) {\n            this.currentExecutionCostInCurrentTick = 0;\n        }\n        if (!this.pending.length) {\n            return;\n        }\n        if (this.allowedExecutionCostWithinTick !== null && delta === undefined && this.currentExecutionCostInCurrentTick + (this.pending[0].cost || 0) > this.allowedExecutionCostWithinTick) {\n            return;\n        }\n        this.processing = this.pending.shift() || null;\n        if (this.processing) {\n            this.currentExecutionCostInCurrentTick += this.processing.cost || 0;\n            this.callback(this.processing);\n        }\n    }\n    clear() {\n        this.pending.splice(0, this.pending.length);\n    }\n}\n__decorate([\n    bound,\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", [Number]),\n    __metadata(\"design:returntype\", void 0)\n], Queue.prototype, \"dequeue\", null);\n//# sourceMappingURL=queue.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Reporter } from '@aurelia/kernel';\nimport { IDOM, IScheduler } from '@aurelia/runtime';\nimport { HTMLDOM } from '@aurelia/runtime-html';\nimport { Queue } from './queue';\n/**\n * @internal - Will be removed\n */\nlet BrowserNavigator = class BrowserNavigator {\n    constructor(scheduler, dom) {\n        this.scheduler = scheduler;\n        this.allowedExecutionCostWithinTick = 2; // Limit no of executed actions within the same RAF (due to browser limitation)\n        this.isActive = false;\n        this.options = {\n            useUrlFragmentHash: true,\n            callback: () => { return; },\n        };\n        this.forwardedState = {};\n        this.handlePopstate = (ev) => {\n            return this.enqueue(this, 'popstate', [ev]);\n        };\n        this.processCalls = (qCall) => {\n            const call = qCall;\n            if (call.target === this && call.methodName !== 'forwardState') {\n                call.parameters.push(this.forwardedState.resolve);\n                this.forwardedState.resolve = null;\n                // Should we suppress this popstate event?\n                if (call.methodName === 'popstate' && this.forwardedState.suppressPopstate) {\n                    call.parameters.push(true);\n                    this.forwardedState.suppressPopstate = false;\n                }\n            }\n            // eslint-disable-next-line @typescript-eslint/ban-types\n            const method = call.target[call.methodName];\n            Reporter.write(10000, 'DEQUEUE', call.methodName, call.parameters);\n            if (method) {\n                method.apply(call.target, call.parameters);\n            }\n            qCall.resolve();\n        };\n        this.window = dom.window;\n        this.history = dom.window.history;\n        this.location = dom.window.location;\n        this.pendingCalls = new Queue(this.processCalls);\n    }\n    activate(options) {\n        if (this.isActive) {\n            throw new Error('Browser navigation has already been activated');\n        }\n        this.isActive = true;\n        this.options.callback = options.callback;\n        if (options.useUrlFragmentHash != void 0) {\n            this.options.useUrlFragmentHash = options.useUrlFragmentHash;\n        }\n        this.pendingCalls.activate({ scheduler: this.scheduler, allowedExecutionCostWithinTick: this.allowedExecutionCostWithinTick });\n        this.window.addEventListener('popstate', this.handlePopstate);\n    }\n    deactivate() {\n        if (!this.isActive) {\n            throw new Error('Browser navigation has not been activated');\n        }\n        this.window.removeEventListener('popstate', this.handlePopstate);\n        this.pendingCalls.deactivate();\n        this.options = { useUrlFragmentHash: true, callback: () => { return; } };\n        this.isActive = false;\n    }\n    get length() {\n        return this.history.length;\n    }\n    get state() {\n        return this.history.state;\n    }\n    get viewerState() {\n        const { pathname, search, hash } = this.location;\n        return {\n            path: pathname,\n            query: search,\n            hash,\n            instruction: this.options.useUrlFragmentHash ? hash.slice(1) : pathname,\n        };\n    }\n    go(delta, suppressPopstate = false) {\n        return this.enqueue(this.history, 'go', [delta], suppressPopstate);\n    }\n    pushNavigatorState(state) {\n        const { title, path } = state.currentEntry;\n        const fragment = this.options.useUrlFragmentHash ? '#/' : '';\n        return this.enqueue(this.history, 'pushState', [state, title, `${fragment}${path}`]);\n    }\n    replaceNavigatorState(state) {\n        const { title, path } = state.currentEntry;\n        const fragment = this.options.useUrlFragmentHash ? '#/' : '';\n        return this.enqueue(this.history, 'replaceState', [state, title, `${fragment}${path}`]);\n    }\n    popNavigatorState() {\n        return this.enqueue(this, 'popState', []);\n    }\n    popstate(ev, resolve, suppressPopstate = false) {\n        if (!suppressPopstate) {\n            this.options.callback({\n                ...this.viewerState,\n                ...{\n                    event: ev,\n                    state: this.history.state,\n                },\n            });\n        }\n        if (resolve !== null && resolve !== void 0) {\n            resolve();\n        }\n    }\n    async popState(resolve) {\n        await this.go(-1, true);\n        const state = this.history.state;\n        // TODO: Fix browser forward bug after pop on first entry\n        if (state && state.navigationEntry && !state.navigationEntry.firstEntry) {\n            await this.go(-1, true);\n            return this.pushNavigatorState(state);\n        }\n        resolve();\n    }\n    forwardState(state) {\n        this.forwardedState = state;\n    }\n    // Everything that wants to await a browser event should pass suppressPopstate param\n    // Events NOT resulting in popstate events should NOT pass suppressPopstate param\n    enqueue(target, methodName, parameters, suppressPopstate) {\n        const calls = [];\n        const costs = [];\n        const promises = [];\n        if (suppressPopstate !== undefined) {\n            // Due to (browser) events not having a promise, we create and propagate one\n            let resolve = null;\n            promises.push(new Promise(_resolve => {\n                resolve = _resolve;\n            }));\n            calls.push({\n                target: this,\n                methodName: 'forwardState',\n                parameters: [\n                    {\n                        resolve,\n                        suppressPopstate,\n                    }\n                ],\n            });\n            costs.push(0);\n        }\n        calls.push({\n            target: target,\n            methodName: methodName,\n            parameters: parameters,\n        });\n        costs.push(1);\n        // The first promise is the relevant one since it's either a) the propagated one (in\n        // case of a browser action), or b) the only one since there's only one call\n        promises.push(this.pendingCalls.enqueue(calls, costs)[0]);\n        return promises[0];\n    }\n};\nBrowserNavigator = __decorate([\n    __param(0, IScheduler),\n    __param(1, IDOM),\n    __metadata(\"design:paramtypes\", [Object, HTMLDOM])\n], BrowserNavigator);\nexport { BrowserNavigator };\n//# sourceMappingURL=browser-navigator.js.map","import { IDOM, CustomAttribute } from '@aurelia/runtime';\n/**\n * Class responsible for handling interactions that should trigger navigation.\n *\n * @internal - Shouldn't be used directly.\n */\nexport class LinkHandler {\n    constructor(dom) {\n        this.options = {\n            useHref: true,\n            callback: () => { return; }\n        };\n        this.isActive = false;\n        this.handler = (e) => {\n            const info = LinkHandler.getEventInfo(e, this.window, this.options);\n            if (info.shouldHandleEvent) {\n                e.preventDefault();\n                this.options.callback(info);\n            }\n        };\n        this.window = dom.window;\n        this.document = dom.document;\n    }\n    /**\n     * Gets the href and a \"should handle\" recommendation, given an Event.\n     *\n     * @param event - The Event to inspect for target anchor and href.\n     */\n    static getEventInfo(event, win, options) {\n        const info = {\n            shouldHandleEvent: false,\n            instruction: null,\n            anchor: null\n        };\n        const target = info.anchor = event.currentTarget;\n        // Switch to this for delegation:\n        // const target = info.anchor = LinkHandler.closestAnchor(event.target as Element);\n        if (!target || !LinkHandler.targetIsThisWindow(target, win)) {\n            return info;\n        }\n        if (target.hasAttribute('external')) {\n            return info;\n        }\n        if (event.altKey || event.ctrlKey || event.metaKey || event.shiftKey) {\n            return info;\n        }\n        const gotoAttr = CustomAttribute.for(target, 'goto');\n        const goto = gotoAttr !== void 0 ? gotoAttr.viewModel.value : null;\n        const href = options.useHref && target.hasAttribute('href') ? target.getAttribute('href') : null;\n        if ((goto === null || goto.length === 0) && (href === null || href.length === 0)) {\n            return info;\n        }\n        info.anchor = target;\n        info.instruction = goto || href;\n        const leftButtonClicked = event.button === 0;\n        info.shouldHandleEvent = leftButtonClicked;\n        return info;\n    }\n    /**\n     * Finds the closest ancestor that's an anchor element.\n     *\n     * @param el - The element to search upward from.\n     * @returns The link element that is the closest ancestor.\n     */\n    // private static closestAnchor(el: Element): Element | null {\n    //   while (el !== null && el !== void 0) {\n    //     if (el.tagName === 'A') {\n    //       return el;\n    //     }\n    //     el = el.parentNode as Element;\n    //   }\n    //   return null;\n    // }\n    /**\n     * Gets a value indicating whether or not an anchor targets the current window.\n     *\n     * @param target - The anchor element whose target should be inspected.\n     * @returns True if the target of the link element is this window; false otherwise.\n     */\n    static targetIsThisWindow(target, win) {\n        const targetWindow = target.getAttribute('target');\n        return !targetWindow ||\n            targetWindow === win.name ||\n            targetWindow === '_self';\n    }\n    /**\n     * Activate the instance.\n     *\n     */\n    activate(options) {\n        if (this.isActive) {\n            throw new Error('Link handler has already been activated');\n        }\n        this.isActive = true;\n        this.options = { ...options };\n    }\n    /**\n     * Deactivate the instance. Event handlers and other resources should be cleaned up here.\n     */\n    deactivate() {\n        if (!this.isActive) {\n            throw new Error('Link handler has not been activated');\n        }\n        this.isActive = false;\n    }\n}\nLinkHandler.inject = [IDOM];\n//# sourceMappingURL=link-handler.js.map","/**\n * @internal - Shouldn't be used directly\n */\nexport function arrayRemove(arr, func) {\n    const removed = [];\n    let arrIndex = arr.findIndex(func);\n    while (arrIndex >= 0) {\n        removed.push(arr.splice(arrIndex, 1)[0]);\n        arrIndex = arr.findIndex(func);\n    }\n    return removed;\n}\n//# sourceMappingURL=utils.js.map","/**\n * @internal - Shouldn't be used directly\n */\nexport function parseQuery(query) {\n    if (!query || !query.length) {\n        return {};\n    }\n    const parameters = {};\n    // TODO: Deal with complex parameters such as lists and objects\n    const params = query.replace('+', ' ').split('&');\n    for (const param of params) {\n        const [key, value] = param.split('=');\n        parameters[decodeURIComponent(key)] = decodeURIComponent(value !== void 0 ? value : key);\n    }\n    return parameters;\n}\n//# sourceMappingURL=parser.js.map","import { Reporter } from '@aurelia/kernel';\nimport { Controller, ILifecycle, CustomElement } from '@aurelia/runtime';\nimport { parseQuery } from './parser';\nimport { ViewportInstruction } from './viewport-instruction';\n/**\n * @internal - Shouldn't be used directly\n */\nexport var ContentStatus;\n(function (ContentStatus) {\n    ContentStatus[ContentStatus[\"none\"] = 0] = \"none\";\n    ContentStatus[ContentStatus[\"created\"] = 1] = \"created\";\n    ContentStatus[ContentStatus[\"loaded\"] = 2] = \"loaded\";\n    ContentStatus[ContentStatus[\"initialized\"] = 3] = \"initialized\";\n    ContentStatus[ContentStatus[\"added\"] = 4] = \"added\";\n})(ContentStatus || (ContentStatus = {}));\n/**\n * @internal - Shouldn't be used directly\n */\nexport class ViewportContent {\n    constructor(\n    // Can (and wants) be a (resolved) type or a string (to be resolved later)\n    content = new ViewportInstruction(''), instruction = {\n        instruction: '',\n        fullStateInstruction: '',\n    }, container = null) {\n        this.content = content;\n        this.instruction = instruction;\n        this.contentStatus = 0 /* none */;\n        this.entered = false;\n        this.fromCache = false;\n        this.fromHistory = false;\n        this.reentry = false;\n        // If we've got a container, we're good to resolve type\n        if (!this.content.isComponentType() && container !== null) {\n            this.content.componentType = this.toComponentType(container);\n        }\n    }\n    get componentInstance() {\n        return this.content.componentInstance;\n    }\n    get viewport() {\n        return this.content.viewport;\n    }\n    equalComponent(other) {\n        return this.content.sameComponent(other.content);\n    }\n    equalParameters(other) {\n        return this.content.sameComponent(other.content, true) &&\n            // TODO: Review whether query is relevant\n            this.instruction.query === other.instruction.query;\n    }\n    reentryBehavior() {\n        return (this.content.componentInstance !== null &&\n            'reentryBehavior' in this.content.componentInstance &&\n            this.content.componentInstance.reentryBehavior !== void 0)\n            ? this.content.componentInstance.reentryBehavior\n            : \"default\" /* default */;\n    }\n    isCacheEqual(other) {\n        return this.content.sameComponent(other.content, true);\n    }\n    createComponent(container, fallback) {\n        if (this.contentStatus !== 0 /* none */) {\n            return;\n        }\n        // Don't load cached content or instantiated history content\n        if (!this.fromCache && !this.fromHistory) {\n            try {\n                this.content.componentInstance = this.toComponentInstance(container);\n            }\n            catch (e) {\n                if (fallback !== void 0) {\n                    this.content.setParameters({ id: this.content.componentName });\n                    this.content.setComponent(fallback);\n                    try {\n                        this.content.componentInstance = this.toComponentInstance(container);\n                    }\n                    catch (ee) {\n                        throw e;\n                    }\n                }\n                else {\n                    throw e;\n                }\n            }\n        }\n        this.contentStatus = 1 /* created */;\n    }\n    destroyComponent() {\n        // TODO: We might want to do something here eventually, who knows?\n        if (this.contentStatus !== 1 /* created */) {\n            return;\n        }\n        // Don't destroy components when stateful\n        this.contentStatus = 0 /* none */;\n    }\n    async canEnter(viewport, previousInstruction) {\n        if (!this.content.componentInstance) {\n            return false;\n        }\n        if (!this.content.componentInstance.canEnter) {\n            return true;\n        }\n        const typeParameters = this.content.componentType ? this.content.componentType.parameters : null;\n        this.instruction.parameters = this.content.toSpecifiedParameters(typeParameters);\n        const merged = { ...parseQuery(this.instruction.query), ...this.instruction.parameters };\n        const result = this.content.componentInstance.canEnter(merged, this.instruction, previousInstruction);\n        Reporter.write(10000, 'viewport canEnter', result);\n        if (typeof result === 'boolean') {\n            return result;\n        }\n        if (typeof result === 'string') {\n            return [viewport.router.createViewportInstruction(result, viewport)];\n        }\n        return result;\n    }\n    async canLeave(nextInstruction) {\n        if (!this.content.componentInstance || !this.content.componentInstance.canLeave) {\n            return true;\n        }\n        const result = this.content.componentInstance.canLeave(nextInstruction, this.instruction);\n        Reporter.write(10000, 'viewport canLeave', result);\n        if (typeof result === 'boolean') {\n            return result;\n        }\n        return result;\n    }\n    async enter(previousInstruction) {\n        // if (!this.reentry && (this.contentStatus !== ContentStatus.created || this.entered)) {\n        if (!this.reentry && (this.contentStatus !== 2 /* loaded */ || this.entered)) {\n            return;\n        }\n        if (this.content.componentInstance && this.content.componentInstance.enter) {\n            const typeParameters = this.content.componentType ? this.content.componentType.parameters : null;\n            this.instruction.parameters = this.content.toSpecifiedParameters(typeParameters);\n            const merged = { ...parseQuery(this.instruction.query), ...this.instruction.parameters };\n            await this.content.componentInstance.enter(merged, this.instruction, previousInstruction);\n        }\n        this.entered = true;\n    }\n    async leave(nextInstruction) {\n        if (this.contentStatus !== 4 /* added */ || !this.entered) {\n            return;\n        }\n        if (this.content.componentInstance && this.content.componentInstance.leave) {\n            await this.content.componentInstance.leave(nextInstruction, this.instruction);\n        }\n        this.entered = false;\n    }\n    // eslint-disable-next-line @typescript-eslint/require-await\n    async loadComponent(container, element, viewport) {\n        // if (this.contentStatus !== ContentStatus.created || !this.entered || !this.content.componentInstance) {\n        if (this.contentStatus !== 1 /* created */ || this.entered || !this.content.componentInstance) {\n            return;\n        }\n        // Don't load cached content or instantiated history content\n        if (!this.fromCache || !this.fromHistory) {\n            const host = element;\n            const controller = Controller.forCustomElement(this.content.componentInstance, container.get(ILifecycle), host, container, void 0, void 0);\n            controller.parent = CustomElement.for(element);\n        }\n        this.contentStatus = 2 /* loaded */;\n    }\n    unloadComponent(cache, stateful = false) {\n        // TODO: We might want to do something here eventually, who knows?\n        if (this.contentStatus !== 2 /* loaded */) {\n            return;\n        }\n        // Don't unload components when stateful\n        if (!stateful) {\n            this.contentStatus = 1 /* created */;\n        }\n        else {\n            cache.push(this);\n        }\n    }\n    initializeComponent(parent) {\n        if (this.contentStatus !== 2 /* loaded */) {\n            return;\n        }\n        // Don't initialize cached content or instantiated history content\n        // if (!this.fromCache || !this.fromHistory) {\n        // ((this.content.componentInstance as IRouteableComponent).$controller as IController).parent = parent;\n        this.content.componentInstance.$controller.bind(1024 /* fromStartTask */ | 4096 /* fromBind */);\n        // }\n        this.contentStatus = 3 /* initialized */;\n    }\n    async terminateComponent(stateful = false) {\n        if (this.contentStatus !== 3 /* initialized */) {\n            return;\n        }\n        // Don't terminate cached content\n        // if (!stateful) {\n        await this.content.componentInstance.$controller.unbind(2048 /* fromStopTask */ | 8192 /* fromUnbind */).wait();\n        // ((this.content.componentInstance as IRouteableComponent).$controller as IController).parent = void 0;\n        // }\n        this.contentStatus = 2 /* loaded */;\n    }\n    addComponent(element) {\n        if (this.contentStatus !== 3 /* initialized */) {\n            return;\n        }\n        this.content.componentInstance.$controller.attach(1024 /* fromStartTask */);\n        if (this.fromCache || this.fromHistory) {\n            const elements = Array.from(element.getElementsByTagName('*'));\n            for (const el of elements) {\n                const attr = el.getAttribute('au-element-scroll');\n                if (attr) {\n                    const [top, left] = attr.split(',');\n                    el.removeAttribute('au-element-scroll');\n                    el.scrollTo(+left, +top);\n                }\n            }\n        }\n        this.contentStatus = 4 /* added */;\n    }\n    removeComponent(element, stateful = false) {\n        if (this.contentStatus !== 4 /* added */ || this.entered) {\n            return;\n        }\n        if (stateful && element !== null) {\n            const elements = Array.from(element.getElementsByTagName('*'));\n            for (const el of elements) {\n                if (el.scrollTop > 0 || el.scrollLeft) {\n                    el.setAttribute('au-element-scroll', `${el.scrollTop},${el.scrollLeft}`);\n                }\n            }\n        }\n        this.content.componentInstance.$controller.detach(2048 /* fromStopTask */);\n        this.contentStatus = 3 /* initialized */;\n    }\n    async freeContent(element, nextInstruction, cache, stateful = false) {\n        switch (this.contentStatus) {\n            case 4 /* added */:\n                await this.leave(nextInstruction);\n                this.removeComponent(element, stateful);\n            case 3 /* initialized */:\n                await this.terminateComponent(stateful);\n            case 2 /* loaded */:\n                this.unloadComponent(cache, stateful);\n            case 1 /* created */:\n                this.destroyComponent();\n        }\n    }\n    toComponentName() {\n        return this.content.componentName;\n    }\n    toComponentType(container) {\n        if (this.content.isEmpty()) {\n            return null;\n        }\n        return this.content.toComponentType(container);\n    }\n    toComponentInstance(container) {\n        if (this.content.isEmpty()) {\n            return null;\n        }\n        return this.content.toComponentInstance(container);\n    }\n}\n//# sourceMappingURL=viewport-content.js.map","/* eslint-disable @typescript-eslint/no-unnecessary-type-assertion */\nexport class ConfigurableRoute {\n    constructor(path, caseSensitive, handler) {\n        this.path = path;\n        this.caseSensitive = caseSensitive;\n        this.handler = handler;\n    }\n}\nexport class Endpoint {\n    constructor(route, paramNames) {\n        this.route = route;\n        this.paramNames = paramNames;\n    }\n}\nexport class RecognizedRoute {\n    constructor(endpoint, params, searchParams, isDynamic, queryString) {\n        this.endpoint = endpoint;\n        this.params = params;\n        this.searchParams = searchParams;\n        this.isDynamic = isDynamic;\n        this.queryString = queryString;\n    }\n}\nclass Candidate {\n    constructor(chars, states, skippedStates, result) {\n        var _a;\n        this.chars = chars;\n        this.states = states;\n        this.skippedStates = skippedStates;\n        this.result = result;\n        this.head = states[states.length - 1];\n        this.endpoint = (_a = this.head) === null || _a === void 0 ? void 0 : _a.endpoint;\n    }\n    advance(ch) {\n        const { chars, states, skippedStates, result } = this;\n        let stateToAdd = null;\n        let matchCount = 0;\n        const state = states[states.length - 1];\n        function $process(nextState, skippedState) {\n            if (nextState.isMatch(ch)) {\n                if (++matchCount === 1) {\n                    stateToAdd = nextState;\n                }\n                else {\n                    result.add(new Candidate(chars.concat(ch), states.concat(nextState), skippedState === null ? skippedStates : skippedStates.concat(skippedState), result));\n                }\n            }\n            if (state.segment === null && nextState.isOptional && nextState.nextStates !== null) {\n                if (nextState.nextStates.length > 1) {\n                    throw new Error(`${nextState.nextStates.length} nextStates`);\n                }\n                const separator = nextState.nextStates[0];\n                if (!separator.isSeparator) {\n                    throw new Error(`Not a separator`);\n                }\n                if (separator.nextStates !== null) {\n                    for (const $nextState of separator.nextStates) {\n                        $process($nextState, nextState);\n                    }\n                }\n            }\n        }\n        if (state.isDynamic) {\n            $process(state, null);\n        }\n        if (state.nextStates !== null) {\n            for (const nextState of state.nextStates) {\n                $process(nextState, null);\n            }\n        }\n        if (stateToAdd !== null) {\n            states.push(this.head = stateToAdd);\n            chars.push(ch);\n            if (stateToAdd.endpoint !== null) {\n                this.endpoint = stateToAdd.endpoint;\n            }\n        }\n        if (matchCount === 0) {\n            result.remove(this);\n        }\n    }\n    finalize() {\n        function collectSkippedStates(skippedStates, state) {\n            const nextStates = state.nextStates;\n            if (nextStates !== null) {\n                if (nextStates.length === 1 && nextStates[0].segment === null) {\n                    collectSkippedStates(skippedStates, nextStates[0]);\n                }\n                else {\n                    for (const nextState of nextStates) {\n                        if (nextState.isOptional && nextState.endpoint !== null) {\n                            skippedStates.push(nextState);\n                            if (nextState.nextStates !== null) {\n                                for (const $nextState of nextState.nextStates) {\n                                    collectSkippedStates(skippedStates, $nextState);\n                                }\n                            }\n                            break;\n                        }\n                    }\n                }\n            }\n        }\n        collectSkippedStates(this.skippedStates, this.head);\n    }\n    getParams() {\n        const { states, chars, endpoint } = this;\n        const params = {};\n        // First initialize all properties with undefined so they all exist (even if they're not filled, e.g. non-matched optional params)\n        for (const name of endpoint.paramNames) {\n            params[name] = void 0;\n        }\n        for (let i = 0, ii = states.length; i < ii; ++i) {\n            const state = states[i];\n            if (state.isDynamic) {\n                const name = state.segment.name;\n                if (params[name] === void 0) {\n                    params[name] = chars[i];\n                }\n                else {\n                    params[name] += chars[i];\n                }\n            }\n        }\n        return params;\n    }\n    /**\n     * Compares this candidate to another candidate to determine the correct sorting order.\n     *\n     * This algorithm is different from `sortSolutions` in v1's route-recognizer in that it compares\n     * the candidates segment-by-segment, rather than merely comparing the cumulative of segment types\n     *\n     * This resolves v1's ambiguity in situations like `/foo/:id/bar` vs. `/foo/bar/:id`, which had the\n     * same sorting value because they both consist of two static segments and one dynamic segment.\n     *\n     * With this algorithm, `/foo/bar/:id` would always be sorted first because the second segment is different,\n     * and static wins over dynamic.\n     *\n     * ### NOTE\n     * This algorithm violates some of the invariants of v1's algorithm,\n     * but those invariants were arguably not very sound to begin with. Example:\n     *\n     * `/foo/*path/bar/baz` vs. `/foo/bar/*path1/*path2`\n     * - in v1, the first would win because that match has fewer stars\n     * - in v2, the second will win because there is a bigger static match at the start of the pattern\n     *\n     * The algorithm should be more logical and easier to reason about in v2, but it's important to be aware of\n     * subtle difference like this which might surprise some users who happened to rely on this behavior from v1,\n     * intentionally or unintentionally.\n     *\n     * @param b - The candidate to compare this to.\n     * Parameter name is `b` because the method should be used like so: `states.sort((a, b) => a.compareTo(b))`.\n     * This will bring the candidate with the highest score to the first position of the array.\n     */\n    compareTo(b) {\n        const statesA = this.states;\n        const statesB = b.states;\n        for (let iA = 0, iB = 0, ii = Math.max(statesA.length, statesB.length); iA < ii; ++iA) {\n            let stateA = statesA[iA];\n            if (stateA === void 0) {\n                return 1;\n            }\n            let stateB = statesB[iB];\n            if (stateB === void 0) {\n                return -1;\n            }\n            let segmentA = stateA.segment;\n            let segmentB = stateB.segment;\n            if (segmentA === null) {\n                if (segmentB === null) {\n                    ++iB;\n                    continue;\n                }\n                if ((stateA = statesA[++iA]) === void 0) {\n                    return 1;\n                }\n                segmentA = stateA.segment;\n            }\n            else if (segmentB === null) {\n                if ((stateB = statesB[++iB]) === void 0) {\n                    return -1;\n                }\n                segmentB = stateB.segment;\n            }\n            if (segmentA.kind < segmentB.kind) {\n                return 1;\n            }\n            if (segmentA.kind > segmentB.kind) {\n                return -1;\n            }\n            ++iB;\n        }\n        const skippedStatesA = this.skippedStates;\n        const skippedStatesB = b.skippedStates;\n        const skippedStatesALen = skippedStatesA.length;\n        const skippedStatesBLen = skippedStatesB.length;\n        if (skippedStatesALen < skippedStatesBLen) {\n            return 1;\n        }\n        if (skippedStatesALen > skippedStatesBLen) {\n            return -1;\n        }\n        for (let i = 0; i < skippedStatesALen; ++i) {\n            const skippedStateA = skippedStatesA[i];\n            const skippedStateB = skippedStatesB[i];\n            if (skippedStateA.length < skippedStateB.length) {\n                return 1;\n            }\n            if (skippedStateA.length > skippedStateB.length) {\n                return -1;\n            }\n        }\n        // This should only be possible with a single pattern with multiple consecutive star segments.\n        // TODO: probably want to warn or even throw here, but leave it be for now.\n        return 0;\n    }\n}\nfunction hasEndpoint(candidate) {\n    return candidate.head.endpoint !== null;\n}\nfunction compareChains(a, b) {\n    return a.compareTo(b);\n}\nclass RecognizeResult {\n    constructor(rootState) {\n        this.candidates = [];\n        this.candidates = [new Candidate([''], [rootState], [], this)];\n    }\n    get isEmpty() {\n        return this.candidates.length === 0;\n    }\n    getSolution() {\n        const candidates = this.candidates.filter(hasEndpoint);\n        if (candidates.length === 0) {\n            return null;\n        }\n        for (const candidate of candidates) {\n            candidate.finalize();\n        }\n        candidates.sort(compareChains);\n        return candidates[0];\n    }\n    add(candidate) {\n        this.candidates.push(candidate);\n    }\n    remove(candidate) {\n        this.candidates.splice(this.candidates.indexOf(candidate), 1);\n    }\n    advance(ch) {\n        const candidates = this.candidates.slice();\n        for (const candidate of candidates) {\n            candidate.advance(ch);\n        }\n    }\n}\nexport class RouteRecognizer {\n    constructor() {\n        this.rootState = new State(null, null, '');\n    }\n    add(routeOrRoutes) {\n        if (routeOrRoutes instanceof Array) {\n            for (const route of routeOrRoutes) {\n                this.add(route);\n            }\n            return;\n        }\n        const route = routeOrRoutes;\n        const $route = new ConfigurableRoute(route.path, route.caseSensitive === true, route.handler);\n        const parts = parsePath($route.path);\n        const paramNames = [];\n        let state = this.rootState;\n        for (const part of parts) {\n            // Each segment always begins with a slash, so we represent this with a non-segment state\n            state = state.append(null, '/');\n            switch (part.charAt(0)) {\n                case ':': { // route parameter\n                    const isOptional = part.endsWith('?');\n                    const name = isOptional ? part.slice(1, -1) : part.slice(1);\n                    paramNames.push(name);\n                    state = new DynamicSegment(name, isOptional).appendTo(state);\n                    break;\n                }\n                case '*': { // dynamic route\n                    const name = part.slice(1);\n                    paramNames.push(name);\n                    state = new StarSegment(name).appendTo(state);\n                    break;\n                }\n                default: { // standard path route\n                    state = new StaticSegment(part, $route.caseSensitive).appendTo(state);\n                    break;\n                }\n            }\n        }\n        const endpoint = new Endpoint($route, paramNames);\n        state.setEndpoint(endpoint);\n    }\n    recognize(path) {\n        let searchParams;\n        let queryString = '';\n        const queryStart = path.indexOf('?');\n        if (queryStart >= 0) {\n            queryString = path.slice(queryStart + 1);\n            path = path.slice(0, queryStart);\n            searchParams = new URLSearchParams(queryString);\n        }\n        else {\n            searchParams = new URLSearchParams();\n        }\n        path = decodeURI(path);\n        if (!path.startsWith('/')) {\n            path = `/${path}`;\n        }\n        if (path.length > 1 && path.endsWith('/')) {\n            path = path.slice(0, -1);\n        }\n        const result = new RecognizeResult(this.rootState);\n        for (let i = 0, ii = path.length; i < ii; ++i) {\n            const ch = path.charAt(i);\n            result.advance(ch);\n            if (result.isEmpty) {\n                return null;\n            }\n        }\n        const candidate = result.getSolution();\n        if (candidate === null) {\n            return null;\n        }\n        const { endpoint } = candidate;\n        const params = candidate.getParams();\n        const isDynamic = candidate.endpoint.paramNames.length > 0;\n        return new RecognizedRoute(endpoint, params, searchParams, isDynamic, queryString);\n    }\n}\nclass State {\n    constructor(prevState, segment, value) {\n        this.prevState = prevState;\n        this.segment = segment;\n        this.value = value;\n        this.nextStates = null;\n        this.endpoint = null;\n        switch (segment === null || segment === void 0 ? void 0 : segment.kind) {\n            case 2 /* dynamic */:\n                this.length = prevState.length + 1;\n                this.isSeparator = false;\n                this.isDynamic = true;\n                this.isOptional = segment.optional;\n                break;\n            case 1 /* star */:\n                this.length = prevState.length + 1;\n                this.isSeparator = false;\n                this.isDynamic = true;\n                this.isOptional = false;\n                break;\n            case 3 /* static */:\n                this.length = prevState.length + 1;\n                this.isSeparator = false;\n                this.isDynamic = false;\n                this.isOptional = false;\n                break;\n            case undefined:\n                this.length = prevState === null ? 0 : prevState.length;\n                this.isSeparator = true;\n                this.isDynamic = false;\n                this.isOptional = false;\n                break;\n        }\n    }\n    append(segment, value) {\n        let state;\n        let nextStates = this.nextStates;\n        if (nextStates === null) {\n            state = void 0;\n            nextStates = this.nextStates = [];\n        }\n        else if (segment === null) {\n            state = nextStates.find(s => s.value === value);\n        }\n        else {\n            state = nextStates.find(s => { var _a; return (_a = s.segment) === null || _a === void 0 ? void 0 : _a.equals(segment); });\n        }\n        if (state === void 0) {\n            nextStates.push(state = new State(this, segment, value));\n        }\n        return state;\n    }\n    setEndpoint(endpoint) {\n        if (this.endpoint !== null) {\n            throw new Error(`Cannot add ambiguous route. The pattern ${endpoint.route.path} clashes with ${this.endpoint.route.path}`);\n        }\n        this.endpoint = endpoint;\n        if (this.isOptional) {\n            this.prevState.setEndpoint(endpoint);\n            if (this.prevState.isSeparator && this.prevState.prevState !== null) {\n                this.prevState.prevState.setEndpoint(endpoint);\n            }\n        }\n    }\n    isMatch(ch) {\n        const segment = this.segment;\n        switch (segment === null || segment === void 0 ? void 0 : segment.kind) {\n            case 2 /* dynamic */:\n                return !this.value.includes(ch);\n            case 1 /* star */:\n                return true;\n            case 3 /* static */:\n            case undefined:\n                // segment separators (slashes) are non-segments. We could say return ch === '/' as well, technically.\n                return this.value.includes(ch);\n        }\n    }\n}\nfunction isNotEmpty(segment) {\n    return segment.length > 0;\n}\nfunction parsePath(path) {\n    // Normalize leading, trailing and double slashes by ignoring empty segments\n    return path.split('/').filter(isNotEmpty);\n}\nvar SegmentKind;\n(function (SegmentKind) {\n    SegmentKind[SegmentKind[\"star\"] = 1] = \"star\";\n    SegmentKind[SegmentKind[\"dynamic\"] = 2] = \"dynamic\";\n    SegmentKind[SegmentKind[\"static\"] = 3] = \"static\";\n})(SegmentKind || (SegmentKind = {}));\nclass StaticSegment {\n    constructor(value, caseSensitive) {\n        this.value = value;\n        this.caseSensitive = caseSensitive;\n    }\n    get kind() { return 3 /* static */; }\n    appendTo(state) {\n        const { value, value: { length } } = this;\n        if (this.caseSensitive) {\n            for (let i = 0; i < length; ++i) {\n                state = state.append(\n                /* segment */ this, \n                /* value   */ value.charAt(i));\n            }\n        }\n        else {\n            for (let i = 0; i < length; ++i) {\n                const ch = value.charAt(i);\n                state = state.append(\n                /* segment */ this, \n                /* value   */ ch.toUpperCase() + ch.toLowerCase());\n            }\n        }\n        return state;\n    }\n    equals(b) {\n        return (b.kind === 3 /* static */ &&\n            b.caseSensitive === this.caseSensitive &&\n            b.value === this.value);\n    }\n}\nclass DynamicSegment {\n    constructor(name, optional) {\n        this.name = name;\n        this.optional = optional;\n    }\n    get kind() { return 2 /* dynamic */; }\n    appendTo(state) {\n        state = state.append(\n        /* segment */ this, \n        /* value   */ '/');\n        return state;\n    }\n    equals(b) {\n        return (b.kind === 2 /* dynamic */ &&\n            b.optional === this.optional &&\n            b.name === this.name);\n    }\n}\nclass StarSegment {\n    constructor(name) {\n        this.name = name;\n    }\n    get kind() { return 1 /* star */; }\n    appendTo(state) {\n        state = state.append(\n        /* segment */ this, \n        /* value   */ '');\n        return state;\n    }\n    equals(b) {\n        return (b.kind === 1 /* star */ &&\n            b.name === this.name);\n    }\n}\n//# sourceMappingURL=index.js.map","import { ViewportInstruction } from './viewport-instruction';\nimport { Scope } from './scope';\nimport { arrayRemove } from './utils';\nexport class ViewportScope {\n    constructor(name, router, element, owningScope, scope, rootComponentType = null, // temporary. Metadata will probably eliminate it\n    options = {\n        catches: [],\n        source: null,\n    }) {\n        this.name = name;\n        this.router = router;\n        this.element = element;\n        this.rootComponentType = rootComponentType;\n        this.options = options;\n        this.path = null;\n        this.content = null;\n        this.nextContent = null;\n        this.available = true;\n        this.sourceItem = null;\n        this.sourceItemIndex = -1;\n        this.remove = false;\n        this.add = false;\n        this.connectedScope = new Scope(router, scope, owningScope, null, this);\n        if (this.catches.length > 0) {\n            this.content = router.createViewportInstruction(this.catches[0], this.name);\n        }\n    }\n    get scope() {\n        return this.connectedScope.scope;\n    }\n    get owningScope() {\n        return this.connectedScope.owningScope;\n    }\n    get enabled() {\n        return this.connectedScope.enabled;\n    }\n    set enabled(enabled) {\n        this.connectedScope.enabled = enabled;\n    }\n    get isViewport() {\n        return false;\n    }\n    get isViewportScope() {\n        return true;\n    }\n    get isEmpty() {\n        return this.content === null;\n    }\n    get passThroughScope() {\n        return this.rootComponentType === null && this.catches.length === 0;\n    }\n    get siblings() {\n        const parent = this.connectedScope.parent;\n        if (parent === null) {\n            return [this];\n        }\n        return parent.enabledChildren\n            .filter(child => child.isViewportScope && child.viewportScope.name === this.name)\n            .map(child => child.viewportScope);\n    }\n    get source() {\n        return this.options.source || null;\n    }\n    get catches() {\n        let catches = this.options.catches || [];\n        if (typeof catches === 'string') {\n            catches = catches.split(',');\n        }\n        return catches;\n    }\n    get default() {\n        if (this.catches.length > 0) {\n            return this.catches[0];\n        }\n    }\n    setNextContent(content, instruction) {\n        let viewportInstruction;\n        if (content instanceof ViewportInstruction) {\n            viewportInstruction = content;\n        }\n        else {\n            if (typeof content === 'string') {\n                viewportInstruction = this.router.instructionResolver.parseViewportInstruction(content);\n            }\n            else {\n                viewportInstruction = this.router.createViewportInstruction(content);\n            }\n        }\n        viewportInstruction.viewportScope = this;\n        this.remove = this.router.instructionResolver.isClearViewportInstruction(viewportInstruction)\n            || this.router.instructionResolver.isClearAllViewportsInstruction(viewportInstruction);\n        this.add = this.router.instructionResolver.isAddViewportInstruction(viewportInstruction)\n            && Array.isArray(this.source);\n        if (this.add) {\n            viewportInstruction.componentName = null;\n        }\n        if (this.default !== void 0 && viewportInstruction.componentName === null) {\n            viewportInstruction.componentName = this.default;\n        }\n        this.nextContent = viewportInstruction;\n        return true;\n    }\n    canLeave() {\n        return Promise.resolve(true);\n    }\n    canEnter() {\n        return Promise.resolve(true);\n    }\n    enter() {\n        return Promise.resolve(true);\n    }\n    loadContent() {\n        this.content = !this.remove ? this.nextContent : null;\n        this.nextContent = null;\n        return Promise.resolve(true);\n    }\n    finalizeContentChange() {\n        // console.log('ViewportScope finalizing', this.content);\n        if (this.remove && Array.isArray(this.source)) {\n            this.removeSourceItem();\n        }\n    }\n    abortContentChange() {\n        this.nextContent = null;\n        if (this.add) {\n            const index = this.source.indexOf(this.sourceItem);\n            this.source.splice(index, 1);\n            this.sourceItem = null;\n        }\n        return Promise.resolve();\n    }\n    acceptSegment(segment) {\n        if (segment === null && segment === void 0 || segment.length === 0) {\n            return true;\n        }\n        if (segment === this.router.instructionResolver.clearViewportInstruction\n            || segment === this.router.instructionResolver.addViewportInstruction\n            || segment === this.name) {\n            return true;\n        }\n        if (this.catches.length === 0) {\n            return true;\n        }\n        if (this.catches.includes(segment)) {\n            return true;\n        }\n        if (this.catches.filter((value) => value.includes('*')).length) {\n            return true;\n        }\n        return false;\n    }\n    beforeBind() {\n        const source = this.source || [];\n        if (source.length > 0 && this.sourceItem === null) {\n            this.sourceItem = this.getAvailableSourceItem();\n        }\n    }\n    beforeUnbind() {\n        if (this.sourceItem !== null && this.source !== null) {\n            arrayRemove(this.source, (item) => item === this.sourceItem);\n        }\n        this.sourceItem = null;\n    }\n    getAvailableSourceItem() {\n        if (this.source === null) {\n            return null;\n        }\n        const siblings = this.siblings;\n        for (const item of this.source) {\n            if (siblings.every(sibling => sibling.sourceItem !== item)) {\n                return item;\n            }\n        }\n        return null;\n    }\n    addSourceItem() {\n        const item = {};\n        this.source.push(item);\n        return item;\n    }\n    removeSourceItem() {\n        this.sourceItemIndex = this.source.indexOf(this.sourceItem);\n        if (this.sourceItemIndex >= 0) {\n            this.source.splice(this.sourceItemIndex, 1);\n        }\n    }\n    getRoutes() {\n        if (this.rootComponentType !== null) {\n            return this.rootComponentType.routes;\n        }\n        return null;\n    }\n}\n//# sourceMappingURL=viewport-scope.js.map","/**\n * @internal - Used when founding route/instructions\n */\nexport class FoundRoute {\n    constructor(match = null, matching = '', instructions = [], remaining = '') {\n        this.match = match;\n        this.matching = matching;\n        this.instructions = instructions;\n        this.remaining = remaining;\n    }\n    get foundConfiguration() {\n        return this.match !== null;\n    }\n    get foundInstructions() {\n        return this.instructions.length > 0;\n    }\n    get hasRemaining() {\n        return this.remaining !== null && this.remaining.length > 0;\n    }\n}\n//# sourceMappingURL=found-route.js.map","import { arrayRemove } from './utils';\n/**\n * @internal - Helper class\n */\nexport class Collection extends Array {\n    constructor() {\n        super(...arguments);\n        this.currentIndex = -1;\n    }\n    next() {\n        if (this.length > this.currentIndex + 1) {\n            return this[++this.currentIndex];\n        }\n        else {\n            this.currentIndex = -1;\n            return null;\n        }\n    }\n    removeCurrent() {\n        this.splice(this.currentIndex--, 1);\n    }\n    remove(instruction) {\n        arrayRemove(this, value => value === instruction);\n    }\n}\n//# sourceMappingURL=collection.js.map","import { RouteRecognizer as $RouteRecognizer, ConfigurableRoute as $ConfigurableRoute, RecognizedRoute as $RecognizedRoute, Endpoint as $Endpoint, } from '@aurelia/route-recognizer';\nexport const RouteRecognizer = $RouteRecognizer;\nexport const ConfigurableRoute = $ConfigurableRoute;\nexport const RecognizedRoute = $RecognizedRoute;\nexport const Endpoint = $Endpoint;\n//# sourceMappingURL=route-recognizer.js.map","import { ViewportScope } from './viewport-scope';\nimport { FoundRoute } from './found-route';\nimport { NavigationInstructionResolver } from './type-resolvers';\nimport { Viewport } from './viewport';\nimport { arrayRemove } from './utils';\nimport { Collection } from './collection';\nimport { RouteRecognizer } from './route-recognizer';\n/**\n * @internal - Shouldn't be used directly\n */\nexport class Scope {\n    constructor(router, hasScope, owningScope, viewport = null, viewportScope = null, rootComponentType = null) {\n        this.router = router;\n        this.hasScope = hasScope;\n        this.owningScope = owningScope;\n        this.viewport = viewport;\n        this.viewportScope = viewportScope;\n        this.rootComponentType = rootComponentType;\n        this.id = '.';\n        this.parent = null;\n        this.children = [];\n        this.replacedChildren = [];\n        this.path = null;\n        this.enabled = true;\n        // Support collection feature in viewport scopes\n        this.childCollections = {};\n        this.owningScope = owningScope || this;\n        this.scope = this.hasScope ? this : this.owningScope;\n    }\n    get isViewport() {\n        return this.viewport !== null;\n    }\n    get isViewportScope() {\n        return this.viewportScope !== null;\n    }\n    get passThroughScope() {\n        return this.isViewportScope && this.viewportScope.passThroughScope;\n    }\n    get owner() {\n        if (this.isViewport) {\n            return this.viewport;\n        }\n        if (this.isViewportScope) {\n            return this.viewportScope;\n        }\n        return null;\n    }\n    get enabledChildren() {\n        return this.children.filter(scope => scope.enabled);\n    }\n    get hoistedChildren() {\n        const scopes = this.enabledChildren;\n        while (scopes.some(scope => scope.passThroughScope)) {\n            for (const scope of scopes.slice()) {\n                if (scope.passThroughScope) {\n                    const index = scopes.indexOf(scope);\n                    scopes.splice(index, 1, ...scope.enabledChildren);\n                }\n            }\n        }\n        return scopes;\n    }\n    get enabledViewports() {\n        return this.children.filter(scope => scope.isViewport && scope.enabled)\n            .map(scope => scope.viewport);\n    }\n    get viewportInstruction() {\n        if (this.isViewportScope) {\n            return this.viewportScope.content;\n        }\n        if (this.isViewport) {\n            return this.viewport.content.content;\n        }\n        return null;\n    }\n    getEnabledViewports(viewportScopes) {\n        return viewportScopes.filter(scope => !scope.isViewportScope).map(scope => scope.viewport).reduce((viewports, viewport) => {\n            viewports[viewport.name] = viewport;\n            return viewports;\n        }, {});\n    }\n    getOwnedViewports(includeDisabled = false) {\n        return this.allViewports(includeDisabled).filter(viewport => viewport.owningScope === this);\n    }\n    getOwnedScopes(includeDisabled = false) {\n        const scopes = this.allScopes(includeDisabled).filter(scope => scope.owningScope === this);\n        // Hoist children to pass through scopes\n        for (const scope of scopes.slice()) {\n            if (scope.passThroughScope) {\n                const index = scopes.indexOf(scope);\n                scopes.splice(index, 1, ...scope.getOwnedScopes());\n            }\n        }\n        return scopes;\n    }\n    // Note: This can't change state other than the instructions!\n    findViewports(instructions, alreadyFound, disregardViewports = false) {\n        const foundViewports = [];\n        let remainingInstructions = [];\n        const ownedScopes = this.getOwnedScopes();\n        // Get a shallow copy of all available manual viewport scopes\n        const viewportScopes = ownedScopes.filter(scope => scope.isViewportScope).map(scope => scope.viewportScope);\n        const availableViewportScopes = viewportScopes.filter(viewportScope => alreadyFound.every(found => found.viewportScope !== viewportScope));\n        // Get a shallow copy of all available viewports\n        const availableViewports = { ...this.getEnabledViewports(ownedScopes) };\n        for (const instruction of alreadyFound.filter(found => found.scope === this)) {\n            availableViewports[instruction.viewportName] = null;\n        }\n        const viewportInstructions = new Collection(...instructions.slice());\n        let instruction = null;\n        // The viewport scope is already known\n        while ((instruction = viewportInstructions.next()) !== null) {\n            if (instruction.viewportScope !== null && !this.router.instructionResolver.isAddViewportInstruction(instruction)) {\n                remainingInstructions.push(...this.foundViewportScope(instruction, instruction.viewportScope));\n                foundViewports.push(instruction);\n                arrayRemove(availableViewportScopes, available => available === instruction.viewportScope);\n                viewportInstructions.removeCurrent();\n            }\n        }\n        // The viewport is already known\n        if (!disregardViewports) {\n            while ((instruction = viewportInstructions.next()) !== null) {\n                if (instruction.viewport) {\n                    remainingInstructions.push(...this.foundViewport(instruction, instruction.viewport, disregardViewports));\n                    foundViewports.push(instruction);\n                    availableViewports[instruction.viewport.name] = null;\n                    viewportInstructions.removeCurrent();\n                }\n            }\n        }\n        // Viewport scopes have priority\n        while ((instruction = viewportInstructions.next()) !== null) {\n            for (let viewportScope of viewportScopes) {\n                if (viewportScope.acceptSegment(instruction.componentName)) {\n                    if (Array.isArray(viewportScope.source)) {\n                        // console.log('available', viewportScope.available, source);\n                        let available = availableViewportScopes.find(available => available.name === viewportScope.name);\n                        if (available === void 0 || this.router.instructionResolver.isAddViewportInstruction(instruction)) {\n                            const item = viewportScope.addSourceItem();\n                            available = this.getOwnedScopes()\n                                .filter(scope => scope.isViewportScope)\n                                .map(scope => scope.viewportScope)\n                                .find(viewportScope => viewportScope.sourceItem === item);\n                        }\n                        viewportScope = available;\n                    }\n                    remainingInstructions.push(...this.foundViewportScope(instruction, viewportScope));\n                    foundViewports.push(instruction);\n                    arrayRemove(availableViewportScopes, available => available === instruction.viewportScope);\n                    viewportInstructions.removeCurrent();\n                    break;\n                }\n            }\n        }\n        // Configured viewport is ruling\n        while ((instruction = viewportInstructions.next()) !== null) {\n            instruction.needsViewportDescribed = true;\n            for (const name in availableViewports) {\n                if (Object.prototype.hasOwnProperty.call(availableViewports, name)) {\n                    const viewport = availableViewports[name];\n                    // TODO: Also check if (resolved) component wants a specific viewport\n                    if (viewport && viewport.wantComponent(instruction.componentName)) {\n                        const remaining = this.foundViewport(instruction, viewport, disregardViewports, true);\n                        foundViewports.push(instruction);\n                        remainingInstructions.push(...remaining);\n                        availableViewports[name] = null;\n                        viewportInstructions.removeCurrent();\n                        break;\n                    }\n                }\n            }\n        }\n        // Next in line is specified viewport (but not if we're disregarding viewports)\n        if (!disregardViewports) {\n            while ((instruction = viewportInstructions.next()) !== null) {\n                const name = instruction.viewportName;\n                if (!name || !name.length) {\n                    continue;\n                }\n                const newScope = instruction.ownsScope;\n                if (!this.getEnabledViewports(ownedScopes)[name]) {\n                    continue;\n                    // TODO: No longer pre-creating viewports. Evaluate!\n                    this.addViewport(name, null, null, { scope: newScope, forceDescription: true });\n                    availableViewports[name] = this.getEnabledViewports(ownedScopes)[name];\n                }\n                const viewport = availableViewports[name];\n                if (viewport && viewport.acceptComponent(instruction.componentName)) {\n                    const remaining = this.foundViewport(instruction, viewport, disregardViewports, true);\n                    foundViewports.push(instruction);\n                    remainingInstructions.push(...remaining);\n                    availableViewports[name] = null;\n                    viewportInstructions.removeCurrent();\n                }\n            }\n        }\n        // Finally, only one accepting viewport left?\n        while ((instruction = viewportInstructions.next()) !== null) {\n            const remainingViewports = [];\n            for (const name in availableViewports) {\n                if (Object.prototype.hasOwnProperty.call(availableViewports, name)) {\n                    const viewport = availableViewports[name];\n                    if (viewport && viewport.acceptComponent(instruction.componentName)) {\n                        remainingViewports.push(viewport);\n                    }\n                }\n            }\n            if (remainingViewports.length === 1) {\n                const viewport = remainingViewports.shift();\n                const remaining = this.foundViewport(instruction, viewport, disregardViewports, true);\n                foundViewports.push(instruction);\n                remainingInstructions.push(...remaining);\n                availableViewports[viewport.name] = null;\n                viewportInstructions.removeCurrent();\n            }\n        }\n        // If we're ignoring viewports, we now match them anyway\n        if (disregardViewports) {\n            while ((instruction = viewportInstructions.next()) !== null) {\n                let viewport = instruction.viewport;\n                if (!viewport) {\n                    const name = instruction.viewportName;\n                    if (!name || !name.length) {\n                        continue;\n                    }\n                    const newScope = instruction.ownsScope;\n                    if (!this.getEnabledViewports(ownedScopes)[name]) {\n                        continue;\n                        // TODO: No longer pre-creating viewports. Evaluate!\n                        this.addViewport(name, null, null, { scope: newScope, forceDescription: true });\n                        availableViewports[name] = this.getEnabledViewports(ownedScopes)[name];\n                    }\n                    viewport = availableViewports[name];\n                }\n                if (viewport && viewport.acceptComponent(instruction.componentName)) {\n                    const remaining = this.foundViewport(instruction, viewport, disregardViewports);\n                    foundViewports.push(instruction);\n                    remainingInstructions.push(...remaining);\n                    availableViewports[viewport.name] = null;\n                    viewportInstructions.removeCurrent();\n                }\n            }\n        }\n        remainingInstructions = [...viewportInstructions, ...remainingInstructions];\n        return {\n            foundViewports,\n            remainingInstructions,\n        };\n    }\n    foundViewportScope(instruction, viewportScope) {\n        instruction.viewportScope = viewportScope;\n        instruction.needsViewportDescribed = false;\n        const remaining = (instruction.nextScopeInstructions || []).slice();\n        for (const rem of remaining) {\n            if (rem.scope === null) {\n                rem.scope = viewportScope.scope.scope;\n            }\n        }\n        return remaining;\n    }\n    foundViewport(instruction, viewport, withoutViewports, doesntNeedViewportDescribed = false) {\n        instruction.setViewport(viewport);\n        if (doesntNeedViewportDescribed) {\n            instruction.needsViewportDescribed = false;\n        }\n        const remaining = (instruction.nextScopeInstructions || []).slice();\n        for (const rem of remaining) {\n            if (rem.scope === null) {\n                rem.scope = viewport.scope;\n            }\n        }\n        return remaining;\n    }\n    addViewport(name, element, container, options = {}) {\n        let viewport = this.getEnabledViewports(this.getOwnedScopes())[name];\n        // Each au-viewport element has its own Viewport\n        if (element && viewport && viewport.element !== null && viewport.element !== element) {\n            viewport.enabled = false;\n            viewport = this.getOwnedViewports(true).find(child => child.name === name && child.element === element) || null;\n            if (viewport) {\n                viewport.enabled = true;\n            }\n        }\n        if (!viewport) {\n            viewport = new Viewport(this.router, name, null, null, this.scope, !!options.scope, options);\n            this.addChild(viewport.connectedScope);\n        }\n        // TODO: Either explain why || instead of && here (might only need one) or change it to && if that should turn out to not be relevant\n        if (element || container) {\n            viewport.setElement(element, container, options);\n        }\n        return viewport;\n    }\n    removeViewport(viewport, element, container) {\n        if ((!element && !container) || viewport.remove(element, container)) {\n            this.removeChild(viewport.connectedScope);\n            return true;\n        }\n        return false;\n    }\n    addViewportScope(name, element, options = {}) {\n        const viewportScope = new ViewportScope(name, this.router, element, this.scope, true, null, options);\n        this.addChild(viewportScope.connectedScope);\n        return viewportScope;\n    }\n    removeViewportScope(viewportScope) {\n        // viewportScope.remove();\n        this.removeChild(viewportScope.connectedScope);\n        return true;\n    }\n    addChild(scope) {\n        if (!this.children.some(vp => vp === scope)) {\n            if (scope.parent !== null) {\n                scope.parent.removeChild(scope);\n            }\n            this.children.push(scope);\n            scope.parent = this;\n        }\n    }\n    removeChild(scope) {\n        const index = this.children.indexOf(scope);\n        if (index >= 0) {\n            this.children.splice(index, 1);\n            scope.parent = null;\n        }\n    }\n    clearReplacedChildren() {\n        this.replacedChildren = [];\n    }\n    disableReplacedChildren() {\n        this.replacedChildren = this.enabledChildren;\n        for (const scope of this.replacedChildren) {\n            scope.enabled = false;\n        }\n    }\n    reenableReplacedChildren() {\n        for (const scope of this.replacedChildren) {\n            scope.enabled = true;\n        }\n    }\n    allViewports(includeDisabled = false, includeReplaced = false) {\n        return this.allScopes(includeDisabled, includeReplaced).filter(scope => scope.isViewport).map(scope => scope.viewport);\n    }\n    allScopes(includeDisabled = false, includeReplaced = false) {\n        const scopes = includeDisabled ? this.children.slice() : this.enabledChildren;\n        for (const scope of scopes.slice()) {\n            scopes.push(...scope.allScopes(includeDisabled, includeReplaced));\n        }\n        return scopes;\n    }\n    reparentViewportInstructions() {\n        const scopes = this.hoistedChildren\n            .filter(scope => scope.viewportInstruction !== null && scope.viewportInstruction.componentName);\n        if (!scopes.length) {\n            return null;\n        }\n        for (const scope of scopes) {\n            const childInstructions = scope.reparentViewportInstructions();\n            scope.viewportInstruction.nextScopeInstructions =\n                childInstructions !== null && childInstructions.length > 0 ? childInstructions : null;\n        }\n        return scopes.map(scope => scope.viewportInstruction);\n    }\n    findMatchingRoute(path) {\n        if (this.isViewportScope && !this.passThroughScope) {\n            return this.findMatchingRouteInRoutes(path, this.viewportScope.getRoutes());\n        }\n        if (this.isViewport) {\n            return this.findMatchingRouteInRoutes(path, this.viewport.getRoutes());\n        }\n        // TODO: Match specified names here\n        for (const child of this.enabledChildren) {\n            const found = child.findMatchingRoute(path);\n            if (found !== null) {\n                return found;\n            }\n        }\n        return null;\n    }\n    async canLeave() {\n        const results = await Promise.all(this.children.map(child => child.viewport !== null\n            ? child.viewport.canLeave()\n            : child.canLeave()));\n        return !results.some(result => result === false);\n    }\n    findMatchingRouteInRoutes(path, routes) {\n        if (!Array.isArray(routes)) {\n            return null;\n        }\n        routes = routes.map(route => this.ensureProperRoute(route));\n        const cRoutes = routes.map(route => ({\n            path: route.path,\n            handler: route,\n        }));\n        for (let i = 0, ii = cRoutes.length; i < ii; ++i) {\n            const cRoute = cRoutes[i];\n            cRoutes.push({\n                ...cRoute,\n                path: `${cRoute.path}/*remainingPath`,\n            });\n        }\n        const found = new FoundRoute();\n        let params = {};\n        if (path.startsWith('/') || path.startsWith('+')) {\n            path = path.slice(1);\n        }\n        const recognizer = new RouteRecognizer();\n        recognizer.add(cRoutes);\n        const result = recognizer.recognize(path);\n        if (result !== null) {\n            found.match = result.endpoint.route.handler;\n            found.matching = path;\n            const $params = { ...result.params };\n            if ($params.remainingPath !== void 0) {\n                found.remaining = $params.remainingPath;\n                Reflect.deleteProperty($params, 'remainingPath');\n                found.matching = found.matching.slice(0, found.matching.indexOf(found.remaining));\n            }\n            params = $params;\n        }\n        if (found.foundConfiguration) {\n            // clone it so config doesn't get modified\n            found.instructions = this.router.instructionResolver.cloneViewportInstructions(found.match.instructions, false, true);\n            const instructions = found.instructions.slice();\n            while (instructions.length > 0) {\n                const instruction = instructions.shift();\n                instruction.addParameters(params);\n                instruction.route = '';\n                if (instruction.nextScopeInstructions !== null) {\n                    instructions.unshift(...instruction.nextScopeInstructions);\n                }\n            }\n            if (found.instructions.length > 0) {\n                found.instructions[0].route = found.matching;\n            }\n        }\n        return found;\n    }\n    ensureProperRoute(route) {\n        if (route.id === void 0) {\n            route.id = route.path;\n        }\n        route.instructions = NavigationInstructionResolver.toViewportInstructions(this.router, route.instructions);\n        return route;\n    }\n}\n//# sourceMappingURL=scope.js.map","import { Reporter } from '@aurelia/kernel';\nimport { CustomElement } from '@aurelia/runtime';\nimport { arrayRemove } from './utils';\nimport { ViewportContent } from './viewport-content';\nimport { ViewportInstruction } from './viewport-instruction';\nimport { Scope } from './scope';\nexport class Viewport {\n    constructor(router, name, element, container, owningScope, scope, options = {}) {\n        this.router = router;\n        this.name = name;\n        this.element = element;\n        this.container = container;\n        this.options = options;\n        this.nextContent = null;\n        this.forceRemove = false;\n        this.path = null;\n        this.clear = false;\n        this.elementResolve = null;\n        this.previousViewportState = null;\n        this.cache = [];\n        this.historyCache = [];\n        this.content = new ViewportContent();\n        this.connectedScope = new Scope(router, scope, owningScope, this);\n    }\n    get scope() {\n        return this.connectedScope.scope;\n    }\n    get owningScope() {\n        return this.connectedScope.owningScope;\n    }\n    get enabled() {\n        return this.connectedScope.enabled;\n    }\n    set enabled(enabled) {\n        this.connectedScope.enabled = enabled;\n    }\n    get isViewport() {\n        return true;\n    }\n    get isViewportScope() {\n        return false;\n    }\n    get isEmpty() {\n        return this.content.componentInstance === null;\n    }\n    get doForceRemove() {\n        let scope = this.connectedScope;\n        while (scope !== null) {\n            if (scope.viewport !== null && scope.viewport.forceRemove) {\n                return true;\n            }\n            scope = scope.parent;\n        }\n        return false;\n    }\n    setNextContent(content, instruction) {\n        let viewportInstruction;\n        if (content instanceof ViewportInstruction) {\n            viewportInstruction = content;\n        }\n        else {\n            if (typeof content === 'string') {\n                viewportInstruction = this.router.instructionResolver.parseViewportInstruction(content);\n            }\n            else {\n                viewportInstruction = this.router.createViewportInstruction(content);\n            }\n        }\n        viewportInstruction.setViewport(this);\n        this.clear = this.router.instructionResolver.isClearViewportInstruction(viewportInstruction);\n        // Can have a (resolved) type or a string (to be resolved later)\n        this.nextContent = new ViewportContent(!this.clear ? viewportInstruction : void 0, instruction, this.container);\n        this.nextContent.fromHistory = this.nextContent.componentInstance && instruction.navigation\n            ? !!instruction.navigation.back || !!instruction.navigation.forward\n            : false;\n        if (this.options.stateful) {\n            // TODO: Add a parameter here to decide required equality\n            const cached = this.cache.find((item) => this.nextContent.isCacheEqual(item));\n            if (cached) {\n                this.nextContent = cached;\n                this.nextContent.fromCache = true;\n            }\n            else {\n                this.cache.push(this.nextContent);\n            }\n        }\n        // Children that will be replaced (unless added again) by next content. Will\n        // be re-enabled on cancel\n        this.connectedScope.clearReplacedChildren();\n        // If we get the same _instance_, don't do anything (happens with cached and history)\n        if (this.nextContent.componentInstance !== null && this.content.componentInstance === this.nextContent.componentInstance) {\n            this.nextContent = null;\n            return false;\n        }\n        // ReentryBehavior 'refresh' takes precedence\n        if (!this.content.equalComponent(this.nextContent) ||\n            instruction.navigation.refresh ||\n            this.content.reentryBehavior() === \"refresh\" /* refresh */) {\n            this.connectedScope.disableReplacedChildren();\n            return true;\n        }\n        // Explicitly don't allow navigation back to the same component again\n        if (this.content.reentryBehavior() === \"disallow\" /* disallow */) {\n            this.nextContent = null;\n            return false;\n        }\n        // Explicitly re-enter same component again\n        if (this.content.reentryBehavior() === \"enter\" /* enter */) {\n            this.content.reentry = true;\n            this.nextContent.content.setComponent(this.content.componentInstance);\n            this.nextContent.contentStatus = this.content.contentStatus;\n            this.nextContent.reentry = this.content.reentry;\n            return true;\n        }\n        // ReentryBehavior is now 'default'\n        // Requires updated parameters if viewport stateful\n        if (this.options.stateful &&\n            this.content.equalParameters(this.nextContent)) {\n            this.nextContent = null;\n            return false;\n        }\n        // Default is to trigger a refresh (without a check of parameters)\n        this.connectedScope.disableReplacedChildren();\n        return true;\n    }\n    setElement(element, container, options) {\n        options = options || {};\n        if (this.element !== element) {\n            // TODO: Restore this state on navigation cancel\n            this.previousViewportState = { ...this };\n            this.clearState();\n            this.element = element;\n            if (options.usedBy) {\n                this.options.usedBy = options.usedBy;\n            }\n            if (options.default) {\n                this.options.default = options.default;\n            }\n            if (options.fallback) {\n                this.options.fallback = options.fallback;\n            }\n            if (options.noLink) {\n                this.options.noLink = options.noLink;\n            }\n            if (options.noHistory) {\n                this.options.noHistory = options.noHistory;\n            }\n            if (options.stateful) {\n                this.options.stateful = options.stateful;\n            }\n            if (this.elementResolve) {\n                this.elementResolve();\n            }\n        }\n        // TODO: Might not need this? Figure it out\n        // if (container) {\n        //   container['viewportName'] = this.name;\n        // }\n        if (this.container !== container) {\n            this.container = container;\n        }\n        if (!this.content.componentInstance && (!this.nextContent || !this.nextContent.componentInstance) && this.options.default) {\n            const instructions = this.router.instructionResolver.parseViewportInstructions(this.options.default);\n            for (const instruction of instructions) {\n                // Set to name to be delayed one turn\n                instruction.setViewport(this.name);\n                instruction.scope = this.owningScope;\n                instruction.default = true;\n            }\n            this.router.goto(instructions, { append: true }).catch(error => { throw error; });\n        }\n    }\n    async remove(element, container) {\n        if (this.element === element && this.container === container) {\n            if (this.content.componentInstance) {\n                await this.content.freeContent(this.element, (this.nextContent ? this.nextContent.instruction : null), this.historyCache, this.doForceRemove ? false : this.router.statefulHistory || this.options.stateful); // .catch(error => { throw error; });\n            }\n            if (this.doForceRemove) {\n                await Promise.all(this.historyCache.map(content => content.freeContent(null, null, this.historyCache, false)));\n                this.historyCache = [];\n            }\n            return true;\n        }\n        return false;\n    }\n    async canLeave() {\n        const canLeaveChildren = await this.connectedScope.canLeave();\n        if (!canLeaveChildren) {\n            return false;\n        }\n        return this.content.canLeave(this.nextContent ? this.nextContent.instruction : null);\n    }\n    async canEnter() {\n        if (this.clear) {\n            return true;\n        }\n        if ((this.nextContent.content || null) === null) {\n            return false;\n        }\n        await this.waitForElement();\n        this.nextContent.createComponent(this.container, this.options.fallback);\n        await this.nextContent.loadComponent(this.container, this.element, this);\n        return this.nextContent.canEnter(this, this.content.instruction);\n    }\n    async enter() {\n        Reporter.write(10000, 'Viewport enter', this.name);\n        if (this.clear) {\n            return true;\n        }\n        if (!this.nextContent || !this.nextContent.componentInstance) {\n            return false;\n        }\n        await this.nextContent.enter(this.content.instruction);\n        // await this.nextContent.loadComponent(this.container as IContainer, this.element as Element, this);\n        this.nextContent.initializeComponent(CustomElement.for(this.element));\n        return true;\n    }\n    async loadContent() {\n        Reporter.write(10000, 'Viewport loadContent', this.name);\n        // No need to wait for next component activation\n        if (this.content.componentInstance && !this.nextContent.componentInstance) {\n            await this.content.leave(this.nextContent.instruction);\n            await this.unloadContent();\n        }\n        if (this.nextContent.componentInstance) {\n            if (this.content.componentInstance !== this.nextContent.componentInstance) {\n                this.nextContent.addComponent(this.element);\n            }\n            else {\n                this.connectedScope.reenableReplacedChildren();\n            }\n            // Only when next component activation is done\n            if (this.content.componentInstance) {\n                await this.content.leave(this.nextContent.instruction);\n                if (!this.content.reentry && this.content.componentInstance !== this.nextContent.componentInstance) {\n                    await this.unloadContent();\n                }\n            }\n            this.content = this.nextContent;\n            this.content.reentry = false;\n        }\n        if (this.clear) {\n            this.content = new ViewportContent(void 0, this.nextContent.instruction);\n        }\n        this.nextContent = null;\n        return true;\n    }\n    finalizeContentChange() {\n        this.previousViewportState = null;\n        this.connectedScope.clearReplacedChildren();\n    }\n    async abortContentChange() {\n        this.connectedScope.reenableReplacedChildren();\n        await this.nextContent.freeContent(this.element, this.nextContent.instruction, this.historyCache, this.router.statefulHistory || this.options.stateful);\n        if (this.previousViewportState) {\n            Object.assign(this, this.previousViewportState);\n        }\n    }\n    // TODO: Deal with non-string components\n    wantComponent(component) {\n        let usedBy = this.options.usedBy || [];\n        if (typeof usedBy === 'string') {\n            usedBy = usedBy.split(',');\n        }\n        return usedBy.includes(component);\n    }\n    // TODO: Deal with non-string components\n    acceptComponent(component) {\n        if (component === '-' || component === null) {\n            return true;\n        }\n        let usedBy = this.options.usedBy;\n        if (!usedBy || !usedBy.length) {\n            return true;\n        }\n        if (typeof usedBy === 'string') {\n            usedBy = usedBy.split(',');\n        }\n        if (usedBy.includes(component)) {\n            return true;\n        }\n        if (usedBy.filter((value) => value.includes('*')).length) {\n            return true;\n        }\n        return false;\n    }\n    beforeBind(flags) {\n        if (this.content.componentInstance) {\n            this.content.initializeComponent(CustomElement.for(this.element));\n        }\n    }\n    async beforeAttach(flags) {\n        this.enabled = true;\n        if (this.content.componentInstance) {\n            // Only acts if not already entered\n            await this.content.enter(this.content.instruction);\n            this.content.addComponent(this.element);\n        }\n    }\n    async beforeDetach(flags) {\n        if (this.content.componentInstance) {\n            // Only acts if not already left\n            await this.content.leave(this.content.instruction);\n            this.content.removeComponent(this.element, this.doForceRemove ? false : this.router.statefulHistory || this.options.stateful);\n        }\n        this.enabled = false;\n    }\n    async beforeUnbind(flags) {\n        if (this.content.componentInstance) {\n            await this.content.terminateComponent(this.doForceRemove ? false : this.router.statefulHistory || this.options.stateful);\n        }\n    }\n    async freeContent(component) {\n        const content = this.historyCache.find(cached => cached.componentInstance === component);\n        if (content !== void 0) {\n            this.forceRemove = true;\n            await content.freeContent(null, null, this.historyCache, false);\n            this.forceRemove = false;\n            arrayRemove(this.historyCache, (cached => cached === content));\n        }\n    }\n    getRoutes() {\n        let componentType = this.nextContent !== null\n            && this.nextContent.content !== null\n            ? this.nextContent.content.componentType\n            : this.content.content.componentType;\n        // TODO: This is going away once Metadata is in!\n        if (componentType === null || componentType === void 0) {\n            const controller = CustomElement.for(this.element);\n            componentType = controller.context.componentType;\n        }\n        if (componentType === null || componentType === void 0) {\n            return null;\n        }\n        const routes = componentType.routes;\n        return Array.isArray(routes) ? routes : null;\n    }\n    async unloadContent() {\n        this.content.removeComponent(this.element, this.router.statefulHistory || this.options.stateful);\n        await this.content.terminateComponent(this.router.statefulHistory || this.options.stateful);\n        this.content.unloadComponent(this.historyCache, this.router.statefulHistory || this.options.stateful);\n        this.content.destroyComponent();\n    }\n    clearState() {\n        this.options = {};\n        this.content = new ViewportContent();\n        this.cache = [];\n    }\n    async waitForElement() {\n        if (this.element) {\n            return Promise.resolve();\n        }\n        return new Promise((resolve) => {\n            this.elementResolve = resolve;\n        });\n    }\n}\n//# sourceMappingURL=viewport.js.map","import { CustomElement } from '@aurelia/runtime';\nimport { Viewport } from './viewport';\nimport { ViewportInstruction } from './viewport-instruction';\nexport const ComponentAppellationResolver = {\n    isName: function (component) {\n        return typeof component === 'string';\n    },\n    isType: function (component) {\n        return CustomElement.isType(component);\n    },\n    isInstance: function (component) {\n        return !ComponentAppellationResolver.isName(component) && !ComponentAppellationResolver.isType(component);\n    },\n    getName: function (component) {\n        if (ComponentAppellationResolver.isName(component)) {\n            return component;\n        }\n        else if (ComponentAppellationResolver.isType(component)) {\n            return CustomElement.getDefinition(component).name;\n        }\n        else {\n            return ComponentAppellationResolver.getName(component.constructor);\n        }\n    },\n    getType: function (component) {\n        if (ComponentAppellationResolver.isName(component)) {\n            return null;\n        }\n        else if (ComponentAppellationResolver.isType(component)) {\n            return component;\n        }\n        else {\n            return component.constructor;\n        }\n    },\n    getInstance: function (component) {\n        if (ComponentAppellationResolver.isName(component) || ComponentAppellationResolver.isType(component)) {\n            return null;\n        }\n        else {\n            return component;\n        }\n    },\n};\nexport const ViewportHandleResolver = {\n    isName: function (viewport) {\n        return typeof viewport === 'string';\n    },\n    isInstance: function (viewport) {\n        return viewport instanceof Viewport;\n    },\n    getName: function (viewport) {\n        if (ViewportHandleResolver.isName(viewport)) {\n            return viewport;\n        }\n        else {\n            return viewport ? (viewport).name : null;\n        }\n    },\n    getInstance: function (viewport) {\n        if (ViewportHandleResolver.isName(viewport)) {\n            return null;\n        }\n        else {\n            return viewport;\n        }\n    },\n};\nexport const NavigationInstructionResolver = {\n    createViewportInstructions: function (router, navigationInstructions, options) {\n        options = options || {};\n        let scope = null;\n        if (options.context) {\n            scope = router.findScope(options.context);\n            if (typeof navigationInstructions === 'string') {\n                // If it's not from scope root, figure out which scope\n                if (!navigationInstructions.startsWith('/')) {\n                    // Scope modifications\n                    if (navigationInstructions.startsWith('.')) {\n                        // The same as no scope modification\n                        if (navigationInstructions.startsWith('./')) {\n                            navigationInstructions = navigationInstructions.slice(2);\n                        }\n                        // Find out how many scopes upwards we should move\n                        while (navigationInstructions.startsWith('../')) {\n                            scope = scope.parent || scope;\n                            navigationInstructions = navigationInstructions.slice(3);\n                        }\n                    }\n                    if (scope.path !== null) {\n                        navigationInstructions = `${scope.path}/${navigationInstructions}`;\n                        scope = router.rootScope.scope;\n                    }\n                }\n                else { // Specified root scope with /\n                    scope = router.rootScope.scope;\n                }\n            }\n            else {\n                navigationInstructions = NavigationInstructionResolver.toViewportInstructions(router, navigationInstructions);\n                for (const instruction of navigationInstructions) {\n                    if (instruction.scope === null) {\n                        instruction.scope = scope;\n                    }\n                }\n            }\n        }\n        return {\n            instructions: navigationInstructions,\n            scope,\n        };\n    },\n    toViewportInstructions: function (router, navigationInstructions) {\n        if (!Array.isArray(navigationInstructions)) {\n            return NavigationInstructionResolver.toViewportInstructions(router, [navigationInstructions]);\n        }\n        const instructions = [];\n        for (const instruction of navigationInstructions) {\n            if (typeof instruction === 'string') {\n                instructions.push(...router.instructionResolver.parseViewportInstructions(instruction));\n            }\n            else if (instruction instanceof ViewportInstruction) {\n                instructions.push(instruction);\n            }\n            else if (instruction.component) {\n                const viewportComponent = instruction;\n                const newInstruction = router.createViewportInstruction(viewportComponent.component, viewportComponent.viewport, viewportComponent.parameters);\n                if (viewportComponent.children !== void 0 && viewportComponent.children !== null) {\n                    newInstruction.nextScopeInstructions = NavigationInstructionResolver.toViewportInstructions(router, viewportComponent.children);\n                }\n                instructions.push(newInstruction);\n            }\n            else {\n                instructions.push(router.createViewportInstruction(instruction));\n            }\n        }\n        return instructions;\n    },\n};\n//# sourceMappingURL=type-resolvers.js.map","import { CustomElement } from '@aurelia/runtime';\nimport { ComponentAppellationResolver } from './type-resolvers';\n/**\n * @internal - Shouldn't be used directly\n */\nexport var ParametersType;\n(function (ParametersType) {\n    ParametersType[\"none\"] = \"none\";\n    ParametersType[\"string\"] = \"string\";\n    ParametersType[\"array\"] = \"array\";\n    ParametersType[\"object\"] = \"object\";\n})(ParametersType || (ParametersType = {}));\n/**\n * Public API - The viewport instructions are the core of the router's navigations\n */\nexport class ViewportInstruction {\n    constructor(component, viewport, parameters, ownsScope = true, nextScopeInstructions = null) {\n        this.ownsScope = ownsScope;\n        this.nextScopeInstructions = nextScopeInstructions;\n        this.componentName = null;\n        this.componentType = null;\n        this.componentInstance = null;\n        this.viewportName = null;\n        this.viewport = null;\n        this.parametersString = null;\n        this.parametersRecord = null;\n        this.parametersList = null;\n        this.parametersType = \"none\" /* none */;\n        this.scope = null;\n        this.context = '';\n        this.viewportScope = null;\n        this.needsViewportDescribed = false;\n        this.route = null;\n        this.default = false;\n        this.instructionResolver = null;\n        this.setComponent(component);\n        this.setViewport(viewport);\n        this.setParameters(parameters);\n    }\n    get owner() {\n        return this.viewport || this.viewportScope || null;\n    }\n    get typedParameters() {\n        switch (this.parametersType) {\n            case \"string\" /* string */:\n                return this.parametersString;\n            case \"array\" /* array */:\n                return this.parametersList;\n            case \"object\" /* object */:\n                return this.parametersRecord;\n            default:\n                return null;\n        }\n    }\n    get parameters() {\n        if (this.instructionResolver !== null) {\n            return this.instructionResolver.parseComponentParameters(this.typedParameters);\n        }\n        return [];\n    }\n    get normalizedParameters() {\n        if (this.instructionResolver !== null && this.typedParameters !== null) {\n            return this.instructionResolver.stringifyComponentParameters(this.parameters);\n        }\n        return '';\n    }\n    setComponent(component) {\n        if (ComponentAppellationResolver.isName(component)) {\n            this.componentName = ComponentAppellationResolver.getName(component);\n            this.componentType = null;\n            this.componentInstance = null;\n        }\n        else if (ComponentAppellationResolver.isType(component)) {\n            this.componentName = ComponentAppellationResolver.getName(component);\n            this.componentType = ComponentAppellationResolver.getType(component);\n            this.componentInstance = null;\n        }\n        else if (ComponentAppellationResolver.isInstance(component)) {\n            this.componentName = ComponentAppellationResolver.getName(component);\n            this.componentType = ComponentAppellationResolver.getType(component);\n            this.componentInstance = ComponentAppellationResolver.getInstance(component);\n        }\n    }\n    setViewport(viewport) {\n        if (viewport === undefined || viewport === '') {\n            viewport = null;\n        }\n        if (typeof viewport === 'string') {\n            this.viewportName = viewport;\n            this.viewport = null;\n        }\n        else {\n            this.viewport = viewport;\n            if (viewport !== null) {\n                this.viewportName = viewport.name;\n                this.scope = viewport.owningScope;\n            }\n        }\n    }\n    setParameters(parameters) {\n        if (parameters === undefined || parameters === null || parameters === '') {\n            this.parametersType = \"none\" /* none */;\n            parameters = null;\n        }\n        else if (typeof parameters === 'string') {\n            this.parametersType = \"string\" /* string */;\n            this.parametersString = parameters;\n        }\n        else if (Array.isArray(parameters)) {\n            this.parametersType = \"array\" /* array */;\n            this.parametersList = parameters;\n        }\n        else {\n            this.parametersType = \"object\" /* object */;\n            this.parametersRecord = parameters;\n        }\n    }\n    // This only works with objects added to objects!\n    addParameters(parameters) {\n        if (this.parametersType === \"none\" /* none */) {\n            return this.setParameters(parameters);\n        }\n        if (this.parametersType !== \"object\" /* object */) {\n            throw new Error('Can\\'t add object parameters to existing non-object parameters!');\n        }\n        this.setParameters({ ...this.parametersRecord, ...parameters });\n    }\n    setInstructionResolver(instructionResolver) {\n        this.instructionResolver = instructionResolver;\n    }\n    isEmpty() {\n        return !this.isComponentName() && !this.isComponentType() && !this.isComponentInstance();\n    }\n    isComponentName() {\n        return !!this.componentName && !this.isComponentType() && !this.isComponentInstance();\n    }\n    isComponentType() {\n        return this.componentType !== null && !this.isComponentInstance();\n    }\n    isComponentInstance() {\n        return this.componentInstance !== null;\n    }\n    toComponentType(container) {\n        if (this.componentType !== null) {\n            return this.componentType;\n        }\n        if (this.componentName !== null\n            && typeof this.componentName === 'string'\n            && container !== null\n            && container.has(CustomElement.keyFrom(this.componentName), true)) {\n            const resolver = container.getResolver(CustomElement.keyFrom(this.componentName));\n            if (resolver !== null && resolver.getFactory !== void 0) {\n                const factory = resolver.getFactory(container);\n                if (factory) {\n                    return factory.Type;\n                }\n            }\n        }\n        return null;\n    }\n    toComponentInstance(container) {\n        if (this.componentInstance !== null) {\n            return this.componentInstance;\n        }\n        if (container !== void 0 && container !== null) {\n            if (this.isComponentType()) {\n                return container.get(this.componentType);\n            }\n            else {\n                return container.get(CustomElement.keyFrom(this.componentName));\n            }\n        }\n        return null;\n    }\n    toViewportInstance(router) {\n        if (this.viewport !== null) {\n            return this.viewport;\n        }\n        return router.getViewport(this.viewportName);\n    }\n    toSpecifiedParameters(specifications) {\n        specifications = specifications || [];\n        const parameters = this.parameters;\n        const specified = {};\n        for (const spec of specifications) {\n            // First get named if it exists\n            let index = parameters.findIndex(param => param.key === spec);\n            if (index >= 0) {\n                const [parameter] = parameters.splice(index, 1);\n                specified[spec] = parameter.value;\n            }\n            else {\n                // Otherwise get first unnamed\n                index = parameters.findIndex(param => param.key === void 0);\n                if (index >= 0) {\n                    const [parameter] = parameters.splice(index, 1);\n                    specified[spec] = parameter.value;\n                }\n            }\n        }\n        // Add all remaining named\n        for (const parameter of parameters.filter(param => param.key !== void 0)) {\n            specified[parameter.key] = parameter.value;\n        }\n        let index = specifications.length;\n        // Add all remaining unnamed...\n        for (const parameter of parameters.filter(param => param.key === void 0)) {\n            // ..with an index\n            specified[index++] = parameter.value;\n        }\n        return specified;\n    }\n    toSortedParameters(specifications) {\n        specifications = specifications || [];\n        const parameters = this.parameters;\n        const sorted = [];\n        for (const spec of specifications) {\n            // First get named if it exists\n            let index = parameters.findIndex(param => param.key === spec);\n            if (index >= 0) {\n                const parameter = { ...parameters.splice(index, 1)[0] };\n                parameter.key = void 0;\n                sorted.push(parameter);\n            }\n            else {\n                // Otherwise get first unnamed\n                index = parameters.findIndex(param => param.key === void 0);\n                if (index >= 0) {\n                    const parameter = { ...parameters.splice(index, 1)[0] };\n                    sorted.push(parameter);\n                }\n                else {\n                    // Or an empty\n                    sorted.push({ value: void 0 });\n                }\n            }\n        }\n        // Add all remaining named\n        const params = parameters.filter(param => param.key !== void 0);\n        params.sort((a, b) => (a.key || '') < (b.key || '') ? 1 : (b.key || '') < (a.key || '') ? -1 : 0);\n        sorted.push(...params);\n        // Add all remaining unnamed...\n        sorted.push(...parameters.filter(param => param.key === void 0));\n        return sorted;\n    }\n    sameComponent(other, compareParameters = false, compareType = false) {\n        if (compareParameters && !this.sameParameters(other, compareType)) {\n            return false;\n        }\n        return compareType ? this.componentType === other.componentType : this.componentName === other.componentName;\n    }\n    // TODO: Somewhere we need to check for format such as spaces etc\n    sameParameters(other, compareType = false) {\n        if (!this.sameComponent(other, false, compareType)) {\n            return false;\n        }\n        const typeParameters = this.componentType ? this.componentType.parameters : [];\n        const mine = this.toSpecifiedParameters(typeParameters);\n        const others = other.toSpecifiedParameters(typeParameters);\n        return Object.keys(mine).every(key => mine[key] === others[key])\n            && Object.keys(others).every(key => others[key] === mine[key]);\n    }\n    sameViewport(other) {\n        if (this.viewport !== null && other.viewport !== null) {\n            return this.viewport === other.viewport;\n        }\n        return this.scope === other.scope &&\n            (this.viewport ? this.viewport.name : this.viewportName) === (other.viewport ? other.viewport.name : other.viewportName);\n    }\n}\n//# sourceMappingURL=viewport-instruction.js.map","export var ReentryBehavior;\n(function (ReentryBehavior) {\n    ReentryBehavior[\"default\"] = \"default\";\n    ReentryBehavior[\"disallow\"] = \"disallow\";\n    ReentryBehavior[\"enter\"] = \"enter\";\n    ReentryBehavior[\"refresh\"] = \"refresh\";\n})(ReentryBehavior || (ReentryBehavior = {}));\n//# sourceMappingURL=interfaces.js.map","import { Hook } from './hook';\n/**\n * Public API\n */\nexport var HookTypes;\n(function (HookTypes) {\n    HookTypes[\"BeforeNavigation\"] = \"beforeNavigation\";\n    HookTypes[\"TransformFromUrl\"] = \"transformFromUrl\";\n    HookTypes[\"TransformToUrl\"] = \"transformToUrl\";\n})(HookTypes || (HookTypes = {}));\n/**\n * @internal - Shouldn't be used directly\n */\nexport class HookManager {\n    constructor() {\n        this.hooks = {\n            beforeNavigation: [],\n            transformFromUrl: [],\n            transformToUrl: [],\n        };\n        this.lastIdentity = 0;\n    }\n    addHook(hookFunction, options) {\n        const hook = new Hook(hookFunction, options || {}, ++this.lastIdentity);\n        this.hooks[hook.type].push(hook);\n        return this.lastIdentity;\n    }\n    removeHook(id) {\n        for (const type in this.hooks) {\n            if (Object.prototype.hasOwnProperty.call(this.hooks, type)) {\n                const index = this.hooks[type].findIndex(hook => hook.id === id);\n                if (index >= 0) {\n                    this.hooks[type].splice(index, 1);\n                }\n            }\n        }\n    }\n    invokeBeforeNavigation(viewportInstructions, navigationInstruction) {\n        return this.invoke(\"beforeNavigation\" /* BeforeNavigation */, navigationInstruction, viewportInstructions);\n    }\n    invokeTransformFromUrl(url, navigationInstruction) {\n        return this.invoke(\"transformFromUrl\" /* TransformFromUrl */, navigationInstruction, url);\n    }\n    invokeTransformToUrl(state, navigationInstruction) {\n        return this.invoke(\"transformToUrl\" /* TransformToUrl */, navigationInstruction, state);\n    }\n    async invoke(type, navigationInstruction, arg) {\n        for (const hook of this.hooks[type]) {\n            if (!hook.wantsMatch || hook.matches(arg)) {\n                const outcome = await hook.invoke(navigationInstruction, arg);\n                if (typeof outcome === 'boolean') {\n                    if (!outcome) {\n                        return false;\n                    }\n                }\n                else {\n                    arg = outcome;\n                }\n            }\n        }\n        return arg;\n    }\n}\n//# sourceMappingURL=hook-manager.js.map","import { ComponentAppellationResolver, ViewportHandleResolver } from './type-resolvers';\nimport { ViewportInstruction } from './viewport-instruction';\n/**\n * @internal - Shouldn't be used directly\n */\nexport class Hook {\n    constructor(hook, options, id) {\n        this.hook = hook;\n        this.id = id;\n        this.type = \"beforeNavigation\" /* BeforeNavigation */;\n        this.includeTargets = [];\n        this.excludeTargets = [];\n        if (options.type !== void 0) {\n            this.type = options.type;\n        }\n        for (const target of options.include || []) {\n            this.includeTargets.push(new Target(target));\n        }\n        for (const target of options.exclude || []) {\n            this.excludeTargets.push(new Target(target));\n        }\n    }\n    get wantsMatch() {\n        return this.includeTargets.length > 0 || this.excludeTargets.length > 0;\n    }\n    matches(viewportInstructions) {\n        if (this.includeTargets.length && !this.includeTargets.some(target => target.matches(viewportInstructions))) {\n            return false;\n        }\n        if (this.excludeTargets.length && this.excludeTargets.some(target => target.matches(viewportInstructions))) {\n            return false;\n        }\n        return true;\n    }\n    invoke(navigationInstruction, arg) {\n        // TODO: Fix the type here\n        return this.hook(arg, navigationInstruction);\n    }\n}\nclass Target {\n    constructor(target) {\n        this.componentType = null;\n        this.componentName = null;\n        this.viewport = null;\n        this.viewportName = null;\n        if (typeof target === 'string') {\n            this.componentName = target;\n        }\n        else if (ComponentAppellationResolver.isType(target)) {\n            this.componentType = target;\n            this.componentName = ComponentAppellationResolver.getName(target);\n        }\n        else {\n            const cvTarget = target;\n            if (cvTarget.component) {\n                this.componentType = ComponentAppellationResolver.isType(cvTarget.component)\n                    ? ComponentAppellationResolver.getType(cvTarget.component)\n                    : null;\n                this.componentName = ComponentAppellationResolver.getName(cvTarget.component);\n            }\n            if (cvTarget.viewport) {\n                this.viewport = ViewportHandleResolver.isInstance(cvTarget.viewport) ? cvTarget.viewport : null;\n                this.viewportName = ViewportHandleResolver.getName(cvTarget.viewport);\n            }\n        }\n    }\n    matches(viewportInstructions) {\n        const instructions = viewportInstructions.slice();\n        if (!instructions.length) {\n            instructions.push(new ViewportInstruction(''));\n        }\n        for (const instruction of instructions) {\n            if ((this.componentName !== null && this.componentName === instruction.componentName) ||\n                (this.componentType !== null && this.componentType === instruction.componentType) ||\n                (this.viewportName !== null && this.viewportName === instruction.viewportName) ||\n                (this.viewport !== null && this.viewport === instruction.viewport)) {\n                return true;\n            }\n        }\n        return false;\n    }\n}\n//# sourceMappingURL=hook.js.map","import { ComponentAppellationResolver, NavigationInstructionResolver } from './type-resolvers';\n/**\n * @internal - Used by au-nav\n */\nexport class NavRoute {\n    constructor(nav, route) {\n        this.nav = nav;\n        this.instructions = [];\n        this.link = null;\n        this.linkVisible = null;\n        this.linkActive = null;\n        this.compareParameters = false;\n        this.children = null;\n        this.visible = true;\n        this.active = '';\n        this.title = route.title;\n        this.meta = route.meta;\n        if (route.route) {\n            this.instructions = this.parseRoute(route.route);\n            this.link = this.computeLink(this.instructions);\n        }\n        this.linkActive = route.consideredActive !== null && route.consideredActive !== void 0 ? route.consideredActive : this.link;\n        if (this.linkActive !== null && (!(this.linkActive instanceof Function) || ComponentAppellationResolver.isType(this.linkActive))) {\n            this.linkActive = NavigationInstructionResolver.toViewportInstructions(this.nav.router, this.linkActive);\n        }\n        this.execute = route.execute;\n        this.compareParameters = !!route.compareParameters;\n        this.linkVisible = route.condition === undefined ? true : route.condition;\n        this.update();\n    }\n    get hasChildren() {\n        return (this.children && this.children.length ? 'nav-has-children' : '');\n    }\n    update() {\n        this.visible = this.computeVisible();\n        if ((this.link && this.link.length) || this.execute) {\n            this.active = this.computeActive();\n        }\n        else {\n            this.active = (this.active === 'nav-active' ? 'nav-active' : (this.activeChild() ? 'nav-active-child' : ''));\n        }\n    }\n    executeAction(event) {\n        if (this.execute) {\n            this.execute(this);\n        }\n        event.stopPropagation();\n    }\n    toggleActive() {\n        this.active = (this.active.startsWith('nav-active') ? '' : 'nav-active');\n    }\n    parseRoute(routes) {\n        return NavigationInstructionResolver.toViewportInstructions(this.nav.router, routes);\n    }\n    computeVisible() {\n        if (this.linkVisible instanceof Function) {\n            return this.linkVisible(this);\n        }\n        return !!this.linkVisible;\n    }\n    computeActive() {\n        if (!Array.isArray(this.linkActive)) {\n            return this.linkActive(this) ? 'nav-active' : '';\n        }\n        const components = this.linkActive;\n        const activeComponents = this.nav.router.instructionResolver.flattenViewportInstructions(this.nav.router.activeComponents);\n        for (const component of components) {\n            if (activeComponents.every((active) => !active.sameComponent(component, this.compareParameters && component.typedParameters !== null))) {\n                return '';\n            }\n        }\n        return 'nav-active';\n    }\n    computeLink(instructions) {\n        return this.nav.router.instructionResolver.stringifyViewportInstructions(instructions);\n    }\n    activeChild() {\n        if (this.children) {\n            for (const child of this.children) {\n                if (child.active.startsWith('nav-active') || child.activeChild()) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n}\n//# sourceMappingURL=nav-route.js.map","import { NavRoute } from './nav-route';\n/**\n * Public API - Used by au-nav and Router add/setNav\n */\nexport class Nav {\n    constructor(router, name, routes = [], classes = {}) {\n        this.router = router;\n        this.name = name;\n        this.routes = routes;\n        this.classes = classes;\n        this.update();\n    }\n    addRoutes(routes) {\n        for (const route of routes) {\n            this.addRoute(this.routes, route);\n        }\n        this.update();\n    }\n    update() {\n        this.updateRoutes(this.routes);\n        this.routes = this.routes.slice();\n    }\n    addRoute(routes, route) {\n        const newRoute = new NavRoute(this, route);\n        routes.push(newRoute);\n        if (route.children) {\n            newRoute.children = [];\n            for (const child of route.children) {\n                this.addRoute(newRoute.children, child);\n            }\n        }\n    }\n    updateRoutes(routes) {\n        for (const route of routes) {\n            route.update();\n            if (route.children && route.children.length) {\n                this.updateRoutes(route.children);\n            }\n        }\n    }\n}\n//# sourceMappingURL=nav.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { bound } from '@aurelia/kernel';\n/**\n * @internal - Shouldn't be used directly\n */\nexport class QueueTask {\n    constructor(taskQueue, item, cost = 0) {\n        this.taskQueue = taskQueue;\n        this.item = item;\n        this.cost = cost;\n        this.done = false;\n        this.promise = new Promise((resolve, reject) => {\n            this.resolve = () => {\n                this.taskQueue.resolve(this, resolve);\n            };\n            this.reject = (reason) => {\n                this.taskQueue.reject(this, reject, reason);\n            };\n        });\n    }\n    async execute() {\n        if ('execute' in this.item) {\n            await this.item.execute(this);\n        }\n        else {\n            await this.item(this);\n        }\n    }\n    wait() {\n        return this.promise;\n    }\n    canCancel() {\n        return false;\n    }\n    cancel() { return; }\n}\n/**\n * A first-in-first-out task queue that only processes the next queued item\n * when the current one has been resolved or rejected. If a callback function\n * is specified, it receives the queued items as tasks one at a time. If no\n * callback is specified, the tasks themselves are either executed (if a\n * function) or the execute method in them are run. The executed function\n * should resolve or reject the task when processing is done.\n * Enqueued items' tasks can be awaited. Enqueued items can specify an\n * (arbitrary) execution cost and the queue can be set up (activated) to\n * only process a specific amount of execution cost per RAF/tick.\n *\n * @internal - Shouldn't be used directly.\n */\nexport class TaskQueue {\n    constructor(callback) {\n        this.callback = callback;\n        this.pending = [];\n        this.processing = null;\n        this.allowedExecutionCostWithinTick = null;\n        this.currentExecutionCostInCurrentTick = 0;\n        this.scheduler = null;\n        this.task = null;\n    }\n    get isActive() {\n        return this.task !== null;\n    }\n    get length() {\n        return this.pending.length;\n    }\n    activate(options) {\n        if (this.isActive) {\n            throw new Error('TaskQueue has already been activated');\n        }\n        this.scheduler = options.scheduler;\n        this.allowedExecutionCostWithinTick = options.allowedExecutionCostWithinTick;\n        this.task = this.scheduler.queueRenderTask(this.dequeue, { persistent: true });\n    }\n    deactivate() {\n        if (!this.isActive) {\n            throw new Error('TaskQueue has not been activated');\n        }\n        this.task.cancel();\n        this.task = null;\n        this.allowedExecutionCostWithinTick = null;\n        this.clear();\n    }\n    enqueue(itemOrItems, costOrCosts) {\n        const list = Array.isArray(itemOrItems);\n        const items = (list ? itemOrItems : [itemOrItems]);\n        const costs = items\n            .map((value, index) => !Array.isArray(costOrCosts) ? costOrCosts : costOrCosts[index])\n            .map((value) => value !== undefined ? value : 1);\n        const tasks = [];\n        for (const item of items) {\n            tasks.push(item instanceof QueueTask\n                ? item\n                : this.createQueueTask(item, costs.shift())); // TODO: Get cancellable in as well\n        }\n        this.pending.push(...tasks);\n        this.dequeue();\n        return list ? tasks : tasks[0];\n    }\n    createQueueTask(item, cost) {\n        return new QueueTask(this, item, cost);\n    }\n    dequeue(delta) {\n        if (this.processing !== null) {\n            return;\n        }\n        if (delta !== undefined) {\n            this.currentExecutionCostInCurrentTick = 0;\n        }\n        if (!this.pending.length) {\n            return;\n        }\n        if (this.allowedExecutionCostWithinTick !== null && delta === undefined && this.currentExecutionCostInCurrentTick + (this.pending[0].cost || 0) > this.allowedExecutionCostWithinTick) {\n            return;\n        }\n        this.processing = this.pending.shift() || null;\n        if (this.processing) {\n            this.currentExecutionCostInCurrentTick += this.processing.cost || 0;\n            if (this.callback !== void 0) {\n                this.callback(this.processing);\n            }\n            else {\n                // Don't need to await this since next task won't be dequeued until\n                // executed function is resolved\n                this.processing.execute().catch(error => { throw error; });\n            }\n        }\n    }\n    clear() {\n        this.pending.splice(0, this.pending.length);\n    }\n    resolve(task, resolve) {\n        resolve();\n        this.processing = null;\n        this.dequeue();\n    }\n    reject(task, reject, reason) {\n        reject(reason);\n        this.processing = null;\n        this.dequeue();\n    }\n}\n__decorate([\n    bound,\n    __metadata(\"design:type\", Function),\n    __metadata(\"design:paramtypes\", [Number]),\n    __metadata(\"design:returntype\", void 0)\n], TaskQueue.prototype, \"dequeue\", null);\n//# sourceMappingURL=task-queue.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { IDOM, IScheduler } from '@aurelia/runtime';\nimport { HTMLDOM } from '@aurelia/runtime-html';\nimport { TaskQueue } from './task-queue';\n/**\n * @internal - Shouldn't be used directly\n */\nlet BrowserViewerStore = class BrowserViewerStore {\n    constructor(scheduler, dom) {\n        this.scheduler = scheduler;\n        this.allowedExecutionCostWithinTick = 2; // Limit no of executed actions within the same RAF (due to browser limitation)\n        this.isActive = false;\n        this.options = {\n            useUrlFragmentHash: true,\n            callback: () => { return; },\n        };\n        this.forwardedState = { eventTask: null, suppressPopstate: false };\n        this.handlePopstate = (event) => {\n            const { eventTask, suppressPopstate } = this.forwardedState;\n            this.forwardedState = { eventTask: null, suppressPopstate: false };\n            return this.pendingCalls.enqueue(async (task) => {\n                const store = this;\n                const ev = event;\n                const evTask = eventTask;\n                const suppressPopstateEvent = suppressPopstate;\n                await store.popstate(ev, evTask, suppressPopstateEvent);\n                task.resolve();\n            }, 1).wait();\n        };\n        this.window = dom.window;\n        this.history = dom.window.history;\n        this.location = dom.window.location;\n        this.pendingCalls = new TaskQueue();\n    }\n    activate(options) {\n        if (this.isActive) {\n            throw new Error('Browser navigation has already been activated');\n        }\n        this.isActive = true;\n        this.options.callback = options.callback;\n        if (options.useUrlFragmentHash != void 0) {\n            this.options.useUrlFragmentHash = options.useUrlFragmentHash;\n        }\n        this.pendingCalls.activate({ scheduler: this.scheduler, allowedExecutionCostWithinTick: this.allowedExecutionCostWithinTick });\n        this.window.addEventListener('popstate', this.handlePopstate);\n    }\n    deactivate() {\n        if (!this.isActive) {\n            throw new Error('Browser navigation has not been activated');\n        }\n        this.window.removeEventListener('popstate', this.handlePopstate);\n        this.pendingCalls.deactivate();\n        this.options = { useUrlFragmentHash: true, callback: () => { return; } };\n        this.isActive = false;\n    }\n    get length() {\n        return this.history.length;\n    }\n    get state() {\n        return this.history.state;\n    }\n    get viewerState() {\n        const { pathname, search, hash } = this.location;\n        return {\n            path: pathname,\n            query: search,\n            hash,\n            instruction: this.options.useUrlFragmentHash ? hash.slice(1) : pathname,\n        };\n    }\n    go(delta, suppressPopstateEvent = false) {\n        const doneTask = this.pendingCalls.createQueueTask((task) => task.resolve(), 1);\n        this.pendingCalls.enqueue([\n            (task) => {\n                const store = this;\n                const eventTask = doneTask;\n                const suppressPopstate = suppressPopstateEvent;\n                store.forwardState({ eventTask, suppressPopstate });\n                task.resolve();\n            },\n            (task) => {\n                const history = this.history;\n                const steps = delta;\n                history.go(steps);\n                task.resolve();\n            },\n        ], [0, 1]);\n        return doneTask.wait();\n    }\n    pushNavigatorState(state) {\n        const { title, path } = state.currentEntry;\n        const fragment = this.options.useUrlFragmentHash ? '#/' : '';\n        return this.pendingCalls.enqueue((task) => {\n            const history = this.history;\n            const data = state;\n            const titleOrEmpty = title || '';\n            const url = `${fragment}${path}`;\n            history.pushState(data, titleOrEmpty, url);\n            task.resolve();\n        }, 1).wait();\n    }\n    replaceNavigatorState(state) {\n        const { title, path } = state.currentEntry;\n        const fragment = this.options.useUrlFragmentHash ? '#/' : '';\n        return this.pendingCalls.enqueue((task) => {\n            const history = this.history;\n            const data = state;\n            const titleOrEmpty = title || '';\n            const url = `${fragment}${path}`;\n            history.replaceState(data, titleOrEmpty, url);\n            task.resolve();\n        }, 1).wait();\n    }\n    popNavigatorState() {\n        const doneTask = this.pendingCalls.createQueueTask((task) => task.resolve(), 1);\n        this.pendingCalls.enqueue(async (task) => {\n            const store = this;\n            const eventTask = doneTask;\n            await store.popState(eventTask);\n            task.resolve();\n        }, 1);\n        return doneTask.wait();\n    }\n    async popState(doneTask) {\n        await this.go(-1, true);\n        const state = this.history.state;\n        // TODO: Fix browser forward bug after pop on first entry\n        if (state && state.navigationEntry && !state.navigationEntry.firstEntry) {\n            await this.go(-1, true);\n            await this.pushNavigatorState(state);\n        }\n        await doneTask.execute();\n    }\n    forwardState(state) {\n        this.forwardedState = state;\n    }\n    async popstate(ev, eventTask, suppressPopstate = false) {\n        if (!suppressPopstate) {\n            this.options.callback({\n                ...this.viewerState,\n                ...{\n                    event: ev,\n                    state: this.history.state,\n                },\n            });\n        }\n        if (eventTask !== null) {\n            await eventTask.execute();\n        }\n    }\n};\nBrowserViewerStore = __decorate([\n    __param(0, IScheduler),\n    __param(1, IDOM),\n    __metadata(\"design:paramtypes\", [Object, HTMLDOM])\n], BrowserViewerStore);\nexport { BrowserViewerStore };\n//# sourceMappingURL=browser-viewer-store.js.map","/* eslint-disable max-lines-per-function */\nimport { DI, IContainer, Reporter, Registration, Metadata } from '@aurelia/kernel';\nimport { Aurelia, CustomElement, DOM, isRenderContext } from '@aurelia/runtime';\nimport { InstructionResolver } from './instruction-resolver';\nimport { LinkHandler } from './link-handler';\nimport { Nav } from './nav';\nimport { Navigator } from './navigator';\nimport { NavigationInstructionResolver } from './type-resolvers';\nimport { arrayRemove } from './utils';\nimport { Viewport } from './viewport';\nimport { FoundRoute } from './found-route';\nimport { HookManager } from './hook-manager';\nimport { Scope } from './scope';\nimport { ViewportScope } from './viewport-scope';\nimport { BrowserViewerStore } from './browser-viewer-store';\nclass ClosestViewportCustomElement {\n}\n/**\n * @internal\n */\nclass ClosestScope {\n}\nexport const IRouter = DI.createInterface('IRouter').withDefault(x => x.singleton(Router));\nexport class Router {\n    constructor(\n    /**\n     * @internal - Shouldn't be used directly.\n     */\n    container, \n    /**\n     * @internal - Shouldn't be used directly.\n     */\n    navigator, \n    /**\n     * @internal - Shouldn't be used directly.\n     */\n    navigation, \n    /**\n     * @internal - Shouldn't be used directly.\n     */\n    linkHandler, \n    /**\n     * @internal - Shouldn't be used directly. Probably.\n     */\n    instructionResolver) {\n        this.container = container;\n        this.navigator = navigator;\n        this.navigation = navigation;\n        this.linkHandler = linkHandler;\n        this.instructionResolver = instructionResolver;\n        this.rootScope = null;\n        /**\n         * @internal\n         */\n        this.navs = {};\n        /**\n         * Public API\n         */\n        this.activeComponents = [];\n        /**\n         * @internal\n         */\n        this.appendedInstructions = [];\n        /**\n         * @internal\n         */\n        this.options = {\n            useHref: true,\n            statefulHistoryLength: 0,\n            useDirectRoutes: true,\n            useConfiguredRoutes: true,\n        };\n        this.isActive = false;\n        this.loadedFirst = false;\n        this.processingNavigation = null;\n        this.lastNavigation = null;\n        this.staleChecks = {};\n        /**\n         * @internal\n         */\n        // TODO: use @bound and improve name (eslint-disable is temp)\n        // eslint-disable-next-line @typescript-eslint/typedef\n        this.linkCallback = (info) => {\n            let instruction = info.instruction || '';\n            if (typeof instruction === 'string' && instruction.startsWith('#')) {\n                instruction = instruction.slice(1);\n                // '#' === '/' === '#/'\n                if (!instruction.startsWith('/')) {\n                    instruction = `/${instruction}`;\n                }\n            }\n            // Adds to Navigator's Queue, which makes sure it's serial\n            this.goto(instruction, { origin: info.anchor }).catch(error => { throw error; });\n        };\n        /**\n         * @internal\n         */\n        // TODO: use @bound and improve name (eslint-disable is temp)\n        // eslint-disable-next-line @typescript-eslint/typedef\n        this.navigatorCallback = (instruction) => {\n            // Instructions extracted from queue, one at a time\n            this.processNavigations(instruction).catch(error => { throw error; });\n        };\n        /**\n         * @internal\n         */\n        // TODO: use @bound and improve name (eslint-disable is temp)\n        // eslint-disable-next-line @typescript-eslint/typedef\n        this.navigatorSerializeCallback = async (entry, preservedEntries) => {\n            let excludeComponents = [];\n            for (const preservedEntry of preservedEntries) {\n                if (typeof preservedEntry.instruction !== 'string') {\n                    excludeComponents.push(...this.instructionResolver.flattenViewportInstructions(preservedEntry.instruction)\n                        .filter(instruction => instruction.viewport !== null)\n                        .map(instruction => instruction.componentInstance));\n                }\n                if (typeof preservedEntry.fullStateInstruction !== 'string') {\n                    excludeComponents.push(...this.instructionResolver.flattenViewportInstructions(preservedEntry.fullStateInstruction)\n                        .filter(instruction => instruction.viewport !== null)\n                        .map(instruction => instruction.componentInstance));\n                }\n            }\n            excludeComponents = excludeComponents.filter((component, i, arr) => component !== null && arr.indexOf(component) === i);\n            const serialized = { ...entry };\n            let instructions = [];\n            if (serialized.fullStateInstruction && typeof serialized.fullStateInstruction !== 'string') {\n                instructions.push(...serialized.fullStateInstruction);\n                serialized.fullStateInstruction = this.instructionResolver.stringifyViewportInstructions(serialized.fullStateInstruction);\n            }\n            if (serialized.instruction && typeof serialized.instruction !== 'string') {\n                instructions.push(...serialized.instruction);\n                serialized.instruction = this.instructionResolver.stringifyViewportInstructions(serialized.instruction);\n            }\n            instructions = instructions.filter((instruction, i, arr) => instruction !== null\n                && instruction.componentInstance !== null\n                && arr.indexOf(instruction) === i);\n            const alreadyDone = [];\n            for (const instruction of instructions) {\n                await this.freeComponents(instruction, excludeComponents, alreadyDone);\n            }\n            return serialized;\n        };\n        /**\n         * @internal\n         */\n        // TODO: use @bound and improve name (eslint-disable is temp)\n        // eslint-disable-next-line @typescript-eslint/typedef\n        this.browserNavigatorCallback = (browserNavigationEvent) => {\n            const entry = (browserNavigationEvent.state && browserNavigationEvent.state.currentEntry\n                ? browserNavigationEvent.state.currentEntry\n                : { instruction: '', fullStateInstruction: '' });\n            entry.instruction = browserNavigationEvent.instruction;\n            entry.fromBrowser = true;\n            this.navigator.navigate(entry).catch(error => { throw error; });\n        };\n        /**\n         * @internal\n         */\n        // TODO: use @bound and improve name (eslint-disable is temp)\n        // eslint-disable-next-line @typescript-eslint/typedef\n        this.processNavigations = async (qInstruction) => {\n            const instruction = this.processingNavigation = qInstruction;\n            if (this.options.reportCallback) {\n                this.options.reportCallback(instruction);\n            }\n            let fullStateInstruction = false;\n            const instructionNavigation = instruction.navigation;\n            if ((instructionNavigation.back || instructionNavigation.forward) && instruction.fullStateInstruction) {\n                fullStateInstruction = true;\n                // if (!confirm('Perform history navigation?')) { this.navigator.cancel(instruction); this.processingNavigation = null; return Promise.resolve(); }\n            }\n            let configuredRoute = await this.findInstructions(this.rootScope.scope, instruction.instruction, instruction.scope || this.rootScope.scope, !fullStateInstruction);\n            let instructions = configuredRoute.instructions;\n            let configuredRoutePath = null;\n            if (instruction.instruction.length > 0 && !configuredRoute.foundConfiguration && !configuredRoute.foundInstructions) {\n                // TODO: Do something here!\n                this.unknownRoute(configuredRoute.remaining);\n            }\n            if (configuredRoute.foundConfiguration) {\n                instruction.path = instruction.instruction.startsWith('/')\n                    ? instruction.instruction.slice(1) : instruction.instruction;\n                configuredRoutePath = `${configuredRoutePath || ''}${configuredRoute.matching}`;\n                this.rootScope.path = configuredRoutePath;\n            }\n            // TODO: Used to have an early exit if no instructions. Restore it?\n            const clearScopeOwners = [];\n            let clearViewportScopes = [];\n            for (const clearInstruction of instructions.filter(instr => this.instructionResolver.isClearAllViewportsInstruction(instr))) {\n                const scope = clearInstruction.scope || this.rootScope.scope;\n                clearScopeOwners.push(...scope.children.filter(scope => !scope.owner.isEmpty).map(scope => scope.owner));\n                if (scope.viewportScope !== null) {\n                    clearViewportScopes.push(scope.viewportScope);\n                }\n            }\n            instructions = instructions.filter(instr => !this.instructionResolver.isClearAllViewportsInstruction(instr));\n            for (const addInstruction of instructions.filter(instr => this.instructionResolver.isAddAllViewportsInstruction(instr))) {\n                addInstruction.setViewport((addInstruction.scope || this.rootScope.scope).viewportScope.name);\n                addInstruction.scope = addInstruction.scope.owningScope;\n            }\n            const updatedScopeOwners = [];\n            const alreadyFoundInstructions = [];\n            // TODO: Take care of cancellations down in subsets/iterations\n            let { found: viewportInstructions, remaining: remainingInstructions } = this.findViewports(instructions, alreadyFoundInstructions);\n            let guard = 100;\n            do {\n                if (!guard--) { // Guard against endless loop\n                    console.log('remainingInstructions', remainingInstructions);\n                    throw Reporter.error(2002);\n                }\n                const changedScopeOwners = [];\n                const hooked = await this.hookManager.invokeBeforeNavigation(viewportInstructions, instruction);\n                if (hooked === false) {\n                    return this.cancelNavigation([...changedScopeOwners, ...updatedScopeOwners], instruction);\n                }\n                else {\n                    viewportInstructions = hooked;\n                }\n                for (const viewportInstruction of viewportInstructions) {\n                    const scopeOwner = viewportInstruction.owner;\n                    if (scopeOwner !== null) {\n                        scopeOwner.path = configuredRoutePath;\n                        if (scopeOwner.setNextContent(viewportInstruction, instruction)) {\n                            changedScopeOwners.push(scopeOwner);\n                        }\n                        arrayRemove(clearScopeOwners, value => value === scopeOwner);\n                        if (!this.instructionResolver.isClearViewportInstruction(viewportInstruction)\n                            && viewportInstruction.scope !== null\n                            && viewportInstruction.scope.parent !== null\n                            && viewportInstruction.scope.parent.isViewportScope) {\n                            arrayRemove(clearViewportScopes, value => value === viewportInstruction.scope.parent.viewportScope);\n                        }\n                    }\n                }\n                let results = await Promise.all(changedScopeOwners.map((value) => value.canLeave()));\n                if (results.some(result => result === false)) {\n                    return this.cancelNavigation([...changedScopeOwners, ...updatedScopeOwners], instruction);\n                }\n                results = await Promise.all(changedScopeOwners.map(async (value) => {\n                    const canEnter = await value.canEnter();\n                    if (typeof canEnter === 'boolean') {\n                        if (canEnter) {\n                            return value.enter();\n                        }\n                        else {\n                            return false;\n                        }\n                    }\n                    await this.goto(canEnter, { append: true });\n                    await value.abortContentChange();\n                    // TODO: Abort content change in the viewports\n                    return true;\n                }));\n                if (results.some(result => result === false)) {\n                    return this.cancelNavigation([...changedScopeOwners, ...updatedScopeOwners], qInstruction);\n                }\n                for (const viewport of changedScopeOwners) {\n                    if (updatedScopeOwners.every(value => value !== viewport)) {\n                        updatedScopeOwners.push(viewport);\n                    }\n                }\n                // TODO: Fix multi level recursiveness!\n                alreadyFoundInstructions.push(...viewportInstructions);\n                ({ found: viewportInstructions, remaining: remainingInstructions } = this.findViewports(remainingInstructions, alreadyFoundInstructions));\n                // Look for configured child routes (once we've loaded everything so far?)\n                if (configuredRoute.hasRemaining &&\n                    viewportInstructions.length === 0 &&\n                    remainingInstructions.length === 0) {\n                    let configured = new FoundRoute();\n                    const routeScopeOwners = alreadyFoundInstructions\n                        .filter(instr => instr.owner !== null && instr.owner.path === configuredRoutePath)\n                        .map(instr => instr.owner)\n                        .filter((value, index, arr) => arr.indexOf(value) === index);\n                    for (const owner of routeScopeOwners) {\n                        configured = await this.findInstructions(owner.scope, configuredRoute.remaining, owner.scope);\n                        if (configured.foundConfiguration) {\n                            break;\n                        }\n                    }\n                    if (configured.foundInstructions) {\n                        configuredRoute = configured;\n                        configuredRoutePath = `${configuredRoutePath || ''}/${configuredRoute.matching}`;\n                    }\n                    else {\n                        // TODO: Do something here!\n                        this.unknownRoute(configured.remaining);\n                    }\n                    this.appendInstructions(configured.instructions);\n                }\n                // Don't use defaults when it's a full state navigation\n                if (fullStateInstruction) {\n                    this.appendedInstructions = this.appendedInstructions.filter(instruction => !instruction.default);\n                }\n                // Process non-defaults first\n                let appendedInstructions = this.appendedInstructions.filter(instruction => !instruction.default);\n                this.appendedInstructions = this.appendedInstructions.filter(instruction => instruction.default);\n                if (appendedInstructions.length === 0) {\n                    const index = this.appendedInstructions.findIndex(instruction => instruction.default);\n                    if (index >= 0) {\n                        appendedInstructions = this.appendedInstructions.splice(index, 1);\n                    }\n                }\n                while (appendedInstructions.length > 0) {\n                    const appendedInstruction = appendedInstructions.shift();\n                    const existingAlreadyFound = alreadyFoundInstructions.some(instruction => instruction.sameViewport(appendedInstruction));\n                    const existingFound = viewportInstructions.find(value => value.sameViewport(appendedInstruction));\n                    const existingRemaining = remainingInstructions.find(value => value.sameViewport(appendedInstruction));\n                    if (appendedInstruction.default &&\n                        (existingAlreadyFound ||\n                            (existingFound !== void 0 && !existingFound.default) ||\n                            (existingRemaining !== void 0 && !existingRemaining.default))) {\n                        continue;\n                    }\n                    if (existingFound !== void 0) {\n                        arrayRemove(viewportInstructions, value => value === existingFound);\n                    }\n                    if (existingRemaining !== void 0) {\n                        arrayRemove(remainingInstructions, value => value === existingRemaining);\n                    }\n                    if (appendedInstruction.viewport !== null) {\n                        viewportInstructions.push(appendedInstruction);\n                    }\n                    else {\n                        remainingInstructions.push(appendedInstruction);\n                    }\n                }\n                if (viewportInstructions.length === 0 && remainingInstructions.length === 0) {\n                    viewportInstructions = clearScopeOwners.map(owner => {\n                        const instruction = this.createViewportInstruction(this.instructionResolver.clearViewportInstruction, owner.isViewport ? owner : void 0);\n                        if (owner.isViewportScope) {\n                            instruction.viewportScope = owner;\n                        }\n                        return instruction;\n                    });\n                    viewportInstructions.push(...clearViewportScopes.map(viewportScope => {\n                        const instr = this.createViewportInstruction(this.instructionResolver.clearViewportInstruction);\n                        instr.viewportScope = viewportScope;\n                        return instr;\n                    }));\n                    clearViewportScopes = [];\n                }\n            } while (viewportInstructions.length > 0 || remainingInstructions.length > 0);\n            await Promise.all(updatedScopeOwners.map((value) => value.loadContent()));\n            await this.replacePaths(instruction);\n            // this.updateNav();\n            // Remove history entry if no history viewports updated\n            if (instructionNavigation.new && !instructionNavigation.first && !instruction.repeating && updatedScopeOwners.every(viewport => viewport.options.noHistory)) {\n                instruction.untracked = true;\n            }\n            updatedScopeOwners.forEach((viewport) => {\n                viewport.finalizeContentChange();\n            });\n            this.lastNavigation = this.processingNavigation;\n            if (this.lastNavigation.repeating) {\n                this.lastNavigation.repeating = false;\n            }\n            this.processingNavigation = null;\n            await this.navigator.finalize(instruction);\n        };\n        this.hookManager = new HookManager();\n    }\n    /**\n     * Public API\n     */\n    get isNavigating() {\n        return this.processingNavigation !== null;\n    }\n    /**\n     * @internal\n     */\n    get statefulHistory() {\n        return this.options.statefulHistoryLength !== void 0 && this.options.statefulHistoryLength > 0;\n    }\n    /**\n     * Public API\n     */\n    activate(options) {\n        if (this.isActive) {\n            throw new Error('Router has already been activated');\n        }\n        this.isActive = true;\n        this.options = {\n            ...this.options,\n            ...options\n        };\n        if (this.options.hooks !== void 0) {\n            this.addHooks(this.options.hooks);\n        }\n        this.instructionResolver.activate({ separators: this.options.separators });\n        this.navigator.activate(this, {\n            callback: this.navigatorCallback,\n            store: this.navigation,\n            statefulHistoryLength: this.options.statefulHistoryLength,\n            serializeCallback: this.statefulHistory ? this.navigatorSerializeCallback : void 0,\n        });\n        this.linkHandler.activate({ callback: this.linkCallback, useHref: this.options.useHref });\n        this.navigation.activate({\n            callback: this.browserNavigatorCallback,\n            useUrlFragmentHash: this.options.useUrlFragmentHash\n        });\n        this.ensureRootScope();\n    }\n    /**\n     * Public API\n     */\n    async loadUrl() {\n        const entry = {\n            ...this.navigation.viewerState,\n            ...{\n                fullStateInstruction: '',\n                replacing: true,\n                fromBrowser: false,\n            }\n        };\n        const result = this.navigator.navigate(entry);\n        this.loadedFirst = true;\n        return result;\n    }\n    /**\n     * Public API\n     */\n    deactivate() {\n        if (!this.isActive) {\n            throw new Error('Router has not been activated');\n        }\n        this.linkHandler.deactivate();\n        this.navigator.deactivate();\n        this.navigation.deactivate();\n    }\n    /**\n     * @internal\n     */\n    findScope(origin) {\n        // this.ensureRootScope();\n        if (origin === void 0 || origin === null) {\n            return this.rootScope.scope;\n        }\n        if (origin instanceof Scope || origin instanceof Viewport) {\n            return origin.scope;\n        }\n        return this.getClosestScope(origin) || this.rootScope.scope;\n    }\n    /**\n     * @internal\n     */\n    findParentScope(container) {\n        if (container === null) {\n            return this.rootScope.scope;\n        }\n        // Already (prematurely) set on this view model so get it from container's parent instead\n        if (container.has(ClosestScope, false)) {\n            container = container.parent;\n            if (container === null) {\n                return this.rootScope.scope;\n            }\n        }\n        if (container.has(ClosestScope, true)) {\n            return container.get(ClosestScope);\n        }\n        return this.rootScope.scope;\n    }\n    /**\n     * Public API - Get viewport by name\n     */\n    getViewport(name) {\n        return this.allViewports().find(viewport => viewport.name === name) || null;\n    }\n    /**\n     * Public API (not yet implemented)\n     */\n    addViewport(...args) {\n        throw new Error('Not implemented');\n    }\n    /**\n     * Public API (not yet implemented)\n     */\n    findViewportScope(...args) {\n        throw new Error('Not implemented');\n    }\n    /**\n     * Public API (not yet implemented)\n     */\n    addViewportScope(...args) {\n        throw new Error('Not implemented');\n    }\n    /**\n     * @internal - Called from the viewport scope custom element in created()\n     */\n    setClosestScope(viewModelOrContainer, scope) {\n        const container = this.getContainer(viewModelOrContainer);\n        Registration.instance(ClosestScope, scope).register(container);\n    }\n    /**\n     * @internal\n     */\n    getClosestScope(viewModelOrElement) {\n        const container = 'resourceResolvers' in viewModelOrElement\n            ? viewModelOrElement\n            : this.getClosestContainer(viewModelOrElement);\n        if (container === null) {\n            return null;\n        }\n        if (!container.has(ClosestScope, true)) {\n            return null;\n        }\n        return container.get(ClosestScope) || null;\n    }\n    /**\n     * @internal\n     */\n    unsetClosestScope(viewModelOrContainer) {\n        const container = this.getContainer(viewModelOrContainer);\n        // TODO: Get an 'unregister' on container\n        container.resolvers.delete(ClosestScope);\n    }\n    /**\n     * @internal - Called from the viewport custom element\n     */\n    connectViewport(viewport, container, name, element, options) {\n        const parentScope = this.findParentScope(container);\n        if (viewport === null) {\n            viewport = parentScope.addViewport(name, element, container, options);\n            this.setClosestScope(container, viewport.connectedScope);\n        }\n        return viewport;\n    }\n    /**\n     * @internal - Called from the viewport custom element\n     */\n    disconnectViewport(viewport, container, element) {\n        if (!viewport.connectedScope.parent.removeViewport(viewport, element, container)) {\n            throw new Error(`Failed to remove viewport: ${viewport.name}`);\n        }\n        this.unsetClosestScope(container);\n    }\n    /**\n     * @internal - Called from the viewport scope custom element\n     */\n    connectViewportScope(viewportScope, name, container, element, options) {\n        const parentScope = this.findParentScope(container);\n        if (viewportScope === null) {\n            viewportScope = parentScope.addViewportScope(name, element, options);\n            this.setClosestScope(container, viewportScope.connectedScope);\n        }\n        return viewportScope;\n    }\n    /**\n     * @internal - Called from the viewport scope custom element\n     */\n    disconnectViewportScope(viewportScope, container) {\n        if (!viewportScope.connectedScope.parent.removeViewportScope(viewportScope)) {\n            throw new Error(`Failed to remove viewport scope: ${viewportScope.path}`);\n        }\n        this.unsetClosestScope(container);\n    }\n    /**\n     * @internal\n     */\n    allViewports(includeDisabled = false, includeReplaced = false) {\n        // this.ensureRootScope();\n        return this.rootScope.scope.allViewports(includeDisabled, includeReplaced);\n    }\n    /**\n     * Public API - THE navigation API\n     */\n    goto(instructions, options) {\n        options = options || {};\n        // TODO: Review query extraction; different pos for path and fragment!\n        if (typeof instructions === 'string' && !options.query) {\n            const [path, search] = instructions.split('?');\n            instructions = path;\n            options.query = search;\n        }\n        const toOptions = {};\n        if (options.origin) {\n            toOptions.context = options.origin;\n        }\n        let scope = null;\n        ({ instructions, scope } = NavigationInstructionResolver.createViewportInstructions(this, instructions, toOptions));\n        if (options.append && this.processingNavigation) {\n            instructions = NavigationInstructionResolver.toViewportInstructions(this, instructions);\n            this.appendInstructions(instructions, scope);\n            // Can't return current navigation promise since it can lead to deadlock in enter\n            return Promise.resolve();\n        }\n        const entry = {\n            instruction: instructions,\n            fullStateInstruction: '',\n            scope: scope,\n            title: options.title,\n            data: options.data,\n            query: options.query,\n            replacing: options.replace,\n            repeating: options.append,\n            fromBrowser: false,\n        };\n        return this.navigator.navigate(entry);\n    }\n    /**\n     * Public API\n     */\n    refresh() {\n        return this.navigator.refresh();\n    }\n    /**\n     * Public API\n     */\n    back() {\n        return this.navigator.go(-1);\n    }\n    /**\n     * Public API\n     */\n    forward() {\n        return this.navigator.go(1);\n    }\n    /**\n     * Public API\n     */\n    checkActive(instructions) {\n        for (const instruction of instructions) {\n            const scopeInstructions = this.instructionResolver.matchScope(this.activeComponents, instruction.scope);\n            const matching = scopeInstructions.filter(instr => instr.sameComponent(instruction, true));\n            if (matching.length === 0) {\n                return false;\n            }\n            if (Array.isArray(instruction.nextScopeInstructions)\n                && instruction.nextScopeInstructions.length > 0\n                && this.instructionResolver.matchChildren(instruction.nextScopeInstructions, matching.map(instr => Array.isArray(instr.nextScopeInstructions) ? instr.nextScopeInstructions : []).flat()) === false) {\n                return false;\n            }\n        }\n        return true;\n    }\n    /**\n     * Public API\n     */\n    setNav(name, routes, classes) {\n        const nav = this.findNav(name);\n        if (nav !== void 0 && nav !== null) {\n            nav.routes = [];\n        }\n        this.addNav(name, routes, classes);\n    }\n    /**\n     * Public API\n     */\n    addNav(name, routes, classes) {\n        let nav = this.navs[name];\n        if (nav === void 0 || nav === null) {\n            nav = this.navs[name] = new Nav(this, name, [], classes);\n        }\n        nav.addRoutes(routes);\n        nav.update();\n    }\n    /**\n     * Public API\n     */\n    updateNav(name) {\n        const navs = name\n            ? [name]\n            : Object.keys(this.navs);\n        for (const nav of navs) {\n            if (this.navs[nav] !== void 0 && this.navs[nav] !== null) {\n                this.navs[nav].update();\n            }\n        }\n    }\n    /**\n     * Public API\n     */\n    findNav(name) {\n        return this.navs[name];\n    }\n    /**\n     * Public API\n     */\n    addRoutes(routes, context) {\n        // TODO: This should add to the context instead\n        // TODO: Add routes without context to rootScope content (which needs to be created)?\n        return [];\n        // const viewport = (context !== void 0 ? this.closestViewport(context) : this.rootScope) || this.rootScope as Viewport;\n        // return viewport.addRoutes(routes);\n    }\n    /**\n     * Public API\n     */\n    removeRoutes(routes, context) {\n        // TODO: This should remove from the context instead\n        // const viewport = (context !== void 0 ? this.closestViewport(context) : this.rootScope) || this.rootScope as Viewport;\n        // return viewport.removeRoutes(routes);\n    }\n    /**\n     * Public API\n     */\n    addHooks(hooks) {\n        return hooks.map(hook => this.addHook(hook.hook, hook.options));\n    }\n    addHook(hook, options) {\n        return this.hookManager.addHook(hook, options);\n    }\n    /**\n     * Public API\n     */\n    removeHooks(hooks) {\n        return;\n    }\n    /**\n     * Public API - The right way to create ViewportInstructions\n     */\n    createViewportInstruction(component, viewport, parameters, ownsScope = true, nextScopeInstructions = null) {\n        return this.instructionResolver.createViewportInstruction(component, viewport, parameters, ownsScope, nextScopeInstructions);\n    }\n    async findInstructions(scope, instruction, instructionScope, transformUrl = false) {\n        let route = new FoundRoute();\n        if (typeof instruction === 'string') {\n            instruction = transformUrl\n                ? await this.hookManager.invokeTransformFromUrl(instruction, this.processingNavigation)\n                : instruction;\n            if (Array.isArray(instruction)) {\n                route.instructions = instruction;\n            }\n            else {\n                // TODO: Review this\n                if (instruction === '/') {\n                    instruction = '';\n                }\n                const instructions = this.instructionResolver.parseViewportInstructions(instruction);\n                if (this.options.useConfiguredRoutes && !this.hasSiblingInstructions(instructions)) {\n                    const foundRoute = scope.findMatchingRoute(instruction);\n                    if (foundRoute !== null && foundRoute.foundConfiguration) {\n                        route = foundRoute;\n                    }\n                    else {\n                        if (this.options.useDirectRoutes) {\n                            route.instructions = instructions;\n                            if (route.instructions.length > 0) {\n                                const nextInstructions = route.instructions[0].nextScopeInstructions || [];\n                                route.remaining = this.instructionResolver.stringifyViewportInstructions(nextInstructions);\n                                route.instructions[0].nextScopeInstructions = null;\n                            }\n                        }\n                    }\n                }\n                else if (this.options.useDirectRoutes) {\n                    route.instructions = instructions;\n                }\n            }\n        }\n        else {\n            route.instructions = instruction;\n        }\n        for (const instr of route.instructions) {\n            if (instr.scope === null) {\n                instr.scope = instructionScope;\n            }\n        }\n        return route;\n    }\n    hasSiblingInstructions(instructions) {\n        if (instructions === null) {\n            return false;\n        }\n        if (instructions.length > 1) {\n            return true;\n        }\n        return instructions.some(instruction => this.hasSiblingInstructions(instruction.nextScopeInstructions));\n    }\n    appendInstructions(instructions, scope = null) {\n        if (scope === null) {\n            scope = this.rootScope.scope;\n        }\n        for (const instruction of instructions) {\n            if (instruction.scope === null) {\n                instruction.scope = scope;\n            }\n        }\n        this.appendedInstructions.push(...instructions);\n    }\n    checkStale(name, instructions) {\n        const staleCheck = this.staleChecks[name];\n        if (staleCheck === void 0) {\n            this.staleChecks[name] = instructions.slice();\n            return false;\n        }\n        if (staleCheck.length !== instructions.length) {\n            this.staleChecks[name] = instructions.slice();\n            return false;\n        }\n        for (let i = 0, ii = instructions.length; i < ii; i++) {\n            if (staleCheck[i] !== instructions[i]) {\n                this.staleChecks[name] = instructions.slice();\n                return false;\n            }\n        }\n        return true;\n    }\n    unknownRoute(route) {\n        if (typeof route !== 'string' || route.length === 0) {\n            return;\n        }\n        if (this.options.useConfiguredRoutes && this.options.useDirectRoutes) {\n            // TODO: Add missing/unknown route handling\n            throw new Error(`No matching configured route or component found for '${route}'`);\n        }\n        else if (this.options.useConfiguredRoutes) {\n            // TODO: Add missing/unknown route handling\n            throw new Error(`No matching configured route found for '${route}'`);\n        }\n        else {\n            // TODO: Add missing/unknown route handling\n            throw new Error(`No matching route/component found for '${route}'`);\n        }\n    }\n    findViewports(instructions, alreadyFound, withoutViewports = false) {\n        const found = [];\n        const remaining = [];\n        while (instructions.length) {\n            if (instructions[0].scope === null) {\n                instructions[0].scope = this.rootScope.scope;\n            }\n            const scope = instructions[0].scope;\n            const { foundViewports, remainingInstructions } = scope.findViewports(instructions.filter(instruction => instruction.scope === scope), alreadyFound, withoutViewports);\n            found.push(...foundViewports);\n            remaining.push(...remainingInstructions);\n            instructions = instructions.filter(instruction => instruction.scope !== scope);\n        }\n        return { found: found.slice(), remaining };\n    }\n    async cancelNavigation(updatedScopeOwners, qInstruction) {\n        // TODO: Take care of disabling viewports when cancelling and stateful!\n        updatedScopeOwners.forEach((viewport) => {\n            viewport.abortContentChange().catch(error => { throw error; });\n        });\n        await this.navigator.cancel(qInstruction);\n        this.processingNavigation = null;\n        qInstruction.resolve();\n    }\n    ensureRootScope() {\n        if (!this.rootScope) {\n            const root = this.container.get(Aurelia).root;\n            // root.config.component shouldn't be used in the end. Metadata will probably eliminate it\n            this.rootScope = new ViewportScope('rootScope', this, root.config.host, null, true, root.config.component);\n        }\n        return this.rootScope;\n    }\n    async replacePaths(instruction) {\n        this.rootScope.scope.reparentViewportInstructions();\n        let instructions = this.rootScope.scope.hoistedChildren\n            .filter(scope => scope.viewportInstruction !== null && !scope.viewportInstruction.isEmpty())\n            .map(scope => scope.viewportInstruction);\n        instructions = this.instructionResolver.cloneViewportInstructions(instructions, true);\n        // The following makes sure right viewport/viewport scopes are set and update\n        // whether viewport name is necessary or not\n        const alreadyFound = [];\n        let { found, remaining } = this.findViewports(instructions, alreadyFound, true);\n        let guard = 100;\n        while (remaining.length) {\n            // Guard against endless loop\n            if (!guard--) {\n                throw new Error('Failed to find viewport when updating viewer paths.');\n            }\n            alreadyFound.push(...found);\n            ({ found, remaining } = this.findViewports(remaining, alreadyFound, true));\n        }\n        this.activeComponents = instructions;\n        this.activeRoute = instruction.route;\n        // First invoke with viewport instructions (should it perhaps get full state?)\n        let state = await this.hookManager.invokeTransformToUrl(instructions, instruction);\n        if (typeof state !== 'string') {\n            // Convert to string if necessary\n            state = this.instructionResolver.stringifyViewportInstructions(state, false, true);\n        }\n        // Invoke again with string\n        state = await this.hookManager.invokeTransformToUrl(state, instruction);\n        const query = (instruction.query && instruction.query.length ? `?${instruction.query}` : '');\n        // if (instruction.path === void 0 || instruction.path.length === 0 || instruction.path === '/') {\n        instruction.path = state + query;\n        // }\n        const fullViewportStates = [this.createViewportInstruction(this.instructionResolver.clearViewportInstruction)];\n        fullViewportStates.push(...this.instructionResolver.cloneViewportInstructions(instructions, this.statefulHistory));\n        instruction.fullStateInstruction = fullViewportStates;\n        // TODO: Fetch and update title\n        return Promise.resolve();\n    }\n    async freeComponents(instruction, excludeComponents, alreadyDone) {\n        const component = instruction.componentInstance;\n        const viewport = instruction.viewport;\n        if (component === null || viewport === null || alreadyDone.some(done => done === component)) {\n            return;\n        }\n        if (!excludeComponents.some(exclude => exclude === component)) {\n            await viewport.freeContent(component);\n            alreadyDone.push(component);\n            return;\n        }\n        if (instruction.nextScopeInstructions !== null) {\n            for (const nextInstruction of instruction.nextScopeInstructions) {\n                await this.freeComponents(nextInstruction, excludeComponents, alreadyDone);\n            }\n        }\n    }\n    getClosestContainer(viewModelOrElement) {\n        if ('context' in viewModelOrElement) {\n            return viewModelOrElement.context;\n        }\n        if ('$controller' in viewModelOrElement) {\n            return viewModelOrElement.$controller.context;\n        }\n        const controller = this.CustomElementFor(viewModelOrElement);\n        if (controller === void 0) {\n            return null;\n        }\n        return controller.context;\n    }\n    getContainer(viewModelOrContainer) {\n        if ('resourceResolvers' in viewModelOrContainer) {\n            return viewModelOrContainer;\n        }\n        if (isRenderContext(viewModelOrContainer)) {\n            return viewModelOrContainer.get(IContainer);\n        }\n        if ('$controller' in viewModelOrContainer) {\n            return viewModelOrContainer.$controller.context.get(IContainer);\n        }\n        return null;\n    }\n    // TODO: This is probably wrong since it caused test fails when in CustomElement.for\n    // Fred probably knows and will need to look at it\n    // This can most likely also be changed so that the node traversal isn't necessary\n    CustomElementFor(node) {\n        let cur = node;\n        while (cur !== null) {\n            const nodeResourceName = cur.nodeName.toLowerCase();\n            const controller = Metadata.getOwn(`${CustomElement.name}:${nodeResourceName}`, cur)\n                || Metadata.getOwn(CustomElement.name, cur);\n            if (controller !== void 0) {\n                return controller;\n            }\n            cur = DOM.getEffectiveParentNode(cur);\n        }\n        return (void 0);\n    }\n}\nRouter.inject = [IContainer, Navigator, BrowserViewerStore, LinkHandler, InstructionResolver];\n//# sourceMappingURL=router.js.map","import { Reporter } from '@aurelia/kernel';\nimport { Queue } from './queue';\n/**\n * @internal - Shouldn't be used directly\n */\nexport class Navigator {\n    constructor() {\n        this.entries = [];\n        this.options = {\n            statefulHistoryLength: 0,\n        };\n        this.isActive = false;\n        this.processNavigations = (qEntry) => {\n            const entry = qEntry;\n            const navigationFlags = {};\n            if (this.currentEntry === this.uninitializedEntry) { // Refresh or first entry\n                this.loadState();\n                if (this.currentEntry !== this.uninitializedEntry) {\n                    navigationFlags.refresh = true;\n                }\n                else {\n                    navigationFlags.first = true;\n                    navigationFlags.new = true;\n                    // TODO: Should this really be created here? Shouldn't it be in the viewer?\n                    this.currentEntry = {\n                        index: 0,\n                        instruction: '',\n                        fullStateInstruction: '',\n                    };\n                    this.entries = [];\n                }\n            }\n            if (entry.index !== void 0 && !entry.replacing && !entry.refreshing) { // History navigation\n                entry.historyMovement = entry.index - (this.currentEntry.index !== void 0 ? this.currentEntry.index : 0);\n                entry.instruction = this.entries[entry.index] !== void 0 && this.entries[entry.index] !== null ? this.entries[entry.index].fullStateInstruction : entry.fullStateInstruction;\n                entry.replacing = true;\n                if (entry.historyMovement > 0) {\n                    navigationFlags.forward = true;\n                }\n                else if (entry.historyMovement < 0) {\n                    navigationFlags.back = true;\n                }\n            }\n            else if (entry.refreshing || navigationFlags.refresh) { // Refreshing\n                entry.index = this.currentEntry.index;\n            }\n            else if (entry.replacing) { // Replacing\n                navigationFlags.replace = true;\n                navigationFlags.new = true;\n                entry.index = this.currentEntry.index;\n            }\n            else { // New entry\n                navigationFlags.new = true;\n                entry.index = this.currentEntry.index !== void 0 ? this.currentEntry.index + 1 : this.entries.length;\n            }\n            this.invokeCallback(entry, navigationFlags, this.currentEntry);\n        };\n        this.uninitializedEntry = {\n            instruction: 'NAVIGATOR UNINITIALIZED',\n            fullStateInstruction: '',\n        };\n        this.currentEntry = this.uninitializedEntry;\n        this.pendingNavigations = new Queue(this.processNavigations);\n    }\n    get queued() {\n        return this.pendingNavigations.length;\n    }\n    activate(router, options) {\n        if (this.isActive) {\n            throw new Error('Navigator has already been activated');\n        }\n        this.isActive = true;\n        this.router = router;\n        this.options = { ...options };\n    }\n    deactivate() {\n        if (!this.isActive) {\n            throw new Error('Navigator has not been activated');\n        }\n        this.pendingNavigations.clear();\n        this.isActive = false;\n    }\n    navigate(entry) {\n        return this.pendingNavigations.enqueue(entry);\n    }\n    refresh() {\n        const entry = this.currentEntry;\n        if (entry === this.uninitializedEntry) {\n            return Promise.reject();\n        }\n        entry.replacing = true;\n        entry.refreshing = true;\n        return this.navigate(entry);\n    }\n    go(movement) {\n        const newIndex = (this.currentEntry.index !== undefined ? this.currentEntry.index : 0) + movement;\n        if (newIndex >= this.entries.length) {\n            return Promise.reject();\n        }\n        const entry = this.entries[newIndex];\n        return this.navigate(entry);\n    }\n    setEntryTitle(title) {\n        this.currentEntry.title = title;\n        return this.saveState();\n    }\n    get titles() {\n        if (this.currentEntry == this.uninitializedEntry) {\n            return [];\n        }\n        const index = this.currentEntry.index !== void 0 ? this.currentEntry.index : 0;\n        return this.entries.slice(0, index + 1).filter((value) => !!value.title).map((value) => value.title ? value.title : '');\n    }\n    getState() {\n        const state = this.options.store ? { ...this.options.store.state } : {};\n        const entries = (state.entries || []);\n        const currentEntry = (state.currentEntry || this.uninitializedEntry);\n        return { state, entries, currentEntry };\n    }\n    loadState() {\n        const state = this.getState();\n        this.entries = state.entries;\n        this.currentEntry = state.currentEntry;\n    }\n    async saveState(push = false) {\n        if (this.currentEntry === this.uninitializedEntry) {\n            return Promise.resolve();\n        }\n        const storedEntry = this.toStoredEntry(this.currentEntry);\n        this.entries[storedEntry.index !== undefined ? storedEntry.index : 0] = storedEntry;\n        if (this.options.serializeCallback !== void 0 && this.options.statefulHistoryLength > 0) {\n            const index = this.entries.length - this.options.statefulHistoryLength;\n            for (let i = 0; i < index; i++) {\n                const entry = this.entries[i];\n                if (typeof entry.instruction !== 'string' || typeof entry.fullStateInstruction !== 'string') {\n                    this.entries[i] = await this.options.serializeCallback(entry, this.entries.slice(index));\n                }\n            }\n        }\n        if (!this.options.store) {\n            return Promise.resolve();\n        }\n        const state = {\n            entries: [],\n            currentEntry: { ...this.toStoreableEntry(storedEntry) },\n        };\n        for (const entry of this.entries) {\n            state.entries.push(this.toStoreableEntry(entry));\n        }\n        if (push) {\n            return this.options.store.pushNavigatorState(state);\n        }\n        else {\n            return this.options.store.replaceNavigatorState(state);\n        }\n    }\n    toStoredEntry(entry) {\n        const { previous, fromBrowser, replacing, refreshing, untracked, historyMovement, navigation, scope, resolve, reject, ...storableEntry } = entry;\n        return storableEntry;\n    }\n    async finalize(instruction) {\n        this.currentEntry = instruction;\n        let index = this.currentEntry.index !== undefined ? this.currentEntry.index : 0;\n        if (this.currentEntry.untracked) {\n            if (instruction.fromBrowser && this.options.store) {\n                await this.options.store.popNavigatorState();\n            }\n            index--;\n            this.currentEntry.index = index;\n            this.entries[index] = this.toStoredEntry(this.currentEntry);\n            await this.saveState();\n        }\n        else if (this.currentEntry.replacing) {\n            this.entries[index] = this.toStoredEntry(this.currentEntry);\n            await this.saveState();\n        }\n        else { // New entry (add and discard later entries)\n            if (this.options.serializeCallback !== void 0 && this.options.statefulHistoryLength > 0) {\n                // Need to clear the instructions we discard!\n                const indexPreserve = this.entries.length - this.options.statefulHistoryLength;\n                for (const entry of this.entries.slice(index)) {\n                    if (typeof entry.instruction !== 'string' || typeof entry.fullStateInstruction !== 'string') {\n                        await this.options.serializeCallback(entry, this.entries.slice(indexPreserve, index));\n                    }\n                }\n            }\n            this.entries = this.entries.slice(0, index);\n            this.entries.push(this.toStoredEntry(this.currentEntry));\n            await this.saveState(true);\n        }\n        if (this.currentEntry.resolve) {\n            this.currentEntry.resolve();\n        }\n    }\n    async cancel(instruction) {\n        if (instruction.fromBrowser && this.options.store) {\n            if (instruction.navigation && instruction.navigation.new) {\n                await this.options.store.popNavigatorState();\n            }\n            else {\n                await this.options.store.go(-(instruction.historyMovement || 0), true);\n            }\n        }\n        if (this.currentEntry.resolve) {\n            this.currentEntry.resolve();\n        }\n    }\n    invokeCallback(entry, navigationFlags, previousEntry) {\n        const instruction = { ...entry };\n        instruction.navigation = navigationFlags;\n        instruction.previous = this.toStoredEntry(previousEntry);\n        Reporter.write(10000, 'callback', instruction, instruction.previous, this.entries);\n        if (this.options.callback) {\n            this.options.callback(instruction);\n        }\n    }\n    toStoreableEntry(entry) {\n        const storeable = { ...entry };\n        if (storeable.instruction && typeof storeable.instruction !== 'string') {\n            storeable.instruction = this.router.instructionResolver.stringifyViewportInstructions(storeable.instruction);\n        }\n        if (storeable.fullStateInstruction && typeof storeable.fullStateInstruction !== 'string') {\n            storeable.fullStateInstruction = this.router.instructionResolver.stringifyViewportInstructions(storeable.fullStateInstruction);\n        }\n        return storeable;\n    }\n}\n//# sourceMappingURL=navigator.js.map","import { ViewportInstruction } from './viewport-instruction';\nexport class InstructionResolver {\n    constructor() {\n        this.separators = {\n            viewport: '@',\n            sibling: '+',\n            scope: '/',\n            scopeStart: '(',\n            scopeEnd: ')',\n            noScope: '!',\n            parameters: '(',\n            parametersEnd: ')',\n            parameterSeparator: ',',\n            parameterKeySeparator: '=',\n            parameter: '&',\n            add: '+',\n            clear: '-',\n            action: '.',\n        };\n    }\n    activate(options) {\n        options = options || {};\n        this.separators = { ...this.separators, ...options.separators };\n    }\n    get clearViewportInstruction() {\n        return this.separators.clear;\n    }\n    get addViewportInstruction() {\n        return this.separators.add;\n    }\n    isClearViewportInstruction(instruction) {\n        return instruction instanceof ViewportInstruction\n            ? instruction.componentName === this.clearViewportInstruction && !!instruction.viewportName\n            : instruction.startsWith(this.clearViewportInstruction) && instruction !== this.clearViewportInstruction;\n    }\n    isAddViewportInstruction(instruction) {\n        return instruction instanceof ViewportInstruction\n            ? instruction.componentName === this.addViewportInstruction\n            : (instruction === this.addViewportInstruction\n                || instruction.startsWith(`${this.separators.add}${this.separators.viewport}`));\n    }\n    isClearViewportScopeInstruction(instruction) {\n        return instruction instanceof ViewportInstruction\n            ? instruction.componentName === this.clearViewportInstruction && !!instruction.viewportScope\n            : instruction.startsWith(this.clearViewportInstruction) && instruction !== this.clearViewportInstruction;\n    }\n    isClearAllViewportsInstruction(instruction) {\n        return instruction instanceof ViewportInstruction\n            ? instruction.componentName === this.clearViewportInstruction && !instruction.viewportName\n            : instruction === this.clearViewportInstruction;\n    }\n    isAddAllViewportsInstruction(instruction) {\n        return instruction instanceof ViewportInstruction\n            ? instruction.componentName === this.addViewportInstruction && !instruction.viewportName\n            : instruction === this.addViewportInstruction;\n    }\n    createViewportInstruction(component, viewport, parameters, ownsScope = true, nextScopeInstructions = null) {\n        const instruction = new ViewportInstruction(component, viewport, parameters, ownsScope, nextScopeInstructions);\n        instruction.setInstructionResolver(this);\n        return instruction;\n    }\n    parseViewportInstructions(instructions) {\n        const match = /^[./]+/.exec(instructions);\n        let context = '';\n        if (Array.isArray(match) && match.length > 0) {\n            context = match[0];\n            instructions = instructions.slice(context.length);\n        }\n        const parsedInstructions = this.parseViewportInstructionsWorker(instructions, true).instructions;\n        for (const instruction of parsedInstructions) {\n            instruction.context = context;\n        }\n        return parsedInstructions;\n    }\n    parseViewportInstruction(instruction) {\n        const instructions = this.parseViewportInstructions(instruction);\n        if (instructions.length) {\n            return instructions[0];\n        }\n        return this.createViewportInstruction('');\n    }\n    stringifyViewportInstructions(instructions, excludeViewport = false, viewportContext = false) {\n        return instructions\n            .map(instruction => this.stringifyViewportInstruction(instruction, excludeViewport, viewportContext))\n            .filter(instruction => instruction && instruction.length)\n            .join(this.separators.sibling);\n    }\n    stringifyViewportInstruction(instruction, excludeViewport = false, viewportContext = false) {\n        if (typeof instruction === 'string') {\n            return this.stringifyAViewportInstruction(instruction, excludeViewport);\n        }\n        else {\n            let excludeCurrentViewport = excludeViewport;\n            let excludeCurrentComponent = false;\n            if (viewportContext) {\n                if (instruction.viewport && instruction.viewport.options.noLink) {\n                    return '';\n                }\n                if (!instruction.needsViewportDescribed && instruction.viewport && !instruction.viewport.options.forceDescription) {\n                    excludeCurrentViewport = true;\n                }\n                if (instruction.viewport && instruction.viewport.options.fallback === instruction.componentName) {\n                    excludeCurrentComponent = true;\n                }\n                if (!instruction.needsViewportDescribed && instruction.viewportScope) {\n                    excludeCurrentViewport = true;\n                }\n            }\n            const route = instruction.route;\n            const nextInstructions = instruction.nextScopeInstructions;\n            let stringified = instruction.context;\n            // It's a configured route\n            if (route !== null) {\n                // Already added as part of a configuration, skip to next scope\n                if (route === '') {\n                    return Array.isArray(nextInstructions)\n                        ? this.stringifyViewportInstructions(nextInstructions, excludeViewport, viewportContext)\n                        : '';\n                }\n                stringified += route.endsWith(this.separators.scope) ? route.slice(0, -this.separators.scope.length) : route;\n            }\n            else {\n                stringified += this.stringifyAViewportInstruction(instruction, excludeCurrentViewport, excludeCurrentComponent);\n            }\n            if (Array.isArray(nextInstructions) && nextInstructions.length) {\n                const nextStringified = this.stringifyViewportInstructions(nextInstructions, excludeViewport, viewportContext);\n                if (nextStringified.length > 0) {\n                    stringified += nextInstructions.length === 1 // TODO: This should really also check that the instructions have value\n                        ? `${this.separators.scope}${nextStringified}`\n                        : `${this.separators.scope}${this.separators.scopeStart}${nextStringified}${this.separators.scopeEnd}`;\n                }\n            }\n            return stringified;\n        }\n    }\n    stringifyScopedViewportInstructions(instructions) {\n        if (!Array.isArray(instructions)) {\n            return this.stringifyScopedViewportInstructions([instructions]);\n        }\n        return instructions.map((instruction) => this.stringifyViewportInstruction(instruction)).join(this.separators.scope);\n    }\n    encodeViewportInstructions(instructions) {\n        return encodeURIComponent(this.stringifyViewportInstructions(instructions)).replace(/\\(/g, '%28').replace(/\\)/g, '%29');\n    }\n    decodeViewportInstructions(instructions) {\n        return this.parseViewportInstructions(decodeURIComponent(instructions));\n    }\n    buildScopedLink(scopeContext, href) {\n        if (scopeContext) {\n            href = `/${scopeContext}${this.separators.scope}${href}`;\n        }\n        return href;\n    }\n    shouldClearViewports(path) {\n        const clearViewports = (path === this.separators.clear || path.startsWith(this.separators.clear + this.separators.add));\n        const newPath = path.startsWith(this.separators.clear) ? path.slice(2) : path;\n        return { clearViewports, newPath };\n    }\n    mergeViewportInstructions(instructions) {\n        const merged = [];\n        for (let instruction of instructions) {\n            if (typeof instruction === 'string') {\n                instruction = this.parseViewportInstruction(instruction);\n            }\n            const index = merged.findIndex(merge => merge.sameViewport(instruction));\n            if (index >= 0) {\n                merged.splice(index, 1, instruction);\n            }\n            else {\n                merged.push(instruction);\n            }\n        }\n        return merged;\n    }\n    flattenViewportInstructions(instructions) {\n        const flat = [];\n        for (const instruction of instructions) {\n            flat.push(instruction);\n            if (instruction.nextScopeInstructions) {\n                flat.push(...this.flattenViewportInstructions(instruction.nextScopeInstructions));\n            }\n        }\n        return flat;\n    }\n    cloneViewportInstructions(instructions, keepInstances = false, context = false) {\n        const clones = [];\n        for (const instruction of instructions) {\n            const clone = this.createViewportInstruction((keepInstances ? instruction.componentInstance : null) || instruction.componentType || instruction.componentName, keepInstances ? instruction.viewport || instruction.viewportName : instruction.viewportName, instruction.typedParameters !== null ? instruction.typedParameters : void 0);\n            clone.needsViewportDescribed = instruction.needsViewportDescribed;\n            clone.route = instruction.route;\n            if (context) {\n                clone.context = instruction.context;\n            }\n            clone.viewportScope = keepInstances ? instruction.viewportScope : null;\n            clone.scope = keepInstances ? instruction.scope : null;\n            if (instruction.nextScopeInstructions) {\n                clone.nextScopeInstructions = this.cloneViewportInstructions(instruction.nextScopeInstructions, keepInstances, context);\n            }\n            clones.push(clone);\n        }\n        return clones;\n    }\n    // TODO: Deal with separators in data and complex types\n    parseComponentParameters(parameters, uriComponent = false) {\n        if (parameters === undefined || parameters === null || parameters.length === 0) {\n            return [];\n        }\n        if (typeof parameters === 'string') {\n            const list = [];\n            const params = parameters.split(this.separators.parameterSeparator);\n            for (const param of params) {\n                let key;\n                let value;\n                [key, value] = param.split(this.separators.parameterKeySeparator);\n                if (value === void 0) {\n                    value = uriComponent ? decodeURIComponent(key) : key;\n                    key = void 0;\n                }\n                else if (uriComponent) {\n                    key = decodeURIComponent(key);\n                    value = decodeURIComponent(value);\n                }\n                list.push({ key, value });\n            }\n            return list;\n        }\n        if (Array.isArray(parameters)) {\n            return parameters.map(param => ({ key: void 0, value: param }));\n        }\n        const keys = Object.keys(parameters);\n        keys.sort();\n        return keys.map(key => ({ key, value: parameters[key] }));\n    }\n    // TODO: Deal with separators in data and complex types\n    stringifyComponentParameters(parameters, uriComponent = false) {\n        if (!Array.isArray(parameters) || parameters.length === 0) {\n            return '';\n        }\n        const seps = this.separators;\n        return parameters\n            .map(param => {\n            const key = param.key !== void 0 && uriComponent ? encodeURIComponent(param.key) : param.key;\n            const value = uriComponent ? encodeURIComponent(param.value) : param.value;\n            return key !== void 0 && key !== value ? key + seps.parameterKeySeparator + value : value;\n        })\n            .join(seps.parameterSeparator);\n    }\n    matchScope(instructions, scope) {\n        const matching = [];\n        matching.push(...instructions.filter(instruction => instruction.scope === scope));\n        matching.push(...instructions\n            .filter(instr => instr.scope !== scope)\n            .map(instr => Array.isArray(instr.nextScopeInstructions) ? this.matchScope(instr.nextScopeInstructions, scope) : [])\n            .flat());\n        return matching;\n    }\n    matchChildren(instructions, active) {\n        for (const instruction of instructions) {\n            const matching = active.filter(instr => instr.sameComponent(instruction));\n            if (matching.length === 0) {\n                return false;\n            }\n            if (Array.isArray(instruction.nextScopeInstructions)\n                && instruction.nextScopeInstructions.length > 0\n                && this.matchChildren(instruction.nextScopeInstructions, matching.map(instr => Array.isArray(instr.nextScopeInstructions) ? instr.nextScopeInstructions : []).flat()) === false) {\n                return false;\n            }\n        }\n        return true;\n    }\n    parseViewportInstructionsWorker(instructions, grouped = false) {\n        if (!instructions) {\n            return { instructions: [], remaining: '' };\n        }\n        if (instructions.startsWith(this.separators.scopeStart)) {\n            instructions = `${this.separators.scope}${instructions}`;\n        }\n        const viewportInstructions = [];\n        let guard = 1000;\n        while (instructions.length && guard) {\n            guard--;\n            if (instructions.startsWith(this.separators.scope)) {\n                instructions = instructions.slice(this.separators.scope.length);\n                const scopeStart = instructions.startsWith(this.separators.scopeStart);\n                if (scopeStart) {\n                    instructions = instructions.slice(this.separators.scopeStart.length);\n                }\n                const { instructions: found, remaining } = this.parseViewportInstructionsWorker(instructions, scopeStart);\n                if (viewportInstructions.length) {\n                    viewportInstructions[viewportInstructions.length - 1].nextScopeInstructions = found;\n                }\n                else {\n                    viewportInstructions.push(...found);\n                }\n                instructions = remaining;\n            }\n            else if (instructions.startsWith(this.separators.scopeEnd)) {\n                if (grouped) {\n                    instructions = instructions.slice(this.separators.scopeEnd.length);\n                }\n                return { instructions: viewportInstructions, remaining: instructions };\n            }\n            else if (instructions.startsWith(this.separators.sibling) && !this.isAddViewportInstruction(instructions)) {\n                if (!grouped) {\n                    return { instructions: viewportInstructions, remaining: instructions };\n                }\n                instructions = instructions.slice(this.separators.sibling.length);\n            }\n            else {\n                const { instruction: viewportInstruction, remaining } = this.parseAViewportInstruction(instructions);\n                viewportInstructions.push(viewportInstruction);\n                instructions = remaining;\n            }\n        }\n        return { instructions: viewportInstructions, remaining: instructions };\n    }\n    findNextToken(instruction, tokens) {\n        const matches = {};\n        // Tokens can have length > 1\n        for (const token of tokens) {\n            const tokenPos = instruction.indexOf(token);\n            if (tokenPos > -1) {\n                matches[token] = instruction.indexOf(token);\n            }\n        }\n        const pos = Math.min(...Object.values(matches));\n        for (const token in matches) {\n            if (matches[token] === pos) {\n                return { token, pos };\n            }\n        }\n        return { token: '', pos: -1 };\n    }\n    parseAViewportInstruction(instruction) {\n        const seps = this.separators;\n        const tokens = [seps.parameters, seps.viewport, seps.noScope, seps.scopeEnd, seps.scope, seps.sibling];\n        let component = void 0;\n        let parametersString = void 0;\n        let viewport = void 0;\n        let scope = true;\n        let token;\n        let pos;\n        const specials = [seps.add, seps.clear];\n        for (const special of specials) {\n            if (instruction === special) {\n                component = instruction;\n                instruction = '';\n                tokens.shift(); // parameters\n                tokens.shift(); // viewport\n                token = seps.viewport;\n                break;\n            }\n        }\n        if (component === void 0) {\n            for (const special of specials) {\n                if (instruction.startsWith(`${special}${seps.viewport}`)) {\n                    component = special;\n                    instruction = instruction.slice(`${special}${seps.viewport}`.length);\n                    tokens.shift(); // parameters\n                    tokens.shift(); // viewport\n                    token = seps.viewport;\n                    break;\n                }\n            }\n        }\n        if (component === void 0) {\n            ({ token, pos } = this.findNextToken(instruction, tokens));\n            component = pos !== -1 ? instruction.slice(0, pos) : instruction;\n            instruction = pos !== -1 ? instruction.slice(pos + token.length) : '';\n            tokens.shift(); // parameters\n            if (token === seps.parameters) {\n                ({ token, pos } = this.findNextToken(instruction, [seps.parametersEnd]));\n                parametersString = instruction.slice(0, pos);\n                instruction = instruction.slice(pos + token.length);\n                ({ token } = this.findNextToken(instruction, tokens));\n                instruction = instruction.slice(token.length);\n            }\n            tokens.shift(); // viewport\n        }\n        if (token === seps.viewport) {\n            ({ token, pos } = this.findNextToken(instruction, tokens));\n            viewport = pos !== -1 ? instruction.slice(0, pos) : instruction;\n            instruction = pos !== -1 ? instruction.slice(pos + token.length) : '';\n        }\n        tokens.shift(); // noScope\n        if (token === seps.noScope) {\n            scope = false;\n        }\n        // Restore token that belongs to next instruction\n        if (token === seps.scopeEnd || token === seps.scope || token === seps.sibling) {\n            instruction = `${token}${instruction}`;\n        }\n        const viewportInstruction = this.createViewportInstruction(component, viewport, parametersString, scope);\n        return { instruction: viewportInstruction, remaining: instruction };\n    }\n    stringifyAViewportInstruction(instruction, excludeViewport = false, excludeComponent = false) {\n        if (typeof instruction === 'string') {\n            return this.stringifyViewportInstruction(this.parseViewportInstruction(instruction), excludeViewport, excludeComponent);\n        }\n        else {\n            let instructionString = !excludeComponent ? instruction.componentName : '';\n            const specification = instruction.componentType ? instruction.componentType.parameters : null;\n            const parameters = this.stringifyComponentParameters(instruction.toSortedParameters(specification));\n            if (parameters.length > 0) {\n                instructionString += !excludeComponent\n                    ? `${this.separators.parameters}${parameters}${this.separators.parametersEnd}`\n                    : parameters;\n            }\n            if (instruction.viewportName !== null && !excludeViewport) {\n                instructionString += this.separators.viewport + instruction.viewportName;\n            }\n            if (!instruction.ownsScope) {\n                instructionString += this.separators.noScope;\n            }\n            return instructionString || '';\n        }\n    }\n}\n//# sourceMappingURL=instruction-resolver.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport { inject } from '@aurelia/kernel';\nimport { bindable, customElement, INode } from '@aurelia/runtime';\nimport { IRouter } from '../router';\nlet NavCustomElement = class NavCustomElement {\n    constructor(router) {\n        this.router = router;\n        this.name = null;\n        this.routes = null;\n        this.level = 0;\n        this.classes = {};\n    }\n    get navRoutes() {\n        const nav = this.router.navs[this.name];\n        return (nav !== void 0 && nav !== null ? nav.routes : []);\n    }\n    get navClasses() {\n        const nav = this.router.navs[this.name];\n        const navClasses = (nav !== void 0 && nav !== null ? nav.classes : {});\n        return {\n            ...{\n                nav: '',\n                ul: '',\n                li: '',\n                a: '',\n                ulActive: '',\n                liActive: 'nav-active',\n                aActive: '',\n            }, ...navClasses\n        };\n    }\n    active(route) {\n        return 'Active';\n    }\n};\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Object)\n], NavCustomElement.prototype, \"name\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Object)\n], NavCustomElement.prototype, \"routes\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Number)\n], NavCustomElement.prototype, \"level\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Object)\n], NavCustomElement.prototype, \"classes\", void 0);\nNavCustomElement = __decorate([\n    inject(IRouter, INode),\n    customElement({\n        name: 'au-nav', template: `<template>\n  <nav if.bind=\"name\" class=\"\\${name} \\${navClasses.nav}\">\n    <au-nav routes.bind=\"navRoutes\" classes.bind=\"navClasses\" containerless></au-nav>\n  </nav>\n  <ul if.bind=\"routes\" class=\"nav-level-\\${level} \\${classes.ul}\">\n    <li repeat.for=\"route of routes\" if.bind=\"route.visible\" class=\"\\${route.active ? classes.liActive : ''} \\${route.hasChildren} \\${classes.li}\">\n      <a if.bind=\"route.link && route.link.length\" goto=\"\\${route.link}\" class=\"\\${route.active ? classes.aActive : ''} \\${classes.a}\" innerhtml.bind=\"route.title\"></a>\n      <a if.bind=\"route.execute\" click.trigger=\"route.executeAction($event)\" href=\"\" class=\"\\${route.active ? classes.aActive : ''} \\${classes.a}\" innerhtml.bind=\"route.title\"></a>\n      <span if.bind=\"(!route.link || !route.link.length) && !route.execute && !route.children\" class=\"\\${route.active ? classes.aActive : ''} \\${classes.span} nav-separator\" innerhtml.bind=\"route.title\"></span>\n      <a if.bind=\"(!route.link || !route.link.length) && !route.execute && route.children\" click.delegate=\"route.toggleActive()\" href=\"\" class=\"\\${route.active ? classes.aActive : ''} \\${classes.a}\" innerhtml.bind=\"route.title\"></a>\n      <au-nav if.bind=\"route.children\" routes.bind=\"route.children\" level.bind=\"level + 1\" classes.bind=\"classes\" containerless></au-nav>\n    </li>\n  </ul>\n</template>`\n    }),\n    __metadata(\"design:paramtypes\", [Object])\n], NavCustomElement);\nexport { NavCustomElement };\n//# sourceMappingURL=nav.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { IContainer } from '@aurelia/kernel';\nimport { bindable, INode, customElement, CustomElement, } from '@aurelia/runtime';\nimport { IRouter } from '../router';\nexport const ParentViewport = CustomElement.createInjectable();\nlet ViewportCustomElement = class ViewportCustomElement {\n    constructor(router, element, container, parentViewport) {\n        this.router = router;\n        this.container = container;\n        this.parentViewport = parentViewport;\n        this.name = 'default';\n        this.usedBy = '';\n        this.default = '';\n        this.fallback = '';\n        this.noScope = false;\n        this.noLink = false;\n        this.noHistory = false;\n        this.stateful = false;\n        this.viewport = null;\n        this.isBound = false;\n        this.element = element;\n    }\n    afterCompile(controller) {\n        this.container = controller.context.get(IContainer);\n        // console.log('Viewport creating', this.getAttribute('name', this.name), this.container, this.parentViewport, controller, this);\n        // this.connect();\n    }\n    afterUnbind() {\n        this.isBound = false;\n    }\n    connect() {\n        if (this.router.rootScope === null) {\n            return;\n        }\n        const name = this.getAttribute('name', this.name);\n        let value = this.getAttribute('no-scope', this.noScope);\n        const options = { scope: value === void 0 || !value ? true : false };\n        value = this.getAttribute('used-by', this.usedBy);\n        if (value !== void 0) {\n            options.usedBy = value;\n        }\n        value = this.getAttribute('default', this.default);\n        if (value !== void 0) {\n            options.default = value;\n        }\n        value = this.getAttribute('fallback', this.fallback);\n        if (value !== void 0) {\n            options.fallback = value;\n        }\n        value = this.getAttribute('no-link', this.noLink, true);\n        if (value !== void 0) {\n            options.noLink = value;\n        }\n        value = this.getAttribute('no-history', this.noHistory, true);\n        if (value !== void 0) {\n            options.noHistory = value;\n        }\n        value = this.getAttribute('stateful', this.stateful, true);\n        if (value !== void 0) {\n            options.stateful = value;\n        }\n        this.viewport = this.router.connectViewport(this.viewport, this.container, name, this.element, options);\n    }\n    disconnect() {\n        if (this.viewport) {\n            this.router.disconnectViewport(this.viewport, this.container, this.element);\n        }\n        this.viewport = null;\n    }\n    beforeBind(flags) {\n        this.isBound = true;\n        this.connect();\n        if (this.viewport) {\n            this.viewport.beforeBind(flags);\n        }\n    }\n    beforeAttach(flags) {\n        if (this.viewport) {\n            return this.viewport.beforeAttach(flags);\n        }\n        return Promise.resolve();\n    }\n    beforeDetach(flags) {\n        if (this.viewport) {\n            return this.viewport.beforeDetach(flags);\n        }\n        return Promise.resolve();\n    }\n    async beforeUnbind(flags) {\n        if (this.viewport) {\n            await this.viewport.beforeUnbind(flags);\n            this.disconnect();\n        }\n    }\n    getAttribute(key, value, checkExists = false) {\n        const result = {};\n        if (this.isBound && !checkExists) {\n            return value;\n        }\n        else {\n            if (this.element.hasAttribute(key)) {\n                if (checkExists) {\n                    return true;\n                }\n                else {\n                    value = this.element.getAttribute(key);\n                    if (value.length > 0) {\n                        return value;\n                    }\n                }\n            }\n        }\n        return void 0;\n    }\n};\n__decorate([\n    bindable,\n    __metadata(\"design:type\", String)\n], ViewportCustomElement.prototype, \"name\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", String)\n], ViewportCustomElement.prototype, \"usedBy\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", String)\n], ViewportCustomElement.prototype, \"default\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", String)\n], ViewportCustomElement.prototype, \"fallback\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Boolean)\n], ViewportCustomElement.prototype, \"noScope\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Boolean)\n], ViewportCustomElement.prototype, \"noLink\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Boolean)\n], ViewportCustomElement.prototype, \"noHistory\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Boolean)\n], ViewportCustomElement.prototype, \"stateful\", void 0);\nViewportCustomElement = __decorate([\n    customElement({\n        name: 'au-viewport',\n        injectable: ParentViewport\n    }),\n    __param(0, IRouter),\n    __param(1, INode),\n    __param(2, IContainer),\n    __param(3, ParentViewport),\n    __metadata(\"design:paramtypes\", [Object, Object, Object, ViewportCustomElement])\n], ViewportCustomElement);\nexport { ViewportCustomElement };\n//# sourceMappingURL=viewport.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { bindable, INode, customElement, CustomElement, CustomElementDefinition, IController, } from '@aurelia/runtime';\nimport { IRouter } from '../router';\nimport { IContainer } from '@aurelia/kernel';\nexport const ParentViewportScope = CustomElement.createInjectable();\nlet ViewportScopeCustomElement = class ViewportScopeCustomElement {\n    constructor(router, element, container, parent, parentController) {\n        this.router = router;\n        this.container = container;\n        this.parent = parent;\n        this.parentController = parentController;\n        this.name = 'default';\n        this.catches = '';\n        this.collection = false;\n        this.source = null;\n        this.viewportScope = null;\n        this.isBound = false;\n        this.element = element;\n    }\n    create(controller, parentContainer, definition, parts) {\n        // TODO(fkleuver): describe this somewhere in the docs instead\n        // Under the condition that there is no `replace` attribute on this custom element's declaration,\n        // and this custom element is containerless, its content will be placed in a part named 'default'\n        // See packages/jit-html/src/template-binder.ts line 411 (`replace = 'default';`) for the logic that governs this.\n        // We could tidy this up into a formal api in the future. For now, there are two ways to do this:\n        // 1. inject the `@ITargetedInstruction` (IHydrateElementInstruction) and grab .parts['default'] from there, manually creating a view factory from that, etc.\n        // 2. what we're doing right here: grab the 'default' part from the create hook and return it as the definition, telling the render context to use that part to compile this element instead\n        // This effectively causes this element to render its declared content as if it was its own template.\n        // We do need to set `containerless` to true on the part definition so that the correct projector is used since parts default to non-containerless.\n        // Otherwise, the controller will try to do `appendChild` on a comment node when it has to do `insertBefore`.\n        // Also, in this particular scenario (specific to viewport-scope) we need to clone the part so as to prevent the resulting compiled definition\n        // from ever being cached. That's the only reason why we're spreading the part into a new object for `getOrCreate`. If we didn't clone the object, this specific element wouldn't work correctly.\n        const part = parts['default'];\n        return CustomElementDefinition.getOrCreate({ ...part, containerless: true });\n    }\n    afterCompile(controller) {\n        this.container = controller.context.get(IContainer);\n        // console.log('ViewportScope creating', this.getAttribute('name', this.name), this.container, this.parent, controller, this);\n        // this.connect();\n    }\n    afterUnbound() {\n        this.isBound = false;\n    }\n    connect() {\n        if (this.router.rootScope === null) {\n            return;\n        }\n        const name = this.getAttribute('name', this.name);\n        const options = {};\n        let value = this.getAttribute('catches', this.catches);\n        if (value !== void 0) {\n            options.catches = value;\n        }\n        value = this.getAttribute('collection', this.collection, true);\n        if (value !== void 0) {\n            options.collection = value;\n        }\n        // TODO: Needs to be bound? How to solve?\n        options.source = this.source || null;\n        this.viewportScope = this.router.connectViewportScope(this.viewportScope, name, this.container, this.element, options);\n    }\n    disconnect() {\n        if (this.viewportScope) {\n            this.router.disconnectViewportScope(this.viewportScope, this.container);\n        }\n        this.viewportScope = null;\n    }\n    beforeBind(flags) {\n        this.isBound = true;\n        this.$controller.scope = this.parentController.scope;\n        this.connect();\n        if (this.viewportScope !== null) {\n            this.viewportScope.beforeBind();\n        }\n    }\n    async beforeUnbind(flags) {\n        if (this.viewportScope !== null) {\n            this.viewportScope.beforeUnbind();\n        }\n        this.disconnect();\n        return Promise.resolve();\n    }\n    getAttribute(key, value, checkExists = false) {\n        const result = {};\n        if (this.isBound) {\n            return value;\n        }\n        else {\n            if (this.element.hasAttribute(key)) {\n                if (checkExists) {\n                    return true;\n                }\n                else {\n                    value = this.element.getAttribute(key);\n                    if (value.length > 0) {\n                        return value;\n                    }\n                }\n            }\n        }\n        return void 0;\n    }\n};\n__decorate([\n    bindable,\n    __metadata(\"design:type\", String)\n], ViewportScopeCustomElement.prototype, \"name\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", String)\n], ViewportScopeCustomElement.prototype, \"catches\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Boolean)\n], ViewportScopeCustomElement.prototype, \"collection\", void 0);\n__decorate([\n    bindable,\n    __metadata(\"design:type\", Object)\n], ViewportScopeCustomElement.prototype, \"source\", void 0);\nViewportScopeCustomElement = __decorate([\n    customElement({\n        name: 'au-viewport-scope',\n        template: '<template></template>',\n        containerless: true,\n        injectable: ParentViewportScope\n    }),\n    __param(0, IRouter),\n    __param(1, INode),\n    __param(2, IContainer),\n    __param(3, ParentViewportScope),\n    __param(4, IController),\n    __metadata(\"design:paramtypes\", [Object, Object, Object, ViewportScopeCustomElement, Object])\n], ViewportScopeCustomElement);\nexport { ViewportScopeCustomElement };\n//# sourceMappingURL=viewport-scope.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { NavigationInstructionResolver } from '../type-resolvers';\nimport { customAttribute, INode, bindable, BindingMode, IDOM, DelegationStrategy, IObserverLocator, CustomAttribute } from '@aurelia/runtime';\nimport { IRouter } from '../router';\nimport { IEventManager } from '@aurelia/runtime-html';\nlet GotoCustomAttribute = class GotoCustomAttribute {\n    constructor(dom, element, router, eventManager) {\n        this.dom = dom;\n        this.router = router;\n        this.eventManager = eventManager;\n        this.listener = null;\n        this.hasHref = null;\n        this.activeClass = 'goto-active';\n        this.element = element;\n    }\n    beforeBind() {\n        this.listener = this.eventManager.addEventListener(this.dom, this.element, 'click', this.router.linkHandler.handler, DelegationStrategy.none);\n        this.updateValue();\n        const observerLocator = this.router.container.get(IObserverLocator);\n        this.observer = observerLocator.getObserver(0 /* none */, this.router, 'activeComponents');\n        this.observer.subscribe(this);\n    }\n    beforeUnbind() {\n        if (this.listener !== null) {\n            this.listener.dispose();\n        }\n        this.observer.unsubscribe(this);\n    }\n    valueChanged(newValue) {\n        this.updateValue();\n    }\n    updateValue() {\n        if (this.hasHref === null) {\n            this.hasHref = this.element.hasAttribute('href');\n        }\n        if (!this.hasHref) {\n            // TODO: Figure out a better value here for non-strings (using InstructionResolver?)\n            const value = typeof this.value === 'string' ? this.value : JSON.stringify(this.value);\n            this.element.setAttribute('href', value);\n        }\n    }\n    handleChange() {\n        const controller = CustomAttribute.for(this.element, 'goto').parent;\n        const created = NavigationInstructionResolver.createViewportInstructions(this.router, this.value, { context: controller });\n        const instructions = NavigationInstructionResolver.toViewportInstructions(this.router, created.instructions);\n        for (const instruction of instructions) {\n            if (instruction.scope === null) {\n                instruction.scope = created.scope;\n            }\n        }\n        // TODO: Use router configuration for class name and update target\n        if (this.router.checkActive(instructions)) {\n            this.element.classList.add(this.activeClass);\n        }\n        else {\n            this.element.classList.remove(this.activeClass);\n        }\n    }\n};\n__decorate([\n    bindable({ mode: BindingMode.toView }),\n    __metadata(\"design:type\", Object)\n], GotoCustomAttribute.prototype, \"value\", void 0);\nGotoCustomAttribute = __decorate([\n    customAttribute('goto'),\n    __param(0, IDOM),\n    __param(1, INode),\n    __param(2, IRouter),\n    __param(3, IEventManager),\n    __metadata(\"design:paramtypes\", [Object, Object, Object, Object])\n], GotoCustomAttribute);\nexport { GotoCustomAttribute };\n//# sourceMappingURL=goto.js.map","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { customAttribute, INode, bindable, BindingMode, IDOM, DelegationStrategy } from '@aurelia/runtime';\nimport { IRouter } from '../router';\nimport { GotoCustomAttribute } from '../configuration';\nimport { IEventManager } from '@aurelia/runtime-html';\nlet HrefCustomAttribute = class HrefCustomAttribute {\n    constructor(dom, element, router, eventManager) {\n        this.dom = dom;\n        this.router = router;\n        this.eventManager = eventManager;\n        this.eventListener = null;\n        this.element = element;\n    }\n    beforeBind() {\n        if (this.router.options.useHref && !this.hasGoto()) {\n            this.eventListener = this.eventManager.addEventListener(this.dom, this.element, 'click', this.router.linkHandler.handler, DelegationStrategy.none);\n        }\n        this.updateValue();\n    }\n    beforeUnbind() {\n        if (this.eventListener !== null) {\n            this.eventListener.dispose();\n        }\n    }\n    valueChanged() {\n        this.updateValue();\n    }\n    updateValue() {\n        this.element.setAttribute('href', this.value);\n    }\n    hasGoto() {\n        const parent = this.$controller.parent;\n        const siblings = parent.vmKind !== 1 /* customAttribute */ ? parent.controllers : void 0;\n        return siblings !== void 0\n            && siblings.some(c => c.vmKind === 1 /* customAttribute */ && c.viewModel instanceof GotoCustomAttribute);\n    }\n};\n__decorate([\n    bindable({ mode: BindingMode.toView }),\n    __metadata(\"design:type\", Object)\n], HrefCustomAttribute.prototype, \"value\", void 0);\nHrefCustomAttribute = __decorate([\n    customAttribute({\n        name: 'href',\n        noMultiBindings: true\n    }),\n    __param(0, IDOM),\n    __param(1, INode),\n    __param(2, IRouter),\n    __param(3, IEventManager),\n    __metadata(\"design:paramtypes\", [Object, Object, Object, Object])\n], HrefCustomAttribute);\nexport { HrefCustomAttribute };\n//# sourceMappingURL=href.js.map","import { DI } from '@aurelia/kernel';\nimport { StartTask } from '@aurelia/runtime';\nimport { NavCustomElement } from './resources/nav';\nimport { ViewportCustomElement } from './resources/viewport';\nimport { ViewportScopeCustomElement } from './resources/viewport-scope';\nimport { GotoCustomAttribute } from './resources/goto';\nimport { HrefCustomAttribute } from './resources/href';\nimport { IRouter } from './router';\nexport const RouterRegistration = IRouter;\n/**\n * Default runtime/environment-agnostic implementations for the following interfaces:\n * - `IRouter`\n */\nexport const DefaultComponents = [\n    RouterRegistration,\n];\nexport { ViewportCustomElement, ViewportScopeCustomElement, NavCustomElement, GotoCustomAttribute, HrefCustomAttribute, };\nexport const ViewportCustomElementRegistration = ViewportCustomElement;\nexport const ViewportScopeCustomElementRegistration = ViewportScopeCustomElement;\nexport const NavCustomElementRegistration = NavCustomElement;\nexport const GotoCustomAttributeRegistration = GotoCustomAttribute;\nexport const HrefCustomAttributeRegistration = HrefCustomAttribute;\n/**\n * Default router resources:\n * - Custom Elements: `au-viewport`, `au-nav`\n * - Custom Attributes: `goto`, `href`\n */\nexport const DefaultResources = [\n    ViewportCustomElement,\n    ViewportScopeCustomElement,\n    NavCustomElement,\n    GotoCustomAttribute,\n    HrefCustomAttribute,\n];\nlet configurationOptions = {};\nlet configurationCall = (router) => {\n    router.activate(configurationOptions);\n};\n/**\n * A DI configuration object containing router resource registrations.\n */\nconst routerConfiguration = {\n    /**\n     * Apply this configuration to the provided container.\n     */\n    register(container) {\n        return container.register(...DefaultComponents, ...DefaultResources, StartTask.with(IRouter).beforeBind().call(configurationCall), StartTask.with(IRouter).beforeAttach().call(router => router.loadUrl()));\n    },\n    /**\n     * Create a new container with this configuration applied to it.\n     */\n    createContainer() {\n        return this.register(DI.createContainer());\n    }\n};\nexport const RouterConfiguration = {\n    /**\n     * Make it possible to specify options to Router activation.\n     * Parameter is either a config object that's passed to Router's activate\n     * or a config function that's called instead of Router's activate.\n     */\n    customize(config) {\n        if (config === undefined) {\n            configurationOptions = {};\n            configurationCall = (router) => {\n                router.activate(configurationOptions);\n            };\n        }\n        else if (config instanceof Function) {\n            configurationCall = config;\n        }\n        else {\n            configurationOptions = config;\n        }\n        return { ...routerConfiguration };\n    },\n    ...routerConfiguration,\n};\n//# sourceMappingURL=configuration.js.map","<h1>${message}</h1>\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nimport * as __au2ViewDef from './welcome.html';\r\nimport { customElement } from '@aurelia/runtime';\r\nlet Welcome = class Welcome {\r\n    constructor() {\r\n        this.message = 'Welcome to Aurelia 2!';\r\n    }\r\n};\r\nWelcome = __decorate([\r\n    customElement(__au2ViewDef)\r\n], Welcome);\r\nexport { Welcome };\r\n","<h1>The about page.</h1>\n","<h3>Ouch! Couldn't find '${missingComponent}'!</h3>\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nimport * as __au2ViewDef from './missing.html';\r\nimport { customElement } from '@aurelia/runtime';\r\nlet Missing = class Missing {\r\n    enter(parameters) {\r\n        this.missingComponent = parameters.id;\r\n    }\r\n};\r\nMissing.parameters = ['id'];\r\nMissing = __decorate([\r\n    customElement(__au2ViewDef)\r\n], Missing);\r\nexport { Missing };\r\n","<import from=\"./welcome\"></import>\n<import from=\"./about.html\"></import>\n<import from=\"./missing\"></import>\n\n<nav>\n  <a goto=\"welcome\">Welcome</a>\n  <a goto=\"about\">About</a>\n</nav>\n\n<au-viewport default=\"welcome\" fallback=\"missing\"></au-viewport>\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nimport * as __au2ViewDef from './my-app.html';\r\nimport { customElement } from '@aurelia/runtime';\r\nlet MyApp = class MyApp {\r\n};\r\nMyApp = __decorate([\r\n    customElement(__au2ViewDef)\r\n], MyApp);\r\nexport { MyApp };\r\n","import Aurelia, { RouterConfiguration } from 'aurelia';\r\nimport { MyApp } from './my-app';\r\nAurelia\r\n    .register(RouterConfiguration)\r\n    // To use HTML5 pushState routes, replace previous line with the following\r\n    // customized router config.\r\n    // .register(RouterConfiguration.customize({ useUrlFragmentHash: false }))\r\n    .app(MyApp)\r\n    .start();\r\n"],"sourceRoot":""}